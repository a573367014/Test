var _0x509b=['getMap','locateNode','removeNode','locatePoint','removeFromMap','isInterior','poly2tri','noConflict','VERSION','sweep','Point','Triangle','area','gluTessNormal','gluTessBeginPolygon','tessy\x20tesselation','gluTessBeginContour','gluTessVertex','ExtrudeBufferGeometry','extrudeScale','curveSegmentsAdaptive','isDeformationON','extrudePath','charFlag','shadingSmoothAngle','computeVertexNormals4TextgeometryYunyang','shape','steps','depth','triangulateMethod','earcut','bevelEnabled','bevelThickness','bevelSize','bevelSegments','bevelType','quad_ellipse','UVGenerator','extrudeOffsetY','laplacianIterationNumb','THREE.ExtrudeBufferGeometry:\x20amount\x20has\x20been\x20renamed\x20to\x20depth.','amount','getSpacedPoints','computeFrenetFrames','holes','isClockWise','reverse','triangulateShape','triangulateShapePoly2tri','inPt\x20and\x20inPrev\x20are\x20the\x20same\x20point','sign','line','generateTopUV','generateSideWallUVExtend','SQRT2','abAngle<0\x20||\x20abAngle>180','options','[object\x20process]','require','base64','ascii','worker_threads','Worker','Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwp2YXIgY29tbW9uanNHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxUaGlzIDogdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB7fTsKCmZ1bmN0aW9uIHVud3JhcEV4cG9ydHMgKHgpIHsKCXJldHVybiB4ICYmIHguX19lc01vZHVsZSAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoeCwgJ2RlZmF1bHQnKSA/IHhbJ2RlZmF1bHQnXSA6IHg7Cn0KCmZ1bmN0aW9uIGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZuLCBtb2R1bGUpIHsKCXJldHVybiBtb2R1bGUgPSB7IGV4cG9ydHM6IHt9IH0sIGZuKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMpLCBtb2R1bGUuZXhwb3J0czsKfQoKZnVuY3Rpb24gZ2V0Q2pzRXhwb3J0RnJvbU5hbWVzcGFjZSAobikgewoJcmV0dXJuIG4gJiYgblsnZGVmYXVsdCddIHx8IG47Cn0KCnZhciBhcnJheVdpdGhIb2xlcyA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICBmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7CiAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOwogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfYXJyYXlXaXRoSG9sZXMsIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp1bndyYXBFeHBvcnRzKGFycmF5V2l0aEhvbGVzKTsKCnZhciBpdGVyYWJsZVRvQXJyYXlMaW1pdCA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICBmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7CiAgICB2YXIgX2kgPSBhcnIgPT0gbnVsbCA/IG51bGwgOiB0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiAmJiBhcnJbU3ltYm9sLml0ZXJhdG9yXSB8fCBhcnJbIkBAaXRlcmF0b3IiXTsKCiAgICBpZiAoX2kgPT0gbnVsbCkgcmV0dXJuOwogICAgdmFyIF9hcnIgPSBbXTsKICAgIHZhciBfbiA9IHRydWU7CiAgICB2YXIgX2QgPSBmYWxzZTsKCiAgICB2YXIgX3MsIF9lOwoKICAgIHRyeSB7CiAgICAgIGZvciAoX2kgPSBfaS5jYWxsKGFycik7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGVycikgewogICAgICBfZCA9IHRydWU7CiAgICAgIF9lID0gZXJyOwogICAgfSBmaW5hbGx5IHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBpZiAoX2QpIHRocm93IF9lOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIF9hcnI7CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IF9pdGVyYWJsZVRvQXJyYXlMaW1pdCwgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKfSk7CnVud3JhcEV4cG9ydHMoaXRlcmFibGVUb0FycmF5TGltaXQpOwoKdmFyIGFycmF5TGlrZVRvQXJyYXkgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7CiAgZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsKICAgIGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOwoKICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgewogICAgICBhcnIyW2ldID0gYXJyW2ldOwogICAgfQoKICAgIHJldHVybiBhcnIyOwogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfYXJyYXlMaWtlVG9BcnJheSwgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKfSk7CnVud3JhcEV4cG9ydHMoYXJyYXlMaWtlVG9BcnJheSk7Cgp2YXIgdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7CiAgZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgewogICAgaWYgKCFvKSByZXR1cm47CiAgICBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOwogICAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOwogICAgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7CiAgICBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOwogICAgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOwogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXksIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp1bndyYXBFeHBvcnRzKHVuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KTsKCnZhciBub25JdGVyYWJsZVJlc3QgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7CiAgZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IF9ub25JdGVyYWJsZVJlc3QsIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp1bndyYXBFeHBvcnRzKG5vbkl0ZXJhYmxlUmVzdCk7Cgp2YXIgc2xpY2VkVG9BcnJheSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICBmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsKICAgIHJldHVybiBhcnJheVdpdGhIb2xlcyhhcnIpIHx8IGl0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBub25JdGVyYWJsZVJlc3QoKTsKICB9CgogIG1vZHVsZS5leHBvcnRzID0gX3NsaWNlZFRvQXJyYXksIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp2YXIgX3NsaWNlZFRvQXJyYXkgPSB1bndyYXBFeHBvcnRzKHNsaWNlZFRvQXJyYXkpOwoKdmFyIHJlYWRPbmx5RXJyb3IgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7CiAgZnVuY3Rpb24gX3JlYWRPbmx5RXJyb3IobmFtZSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiXCIiICsgbmFtZSArICJcIiBpcyByZWFkLW9ubHkiKTsKICB9CgogIG1vZHVsZS5leHBvcnRzID0gX3JlYWRPbmx5RXJyb3IsIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp2YXIgX3JlYWRPbmx5RXJyb3IgPSB1bndyYXBFeHBvcnRzKHJlYWRPbmx5RXJyb3IpOwoKdmFyIGNsYXNzQ2FsbENoZWNrID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkgewogIGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgfQogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfY2xhc3NDYWxsQ2hlY2ssIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp2YXIgX2NsYXNzQ2FsbENoZWNrID0gdW53cmFwRXhwb3J0cyhjbGFzc0NhbGxDaGVjayk7Cgp2YXIgY3JlYXRlQ2xhc3MgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7CiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogICAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCAicHJvdG90eXBlIiwgewogICAgICB3cml0YWJsZTogZmFsc2UKICAgIH0pOwogICAgcmV0dXJuIENvbnN0cnVjdG9yOwogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfY3JlYXRlQ2xhc3MsIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp2YXIgX2NyZWF0ZUNsYXNzID0gdW53cmFwRXhwb3J0cyhjcmVhdGVDbGFzcyk7CgovKioKICogQGF1dGhvciBtcmRvb2IgLyBodHRwOi8vbXJkb29iLmNvbS8KICogQGF1dGhvciBwaGlsb2diIC8gaHR0cDovL2Jsb2cudGhlaml0Lm9yZy8KICogQGF1dGhvciBlZ3JhZXRoZXIgLyBodHRwOi8vZWdyYWV0aGVyLmNvbS8KICogQGF1dGhvciB6ejg1IC8gaHR0cDovL3d3dy5sYWI0Z2FtZXMubmV0L3p6ODUvYmxvZwogKi8KdmFyIFZlY3RvcjIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFZlY3RvcjIoeCwgeSkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZlY3RvcjIpOwoKICAgIHRoaXMueCA9IHggfHwgMDsKICAgIHRoaXMueSA9IHkgfHwgMDsKICAgIHRoaXMuaXNWZWN0b3IyID0gdHJ1ZTsKICB9CgogIF9jcmVhdGVDbGFzcyhWZWN0b3IyLCBbewogICAga2V5OiAic2V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXQoeCwgeSkgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRTY2FsYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFNjYWxhcihzY2FsYXIpIHsKICAgICAgdGhpcy54ID0gc2NhbGFyOwogICAgICB0aGlzLnkgPSBzY2FsYXI7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFgoeCkgewogICAgICB0aGlzLnggPSB4OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRZIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRZKHkpIHsKICAgICAgdGhpcy55ID0geTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Q29tcG9uZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRDb21wb25lbnQoaW5kZXgsIHZhbHVlKSB7CiAgICAgIHN3aXRjaCAoaW5kZXgpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICB0aGlzLnggPSB2YWx1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICB0aGlzLnkgPSB2YWx1ZTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbmRleCBpcyBvdXQgb2YgcmFuZ2U6ICcgKyBpbmRleCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImdldENvbXBvbmVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29tcG9uZW50KGluZGV4KSB7CiAgICAgIHN3aXRjaCAoaW5kZXgpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICByZXR1cm4gdGhpcy54OwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXR1cm4gdGhpcy55OwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbmRleCBpcyBvdXQgb2YgcmFuZ2U6ICcgKyBpbmRleCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngsIHRoaXMueSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29weSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29weSh2KSB7CiAgICAgIHRoaXMueCA9IHYueDsKICAgICAgdGhpcy55ID0gdi55OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZCh2LCB3KSB7CiAgICAgIGlmICh3ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLlZlY3RvcjI6IC5hZGQoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5hZGRWZWN0b3JzKCBhLCBiICkgaW5zdGVhZC4nKTsKICAgICAgICByZXR1cm4gdGhpcy5hZGRWZWN0b3JzKHYsIHcpOwogICAgICB9CgogICAgICB0aGlzLnggKz0gdi54OwogICAgICB0aGlzLnkgKz0gdi55OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGRTY2FsYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFNjYWxhcihzKSB7CiAgICAgIHRoaXMueCArPSBzOwogICAgICB0aGlzLnkgKz0gczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWRkVmVjdG9ycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkVmVjdG9ycyhhLCBiKSB7CiAgICAgIHRoaXMueCA9IGEueCArIGIueDsKICAgICAgdGhpcy55ID0gYS55ICsgYi55OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGRTY2FsZWRWZWN0b3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFNjYWxlZFZlY3Rvcih2LCBzKSB7CiAgICAgIHRoaXMueCArPSB2LnggKiBzOwogICAgICB0aGlzLnkgKz0gdi55ICogczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic3ViIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdWIodiwgdykgewogICAgICBpZiAodyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdUSFJFRS5WZWN0b3IyOiAuc3ViKCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAuc3ViVmVjdG9ycyggYSwgYiApIGluc3RlYWQuJyk7CiAgICAgICAgcmV0dXJuIHRoaXMuc3ViVmVjdG9ycyh2LCB3KTsKICAgICAgfQoKICAgICAgdGhpcy54IC09IHYueDsKICAgICAgdGhpcy55IC09IHYueTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic3ViU2NhbGFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJTY2FsYXIocykgewogICAgICB0aGlzLnggLT0gczsKICAgICAgdGhpcy55IC09IHM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInN1YlZlY3RvcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN1YlZlY3RvcnMoYSwgYikgewogICAgICB0aGlzLnggPSBhLnggLSBiLng7CiAgICAgIHRoaXMueSA9IGEueSAtIGIueTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibXVsdGlwbHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG11bHRpcGx5KHYpIHsKICAgICAgdGhpcy54ICo9IHYueDsKICAgICAgdGhpcy55ICo9IHYueTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibXVsdGlwbHlTY2FsYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG11bHRpcGx5U2NhbGFyKHNjYWxhcikgewogICAgICB0aGlzLnggKj0gc2NhbGFyOwogICAgICB0aGlzLnkgKj0gc2NhbGFyOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXZpZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpdmlkZSh2KSB7CiAgICAgIHRoaXMueCAvPSB2Lng7CiAgICAgIHRoaXMueSAvPSB2Lnk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImRpdmlkZVNjYWxhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGl2aWRlU2NhbGFyKHNjYWxhcikgewogICAgICByZXR1cm4gdGhpcy5tdWx0aXBseVNjYWxhcigxIC8gc2NhbGFyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhcHBseU1hdHJpeDMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5TWF0cml4MyhtKSB7CiAgICAgIHZhciB4ID0gdGhpcy54LAogICAgICAgICAgeSA9IHRoaXMueTsKICAgICAgdmFyIGUgPSBtLmVsZW1lbnRzOwogICAgICB0aGlzLnggPSBlWzBdICogeCArIGVbM10gKiB5ICsgZVs2XTsKICAgICAgdGhpcy55ID0gZVsxXSAqIHggKyBlWzRdICogeSArIGVbN107CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm1pbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWluKHYpIHsKICAgICAgdGhpcy54ID0gTWF0aC5taW4odGhpcy54LCB2LngpOwogICAgICB0aGlzLnkgPSBNYXRoLm1pbih0aGlzLnksIHYueSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm1heCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWF4KHYpIHsKICAgICAgdGhpcy54ID0gTWF0aC5tYXgodGhpcy54LCB2LngpOwogICAgICB0aGlzLnkgPSBNYXRoLm1heCh0aGlzLnksIHYueSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImNsYW1wIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGFtcChtaW4sIG1heCkgewogICAgICAvLyBhc3N1bWVzIG1pbiA8IG1heCwgY29tcG9uZW50d2lzZQogICAgICB0aGlzLnggPSBNYXRoLm1heChtaW4ueCwgTWF0aC5taW4obWF4LngsIHRoaXMueCkpOwogICAgICB0aGlzLnkgPSBNYXRoLm1heChtaW4ueSwgTWF0aC5taW4obWF4LnksIHRoaXMueSkpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbGFtcFNjYWxhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xhbXBTY2FsYXIobWluVmFsLCBtYXhWYWwpIHsKICAgICAgdmFyIG1pbiA9IG5ldyBWZWN0b3IyKG1pblZhbCwgbWluVmFsKTsKICAgICAgdmFyIG1heCA9IG5ldyBWZWN0b3IyKG1heFZhbCwgbWF4VmFsKTsKICAgICAgcmV0dXJuIHRoaXMuY2xhbXAobWluLCBtYXgpOwogICAgfQogIH0sIHsKICAgIGtleTogImNsYW1wTGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGFtcExlbmd0aChtaW4sIG1heCkgewogICAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTsKICAgICAgcmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKGxlbmd0aCB8fCAxKS5tdWx0aXBseVNjYWxhcihNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgbGVuZ3RoKSkpOwogICAgfQogIH0sIHsKICAgIGtleTogImZsb29yIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmbG9vcigpIHsKICAgICAgdGhpcy54ID0gTWF0aC5mbG9vcih0aGlzLngpOwogICAgICB0aGlzLnkgPSBNYXRoLmZsb29yKHRoaXMueSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImNlaWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNlaWwoKSB7CiAgICAgIHRoaXMueCA9IE1hdGguY2VpbCh0aGlzLngpOwogICAgICB0aGlzLnkgPSBNYXRoLmNlaWwodGhpcy55KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAicm91bmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJvdW5kKCkgewogICAgICB0aGlzLnggPSBNYXRoLnJvdW5kKHRoaXMueCk7CiAgICAgIHRoaXMueSA9IE1hdGgucm91bmQodGhpcy55KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAicm91bmRUb1plcm8iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJvdW5kVG9aZXJvKCkgewogICAgICB0aGlzLnggPSB0aGlzLnggPCAwID8gTWF0aC5jZWlsKHRoaXMueCkgOiBNYXRoLmZsb29yKHRoaXMueCk7CiAgICAgIHRoaXMueSA9IHRoaXMueSA8IDAgPyBNYXRoLmNlaWwodGhpcy55KSA6IE1hdGguZmxvb3IodGhpcy55KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibmVnYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBuZWdhdGUoKSB7CiAgICAgIHRoaXMueCA9IC10aGlzLng7CiAgICAgIHRoaXMueSA9IC10aGlzLnk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImRvdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZG90KHYpIHsKICAgICAgcmV0dXJuIHRoaXMueCAqIHYueCArIHRoaXMueSAqIHYueTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcm9zcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3Jvc3ModikgewogICAgICByZXR1cm4gdGhpcy54ICogdi55IC0gdGhpcy55ICogdi54OwogICAgfQogIH0sIHsKICAgIGtleTogImxlbmd0aFNxIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsZW5ndGhTcSgpIHsKICAgICAgcmV0dXJuIHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsZW5ndGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxlbmd0aCgpIHsKICAgICAgcmV0dXJuIE1hdGguaHlwb3QodGhpcy54LCB0aGlzLnkpOwogICAgfQogIH0sIHsKICAgIGtleTogIm1hbmhhdHRhbkxlbmd0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFuaGF0dGFuTGVuZ3RoKCkgewogICAgICByZXR1cm4gTWF0aC5hYnModGhpcy54KSArIE1hdGguYWJzKHRoaXMueSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibm9ybWFsaXplIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBub3JtYWxpemUoKSB7CiAgICAgIHJldHVybiB0aGlzLmRpdmlkZVNjYWxhcih0aGlzLmxlbmd0aCgpIHx8IDEpOwogICAgfQogIH0sIHsKICAgIGtleTogImFuZ2xlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhbmdsZSgpIHsKICAgICAgLy8gY29tcHV0ZXMgdGhlIGFuZ2xlIGluIHJhZGlhbnMgd2l0aCByZXNwZWN0IHRvIHRoZSBwb3NpdGl2ZSB4LWF4aXMKICAgICAgdmFyIGFuZ2xlID0gTWF0aC5hdGFuMih0aGlzLnksIHRoaXMueCk7CiAgICAgIGlmIChhbmdsZSA8IDApIGFuZ2xlICs9IDIgKiBNYXRoLlBJOwogICAgICByZXR1cm4gYW5nbGU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzdGFuY2VUbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzdGFuY2VUbyh2KSB7CiAgICAgIHJldHVybiBNYXRoLmh5cG90KHYueCAtIHRoaXMueCwgdi55IC0gdGhpcy55KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXN0YW5jZVRvU3F1YXJlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzdGFuY2VUb1NxdWFyZWQodikgewogICAgICB2YXIgZHggPSB0aGlzLnggLSB2Lng7CiAgICAgIHZhciBkeSA9IHRoaXMueSAtIHYueTsKICAgICAgcmV0dXJuIGR4ICogZHggKyBkeSAqIGR5OwogICAgfQogIH0sIHsKICAgIGtleTogIm1hbmhhdHRhbkRpc3RhbmNlVG8iLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1hbmhhdHRhbkRpc3RhbmNlVG8odikgewogICAgICByZXR1cm4gTWF0aC5hYnModGhpcy54IC0gdi54KSArIE1hdGguYWJzKHRoaXMueSAtIHYueSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0TGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRMZW5ndGgobGVuZ3RoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZSgpLm11bHRpcGx5U2NhbGFyKGxlbmd0aCk7CiAgICB9CiAgfSwgewogICAga2V5OiAibGVycCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbGVycCh2LCBhbHBoYSkgewogICAgICB0aGlzLnggKz0gKHYueCAtIHRoaXMueCkgKiBhbHBoYTsKICAgICAgdGhpcy55ICs9ICh2LnkgLSB0aGlzLnkpICogYWxwaGE7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImxlcnBWZWN0b3JzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsZXJwVmVjdG9ycyh2MSwgdjIsIGFscGhhKSB7CiAgICAgIHJldHVybiB0aGlzLnN1YlZlY3RvcnModjIsIHYxKS5tdWx0aXBseVNjYWxhcihhbHBoYSkuYWRkKHYxKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJlcXVhbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVxdWFscyh2KSB7CiAgICAgIHJldHVybiB2LnggPT09IHRoaXMueCAmJiB2LnkgPT09IHRoaXMueTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmcm9tQXJyYXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZyb21BcnJheShhcnJheSwgb2Zmc2V0KSB7CiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDsKICAgICAgdGhpcy54ID0gYXJyYXlbb2Zmc2V0XTsKICAgICAgdGhpcy55ID0gYXJyYXlbb2Zmc2V0ICsgMV07CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInRvQXJyYXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvQXJyYXkoYXJyYXksIG9mZnNldCkgewogICAgICBpZiAoYXJyYXkgPT09IHVuZGVmaW5lZCkgYXJyYXkgPSBbXTsKICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSBvZmZzZXQgPSAwOwogICAgICBhcnJheVtvZmZzZXRdID0gdGhpcy54OwogICAgICBhcnJheVtvZmZzZXQgKyAxXSA9IHRoaXMueTsKICAgICAgcmV0dXJuIGFycmF5OwogICAgfQogIH0sIHsKICAgIGtleTogImZyb21CdWZmZXJBdHRyaWJ1dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZyb21CdWZmZXJBdHRyaWJ1dGUoYXR0cmlidXRlLCBpbmRleCwgb2Zmc2V0KSB7CiAgICAgIGlmIChvZmZzZXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnNvbGUud2FybignVEhSRUUuVmVjdG9yMjogb2Zmc2V0IGhhcyBiZWVuIHJlbW92ZWQgZnJvbSAuZnJvbUJ1ZmZlckF0dHJpYnV0ZSgpLicpOwogICAgICB9CgogICAgICB0aGlzLnggPSBhdHRyaWJ1dGUuZ2V0WChpbmRleCk7CiAgICAgIHRoaXMueSA9IGF0dHJpYnV0ZS5nZXRZKGluZGV4KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAicm90YXRlQXJvdW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByb3RhdGVBcm91bmQoY2VudGVyLCBhbmdsZSkgewogICAgICB2YXIgYyA9IE1hdGguY29zKGFuZ2xlKTsKICAgICAgdmFyIHMgPSBNYXRoLnNpbihhbmdsZSk7CiAgICAgIHZhciB4ID0gdGhpcy54IC0gY2VudGVyLng7CiAgICAgIHZhciB5ID0gdGhpcy55IC0gY2VudGVyLnk7CiAgICAgIHRoaXMueCA9IHggKiBjIC0geSAqIHMgKyBjZW50ZXIueDsKICAgICAgdGhpcy55ID0geCAqIHMgKyB5ICogYyArIGNlbnRlci55OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9XSk7CgogIHJldHVybiBWZWN0b3IyOwp9KCk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFZlY3RvcjIucHJvdG90eXBlLCB7CiAgd2lkdGg6IHsKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy54OwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7CiAgICAgIHRoaXMueCA9IHZhbHVlOwogICAgfQogIH0sCiAgaGVpZ2h0OiB7CiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMueTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkgewogICAgICB0aGlzLnkgPSB2YWx1ZTsKICAgIH0KICB9Cn0pOwoKLyoqCiAqIEBhdXRob3IgYWx0ZXJlZHEgLyBodHRwOi8vYWx0ZXJlZHF1YWxpYS5jb20vCiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb20vCiAqLwp2YXIgX01hdGggPSB7CiAgREVHMlJBRDogTWF0aC5QSSAvIDE4MCwKICBSQUQyREVHOiAxODAgLyBNYXRoLlBJLAogIGdlbmVyYXRlVVVJRDogZnVuY3Rpb24gKCkgewogICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMDUwMzQvaG93LXRvLWNyZWF0ZS1hLWd1aWQtdXVpZC1pbi1qYXZhc2NyaXB0LzIxOTYzMTM2IzIxOTYzMTM2CiAgICB2YXIgbHV0ID0gW107CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7IGkrKykgewogICAgICBsdXRbaV0gPSAoaSA8IDE2ID8gJzAnIDogJycpICsgaS50b1N0cmluZygxNik7CiAgICB9CgogICAgcmV0dXJuIGZ1bmN0aW9uIGdlbmVyYXRlVVVJRCgpIHsKICAgICAgdmFyIGQwID0gTWF0aC5yYW5kb20oKSAqIDB4ZmZmZmZmZmYgfCAwOwogICAgICB2YXIgZDEgPSBNYXRoLnJhbmRvbSgpICogMHhmZmZmZmZmZiB8IDA7CiAgICAgIHZhciBkMiA9IE1hdGgucmFuZG9tKCkgKiAweGZmZmZmZmZmIHwgMDsKICAgICAgdmFyIGQzID0gTWF0aC5yYW5kb20oKSAqIDB4ZmZmZmZmZmYgfCAwOwogICAgICB2YXIgdXVpZCA9IGx1dFtkMCAmIDB4ZmZdICsgbHV0W2QwID4+IDggJiAweGZmXSArIGx1dFtkMCA+PiAxNiAmIDB4ZmZdICsgbHV0W2QwID4+IDI0ICYgMHhmZl0gKyAnLScgKyBsdXRbZDEgJiAweGZmXSArIGx1dFtkMSA+PiA4ICYgMHhmZl0gKyAnLScgKyBsdXRbZDEgPj4gMTYgJiAweDBmIHwgMHg0MF0gKyBsdXRbZDEgPj4gMjQgJiAweGZmXSArICctJyArIGx1dFtkMiAmIDB4M2YgfCAweDgwXSArIGx1dFtkMiA+PiA4ICYgMHhmZl0gKyAnLScgKyBsdXRbZDIgPj4gMTYgJiAweGZmXSArIGx1dFtkMiA+PiAyNCAmIDB4ZmZdICsgbHV0W2QzICYgMHhmZl0gKyBsdXRbZDMgPj4gOCAmIDB4ZmZdICsgbHV0W2QzID4+IDE2ICYgMHhmZl0gKyBsdXRbZDMgPj4gMjQgJiAweGZmXTsgLy8gLnRvVXBwZXJDYXNlKCkgaGVyZSBmbGF0dGVucyBjb25jYXRlbmF0ZWQgc3RyaW5ncyB0byBzYXZlIGhlYXAgbWVtb3J5IHNwYWNlLgoKICAgICAgcmV0dXJuIHV1aWQudG9VcHBlckNhc2UoKTsKICAgIH07CiAgfSgpLAogIGNsYW1wOiBmdW5jdGlvbiBjbGFtcCh2YWx1ZSwgbWluLCBtYXgpIHsKICAgIHJldHVybiBNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgdmFsdWUpKTsKICB9LAogIC8vIGNvbXB1dGUgZXVjbGlkaWFuIG1vZHVsbyBvZiBtICUgbgogIC8vIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL01vZHVsb19vcGVyYXRpb24KICBldWNsaWRlYW5Nb2R1bG86IGZ1bmN0aW9uIGV1Y2xpZGVhbk1vZHVsbyhuLCBtKSB7CiAgICByZXR1cm4gKG4gJSBtICsgbSkgJSBtOwogIH0sCiAgLy8gTGluZWFyIG1hcHBpbmcgZnJvbSByYW5nZSA8YTEsIGEyPiB0byByYW5nZSA8YjEsIGIyPgogIG1hcExpbmVhcjogZnVuY3Rpb24gbWFwTGluZWFyKHgsIGExLCBhMiwgYjEsIGIyKSB7CiAgICByZXR1cm4gYjEgKyAoeCAtIGExKSAqIChiMiAtIGIxKSAvIChhMiAtIGExKTsKICB9LAogIC8vIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpbmVhcl9pbnRlcnBvbGF0aW9uCiAgbGVycDogZnVuY3Rpb24gbGVycCh4LCB5LCB0KSB7CiAgICByZXR1cm4gKDEgLSB0KSAqIHggKyB0ICogeTsKICB9LAogIC8vIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU21vb3Roc3RlcAogIHNtb290aHN0ZXA6IGZ1bmN0aW9uIHNtb290aHN0ZXAoeCwgbWluLCBtYXgpIHsKICAgIGlmICh4IDw9IG1pbikgcmV0dXJuIDA7CiAgICBpZiAoeCA+PSBtYXgpIHJldHVybiAxOwogICAgeCA9ICh4IC0gbWluKSAvIChtYXggLSBtaW4pOwogICAgcmV0dXJuIHggKiB4ICogKDMgLSAyICogeCk7CiAgfSwKICBzbW9vdGhlcnN0ZXA6IGZ1bmN0aW9uIHNtb290aGVyc3RlcCh4LCBtaW4sIG1heCkgewogICAgaWYgKHggPD0gbWluKSByZXR1cm4gMDsKICAgIGlmICh4ID49IG1heCkgcmV0dXJuIDE7CiAgICB4ID0gKHggLSBtaW4pIC8gKG1heCAtIG1pbik7CiAgICByZXR1cm4geCAqIHggKiB4ICogKHggKiAoeCAqIDYgLSAxNSkgKyAxMCk7CiAgfSwKICAvLyBSYW5kb20gaW50ZWdlciBmcm9tIDxsb3csIGhpZ2g+IGludGVydmFsCiAgcmFuZEludDogZnVuY3Rpb24gcmFuZEludChsb3csIGhpZ2gpIHsKICAgIHJldHVybiBsb3cgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoaGlnaCAtIGxvdyArIDEpKTsKICB9LAogIC8vIFJhbmRvbSBmbG9hdCBmcm9tIDxsb3csIGhpZ2g+IGludGVydmFsCiAgcmFuZEZsb2F0OiBmdW5jdGlvbiByYW5kRmxvYXQobG93LCBoaWdoKSB7CiAgICByZXR1cm4gbG93ICsgTWF0aC5yYW5kb20oKSAqIChoaWdoIC0gbG93KTsKICB9LAogIC8vIFJhbmRvbSBmbG9hdCBmcm9tIDwtcmFuZ2UvMiwgcmFuZ2UvMj4gaW50ZXJ2YWwKICByYW5kRmxvYXRTcHJlYWQ6IGZ1bmN0aW9uIHJhbmRGbG9hdFNwcmVhZChyYW5nZSkgewogICAgcmV0dXJuIHJhbmdlICogKDAuNSAtIE1hdGgucmFuZG9tKCkpOwogIH0sCiAgZGVnVG9SYWQ6IGZ1bmN0aW9uIGRlZ1RvUmFkKGRlZ3JlZXMpIHsKICAgIHJldHVybiBkZWdyZWVzICogX01hdGguREVHMlJBRDsKICB9LAogIHJhZFRvRGVnOiBmdW5jdGlvbiByYWRUb0RlZyhyYWRpYW5zKSB7CiAgICByZXR1cm4gcmFkaWFucyAqIF9NYXRoLlJBRDJERUc7CiAgfSwKICBpc1Bvd2VyT2ZUd286IGZ1bmN0aW9uIGlzUG93ZXJPZlR3byh2YWx1ZSkgewogICAgcmV0dXJuICh2YWx1ZSAmIHZhbHVlIC0gMSkgPT09IDAgJiYgdmFsdWUgIT09IDA7CiAgfSwKICBjZWlsUG93ZXJPZlR3bzogZnVuY3Rpb24gY2VpbFBvd2VyT2ZUd28odmFsdWUpIHsKICAgIHJldHVybiBNYXRoLnBvdygyLCBNYXRoLmNlaWwoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpKTsKICB9LAogIGZsb29yUG93ZXJPZlR3bzogZnVuY3Rpb24gZmxvb3JQb3dlck9mVHdvKHZhbHVlKSB7CiAgICByZXR1cm4gTWF0aC5wb3coMiwgTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMikpOwogIH0KfTsKCi8qKgogKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tLwogKiBAYXV0aG9yIHN1cGVyZWdnYmVydCAvIGh0dHA6Ly93d3cucGF1bGJydW50LmNvLnVrLwogKiBAYXV0aG9yIHBoaWxvZ2IgLyBodHRwOi8vYmxvZy50aGVqaXQub3JnLwogKiBAYXV0aG9yIGpvcmRpX3JvcyAvIGh0dHA6Ly9wbGF0dHNvZnQuY29tCiAqIEBhdXRob3IgRDFwbG8xZCAvIGh0dHA6Ly9naXRodWIuY29tL0QxcGxvMWQKICogQGF1dGhvciBhbHRlcmVkcSAvIGh0dHA6Ly9hbHRlcmVkcXVhbGlhLmNvbS8KICogQGF1dGhvciBtaWthZWwgZW10aW5nZXIgLyBodHRwOi8vZ29tby5zZS8KICogQGF1dGhvciB0aW1rbmlwIC8gaHR0cDovL3d3dy5mbG9vcnBsYW5uZXIuY29tLwogKiBAYXV0aG9yIGJob3VzdG9uIC8gaHR0cDovL2NsYXJhLmlvCiAqIEBhdXRob3IgV2VzdExhbmdsZXkgLyBodHRwOi8vZ2l0aHViLmNvbS9XZXN0TGFuZ2xleQogKi8KCnZhciBNYXRyaXg0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBNYXRyaXg0KCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1hdHJpeDQpOwoKICAgIHRoaXMuZWxlbWVudHMgPSBbMSwgMCwgMCwgMCwgMCwgMSwgMCwgMCwgMCwgMCwgMSwgMCwgMCwgMCwgMCwgMV07CiAgICB0aGlzLmlzTWF0cml4NCA9IHRydWU7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTWF0cml4NCwgW3sKICAgIGtleTogInNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0KG4xMSwgbjEyLCBuMTMsIG4xNCwgbjIxLCBuMjIsIG4yMywgbjI0LCBuMzEsIG4zMiwgbjMzLCBuMzQsIG40MSwgbjQyLCBuNDMsIG40NCkgewogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB0ZVswXSA9IG4xMTsKICAgICAgdGVbNF0gPSBuMTI7CiAgICAgIHRlWzhdID0gbjEzOwogICAgICB0ZVsxMl0gPSBuMTQ7CiAgICAgIHRlWzFdID0gbjIxOwogICAgICB0ZVs1XSA9IG4yMjsKICAgICAgdGVbOV0gPSBuMjM7CiAgICAgIHRlWzEzXSA9IG4yNDsKICAgICAgdGVbMl0gPSBuMzE7CiAgICAgIHRlWzZdID0gbjMyOwogICAgICB0ZVsxMF0gPSBuMzM7CiAgICAgIHRlWzE0XSA9IG4zNDsKICAgICAgdGVbM10gPSBuNDE7CiAgICAgIHRlWzddID0gbjQyOwogICAgICB0ZVsxMV0gPSBuNDM7CiAgICAgIHRlWzE1XSA9IG40NDsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiaWRlbnRpdHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlkZW50aXR5KCkgewogICAgICB0aGlzLnNldCgxLCAwLCAwLCAwLCAwLCAxLCAwLCAwLCAwLCAwLCAxLCAwLCAwLCAwLCAwLCAxKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xvbmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IE1hdHJpeDQoKS5mcm9tQXJyYXkodGhpcy5lbGVtZW50cyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29weSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29weShtKSB7CiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIHZhciBtZSA9IG0uZWxlbWVudHM7CiAgICAgIHRlWzBdID0gbWVbMF07CiAgICAgIHRlWzFdID0gbWVbMV07CiAgICAgIHRlWzJdID0gbWVbMl07CiAgICAgIHRlWzNdID0gbWVbM107CiAgICAgIHRlWzRdID0gbWVbNF07CiAgICAgIHRlWzVdID0gbWVbNV07CiAgICAgIHRlWzZdID0gbWVbNl07CiAgICAgIHRlWzddID0gbWVbN107CiAgICAgIHRlWzhdID0gbWVbOF07CiAgICAgIHRlWzldID0gbWVbOV07CiAgICAgIHRlWzEwXSA9IG1lWzEwXTsKICAgICAgdGVbMTFdID0gbWVbMTFdOwogICAgICB0ZVsxMl0gPSBtZVsxMl07CiAgICAgIHRlWzEzXSA9IG1lWzEzXTsKICAgICAgdGVbMTRdID0gbWVbMTRdOwogICAgICB0ZVsxNV0gPSBtZVsxNV07CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImNvcHlQb3NpdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29weVBvc2l0aW9uKG0pIHsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIG1lID0gbS5lbGVtZW50czsKICAgICAgdGVbMTJdID0gbWVbMTJdOwogICAgICB0ZVsxM10gPSBtZVsxM107CiAgICAgIHRlWzE0XSA9IG1lWzE0XTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXh0cmFjdEJhc2lzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBleHRyYWN0QmFzaXMoeEF4aXMsIHlBeGlzLCB6QXhpcykgewogICAgICB4QXhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsIDApOwogICAgICB5QXhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsIDEpOwogICAgICB6QXhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsIDIpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYWtlQmFzaXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1ha2VCYXNpcyh4QXhpcywgeUF4aXMsIHpBeGlzKSB7CiAgICAgIHRoaXMuc2V0KHhBeGlzLngsIHlBeGlzLngsIHpBeGlzLngsIDAsIHhBeGlzLnksIHlBeGlzLnksIHpBeGlzLnksIDAsIHhBeGlzLnosIHlBeGlzLnosIHpBeGlzLnosIDAsIDAsIDAsIDAsIDEpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJleHRyYWN0Um90YXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV4dHJhY3RSb3RhdGlvbihtKSB7CiAgICAgIC8vIHRoaXMgbWV0aG9kIGRvZXMgbm90IHN1cHBvcnQgcmVmbGVjdGlvbiBtYXRyaWNlcwogICAgICB2YXIgdjEgPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB2YXIgbWUgPSBtLmVsZW1lbnRzOwogICAgICB2YXIgc2NhbGVYID0gMSAvIHYxLnNldEZyb21NYXRyaXhDb2x1bW4obSwgMCkubGVuZ3RoKCk7CiAgICAgIHZhciBzY2FsZVkgPSAxIC8gdjEuc2V0RnJvbU1hdHJpeENvbHVtbihtLCAxKS5sZW5ndGgoKTsKICAgICAgdmFyIHNjYWxlWiA9IDEgLyB2MS5zZXRGcm9tTWF0cml4Q29sdW1uKG0sIDIpLmxlbmd0aCgpOwogICAgICB0ZVswXSA9IG1lWzBdICogc2NhbGVYOwogICAgICB0ZVsxXSA9IG1lWzFdICogc2NhbGVYOwogICAgICB0ZVsyXSA9IG1lWzJdICogc2NhbGVYOwogICAgICB0ZVszXSA9IDA7CiAgICAgIHRlWzRdID0gbWVbNF0gKiBzY2FsZVk7CiAgICAgIHRlWzVdID0gbWVbNV0gKiBzY2FsZVk7CiAgICAgIHRlWzZdID0gbWVbNl0gKiBzY2FsZVk7CiAgICAgIHRlWzddID0gMDsKICAgICAgdGVbOF0gPSBtZVs4XSAqIHNjYWxlWjsKICAgICAgdGVbOV0gPSBtZVs5XSAqIHNjYWxlWjsKICAgICAgdGVbMTBdID0gbWVbMTBdICogc2NhbGVaOwogICAgICB0ZVsxMV0gPSAwOwogICAgICB0ZVsxMl0gPSAwOwogICAgICB0ZVsxM10gPSAwOwogICAgICB0ZVsxNF0gPSAwOwogICAgICB0ZVsxNV0gPSAxOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYWtlUm90YXRpb25Gcm9tUXVhdGVybmlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZVJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgICB2YXIgemVybyA9IG5ldyBWZWN0b3IzKDAsIDAsIDApOwogICAgICB2YXIgb25lID0gbmV3IFZlY3RvcjMoMSwgMSwgMSk7CiAgICAgIHJldHVybiB0aGlzLmNvbXBvc2UoemVybywgcSwgb25lKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb29rQXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxvb2tBdChleWUsIHRhcmdldCwgdXApIHsKICAgICAgdmFyIHggPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgeSA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIHZhciB6ID0gbmV3IFZlY3RvcjMoKTsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgei5zdWJWZWN0b3JzKGV5ZSwgdGFyZ2V0KTsKCiAgICAgIGlmICh6Lmxlbmd0aFNxKCkgPT09IDApIHsKICAgICAgICAvLyBleWUgYW5kIHRhcmdldCBhcmUgaW4gdGhlIHNhbWUgcG9zaXRpb24KICAgICAgICB6LnogPSAxOwogICAgICB9CgogICAgICB6Lm5vcm1hbGl6ZSgpOwogICAgICB4LmNyb3NzVmVjdG9ycyh1cCwgeik7CgogICAgICBpZiAoeC5sZW5ndGhTcSgpID09PSAwKSB7CiAgICAgICAgLy8gdXAgYW5kIHogYXJlIHBhcmFsbGVsCiAgICAgICAgaWYgKE1hdGguYWJzKHVwLnopID09PSAxKSB7CiAgICAgICAgICB6LnggKz0gMC4wMDAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB6LnogKz0gMC4wMDAxOwogICAgICAgIH0KCiAgICAgICAgei5ub3JtYWxpemUoKTsKICAgICAgICB4LmNyb3NzVmVjdG9ycyh1cCwgeik7CiAgICAgIH0KCiAgICAgIHgubm9ybWFsaXplKCk7CiAgICAgIHkuY3Jvc3NWZWN0b3JzKHosIHgpOwogICAgICB0ZVswXSA9IHgueDsKICAgICAgdGVbNF0gPSB5Lng7CiAgICAgIHRlWzhdID0gei54OwogICAgICB0ZVsxXSA9IHgueTsKICAgICAgdGVbNV0gPSB5Lnk7CiAgICAgIHRlWzldID0gei55OwogICAgICB0ZVsyXSA9IHguejsKICAgICAgdGVbNl0gPSB5Lno7CiAgICAgIHRlWzEwXSA9IHouejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibXVsdGlwbHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG11bHRpcGx5KG0sIG4pIHsKICAgICAgaWYgKG4gIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnNvbGUud2FybignVEhSRUUuTWF0cml4NDogLm11bHRpcGx5KCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAubXVsdGlwbHlNYXRyaWNlcyggYSwgYiApIGluc3RlYWQuJyk7CiAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHlNYXRyaWNlcyhtLCBuKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHlNYXRyaWNlcyh0aGlzLCBtKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwcmVtdWx0aXBseSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJlbXVsdGlwbHkobSkgewogICAgICByZXR1cm4gdGhpcy5tdWx0aXBseU1hdHJpY2VzKG0sIHRoaXMpOwogICAgfQogIH0sIHsKICAgIGtleTogIm11bHRpcGx5TWF0cmljZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG11bHRpcGx5TWF0cmljZXMoYSwgYikgewogICAgICB2YXIgYWUgPSBhLmVsZW1lbnRzOwogICAgICB2YXIgYmUgPSBiLmVsZW1lbnRzOwogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB2YXIgYTExID0gYWVbMF07CiAgICAgIHZhciBhMTIgPSBhZVs0XTsKICAgICAgdmFyIGExMyA9IGFlWzhdOwogICAgICB2YXIgYTE0ID0gYWVbMTJdOwogICAgICB2YXIgYTIxID0gYWVbMV07CiAgICAgIHZhciBhMjIgPSBhZVs1XTsKICAgICAgdmFyIGEyMyA9IGFlWzldOwogICAgICB2YXIgYTI0ID0gYWVbMTNdOwogICAgICB2YXIgYTMxID0gYWVbMl07CiAgICAgIHZhciBhMzIgPSBhZVs2XTsKICAgICAgdmFyIGEzMyA9IGFlWzEwXTsKICAgICAgdmFyIGEzNCA9IGFlWzE0XTsKICAgICAgdmFyIGE0MSA9IGFlWzNdOwogICAgICB2YXIgYTQyID0gYWVbN107CiAgICAgIHZhciBhNDMgPSBhZVsxMV07CiAgICAgIHZhciBhNDQgPSBhZVsxNV07CiAgICAgIHZhciBiMTEgPSBiZVswXTsKICAgICAgdmFyIGIxMiA9IGJlWzRdOwogICAgICB2YXIgYjEzID0gYmVbOF07CiAgICAgIHZhciBiMTQgPSBiZVsxMl07CiAgICAgIHZhciBiMjEgPSBiZVsxXTsKICAgICAgdmFyIGIyMiA9IGJlWzVdOwogICAgICB2YXIgYjIzID0gYmVbOV07CiAgICAgIHZhciBiMjQgPSBiZVsxM107CiAgICAgIHZhciBiMzEgPSBiZVsyXTsKICAgICAgdmFyIGIzMiA9IGJlWzZdOwogICAgICB2YXIgYjMzID0gYmVbMTBdOwogICAgICB2YXIgYjM0ID0gYmVbMTRdOwogICAgICB2YXIgYjQxID0gYmVbM107CiAgICAgIHZhciBiNDIgPSBiZVs3XTsKICAgICAgdmFyIGI0MyA9IGJlWzExXTsKICAgICAgdmFyIGI0NCA9IGJlWzE1XTsKICAgICAgdGVbMF0gPSBhMTEgKiBiMTEgKyBhMTIgKiBiMjEgKyBhMTMgKiBiMzEgKyBhMTQgKiBiNDE7CiAgICAgIHRlWzRdID0gYTExICogYjEyICsgYTEyICogYjIyICsgYTEzICogYjMyICsgYTE0ICogYjQyOwogICAgICB0ZVs4XSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMyAqIGIzMyArIGExNCAqIGI0MzsKICAgICAgdGVbMTJdID0gYTExICogYjE0ICsgYTEyICogYjI0ICsgYTEzICogYjM0ICsgYTE0ICogYjQ0OwogICAgICB0ZVsxXSA9IGEyMSAqIGIxMSArIGEyMiAqIGIyMSArIGEyMyAqIGIzMSArIGEyNCAqIGI0MTsKICAgICAgdGVbNV0gPSBhMjEgKiBiMTIgKyBhMjIgKiBiMjIgKyBhMjMgKiBiMzIgKyBhMjQgKiBiNDI7CiAgICAgIHRlWzldID0gYTIxICogYjEzICsgYTIyICogYjIzICsgYTIzICogYjMzICsgYTI0ICogYjQzOwogICAgICB0ZVsxM10gPSBhMjEgKiBiMTQgKyBhMjIgKiBiMjQgKyBhMjMgKiBiMzQgKyBhMjQgKiBiNDQ7CiAgICAgIHRlWzJdID0gYTMxICogYjExICsgYTMyICogYjIxICsgYTMzICogYjMxICsgYTM0ICogYjQxOwogICAgICB0ZVs2XSA9IGEzMSAqIGIxMiArIGEzMiAqIGIyMiArIGEzMyAqIGIzMiArIGEzNCAqIGI0MjsKICAgICAgdGVbMTBdID0gYTMxICogYjEzICsgYTMyICogYjIzICsgYTMzICogYjMzICsgYTM0ICogYjQzOwogICAgICB0ZVsxNF0gPSBhMzEgKiBiMTQgKyBhMzIgKiBiMjQgKyBhMzMgKiBiMzQgKyBhMzQgKiBiNDQ7CiAgICAgIHRlWzNdID0gYTQxICogYjExICsgYTQyICogYjIxICsgYTQzICogYjMxICsgYTQ0ICogYjQxOwogICAgICB0ZVs3XSA9IGE0MSAqIGIxMiArIGE0MiAqIGIyMiArIGE0MyAqIGIzMiArIGE0NCAqIGI0MjsKICAgICAgdGVbMTFdID0gYTQxICogYjEzICsgYTQyICogYjIzICsgYTQzICogYjMzICsgYTQ0ICogYjQzOwogICAgICB0ZVsxNV0gPSBhNDEgKiBiMTQgKyBhNDIgKiBiMjQgKyBhNDMgKiBiMzQgKyBhNDQgKiBiNDQ7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm11bHRpcGx5U2NhbGFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtdWx0aXBseVNjYWxhcihzKSB7CiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIHRlWzBdICo9IHM7CiAgICAgIHRlWzRdICo9IHM7CiAgICAgIHRlWzhdICo9IHM7CiAgICAgIHRlWzEyXSAqPSBzOwogICAgICB0ZVsxXSAqPSBzOwogICAgICB0ZVs1XSAqPSBzOwogICAgICB0ZVs5XSAqPSBzOwogICAgICB0ZVsxM10gKj0gczsKICAgICAgdGVbMl0gKj0gczsKICAgICAgdGVbNl0gKj0gczsKICAgICAgdGVbMTBdICo9IHM7CiAgICAgIHRlWzE0XSAqPSBzOwogICAgICB0ZVszXSAqPSBzOwogICAgICB0ZVs3XSAqPSBzOwogICAgICB0ZVsxMV0gKj0gczsKICAgICAgdGVbMTVdICo9IHM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImFwcGx5VG9CdWZmZXJBdHRyaWJ1dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5VG9CdWZmZXJBdHRyaWJ1dGUoYXR0cmlidXRlKSB7CiAgICAgIHZhciB2MSA9IG5ldyBWZWN0b3IzKCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGF0dHJpYnV0ZS5jb3VudDsgaSA8IGw7IGkrKykgewogICAgICAgIHYxLnggPSBhdHRyaWJ1dGUuZ2V0WChpKTsKICAgICAgICB2MS55ID0gYXR0cmlidXRlLmdldFkoaSk7CiAgICAgICAgdjEueiA9IGF0dHJpYnV0ZS5nZXRaKGkpOwogICAgICAgIHYxLmFwcGx5TWF0cml4NCh0aGlzKTsKICAgICAgICBhdHRyaWJ1dGUuc2V0WFlaKGksIHYxLngsIHYxLnksIHYxLnopOwogICAgICB9CgogICAgICByZXR1cm4gYXR0cmlidXRlOwogICAgfQogIH0sIHsKICAgIGtleTogImRldGVybWluYW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRlcm1pbmFudCgpIHsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIG4xMSA9IHRlWzBdOwogICAgICB2YXIgbjEyID0gdGVbNF07CiAgICAgIHZhciBuMTMgPSB0ZVs4XTsKICAgICAgdmFyIG4xNCA9IHRlWzEyXTsKICAgICAgdmFyIG4yMSA9IHRlWzFdOwogICAgICB2YXIgbjIyID0gdGVbNV07CiAgICAgIHZhciBuMjMgPSB0ZVs5XTsKICAgICAgdmFyIG4yNCA9IHRlWzEzXTsKICAgICAgdmFyIG4zMSA9IHRlWzJdOwogICAgICB2YXIgbjMyID0gdGVbNl07CiAgICAgIHZhciBuMzMgPSB0ZVsxMF07CiAgICAgIHZhciBuMzQgPSB0ZVsxNF07CiAgICAgIHZhciBuNDEgPSB0ZVszXTsKICAgICAgdmFyIG40MiA9IHRlWzddOwogICAgICB2YXIgbjQzID0gdGVbMTFdOwogICAgICB2YXIgbjQ0ID0gdGVbMTVdOyAvLyBUT0RPOiBtYWtlIHRoaXMgbW9yZSBlZmZpY2llbnQKICAgICAgLy8gKCBiYXNlZCBvbiBodHRwOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9hbGdlYnJhL21hdHJpeC9mdW5jdGlvbnMvaW52ZXJzZS9mb3VyRC9pbmRleC5odG0gKQoKICAgICAgcmV0dXJuIG40MSAqICgrbjE0ICogbjIzICogbjMyIC0gbjEzICogbjI0ICogbjMyIC0gbjE0ICogbjIyICogbjMzICsgbjEyICogbjI0ICogbjMzICsgbjEzICogbjIyICogbjM0IC0gbjEyICogbjIzICogbjM0KSArIG40MiAqICgrbjExICogbjIzICogbjM0IC0gbjExICogbjI0ICogbjMzICsgbjE0ICogbjIxICogbjMzIC0gbjEzICogbjIxICogbjM0ICsgbjEzICogbjI0ICogbjMxIC0gbjE0ICogbjIzICogbjMxKSArIG40MyAqICgrbjExICogbjI0ICogbjMyIC0gbjExICogbjIyICogbjM0IC0gbjE0ICogbjIxICogbjMyICsgbjEyICogbjIxICogbjM0ICsgbjE0ICogbjIyICogbjMxIC0gbjEyICogbjI0ICogbjMxKSArIG40NCAqICgtbjEzICogbjIyICogbjMxIC0gbjExICogbjIzICogbjMyICsgbjExICogbjIyICogbjMzICsgbjEzICogbjIxICogbjMyIC0gbjEyICogbjIxICogbjMzICsgbjEyICogbjIzICogbjMxKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0cmFuc3Bvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRyYW5zcG9zZSgpIHsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIHRtcDsKICAgICAgdG1wID0gdGVbMV07CiAgICAgIHRlWzFdID0gdGVbNF07CiAgICAgIHRlWzRdID0gdG1wOwogICAgICB0bXAgPSB0ZVsyXTsKICAgICAgdGVbMl0gPSB0ZVs4XTsKICAgICAgdGVbOF0gPSB0bXA7CiAgICAgIHRtcCA9IHRlWzZdOwogICAgICB0ZVs2XSA9IHRlWzldOwogICAgICB0ZVs5XSA9IHRtcDsKICAgICAgdG1wID0gdGVbM107CiAgICAgIHRlWzNdID0gdGVbMTJdOwogICAgICB0ZVsxMl0gPSB0bXA7CiAgICAgIHRtcCA9IHRlWzddOwogICAgICB0ZVs3XSA9IHRlWzEzXTsKICAgICAgdGVbMTNdID0gdG1wOwogICAgICB0bXAgPSB0ZVsxMV07CiAgICAgIHRlWzExXSA9IHRlWzE0XTsKICAgICAgdGVbMTRdID0gdG1wOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRQb3NpdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0UG9zaXRpb24odikgewogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB0ZVsxMl0gPSB2Lng7CiAgICAgIHRlWzEzXSA9IHYueTsKICAgICAgdGVbMTRdID0gdi56OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRJbnZlcnNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJbnZlcnNlKG0sIHRocm93T25EZWdlbmVyYXRlKSB7CiAgICAgIC8vIGJhc2VkIG9uIGh0dHA6Ly93d3cuZXVjbGlkZWFuc3BhY2UuY29tL21hdGhzL2FsZ2VicmEvbWF0cml4L2Z1bmN0aW9ucy9pbnZlcnNlL2ZvdXJEL2luZGV4Lmh0bQogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB2YXIgbWUgPSBtLmVsZW1lbnRzOwogICAgICB2YXIgbjExID0gbWVbMF07CiAgICAgIHZhciBuMjEgPSBtZVsxXTsKICAgICAgdmFyIG4zMSA9IG1lWzJdOwogICAgICB2YXIgbjQxID0gbWVbM107CiAgICAgIHZhciBuMTIgPSBtZVs0XTsKICAgICAgdmFyIG4yMiA9IG1lWzVdOwogICAgICB2YXIgbjMyID0gbWVbNl07CiAgICAgIHZhciBuNDIgPSBtZVs3XTsKICAgICAgdmFyIG4xMyA9IG1lWzhdOwogICAgICB2YXIgbjIzID0gbWVbOV07CiAgICAgIHZhciBuMzMgPSBtZVsxMF07CiAgICAgIHZhciBuNDMgPSBtZVsxMV07CiAgICAgIHZhciBuMTQgPSBtZVsxMl07CiAgICAgIHZhciBuMjQgPSBtZVsxM107CiAgICAgIHZhciBuMzQgPSBtZVsxNF07CiAgICAgIHZhciBuNDQgPSBtZVsxNV07CiAgICAgIHZhciB0MTEgPSBuMjMgKiBuMzQgKiBuNDIgLSBuMjQgKiBuMzMgKiBuNDIgKyBuMjQgKiBuMzIgKiBuNDMgLSBuMjIgKiBuMzQgKiBuNDMgLSBuMjMgKiBuMzIgKiBuNDQgKyBuMjIgKiBuMzMgKiBuNDQ7CiAgICAgIHZhciB0MTIgPSBuMTQgKiBuMzMgKiBuNDIgLSBuMTMgKiBuMzQgKiBuNDIgLSBuMTQgKiBuMzIgKiBuNDMgKyBuMTIgKiBuMzQgKiBuNDMgKyBuMTMgKiBuMzIgKiBuNDQgLSBuMTIgKiBuMzMgKiBuNDQ7CiAgICAgIHZhciB0MTMgPSBuMTMgKiBuMjQgKiBuNDIgLSBuMTQgKiBuMjMgKiBuNDIgKyBuMTQgKiBuMjIgKiBuNDMgLSBuMTIgKiBuMjQgKiBuNDMgLSBuMTMgKiBuMjIgKiBuNDQgKyBuMTIgKiBuMjMgKiBuNDQ7CiAgICAgIHZhciB0MTQgPSBuMTQgKiBuMjMgKiBuMzIgLSBuMTMgKiBuMjQgKiBuMzIgLSBuMTQgKiBuMjIgKiBuMzMgKyBuMTIgKiBuMjQgKiBuMzMgKyBuMTMgKiBuMjIgKiBuMzQgLSBuMTIgKiBuMjMgKiBuMzQ7CiAgICAgIHZhciBkZXQgPSBuMTEgKiB0MTEgKyBuMjEgKiB0MTIgKyBuMzEgKiB0MTMgKyBuNDEgKiB0MTQ7CgogICAgICBpZiAoZGV0ID09PSAwKSB7CiAgICAgICAgdmFyIG1zZyA9ICJUSFJFRS5NYXRyaXg0OiAuZ2V0SW52ZXJzZSgpIGNhbid0IGludmVydCBtYXRyaXgsIGRldGVybWluYW50IGlzIDAiOwoKICAgICAgICBpZiAodGhyb3dPbkRlZ2VuZXJhdGUgPT09IHRydWUpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLndhcm4obXNnKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzLmlkZW50aXR5KCk7CiAgICAgIH0KCiAgICAgIHZhciBkZXRJbnYgPSAxIC8gZGV0OwogICAgICB0ZVswXSA9IHQxMSAqIGRldEludjsKICAgICAgdGVbMV0gPSAobjI0ICogbjMzICogbjQxIC0gbjIzICogbjM0ICogbjQxIC0gbjI0ICogbjMxICogbjQzICsgbjIxICogbjM0ICogbjQzICsgbjIzICogbjMxICogbjQ0IC0gbjIxICogbjMzICogbjQ0KSAqIGRldEludjsKICAgICAgdGVbMl0gPSAobjIyICogbjM0ICogbjQxIC0gbjI0ICogbjMyICogbjQxICsgbjI0ICogbjMxICogbjQyIC0gbjIxICogbjM0ICogbjQyIC0gbjIyICogbjMxICogbjQ0ICsgbjIxICogbjMyICogbjQ0KSAqIGRldEludjsKICAgICAgdGVbM10gPSAobjIzICogbjMyICogbjQxIC0gbjIyICogbjMzICogbjQxIC0gbjIzICogbjMxICogbjQyICsgbjIxICogbjMzICogbjQyICsgbjIyICogbjMxICogbjQzIC0gbjIxICogbjMyICogbjQzKSAqIGRldEludjsKICAgICAgdGVbNF0gPSB0MTIgKiBkZXRJbnY7CiAgICAgIHRlWzVdID0gKG4xMyAqIG4zNCAqIG40MSAtIG4xNCAqIG4zMyAqIG40MSArIG4xNCAqIG4zMSAqIG40MyAtIG4xMSAqIG4zNCAqIG40MyAtIG4xMyAqIG4zMSAqIG40NCArIG4xMSAqIG4zMyAqIG40NCkgKiBkZXRJbnY7CiAgICAgIHRlWzZdID0gKG4xNCAqIG4zMiAqIG40MSAtIG4xMiAqIG4zNCAqIG40MSAtIG4xNCAqIG4zMSAqIG40MiArIG4xMSAqIG4zNCAqIG40MiArIG4xMiAqIG4zMSAqIG40NCAtIG4xMSAqIG4zMiAqIG40NCkgKiBkZXRJbnY7CiAgICAgIHRlWzddID0gKG4xMiAqIG4zMyAqIG40MSAtIG4xMyAqIG4zMiAqIG40MSArIG4xMyAqIG4zMSAqIG40MiAtIG4xMSAqIG4zMyAqIG40MiAtIG4xMiAqIG4zMSAqIG40MyArIG4xMSAqIG4zMiAqIG40MykgKiBkZXRJbnY7CiAgICAgIHRlWzhdID0gdDEzICogZGV0SW52OwogICAgICB0ZVs5XSA9IChuMTQgKiBuMjMgKiBuNDEgLSBuMTMgKiBuMjQgKiBuNDEgLSBuMTQgKiBuMjEgKiBuNDMgKyBuMTEgKiBuMjQgKiBuNDMgKyBuMTMgKiBuMjEgKiBuNDQgLSBuMTEgKiBuMjMgKiBuNDQpICogZGV0SW52OwogICAgICB0ZVsxMF0gPSAobjEyICogbjI0ICogbjQxIC0gbjE0ICogbjIyICogbjQxICsgbjE0ICogbjIxICogbjQyIC0gbjExICogbjI0ICogbjQyIC0gbjEyICogbjIxICogbjQ0ICsgbjExICogbjIyICogbjQ0KSAqIGRldEludjsKICAgICAgdGVbMTFdID0gKG4xMyAqIG4yMiAqIG40MSAtIG4xMiAqIG4yMyAqIG40MSAtIG4xMyAqIG4yMSAqIG40MiArIG4xMSAqIG4yMyAqIG40MiArIG4xMiAqIG4yMSAqIG40MyAtIG4xMSAqIG4yMiAqIG40MykgKiBkZXRJbnY7CiAgICAgIHRlWzEyXSA9IHQxNCAqIGRldEludjsKICAgICAgdGVbMTNdID0gKG4xMyAqIG4yNCAqIG4zMSAtIG4xNCAqIG4yMyAqIG4zMSArIG4xNCAqIG4yMSAqIG4zMyAtIG4xMSAqIG4yNCAqIG4zMyAtIG4xMyAqIG4yMSAqIG4zNCArIG4xMSAqIG4yMyAqIG4zNCkgKiBkZXRJbnY7CiAgICAgIHRlWzE0XSA9IChuMTQgKiBuMjIgKiBuMzEgLSBuMTIgKiBuMjQgKiBuMzEgLSBuMTQgKiBuMjEgKiBuMzIgKyBuMTEgKiBuMjQgKiBuMzIgKyBuMTIgKiBuMjEgKiBuMzQgLSBuMTEgKiBuMjIgKiBuMzQpICogZGV0SW52OwogICAgICB0ZVsxNV0gPSAobjEyICogbjIzICogbjMxIC0gbjEzICogbjIyICogbjMxICsgbjEzICogbjIxICogbjMyIC0gbjExICogbjIzICogbjMyIC0gbjEyICogbjIxICogbjMzICsgbjExICogbjIyICogbjMzKSAqIGRldEludjsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic2NhbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNjYWxlKHYpIHsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIHggPSB2Lng7CiAgICAgIHZhciB5ID0gdi55OwogICAgICB2YXIgeiA9IHYuejsKICAgICAgdGVbMF0gKj0geDsKICAgICAgdGVbNF0gKj0geTsKICAgICAgdGVbOF0gKj0gejsKICAgICAgdGVbMV0gKj0geDsKICAgICAgdGVbNV0gKj0geTsKICAgICAgdGVbOV0gKj0gejsKICAgICAgdGVbMl0gKj0geDsKICAgICAgdGVbNl0gKj0geTsKICAgICAgdGVbMTBdICo9IHo7CiAgICAgIHRlWzNdICo9IHg7CiAgICAgIHRlWzddICo9IHk7CiAgICAgIHRlWzExXSAqPSB6OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRNYXhTY2FsZU9uQXhpcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWF4U2NhbGVPbkF4aXMoKSB7CiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIHZhciBzY2FsZVhTcSA9IHRlWzBdICogdGVbMF0gKyB0ZVsxXSAqIHRlWzFdICsgdGVbMl0gKiB0ZVsyXTsKICAgICAgdmFyIHNjYWxlWVNxID0gdGVbNF0gKiB0ZVs0XSArIHRlWzVdICogdGVbNV0gKyB0ZVs2XSAqIHRlWzZdOwogICAgICB2YXIgc2NhbGVaU3EgPSB0ZVs4XSAqIHRlWzhdICsgdGVbOV0gKiB0ZVs5XSArIHRlWzEwXSAqIHRlWzEwXTsKICAgICAgcmV0dXJuIE1hdGguc3FydChNYXRoLm1heChzY2FsZVhTcSwgc2NhbGVZU3EsIHNjYWxlWlNxKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZVRyYW5zbGF0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYWtlVHJhbnNsYXRpb24oeCwgeSwgeikgewogICAgICB0aGlzLnNldCgxLCAwLCAwLCB4LCAwLCAxLCAwLCB5LCAwLCAwLCAxLCB6LCAwLCAwLCAwLCAxKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZVJvdGF0aW9uWCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZVJvdGF0aW9uWCh0aGV0YSkgewogICAgICB2YXIgYyA9IE1hdGguY29zKHRoZXRhKTsKICAgICAgdmFyIHMgPSBNYXRoLnNpbih0aGV0YSk7CiAgICAgIHRoaXMuc2V0KDEsIDAsIDAsIDAsIDAsIGMsIC1zLCAwLCAwLCBzLCBjLCAwLCAwLCAwLCAwLCAxKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZVJvdGF0aW9uWSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZVJvdGF0aW9uWSh0aGV0YSkgewogICAgICB2YXIgYyA9IE1hdGguY29zKHRoZXRhKTsKICAgICAgdmFyIHMgPSBNYXRoLnNpbih0aGV0YSk7CiAgICAgIHRoaXMuc2V0KGMsIDAsIHMsIDAsIDAsIDEsIDAsIDAsIC1zLCAwLCBjLCAwLCAwLCAwLCAwLCAxKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZVJvdGF0aW9uWiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZVJvdGF0aW9uWih0aGV0YSkgewogICAgICB2YXIgYyA9IE1hdGguY29zKHRoZXRhKTsKICAgICAgdmFyIHMgPSBNYXRoLnNpbih0aGV0YSk7CiAgICAgIHRoaXMuc2V0KGMsIC1zLCAwLCAwLCBzLCBjLCAwLCAwLCAwLCAwLCAxLCAwLCAwLCAwLCAwLCAxKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZVJvdGF0aW9uQXhpcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZVJvdGF0aW9uQXhpcyhheGlzLCBhbmdsZSkgewogICAgICAvLyBCYXNlZCBvbiBodHRwOi8vd3d3LmdhbWVkZXYubmV0L3JlZmVyZW5jZS9hcnRpY2xlcy9hcnRpY2xlMTE5OS5hc3AKICAgICAgdmFyIGMgPSBNYXRoLmNvcyhhbmdsZSk7CiAgICAgIHZhciBzID0gTWF0aC5zaW4oYW5nbGUpOwogICAgICB2YXIgdCA9IDEgLSBjOwogICAgICB2YXIgeCA9IGF4aXMueDsKICAgICAgdmFyIHkgPSBheGlzLnk7CiAgICAgIHZhciB6ID0gYXhpcy56OwogICAgICB2YXIgdHggPSB0ICogeDsKICAgICAgdmFyIHR5ID0gdCAqIHk7CiAgICAgIHRoaXMuc2V0KHR4ICogeCArIGMsIHR4ICogeSAtIHMgKiB6LCB0eCAqIHogKyBzICogeSwgMCwgdHggKiB5ICsgcyAqIHosIHR5ICogeSArIGMsIHR5ICogeiAtIHMgKiB4LCAwLCB0eCAqIHogLSBzICogeSwgdHkgKiB6ICsgcyAqIHgsIHQgKiB6ICogeiArIGMsIDAsIDAsIDAsIDAsIDEpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYWtlU2NhbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1ha2VTY2FsZSh4LCB5LCB6KSB7CiAgICAgIHRoaXMuc2V0KHgsIDAsIDAsIDAsIDAsIHksIDAsIDAsIDAsIDAsIHosIDAsIDAsIDAsIDAsIDEpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYWtlU2hlYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1ha2VTaGVhcih4LCB5LCB6KSB7CiAgICAgIHRoaXMuc2V0KDEsIHksIHosIDAsIHgsIDEsIHosIDAsIHgsIHksIDEsIDAsIDAsIDAsIDAsIDEpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb3NlKHBvc2l0aW9uLCBxdWF0ZXJuaW9uLCBzY2FsZSkgewogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB2YXIgeCA9IHF1YXRlcm5pb24uX3g7CiAgICAgIHZhciB5ID0gcXVhdGVybmlvbi5feTsKICAgICAgdmFyIHogPSBxdWF0ZXJuaW9uLl96OwogICAgICB2YXIgdyA9IHF1YXRlcm5pb24uX3c7CiAgICAgIHZhciB4MiA9IHggKyB4OwogICAgICB2YXIgeTIgPSB5ICsgeTsKICAgICAgdmFyIHoyID0geiArIHo7CiAgICAgIHZhciB4eCA9IHggKiB4MjsKICAgICAgdmFyIHh5ID0geCAqIHkyOwogICAgICB2YXIgeHogPSB4ICogejI7CiAgICAgIHZhciB5eSA9IHkgKiB5MjsKICAgICAgdmFyIHl6ID0geSAqIHoyOwogICAgICB2YXIgenogPSB6ICogejI7CiAgICAgIHZhciB3eCA9IHcgKiB4MjsKICAgICAgdmFyIHd5ID0gdyAqIHkyOwogICAgICB2YXIgd3ogPSB3ICogejI7CiAgICAgIHZhciBzeCA9IHNjYWxlLng7CiAgICAgIHZhciBzeSA9IHNjYWxlLnk7CiAgICAgIHZhciBzeiA9IHNjYWxlLno7CiAgICAgIHRlWzBdID0gKDEgLSAoeXkgKyB6eikpICogc3g7CiAgICAgIHRlWzFdID0gKHh5ICsgd3opICogc3g7CiAgICAgIHRlWzJdID0gKHh6IC0gd3kpICogc3g7CiAgICAgIHRlWzNdID0gMDsKICAgICAgdGVbNF0gPSAoeHkgLSB3eikgKiBzeTsKICAgICAgdGVbNV0gPSAoMSAtICh4eCArIHp6KSkgKiBzeTsKICAgICAgdGVbNl0gPSAoeXogKyB3eCkgKiBzeTsKICAgICAgdGVbN10gPSAwOwogICAgICB0ZVs4XSA9ICh4eiArIHd5KSAqIHN6OwogICAgICB0ZVs5XSA9ICh5eiAtIHd4KSAqIHN6OwogICAgICB0ZVsxMF0gPSAoMSAtICh4eCArIHl5KSkgKiBzejsKICAgICAgdGVbMTFdID0gMDsKICAgICAgdGVbMTJdID0gcG9zaXRpb24ueDsKICAgICAgdGVbMTNdID0gcG9zaXRpb24ueTsKICAgICAgdGVbMTRdID0gcG9zaXRpb24uejsKICAgICAgdGVbMTVdID0gMTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVjb21wb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZWNvbXBvc2UocG9zaXRpb24sIHF1YXRlcm5pb24sIHNjYWxlKSB7CiAgICAgIHZhciB2ZWN0b3IgPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgbWF0cml4ID0gbmV3IE1hdHJpeDQoKTsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIHN4ID0gdmVjdG9yLnNldCh0ZVswXSwgdGVbMV0sIHRlWzJdKS5sZW5ndGgoKTsKICAgICAgdmFyIHN5ID0gdmVjdG9yLnNldCh0ZVs0XSwgdGVbNV0sIHRlWzZdKS5sZW5ndGgoKTsKICAgICAgdmFyIHN6ID0gdmVjdG9yLnNldCh0ZVs4XSwgdGVbOV0sIHRlWzEwXSkubGVuZ3RoKCk7IC8vIGlmIGRldGVybWluZSBpcyBuZWdhdGl2ZSwgd2UgbmVlZCB0byBpbnZlcnQgb25lIHNjYWxlCgogICAgICB2YXIgZGV0ID0gdGhpcy5kZXRlcm1pbmFudCgpOwogICAgICBpZiAoZGV0IDwgMCkgc3ggPSAtc3g7CiAgICAgIHBvc2l0aW9uLnggPSB0ZVsxMl07CiAgICAgIHBvc2l0aW9uLnkgPSB0ZVsxM107CiAgICAgIHBvc2l0aW9uLnogPSB0ZVsxNF07IC8vIHNjYWxlIHRoZSByb3RhdGlvbiBwYXJ0CgogICAgICBtYXRyaXguY29weSh0aGlzKTsKICAgICAgdmFyIGludlNYID0gMSAvIHN4OwogICAgICB2YXIgaW52U1kgPSAxIC8gc3k7CiAgICAgIHZhciBpbnZTWiA9IDEgLyBzejsKICAgICAgbWF0cml4LmVsZW1lbnRzWzBdICo9IGludlNYOwogICAgICBtYXRyaXguZWxlbWVudHNbMV0gKj0gaW52U1g7CiAgICAgIG1hdHJpeC5lbGVtZW50c1syXSAqPSBpbnZTWDsKICAgICAgbWF0cml4LmVsZW1lbnRzWzRdICo9IGludlNZOwogICAgICBtYXRyaXguZWxlbWVudHNbNV0gKj0gaW52U1k7CiAgICAgIG1hdHJpeC5lbGVtZW50c1s2XSAqPSBpbnZTWTsKICAgICAgbWF0cml4LmVsZW1lbnRzWzhdICo9IGludlNaOwogICAgICBtYXRyaXguZWxlbWVudHNbOV0gKj0gaW52U1o7CiAgICAgIG1hdHJpeC5lbGVtZW50c1sxMF0gKj0gaW52U1o7CiAgICAgIHF1YXRlcm5pb24uc2V0RnJvbVJvdGF0aW9uTWF0cml4KG1hdHJpeCk7CiAgICAgIHNjYWxlLnggPSBzeDsKICAgICAgc2NhbGUueSA9IHN5OwogICAgICBzY2FsZS56ID0gc3o7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm1ha2VQZXJzcGVjdGl2ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZVBlcnNwZWN0aXZlKGxlZnQsIHJpZ2h0LCB0b3AsIGJvdHRvbSwgbmVhciwgZmFyKSB7CiAgICAgIGlmIChmYXIgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnNvbGUud2FybignVEhSRUUuTWF0cml4NDogLm1ha2VQZXJzcGVjdGl2ZSgpIGhhcyBiZWVuIHJlZGVmaW5lZCBhbmQgaGFzIGEgbmV3IHNpZ25hdHVyZS4gUGxlYXNlIGNoZWNrIHRoZSBkb2NzLicpOwogICAgICB9CgogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB2YXIgeCA9IDIgKiBuZWFyIC8gKHJpZ2h0IC0gbGVmdCk7CiAgICAgIHZhciB5ID0gMiAqIG5lYXIgLyAodG9wIC0gYm90dG9tKTsKICAgICAgdmFyIGEgPSAocmlnaHQgKyBsZWZ0KSAvIChyaWdodCAtIGxlZnQpOwogICAgICB2YXIgYiA9ICh0b3AgKyBib3R0b20pIC8gKHRvcCAtIGJvdHRvbSk7CiAgICAgIHZhciBjID0gLShmYXIgKyBuZWFyKSAvIChmYXIgLSBuZWFyKTsKICAgICAgdmFyIGQgPSAtMiAqIGZhciAqIG5lYXIgLyAoZmFyIC0gbmVhcik7CiAgICAgIHRlWzBdID0geDsKICAgICAgdGVbNF0gPSAwOwogICAgICB0ZVs4XSA9IGE7CiAgICAgIHRlWzEyXSA9IDA7CiAgICAgIHRlWzFdID0gMDsKICAgICAgdGVbNV0gPSB5OwogICAgICB0ZVs5XSA9IGI7CiAgICAgIHRlWzEzXSA9IDA7CiAgICAgIHRlWzJdID0gMDsKICAgICAgdGVbNl0gPSAwOwogICAgICB0ZVsxMF0gPSBjOwogICAgICB0ZVsxNF0gPSBkOwogICAgICB0ZVszXSA9IDA7CiAgICAgIHRlWzddID0gMDsKICAgICAgdGVbMTFdID0gLTE7CiAgICAgIHRlWzE1XSA9IDA7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm1ha2VPcnRob2dyYXBoaWMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1ha2VPcnRob2dyYXBoaWMobGVmdCwgcmlnaHQsIHRvcCwgYm90dG9tLCBuZWFyLCBmYXIpIHsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIHcgPSAxLjAgLyAocmlnaHQgLSBsZWZ0KTsKICAgICAgdmFyIGggPSAxLjAgLyAodG9wIC0gYm90dG9tKTsKICAgICAgdmFyIHAgPSAxLjAgLyAoZmFyIC0gbmVhcik7CiAgICAgIHZhciB4ID0gKHJpZ2h0ICsgbGVmdCkgKiB3OwogICAgICB2YXIgeSA9ICh0b3AgKyBib3R0b20pICogaDsKICAgICAgdmFyIHogPSAoZmFyICsgbmVhcikgKiBwOwogICAgICB0ZVswXSA9IDIgKiB3OwogICAgICB0ZVs0XSA9IDA7CiAgICAgIHRlWzhdID0gMDsKICAgICAgdGVbMTJdID0gLXg7CiAgICAgIHRlWzFdID0gMDsKICAgICAgdGVbNV0gPSAyICogaDsKICAgICAgdGVbOV0gPSAwOwogICAgICB0ZVsxM10gPSAteTsKICAgICAgdGVbMl0gPSAwOwogICAgICB0ZVs2XSA9IDA7CiAgICAgIHRlWzEwXSA9IC0yICogcDsKICAgICAgdGVbMTRdID0gLXo7CiAgICAgIHRlWzNdID0gMDsKICAgICAgdGVbN10gPSAwOwogICAgICB0ZVsxMV0gPSAwOwogICAgICB0ZVsxNV0gPSAxOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJlcXVhbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVxdWFscyhtYXRyaXgpIHsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIG1lID0gbWF0cml4LmVsZW1lbnRzOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7CiAgICAgICAgaWYgKHRlW2ldICE9PSBtZVtpXSkgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmcm9tQXJyYXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZyb21BcnJheShhcnJheSwgb2Zmc2V0KSB7CiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykgewogICAgICAgIHRoaXMuZWxlbWVudHNbaV0gPSBhcnJheVtpICsgb2Zmc2V0XTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAidG9BcnJheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9BcnJheShhcnJheSwgb2Zmc2V0KSB7CiAgICAgIGlmIChhcnJheSA9PT0gdW5kZWZpbmVkKSBhcnJheSA9IFtdOwogICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7CiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGFycmF5W29mZnNldF0gPSB0ZVswXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSB0ZVsxXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgMl0gPSB0ZVsyXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgM10gPSB0ZVszXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgNF0gPSB0ZVs0XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgNV0gPSB0ZVs1XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgNl0gPSB0ZVs2XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgN10gPSB0ZVs3XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgOF0gPSB0ZVs4XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgOV0gPSB0ZVs5XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgMTBdID0gdGVbMTBdOwogICAgICBhcnJheVtvZmZzZXQgKyAxMV0gPSB0ZVsxMV07CiAgICAgIGFycmF5W29mZnNldCArIDEyXSA9IHRlWzEyXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgMTNdID0gdGVbMTNdOwogICAgICBhcnJheVtvZmZzZXQgKyAxNF0gPSB0ZVsxNF07CiAgICAgIGFycmF5W29mZnNldCArIDE1XSA9IHRlWzE1XTsKICAgICAgcmV0dXJuIGFycmF5OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE1hdHJpeDQ7Cn0oKTsKCnZhciBRdWF0ZXJuaW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBRdWF0ZXJuaW9uKHgsIHksIHosIHcpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBRdWF0ZXJuaW9uKTsKCiAgICB0aGlzLl94ID0geCB8fCAwOwogICAgdGhpcy5feSA9IHkgfHwgMDsKICAgIHRoaXMuX3ogPSB6IHx8IDA7CiAgICB0aGlzLl93ID0gdyAhPT0gdW5kZWZpbmVkID8gdyA6IDE7CiAgICB0aGlzLmlzUXVhdGVybmlvbiA9IHRydWU7CiAgfQoKICBfY3JlYXRlQ2xhc3MoUXVhdGVybmlvbiwgW3sKICAgIGtleTogInNsZXJwRmxhdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2xlcnBGbGF0KGRzdCwgZHN0T2Zmc2V0LCBzcmMwLCBzcmNPZmZzZXQwLCBzcmMxLCBzcmNPZmZzZXQxLCB0KSB7CiAgICAgIC8vIGZ1enotZnJlZSwgYXJyYXktYmFzZWQgUXVhdGVybmlvbiBTTEVSUCBvcGVyYXRpb24KICAgICAgdmFyIHgwID0gc3JjMFtzcmNPZmZzZXQwICsgMF07CiAgICAgIHZhciB5MCA9IHNyYzBbc3JjT2Zmc2V0MCArIDFdOwogICAgICB2YXIgejAgPSBzcmMwW3NyY09mZnNldDAgKyAyXTsKICAgICAgdmFyIHcwID0gc3JjMFtzcmNPZmZzZXQwICsgM107CiAgICAgIHZhciB4MSA9IHNyYzFbc3JjT2Zmc2V0MSArIDBdOwogICAgICB2YXIgeTEgPSBzcmMxW3NyY09mZnNldDEgKyAxXTsKICAgICAgdmFyIHoxID0gc3JjMVtzcmNPZmZzZXQxICsgMl07CiAgICAgIHZhciB3MSA9IHNyYzFbc3JjT2Zmc2V0MSArIDNdOwoKICAgICAgaWYgKHcwICE9PSB3MSB8fCB4MCAhPT0geDEgfHwgeTAgIT09IHkxIHx8IHowICE9PSB6MSkgewogICAgICAgIHZhciBzID0gMSAtIHQ7CiAgICAgICAgdmFyIGNvcyA9IHgwICogeDEgKyB5MCAqIHkxICsgejAgKiB6MSArIHcwICogdzE7CiAgICAgICAgdmFyIGRpciA9IGNvcyA+PSAwID8gMSA6IC0xOwogICAgICAgIHZhciBzcXJTaW4gPSAxIC0gY29zICogY29zOyAvLyBTa2lwIHRoZSBTbGVycCBmb3IgdGlueSBzdGVwcyB0byBhdm9pZCBudW1lcmljIHByb2JsZW1zOgoKICAgICAgICBpZiAoc3FyU2luID4gTnVtYmVyLkVQU0lMT04pIHsKICAgICAgICAgIHZhciBzaW4gPSBNYXRoLnNxcnQoc3FyU2luKTsKICAgICAgICAgIHZhciBsZW4gPSBNYXRoLmF0YW4yKHNpbiwgY29zICogZGlyKTsKICAgICAgICAgIHMgPSBNYXRoLnNpbihzICogbGVuKSAvIHNpbjsKICAgICAgICAgIHQgPSBNYXRoLnNpbih0ICogbGVuKSAvIHNpbjsKICAgICAgICB9CgogICAgICAgIHZhciB0RGlyID0gdCAqIGRpcjsKICAgICAgICB4MCA9IHgwICogcyArIHgxICogdERpcjsKICAgICAgICB5MCA9IHkwICogcyArIHkxICogdERpcjsKICAgICAgICB6MCA9IHowICogcyArIHoxICogdERpcjsKICAgICAgICB3MCA9IHcwICogcyArIHcxICogdERpcjsgLy8gTm9ybWFsaXplIGluIGNhc2Ugd2UganVzdCBkaWQgYSBsZXJwOgoKICAgICAgICBpZiAocyA9PT0gMSAtIHQpIHsKICAgICAgICAgIHZhciBmID0gMSAvIE1hdGguc3FydCh4MCAqIHgwICsgeTAgKiB5MCArIHowICogejAgKyB3MCAqIHcwKTsKICAgICAgICAgIHgwICo9IGY7CiAgICAgICAgICB5MCAqPSBmOwogICAgICAgICAgejAgKj0gZjsKICAgICAgICAgIHcwICo9IGY7CiAgICAgICAgfQogICAgICB9CgogICAgICBkc3RbZHN0T2Zmc2V0XSA9IHgwOwogICAgICBkc3RbZHN0T2Zmc2V0ICsgMV0gPSB5MDsKICAgICAgZHN0W2RzdE9mZnNldCArIDJdID0gejA7CiAgICAgIGRzdFtkc3RPZmZzZXQgKyAzXSA9IHcwOwogICAgfQogIH0sIHsKICAgIGtleTogInNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0KHgsIHksIHosIHcpIHsKICAgICAgdGhpcy5feCA9IHg7CiAgICAgIHRoaXMuX3kgPSB5OwogICAgICB0aGlzLl96ID0gejsKICAgICAgdGhpcy5fdyA9IHc7CiAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjaygpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLl94LCB0aGlzLl95LCB0aGlzLl96LCB0aGlzLl93KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb3B5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb3B5KHF1YXRlcm5pb24pIHsKICAgICAgdGhpcy5feCA9IHF1YXRlcm5pb24ueDsKICAgICAgdGhpcy5feSA9IHF1YXRlcm5pb24ueTsKICAgICAgdGhpcy5feiA9IHF1YXRlcm5pb24uejsKICAgICAgdGhpcy5fdyA9IHF1YXRlcm5pb24udzsKICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21FdWxlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbUV1bGVyKGV1bGVyLCB1cGRhdGUpIHsKICAgICAgaWYgKCEoZXVsZXIgJiYgZXVsZXIuaXNFdWxlcikpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RIUkVFLlF1YXRlcm5pb246IC5zZXRGcm9tRXVsZXIoKSBub3cgZXhwZWN0cyBhbiBFdWxlciByb3RhdGlvbiByYXRoZXIgdGhhbiBhIFZlY3RvcjMgYW5kIG9yZGVyLicpOwogICAgICB9CgogICAgICB2YXIgeCA9IGV1bGVyLl94OwogICAgICB2YXIgeSA9IGV1bGVyLl95OwogICAgICB2YXIgeiA9IGV1bGVyLl96OwogICAgICB2YXIgb3JkZXIgPSBldWxlci5vcmRlcjsgLy8gaHR0cDovL3d3dy5tYXRod29ya3MuY29tL21hdGxhYmNlbnRyYWwvZmlsZWV4Y2hhbmdlLwogICAgICAvLyAyMDY5Ni1mdW5jdGlvbi10by1jb252ZXJ0LWJldHdlZW4tZGNtLWV1bGVyLWFuZ2xlcy1xdWF0ZXJuaW9ucy1hbmQtZXVsZXItdmVjdG9ycy8KICAgICAgLy8gY29udGVudC9TcGluQ2FsYy5tCgogICAgICB2YXIgY29zID0gTWF0aC5jb3M7CiAgICAgIHZhciBzaW4gPSBNYXRoLnNpbjsKICAgICAgdmFyIGMxID0gY29zKHggLyAyKTsKICAgICAgdmFyIGMyID0gY29zKHkgLyAyKTsKICAgICAgdmFyIGMzID0gY29zKHogLyAyKTsKICAgICAgdmFyIHMxID0gc2luKHggLyAyKTsKICAgICAgdmFyIHMyID0gc2luKHkgLyAyKTsKICAgICAgdmFyIHMzID0gc2luKHogLyAyKTsKCiAgICAgIGlmIChvcmRlciA9PT0gJ1hZWicpIHsKICAgICAgICB0aGlzLl94ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMuX3kgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy5feiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLl93ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWVhaJykgewogICAgICAgIHRoaXMuX3ggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy5feSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLl96ID0gYzEgKiBjMiAqIHMzIC0gczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMuX3cgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdaWFknKSB7CiAgICAgICAgdGhpcy5feCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLl95ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMuX3ogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy5fdyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1pZWCcpIHsKICAgICAgICB0aGlzLl94ID0gczEgKiBjMiAqIGMzIC0gYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMuX3kgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy5feiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLl93ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWVpYJykgewogICAgICAgIHRoaXMuX3ggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy5feSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLl96ID0gYzEgKiBjMiAqIHMzIC0gczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMuX3cgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdYWlknKSB7CiAgICAgICAgdGhpcy5feCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLl95ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMuX3ogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy5fdyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgfQoKICAgICAgaWYgKHVwZGF0ZSAhPT0gZmFsc2UpIHRoaXMub25DaGFuZ2VDYWxsYmFjaygpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGcm9tQXhpc0FuZ2xlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGcm9tQXhpc0FuZ2xlKGF4aXMsIGFuZ2xlKSB7CiAgICAgIC8vIGh0dHA6Ly93d3cuZXVjbGlkZWFuc3BhY2UuY29tL21hdGhzL2dlb21ldHJ5L3JvdGF0aW9ucy9jb252ZXJzaW9ucy9hbmdsZVRvUXVhdGVybmlvbi9pbmRleC5odG0KICAgICAgLy8gYXNzdW1lcyBheGlzIGlzIG5vcm1hbGl6ZWQKICAgICAgdmFyIGhhbGZBbmdsZSA9IGFuZ2xlIC8gMjsKICAgICAgdmFyIHMgPSBNYXRoLnNpbihoYWxmQW5nbGUpOwogICAgICB0aGlzLl94ID0gYXhpcy54ICogczsKICAgICAgdGhpcy5feSA9IGF4aXMueSAqIHM7CiAgICAgIHRoaXMuX3ogPSBheGlzLnogKiBzOwogICAgICB0aGlzLl93ID0gTWF0aC5jb3MoaGFsZkFuZ2xlKTsKICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21Sb3RhdGlvbk1hdHJpeCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbVJvdGF0aW9uTWF0cml4KG0pIHsKICAgICAgLy8gaHR0cDovL3d3dy5ldWNsaWRlYW5zcGFjZS5jb20vbWF0aHMvZ2VvbWV0cnkvcm90YXRpb25zL2NvbnZlcnNpb25zL21hdHJpeFRvUXVhdGVybmlvbi9pbmRleC5odG0KICAgICAgLy8gYXNzdW1lcyB0aGUgdXBwZXIgM3gzIG9mIG0gaXMgYSBwdXJlIHJvdGF0aW9uIG1hdHJpeCAoaS5lLCB1bnNjYWxlZCkKICAgICAgdmFyIHRlID0gbS5lbGVtZW50czsKICAgICAgdmFyIG0xMSA9IHRlWzBdOwogICAgICB2YXIgbTEyID0gdGVbNF07CiAgICAgIHZhciBtMTMgPSB0ZVs4XTsKICAgICAgdmFyIG0yMSA9IHRlWzFdOwogICAgICB2YXIgbTIyID0gdGVbNV07CiAgICAgIHZhciBtMjMgPSB0ZVs5XTsKICAgICAgdmFyIG0zMSA9IHRlWzJdOwogICAgICB2YXIgbTMyID0gdGVbNl07CiAgICAgIHZhciBtMzMgPSB0ZVsxMF07CiAgICAgIHZhciB0cmFjZSA9IG0xMSArIG0yMiArIG0zMzsKICAgICAgdmFyIHM7CgogICAgICBpZiAodHJhY2UgPiAwKSB7CiAgICAgICAgcyA9IDAuNSAvIE1hdGguc3FydCh0cmFjZSArIDEuMCk7CiAgICAgICAgdGhpcy5fdyA9IDAuMjUgLyBzOwogICAgICAgIHRoaXMuX3ggPSAobTMyIC0gbTIzKSAqIHM7CiAgICAgICAgdGhpcy5feSA9IChtMTMgLSBtMzEpICogczsKICAgICAgICB0aGlzLl96ID0gKG0yMSAtIG0xMikgKiBzOwogICAgICB9IGVsc2UgaWYgKG0xMSA+IG0yMiAmJiBtMTEgPiBtMzMpIHsKICAgICAgICBzID0gMi4wICogTWF0aC5zcXJ0KDEuMCArIG0xMSAtIG0yMiAtIG0zMyk7CiAgICAgICAgdGhpcy5fdyA9IChtMzIgLSBtMjMpIC8gczsKICAgICAgICB0aGlzLl94ID0gMC4yNSAqIHM7CiAgICAgICAgdGhpcy5feSA9IChtMTIgKyBtMjEpIC8gczsKICAgICAgICB0aGlzLl96ID0gKG0xMyArIG0zMSkgLyBzOwogICAgICB9IGVsc2UgaWYgKG0yMiA+IG0zMykgewogICAgICAgIHMgPSAyLjAgKiBNYXRoLnNxcnQoMS4wICsgbTIyIC0gbTExIC0gbTMzKTsKICAgICAgICB0aGlzLl93ID0gKG0xMyAtIG0zMSkgLyBzOwogICAgICAgIHRoaXMuX3ggPSAobTEyICsgbTIxKSAvIHM7CiAgICAgICAgdGhpcy5feSA9IDAuMjUgKiBzOwogICAgICAgIHRoaXMuX3ogPSAobTIzICsgbTMyKSAvIHM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcyA9IDIuMCAqIE1hdGguc3FydCgxLjAgKyBtMzMgLSBtMTEgLSBtMjIpOwogICAgICAgIHRoaXMuX3cgPSAobTIxIC0gbTEyKSAvIHM7CiAgICAgICAgdGhpcy5feCA9IChtMTMgKyBtMzEpIC8gczsKICAgICAgICB0aGlzLl95ID0gKG0yMyArIG0zMikgLyBzOwogICAgICAgIHRoaXMuX3ogPSAwLjI1ICogczsKICAgICAgfQoKICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21Vbml0VmVjdG9ycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbVVuaXRWZWN0b3JzKHZGcm9tLCB2VG8pIHsKICAgICAgdmFyIHYxID0gbmV3IFZlY3RvcjMoKTsKICAgICAgdmFyIHI7CiAgICAgIHZhciBFUFMgPSAwLjAwMDAwMTsKICAgICAgaWYgKHYxID09PSB1bmRlZmluZWQpIHYxID0gbmV3IFZlY3RvcjMoKTsKICAgICAgciA9IHZGcm9tLmRvdCh2VG8pICsgMTsKCiAgICAgIGlmIChyIDwgRVBTKSB7CiAgICAgICAgciA9IDA7CgogICAgICAgIGlmIChNYXRoLmFicyh2RnJvbS54KSA+IE1hdGguYWJzKHZGcm9tLnopKSB7CiAgICAgICAgICB2MS5zZXQoLXZGcm9tLnksIHZGcm9tLngsIDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2MS5zZXQoMCwgLXZGcm9tLnosIHZGcm9tLnkpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2MS5jcm9zc1ZlY3RvcnModkZyb20sIHZUbyk7CiAgICAgIH0KCiAgICAgIHRoaXMuX3ggPSB2MS54OwogICAgICB0aGlzLl95ID0gdjEueTsKICAgICAgdGhpcy5feiA9IHYxLno7CiAgICAgIHRoaXMuX3cgPSByOwogICAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhbmdsZVRvIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhbmdsZVRvKHEpIHsKICAgICAgcmV0dXJuIDIgKiBNYXRoLmFjb3MoTWF0aC5hYnMoX01hdGguY2xhbXAodGhpcy5kb3QocSksIC0xLCAxKSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJvdGF0ZVRvd2FyZHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJvdGF0ZVRvd2FyZHMocSwgc3RlcCkgewogICAgICB2YXIgYW5nbGUgPSB0aGlzLmFuZ2xlVG8ocSk7CiAgICAgIGlmIChhbmdsZSA9PT0gMCkgcmV0dXJuIHRoaXM7CiAgICAgIHZhciB0ID0gTWF0aC5taW4oMSwgc3RlcCAvIGFuZ2xlKTsKICAgICAgdGhpcy5zbGVycChxLCB0KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW52ZXJzZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW52ZXJzZSgpIHsKICAgICAgLy8gcXVhdGVybmlvbiBpcyBhc3N1bWVkIHRvIGhhdmUgdW5pdCBsZW5ndGgKICAgICAgcmV0dXJuIHRoaXMuY29uanVnYXRlKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29uanVnYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb25qdWdhdGUoKSB7CiAgICAgIHRoaXMuX3ggKj0gLTE7CiAgICAgIHRoaXMuX3kgKj0gLTE7CiAgICAgIHRoaXMuX3ogKj0gLTE7CiAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjaygpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkb3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRvdCh2KSB7CiAgICAgIHJldHVybiB0aGlzLl94ICogdi5feCArIHRoaXMuX3kgKiB2Ll95ICsgdGhpcy5feiAqIHYuX3ogKyB0aGlzLl93ICogdi5fdzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsZW5ndGhTcSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbGVuZ3RoU3EoKSB7CiAgICAgIHJldHVybiB0aGlzLl94ICogdGhpcy5feCArIHRoaXMuX3kgKiB0aGlzLl95ICsgdGhpcy5feiAqIHRoaXMuX3ogKyB0aGlzLl93ICogdGhpcy5fdzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsZW5ndGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxlbmd0aCgpIHsKICAgICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLl94ICogdGhpcy5feCArIHRoaXMuX3kgKiB0aGlzLl95ICsgdGhpcy5feiAqIHRoaXMuX3ogKyB0aGlzLl93ICogdGhpcy5fdyk7CiAgICB9CiAgfSwgewogICAga2V5OiAibm9ybWFsaXplIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBub3JtYWxpemUoKSB7CiAgICAgIHZhciBsID0gdGhpcy5sZW5ndGgoKTsKCiAgICAgIGlmIChsID09PSAwKSB7CiAgICAgICAgdGhpcy5feCA9IDA7CiAgICAgICAgdGhpcy5feSA9IDA7CiAgICAgICAgdGhpcy5feiA9IDA7CiAgICAgICAgdGhpcy5fdyA9IDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbCA9IDEgLyBsOwogICAgICAgIHRoaXMuX3ggPSB0aGlzLl94ICogbDsKICAgICAgICB0aGlzLl95ID0gdGhpcy5feSAqIGw7CiAgICAgICAgdGhpcy5feiA9IHRoaXMuX3ogKiBsOwogICAgICAgIHRoaXMuX3cgPSB0aGlzLl93ICogbDsKICAgICAgfQoKICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm11bHRpcGx5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtdWx0aXBseShxLCBwKSB7CiAgICAgIGlmIChwICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLlF1YXRlcm5pb246IC5tdWx0aXBseSgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLm11bHRpcGx5UXVhdGVybmlvbnMoIGEsIGIgKSBpbnN0ZWFkLicpOwogICAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5UXVhdGVybmlvbnMocSwgcCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5UXVhdGVybmlvbnModGhpcywgcSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJlbXVsdGlwbHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZW11bHRpcGx5KHEpIHsKICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHlRdWF0ZXJuaW9ucyhxLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtdWx0aXBseVF1YXRlcm5pb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtdWx0aXBseVF1YXRlcm5pb25zKGEsIGIpIHsKICAgICAgLy8gZnJvbSBodHRwOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9hbGdlYnJhL3JlYWxOb3JtZWRBbGdlYnJhL3F1YXRlcm5pb25zL2NvZGUvaW5kZXguaHRtCiAgICAgIHZhciBxYXggPSBhLl94OwogICAgICB2YXIgcWF5ID0gYS5feTsKICAgICAgdmFyIHFheiA9IGEuX3o7CiAgICAgIHZhciBxYXcgPSBhLl93OwogICAgICB2YXIgcWJ4ID0gYi5feDsKICAgICAgdmFyIHFieSA9IGIuX3k7CiAgICAgIHZhciBxYnogPSBiLl96OwogICAgICB2YXIgcWJ3ID0gYi5fdzsKICAgICAgdGhpcy5feCA9IHFheCAqIHFidyArIHFhdyAqIHFieCArIHFheSAqIHFieiAtIHFheiAqIHFieTsKICAgICAgdGhpcy5feSA9IHFheSAqIHFidyArIHFhdyAqIHFieSArIHFheiAqIHFieCAtIHFheCAqIHFiejsKICAgICAgdGhpcy5feiA9IHFheiAqIHFidyArIHFhdyAqIHFieiArIHFheCAqIHFieSAtIHFheSAqIHFieDsKICAgICAgdGhpcy5fdyA9IHFhdyAqIHFidyAtIHFheCAqIHFieCAtIHFheSAqIHFieSAtIHFheiAqIHFiejsKICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNsZXJwIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzbGVycChxYiwgdCkgewogICAgICBpZiAodCA9PT0gMCkgcmV0dXJuIHRoaXM7CiAgICAgIGlmICh0ID09PSAxKSByZXR1cm4gdGhpcy5jb3B5KHFiKTsKICAgICAgdmFyIHggPSB0aGlzLl94OwogICAgICB2YXIgeSA9IHRoaXMuX3k7CiAgICAgIHZhciB6ID0gdGhpcy5fejsKICAgICAgdmFyIHcgPSB0aGlzLl93OyAvLyBodHRwOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9hbGdlYnJhL3JlYWxOb3JtZWRBbGdlYnJhL3F1YXRlcm5pb25zL3NsZXJwLwoKICAgICAgdmFyIGNvc0hhbGZUaGV0YSA9IHcgKiBxYi5fdyArIHggKiBxYi5feCArIHkgKiBxYi5feSArIHogKiBxYi5fejsKCiAgICAgIGlmIChjb3NIYWxmVGhldGEgPCAwKSB7CiAgICAgICAgdGhpcy5fdyA9IC1xYi5fdzsKICAgICAgICB0aGlzLl94ID0gLXFiLl94OwogICAgICAgIHRoaXMuX3kgPSAtcWIuX3k7CiAgICAgICAgdGhpcy5feiA9IC1xYi5fejsKICAgICAgICBjb3NIYWxmVGhldGEgPSAtY29zSGFsZlRoZXRhOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29weShxYik7CiAgICAgIH0KCiAgICAgIGlmIChjb3NIYWxmVGhldGEgPj0gMS4wKSB7CiAgICAgICAgdGhpcy5fdyA9IHc7CiAgICAgICAgdGhpcy5feCA9IHg7CiAgICAgICAgdGhpcy5feSA9IHk7CiAgICAgICAgdGhpcy5feiA9IHo7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIHZhciBzcXJTaW5IYWxmVGhldGEgPSAxLjAgLSBjb3NIYWxmVGhldGEgKiBjb3NIYWxmVGhldGE7CgogICAgICBpZiAoc3FyU2luSGFsZlRoZXRhIDw9IE51bWJlci5FUFNJTE9OKSB7CiAgICAgICAgdmFyIHMgPSAxIC0gdDsKICAgICAgICB0aGlzLl93ID0gcyAqIHcgKyB0ICogdGhpcy5fdzsKICAgICAgICB0aGlzLl94ID0gcyAqIHggKyB0ICogdGhpcy5feDsKICAgICAgICB0aGlzLl95ID0gcyAqIHkgKyB0ICogdGhpcy5feTsKICAgICAgICB0aGlzLl96ID0gcyAqIHogKyB0ICogdGhpcy5fejsKICAgICAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUoKTsKICAgICAgfQoKICAgICAgdmFyIHNpbkhhbGZUaGV0YSA9IE1hdGguc3FydChzcXJTaW5IYWxmVGhldGEpOwogICAgICB2YXIgaGFsZlRoZXRhID0gTWF0aC5hdGFuMihzaW5IYWxmVGhldGEsIGNvc0hhbGZUaGV0YSk7CiAgICAgIHZhciByYXRpb0EgPSBNYXRoLnNpbigoMSAtIHQpICogaGFsZlRoZXRhKSAvIHNpbkhhbGZUaGV0YTsKICAgICAgdmFyIHJhdGlvQiA9IE1hdGguc2luKHQgKiBoYWxmVGhldGEpIC8gc2luSGFsZlRoZXRhOwogICAgICB0aGlzLl93ID0gdyAqIHJhdGlvQSArIHRoaXMuX3cgKiByYXRpb0I7CiAgICAgIHRoaXMuX3ggPSB4ICogcmF0aW9BICsgdGhpcy5feCAqIHJhdGlvQjsKICAgICAgdGhpcy5feSA9IHkgKiByYXRpb0EgKyB0aGlzLl95ICogcmF0aW9COwogICAgICB0aGlzLl96ID0geiAqIHJhdGlvQSArIHRoaXMuX3ogKiByYXRpb0I7CiAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjaygpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJlcXVhbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVxdWFscyhxdWF0ZXJuaW9uKSB7CiAgICAgIHJldHVybiBxdWF0ZXJuaW9uLl94ID09PSB0aGlzLl94ICYmIHF1YXRlcm5pb24uX3kgPT09IHRoaXMuX3kgJiYgcXVhdGVybmlvbi5feiA9PT0gdGhpcy5feiAmJiBxdWF0ZXJuaW9uLl93ID09PSB0aGlzLl93OwogICAgfQogIH0sIHsKICAgIGtleTogImZyb21BcnJheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZnJvbUFycmF5KGFycmF5LCBvZmZzZXQpIHsKICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSBvZmZzZXQgPSAwOwogICAgICB0aGlzLl94ID0gYXJyYXlbb2Zmc2V0XTsKICAgICAgdGhpcy5feSA9IGFycmF5W29mZnNldCArIDFdOwogICAgICB0aGlzLl96ID0gYXJyYXlbb2Zmc2V0ICsgMl07CiAgICAgIHRoaXMuX3cgPSBhcnJheVtvZmZzZXQgKyAzXTsKICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInRvQXJyYXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvQXJyYXkoYXJyYXksIG9mZnNldCkgewogICAgICBpZiAoYXJyYXkgPT09IHVuZGVmaW5lZCkgYXJyYXkgPSBbXTsKICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSBvZmZzZXQgPSAwOwogICAgICBhcnJheVtvZmZzZXRdID0gdGhpcy5feDsKICAgICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSB0aGlzLl95OwogICAgICBhcnJheVtvZmZzZXQgKyAyXSA9IHRoaXMuX3o7CiAgICAgIGFycmF5W29mZnNldCArIDNdID0gdGhpcy5fdzsKICAgICAgcmV0dXJuIGFycmF5OwogICAgfQogIH0sIHsKICAgIGtleTogIm9uQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShjYWxsYmFjaykgewogICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAib25DaGFuZ2VDYWxsYmFjayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2VDYWxsYmFjaygpIHt9CiAgfV0pOwoKICByZXR1cm4gUXVhdGVybmlvbjsKfSgpOwpPYmplY3QuZGVmaW5lUHJvcGVydGllcyhRdWF0ZXJuaW9uLnByb3RvdHlwZSwgewogIHg6IHsKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5feDsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkgewogICAgICB0aGlzLl94ID0gdmFsdWU7CiAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjaygpOwogICAgfQogIH0sCiAgeTogewogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl95OwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7CiAgICAgIHRoaXMuX3kgPSB2YWx1ZTsKICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCk7CiAgICB9CiAgfSwKICB6OiB7CiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3o7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHsKICAgICAgdGhpcy5feiA9IHZhbHVlOwogICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKTsKICAgIH0KICB9LAogIHc6IHsKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fdzsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkgewogICAgICB0aGlzLl93ID0gdmFsdWU7CiAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjaygpOwogICAgfQogIH0KfSk7CgovKioKICogQGF1dGhvciBtcmRvb2IgLyBodHRwOi8vbXJkb29iLmNvbS8KICogQGF1dGhvciBraWxlIC8gaHR0cDovL2tpbGUuc3RyYXZhZ2FuemEub3JnLwogKiBAYXV0aG9yIHBoaWxvZ2IgLyBodHRwOi8vYmxvZy50aGVqaXQub3JnLwogKiBAYXV0aG9yIG1pa2FlbCBlbXRpbmdlciAvIGh0dHA6Ly9nb21vLnNlLwogKiBAYXV0aG9yIGVncmFldGhlciAvIGh0dHA6Ly9lZ3JhZXRoZXIuY29tLwogKiBAYXV0aG9yIFdlc3RMYW5nbGV5IC8gaHR0cDovL2dpdGh1Yi5jb20vV2VzdExhbmdsZXkKICovCgp2YXIgVmVjdG9yMyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gVmVjdG9yMyh4LCB5LCB6KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVmVjdG9yMyk7CgogICAgdGhpcy54ID0geCB8fCAwOwogICAgdGhpcy55ID0geSB8fCAwOwogICAgdGhpcy56ID0geiB8fCAwOwogICAgdGhpcy5pc1ZlY3RvcjMgPSB0cnVlOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFZlY3RvcjMsIFt7CiAgICBrZXk6ICJzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldCh4LCB5LCB6KSB7CiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMueiA9IHo7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFNjYWxhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U2NhbGFyKHNjYWxhcikgewogICAgICB0aGlzLnggPSBzY2FsYXI7CiAgICAgIHRoaXMueSA9IHNjYWxhcjsKICAgICAgdGhpcy56ID0gc2NhbGFyOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRYIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRYKHgpIHsKICAgICAgdGhpcy54ID0geDsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0WSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0WSh5KSB7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFoiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFooeikgewogICAgICB0aGlzLnogPSB6OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRDb21wb25lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbXBvbmVudChpbmRleCwgdmFsdWUpIHsKICAgICAgc3dpdGNoIChpbmRleCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHRoaXMueCA9IHZhbHVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRoaXMueSA9IHZhbHVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHRoaXMueiA9IHZhbHVlOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2luZGV4IGlzIG91dCBvZiByYW5nZTogJyArIGluZGV4KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Q29tcG9uZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb21wb25lbnQoaW5kZXgpIHsKICAgICAgc3dpdGNoIChpbmRleCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHJldHVybiB0aGlzLng7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIHJldHVybiB0aGlzLnk7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHJldHVybiB0aGlzLno7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2luZGV4IGlzIG91dCBvZiByYW5nZTogJyArIGluZGV4KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNsb25lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHsKICAgICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCwgdGhpcy55LCB0aGlzLnopOwogICAgfQogIH0sIHsKICAgIGtleTogImNvcHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvcHkodikgewogICAgICB0aGlzLnggPSB2Lng7CiAgICAgIHRoaXMueSA9IHYueTsKICAgICAgdGhpcy56ID0gdi56OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZCh2LCB3KSB7CiAgICAgIGlmICh3ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLlZlY3RvcjM6IC5hZGQoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5hZGRWZWN0b3JzKCBhLCBiICkgaW5zdGVhZC4nKTsKICAgICAgICByZXR1cm4gdGhpcy5hZGRWZWN0b3JzKHYsIHcpOwogICAgICB9CgogICAgICB0aGlzLnggKz0gdi54OwogICAgICB0aGlzLnkgKz0gdi55OwogICAgICB0aGlzLnogKz0gdi56OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGRTY2FsYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFNjYWxhcihzKSB7CiAgICAgIHRoaXMueCArPSBzOwogICAgICB0aGlzLnkgKz0gczsKICAgICAgdGhpcy56ICs9IHM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImFkZFZlY3RvcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFZlY3RvcnMoYSwgYikgewogICAgICB0aGlzLnggPSBhLnggKyBiLng7CiAgICAgIHRoaXMueSA9IGEueSArIGIueTsKICAgICAgdGhpcy56ID0gYS56ICsgYi56OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGRTY2FsZWRWZWN0b3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFNjYWxlZFZlY3Rvcih2LCBzKSB7CiAgICAgIHRoaXMueCArPSB2LnggKiBzOwogICAgICB0aGlzLnkgKz0gdi55ICogczsKICAgICAgdGhpcy56ICs9IHYueiAqIHM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInN1YiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3ViKHYsIHcpIHsKICAgICAgaWYgKHcgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnNvbGUud2FybignVEhSRUUuVmVjdG9yMzogLnN1YigpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLnN1YlZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLicpOwogICAgICAgIHJldHVybiB0aGlzLnN1YlZlY3RvcnModiwgdyk7CiAgICAgIH0KCiAgICAgIHRoaXMueCAtPSB2Lng7CiAgICAgIHRoaXMueSAtPSB2Lnk7CiAgICAgIHRoaXMueiAtPSB2Lno7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInN1YlNjYWxhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3ViU2NhbGFyKHMpIHsKICAgICAgdGhpcy54IC09IHM7CiAgICAgIHRoaXMueSAtPSBzOwogICAgICB0aGlzLnogLT0gczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic3ViVmVjdG9ycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3ViVmVjdG9ycyhhLCBiKSB7CiAgICAgIHRoaXMueCA9IGEueCAtIGIueDsKICAgICAgdGhpcy55ID0gYS55IC0gYi55OwogICAgICB0aGlzLnogPSBhLnogLSBiLno7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm11bHRpcGx5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtdWx0aXBseSh2LCB3KSB7CiAgICAgIGlmICh3ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLlZlY3RvcjM6IC5tdWx0aXBseSgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLm11bHRpcGx5VmVjdG9ycyggYSwgYiApIGluc3RlYWQuJyk7CiAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHlWZWN0b3JzKHYsIHcpOwogICAgICB9CgogICAgICB0aGlzLnggKj0gdi54OwogICAgICB0aGlzLnkgKj0gdi55OwogICAgICB0aGlzLnogKj0gdi56OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtdWx0aXBseVNjYWxhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbXVsdGlwbHlTY2FsYXIoc2NhbGFyKSB7CiAgICAgIHRoaXMueCAqPSBzY2FsYXI7CiAgICAgIHRoaXMueSAqPSBzY2FsYXI7CiAgICAgIHRoaXMueiAqPSBzY2FsYXI7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm11bHRpcGx5VmVjdG9ycyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbXVsdGlwbHlWZWN0b3JzKGEsIGIpIHsKICAgICAgdGhpcy54ID0gYS54ICogYi54OwogICAgICB0aGlzLnkgPSBhLnkgKiBiLnk7CiAgICAgIHRoaXMueiA9IGEueiAqIGIuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiYXBwbHlFdWxlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlFdWxlcihldWxlcikgewogICAgICBpZiAoIShldWxlciAmJiBldWxlci5pc0V1bGVyKSkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RIUkVFLlZlY3RvcjM6IC5hcHBseUV1bGVyKCkgbm93IGV4cGVjdHMgYW4gRXVsZXIgcm90YXRpb24gcmF0aGVyIHRoYW4gYSBWZWN0b3IzIGFuZCBvcmRlci4nKTsKICAgICAgfQoKICAgICAgdmFyIHF1YXRlcm5pb24gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICByZXR1cm4gdGhpcy5hcHBseVF1YXRlcm5pb24ocXVhdGVybmlvbi5zZXRGcm9tRXVsZXIoZXVsZXIpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhcHBseUF4aXNBbmdsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlBeGlzQW5nbGUoYXhpcywgYW5nbGUpIHsKICAgICAgdmFyIHF1YXRlcm5pb24gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICByZXR1cm4gdGhpcy5hcHBseVF1YXRlcm5pb24ocXVhdGVybmlvbi5zZXRGcm9tQXhpc0FuZ2xlKGF4aXMsIGFuZ2xlKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYXBwbHlNYXRyaXgzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseU1hdHJpeDMobSkgewogICAgICB2YXIgeCA9IHRoaXMueDsKICAgICAgdmFyIHkgPSB0aGlzLnk7CiAgICAgIHZhciB6ID0gdGhpcy56OwogICAgICB2YXIgZSA9IG0uZWxlbWVudHM7CiAgICAgIHRoaXMueCA9IGVbMF0gKiB4ICsgZVszXSAqIHkgKyBlWzZdICogejsKICAgICAgdGhpcy55ID0gZVsxXSAqIHggKyBlWzRdICogeSArIGVbN10gKiB6OwogICAgICB0aGlzLnogPSBlWzJdICogeCArIGVbNV0gKiB5ICsgZVs4XSAqIHo7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImFwcGx5TWF0cml4NCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlNYXRyaXg0KG0pIHsKICAgICAgdmFyIHggPSB0aGlzLng7CiAgICAgIHZhciB5ID0gdGhpcy55OwogICAgICB2YXIgeiA9IHRoaXMuejsKICAgICAgdmFyIGUgPSBtLmVsZW1lbnRzOwogICAgICB2YXIgdyA9IDEgLyAoZVszXSAqIHggKyBlWzddICogeSArIGVbMTFdICogeiArIGVbMTVdKTsKICAgICAgdGhpcy54ID0gKGVbMF0gKiB4ICsgZVs0XSAqIHkgKyBlWzhdICogeiArIGVbMTJdKSAqIHc7CiAgICAgIHRoaXMueSA9IChlWzFdICogeCArIGVbNV0gKiB5ICsgZVs5XSAqIHogKyBlWzEzXSkgKiB3OwogICAgICB0aGlzLnogPSAoZVsyXSAqIHggKyBlWzZdICogeSArIGVbMTBdICogeiArIGVbMTRdKSAqIHc7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImFwcGx5UXVhdGVybmlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlRdWF0ZXJuaW9uKHEpIHsKICAgICAgdmFyIHggPSB0aGlzLng7CiAgICAgIHZhciB5ID0gdGhpcy55OwogICAgICB2YXIgeiA9IHRoaXMuejsKICAgICAgdmFyIHF4ID0gcS54OwogICAgICB2YXIgcXkgPSBxLnk7CiAgICAgIHZhciBxeiA9IHEuejsKICAgICAgdmFyIHF3ID0gcS53OyAvLyBjYWxjdWxhdGUgcXVhdCAqIHZlY3RvcgoKICAgICAgdmFyIGl4ID0gcXcgKiB4ICsgcXkgKiB6IC0gcXogKiB5OwogICAgICB2YXIgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CiAgICAgIHZhciBpeiA9IHF3ICogeiArIHF4ICogeSAtIHF5ICogeDsKICAgICAgdmFyIGl3ID0gLXF4ICogeCAtIHF5ICogeSAtIHF6ICogejsgLy8gY2FsY3VsYXRlIHJlc3VsdCAqIGludmVyc2UgcXVhdAoKICAgICAgdGhpcy54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgICAgdGhpcy55ID0gaXkgKiBxdyArIGl3ICogLXF5ICsgaXogKiAtcXggLSBpeCAqIC1xejsKICAgICAgdGhpcy56ID0gaXogKiBxdyArIGl3ICogLXF6ICsgaXggKiAtcXkgLSBpeSAqIC1xeDsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJvamVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvamVjdChjYW1lcmEpIHsKICAgICAgcmV0dXJuIHRoaXMuYXBwbHlNYXRyaXg0KGNhbWVyYS5tYXRyaXhXb3JsZEludmVyc2UpLmFwcGx5TWF0cml4NChjYW1lcmEucHJvamVjdGlvbk1hdHJpeCk7CiAgICB9CiAgfSwgewogICAga2V5OiAidW5wcm9qZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1bnByb2plY3QoY2FtZXJhKSB7CiAgICAgIHZhciBtYXRyaXggPSBuZXcgTWF0cml4NCgpOwogICAgICByZXR1cm4gdGhpcy5hcHBseU1hdHJpeDQobWF0cml4LmdldEludmVyc2UoY2FtZXJhLnByb2plY3Rpb25NYXRyaXgpKS5hcHBseU1hdHJpeDQoY2FtZXJhLm1hdHJpeFdvcmxkKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0cmFuc2Zvcm1EaXJlY3Rpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRyYW5zZm9ybURpcmVjdGlvbihtKSB7CiAgICAgIC8vIGlucHV0OiBUSFJFRS5NYXRyaXg0IGFmZmluZSBtYXRyaXgKICAgICAgLy8gdmVjdG9yIGludGVycHJldGVkIGFzIGEgZGlyZWN0aW9uCiAgICAgIHZhciB4ID0gdGhpcy54OwogICAgICB2YXIgeSA9IHRoaXMueTsKICAgICAgdmFyIHogPSB0aGlzLno7CiAgICAgIHZhciBlID0gbS5lbGVtZW50czsKICAgICAgdGhpcy54ID0gZVswXSAqIHggKyBlWzRdICogeSArIGVbOF0gKiB6OwogICAgICB0aGlzLnkgPSBlWzFdICogeCArIGVbNV0gKiB5ICsgZVs5XSAqIHo7CiAgICAgIHRoaXMueiA9IGVbMl0gKiB4ICsgZVs2XSAqIHkgKyBlWzEwXSAqIHo7CiAgICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImRpdmlkZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGl2aWRlKHYpIHsKICAgICAgdGhpcy54IC89IHYueDsKICAgICAgdGhpcy55IC89IHYueTsKICAgICAgdGhpcy56IC89IHYuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGl2aWRlU2NhbGFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXZpZGVTY2FsYXIoc2NhbGFyKSB7CiAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5U2NhbGFyKDEgLyBzY2FsYXIpOwogICAgfQogIH0sIHsKICAgIGtleTogIm1pbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWluKHYpIHsKICAgICAgdGhpcy54ID0gTWF0aC5taW4odGhpcy54LCB2LngpOwogICAgICB0aGlzLnkgPSBNYXRoLm1pbih0aGlzLnksIHYueSk7CiAgICAgIHRoaXMueiA9IE1hdGgubWluKHRoaXMueiwgdi56KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibWF4IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYXgodikgewogICAgICB0aGlzLnggPSBNYXRoLm1heCh0aGlzLngsIHYueCk7CiAgICAgIHRoaXMueSA9IE1hdGgubWF4KHRoaXMueSwgdi55KTsKICAgICAgdGhpcy56ID0gTWF0aC5tYXgodGhpcy56LCB2LnopOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbGFtcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xhbXAobWluLCBtYXgpIHsKICAgICAgLy8gYXNzdW1lcyBtaW4gPCBtYXgsIGNvbXBvbmVudHdpc2UKICAgICAgdGhpcy54ID0gTWF0aC5tYXgobWluLngsIE1hdGgubWluKG1heC54LCB0aGlzLngpKTsKICAgICAgdGhpcy55ID0gTWF0aC5tYXgobWluLnksIE1hdGgubWluKG1heC55LCB0aGlzLnkpKTsKICAgICAgdGhpcy56ID0gTWF0aC5tYXgobWluLnosIE1hdGgubWluKG1heC56LCB0aGlzLnopKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xhbXBTY2FsYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsYW1wU2NhbGFyKG1pblZhbCwgbWF4VmFsKSB7CiAgICAgIHZhciBtaW4gPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgbWF4ID0gbmV3IFZlY3RvcjMoKTsKICAgICAgbWluLnNldChtaW5WYWwsIG1pblZhbCwgbWluVmFsKTsKICAgICAgbWF4LnNldChtYXhWYWwsIG1heFZhbCwgbWF4VmFsKTsKICAgICAgcmV0dXJuIHRoaXMuY2xhbXAobWluLCBtYXgpOwogICAgfQogIH0sIHsKICAgIGtleTogImNsYW1wTGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGFtcExlbmd0aChtaW4sIG1heCkgewogICAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTsKICAgICAgcmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKGxlbmd0aCB8fCAxKS5tdWx0aXBseVNjYWxhcihNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgbGVuZ3RoKSkpOwogICAgfQogIH0sIHsKICAgIGtleTogImZsb29yIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmbG9vcigpIHsKICAgICAgdGhpcy54ID0gTWF0aC5mbG9vcih0aGlzLngpOwogICAgICB0aGlzLnkgPSBNYXRoLmZsb29yKHRoaXMueSk7CiAgICAgIHRoaXMueiA9IE1hdGguZmxvb3IodGhpcy56KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2VpbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2VpbCgpIHsKICAgICAgdGhpcy54ID0gTWF0aC5jZWlsKHRoaXMueCk7CiAgICAgIHRoaXMueSA9IE1hdGguY2VpbCh0aGlzLnkpOwogICAgICB0aGlzLnogPSBNYXRoLmNlaWwodGhpcy56KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAicm91bmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJvdW5kKCkgewogICAgICB0aGlzLnggPSBNYXRoLnJvdW5kKHRoaXMueCk7CiAgICAgIHRoaXMueSA9IE1hdGgucm91bmQodGhpcy55KTsKICAgICAgdGhpcy56ID0gTWF0aC5yb3VuZCh0aGlzLnopOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyb3VuZFRvWmVybyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcm91bmRUb1plcm8oKSB7CiAgICAgIHRoaXMueCA9IHRoaXMueCA8IDAgPyBNYXRoLmNlaWwodGhpcy54KSA6IE1hdGguZmxvb3IodGhpcy54KTsKICAgICAgdGhpcy55ID0gdGhpcy55IDwgMCA/IE1hdGguY2VpbCh0aGlzLnkpIDogTWF0aC5mbG9vcih0aGlzLnkpOwogICAgICB0aGlzLnogPSB0aGlzLnogPCAwID8gTWF0aC5jZWlsKHRoaXMueikgOiBNYXRoLmZsb29yKHRoaXMueik7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm5lZ2F0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbmVnYXRlKCkgewogICAgICB0aGlzLnggPSAtdGhpcy54OwogICAgICB0aGlzLnkgPSAtdGhpcy55OwogICAgICB0aGlzLnogPSAtdGhpcy56OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkb3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRvdCh2KSB7CiAgICAgIHJldHVybiB0aGlzLnggKiB2LnggKyB0aGlzLnkgKiB2LnkgKyB0aGlzLnogKiB2Lno7CiAgICB9IC8vIFRPRE8gbGVuZ3RoU3F1YXJlZD8KCiAgfSwgewogICAga2V5OiAibGVuZ3RoU3EiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxlbmd0aFNxKCkgewogICAgICByZXR1cm4gdGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56OwogICAgfQogIH0sIHsKICAgIGtleTogImxlbmd0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbGVuZ3RoKCkgewogICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMueik7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFuaGF0dGFuTGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYW5oYXR0YW5MZW5ndGgoKSB7CiAgICAgIHJldHVybiBNYXRoLmFicyh0aGlzLngpICsgTWF0aC5hYnModGhpcy55KSArIE1hdGguYWJzKHRoaXMueik7CiAgICB9CiAgfSwgewogICAga2V5OiAibm9ybWFsaXplIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBub3JtYWxpemUoKSB7CiAgICAgIHJldHVybiB0aGlzLmRpdmlkZVNjYWxhcih0aGlzLmxlbmd0aCgpIHx8IDEpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldExlbmd0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0TGVuZ3RoKGxlbmd0aCkgewogICAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUoKS5tdWx0aXBseVNjYWxhcihsZW5ndGgpOwogICAgfQogIH0sIHsKICAgIGtleTogImxlcnAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxlcnAodiwgYWxwaGEpIHsKICAgICAgdGhpcy54ICs9ICh2LnggLSB0aGlzLngpICogYWxwaGE7CiAgICAgIHRoaXMueSArPSAodi55IC0gdGhpcy55KSAqIGFscGhhOwogICAgICB0aGlzLnogKz0gKHYueiAtIHRoaXMueikgKiBhbHBoYTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibGVycFZlY3RvcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxlcnBWZWN0b3JzKHYxLCB2MiwgYWxwaGEpIHsKICAgICAgcmV0dXJuIHRoaXMuc3ViVmVjdG9ycyh2MiwgdjEpLm11bHRpcGx5U2NhbGFyKGFscGhhKS5hZGQodjEpOwogICAgfQogIH0sIHsKICAgIGtleTogImNyb3NzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcm9zcyh2LCB3KSB7CiAgICAgIGlmICh3ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLlZlY3RvcjM6IC5jcm9zcygpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLmNyb3NzVmVjdG9ycyggYSwgYiApIGluc3RlYWQuJyk7CiAgICAgICAgcmV0dXJuIHRoaXMuY3Jvc3NWZWN0b3JzKHYsIHcpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5jcm9zc1ZlY3RvcnModGhpcywgdik7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3Jvc3NWZWN0b3JzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcm9zc1ZlY3RvcnMoYSwgYikgewogICAgICB2YXIgYXggPSBhLng7CiAgICAgIHZhciBheSA9IGEueTsKICAgICAgdmFyIGF6ID0gYS56OwogICAgICB2YXIgYnggPSBiLng7CiAgICAgIHZhciBieSA9IGIueTsKICAgICAgdmFyIGJ6ID0gYi56OwogICAgICB0aGlzLnggPSBheSAqIGJ6IC0gYXogKiBieTsKICAgICAgdGhpcy55ID0gYXogKiBieCAtIGF4ICogYno7CiAgICAgIHRoaXMueiA9IGF4ICogYnkgLSBheSAqIGJ4OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwcm9qZWN0T25WZWN0b3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByb2plY3RPblZlY3Rvcih2ZWN0b3IpIHsKICAgICAgdmFyIHNjYWxhciA9IHZlY3Rvci5kb3QodGhpcykgLyB2ZWN0b3IubGVuZ3RoU3EoKTsKICAgICAgcmV0dXJuIHRoaXMuY29weSh2ZWN0b3IpLm11bHRpcGx5U2NhbGFyKHNjYWxhcik7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJvamVjdE9uUGxhbmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByb2plY3RPblBsYW5lKHBsYW5lTm9ybWFsKSB7CiAgICAgIHZhciB2MSA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIHYxLmNvcHkodGhpcykucHJvamVjdE9uVmVjdG9yKHBsYW5lTm9ybWFsKTsKICAgICAgcmV0dXJuIHRoaXMuc3ViKHYxKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWZsZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWZsZWN0KG5vcm1hbCkgewogICAgICB2YXIgdjEgPSBuZXcgVmVjdG9yMygpOwogICAgICByZXR1cm4gdGhpcy5zdWIodjEuY29weShub3JtYWwpLm11bHRpcGx5U2NhbGFyKDIgKiB0aGlzLmRvdChub3JtYWwpKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYW5nbGVUbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYW5nbGVUbyh2KSB7CiAgICAgIHZhciB0aGV0YSA9IHRoaXMuZG90KHYpIC8gTWF0aC5zcXJ0KHRoaXMubGVuZ3RoU3EoKSAqIHYubGVuZ3RoU3EoKSk7IC8vIGNsYW1wLCB0byBoYW5kbGUgbnVtZXJpY2FsIHByb2JsZW1zCgogICAgICByZXR1cm4gTWF0aC5hY29zKF9NYXRoLmNsYW1wKHRoZXRhLCAtMSwgMSkpOwogICAgfQogIH0sIHsKICAgIGtleTogImRpc3RhbmNlVG8iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3RhbmNlVG8odikgewogICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMuZGlzdGFuY2VUb1NxdWFyZWQodikpOwogICAgfQogIH0sIHsKICAgIGtleTogImRpc3RhbmNlVG9TcXVhcmVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXN0YW5jZVRvU3F1YXJlZCh2KSB7CiAgICAgIHZhciBkeCA9IHRoaXMueCAtIHYueDsKICAgICAgdmFyIGR5ID0gdGhpcy55IC0gdi55OwogICAgICB2YXIgZHogPSB0aGlzLnogLSB2Lno7CiAgICAgIHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeSArIGR6ICogZHo7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFuaGF0dGFuRGlzdGFuY2VUbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFuaGF0dGFuRGlzdGFuY2VUbyh2KSB7CiAgICAgIHJldHVybiBNYXRoLmFicyh0aGlzLnggLSB2LngpICsgTWF0aC5hYnModGhpcy55IC0gdi55KSArIE1hdGguYWJzKHRoaXMueiAtIHYueik7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0RnJvbVNwaGVyaWNhbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbVNwaGVyaWNhbChzKSB7CiAgICAgIHJldHVybiB0aGlzLnNldEZyb21TcGhlcmljYWxDb29yZHMocy5yYWRpdXMsIHMucGhpLCBzLnRoZXRhKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGcm9tU3BoZXJpY2FsQ29vcmRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGcm9tU3BoZXJpY2FsQ29vcmRzKHJhZGl1cywgcGhpLCB0aGV0YSkgewogICAgICB2YXIgc2luUGhpUmFkaXVzID0gTWF0aC5zaW4ocGhpKSAqIHJhZGl1czsKICAgICAgdGhpcy54ID0gc2luUGhpUmFkaXVzICogTWF0aC5zaW4odGhldGEpOwogICAgICB0aGlzLnkgPSBNYXRoLmNvcyhwaGkpICogcmFkaXVzOwogICAgICB0aGlzLnogPSBzaW5QaGlSYWRpdXMgKiBNYXRoLmNvcyh0aGV0YSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21DeWxpbmRyaWNhbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbUN5bGluZHJpY2FsKGMpIHsKICAgICAgcmV0dXJuIHRoaXMuc2V0RnJvbUN5bGluZHJpY2FsQ29vcmRzKGMucmFkaXVzLCBjLnRoZXRhLCBjLnkpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21DeWxpbmRyaWNhbENvb3JkcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbUN5bGluZHJpY2FsQ29vcmRzKHJhZGl1cywgdGhldGEsIHkpIHsKICAgICAgdGhpcy54ID0gcmFkaXVzICogTWF0aC5zaW4odGhldGEpOwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSByYWRpdXMgKiBNYXRoLmNvcyh0aGV0YSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21NYXRyaXhQb3NpdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbU1hdHJpeFBvc2l0aW9uKG0pIHsKICAgICAgdmFyIGUgPSBtLmVsZW1lbnRzOwogICAgICB0aGlzLnggPSBlWzEyXTsKICAgICAgdGhpcy55ID0gZVsxM107CiAgICAgIHRoaXMueiA9IGVbMTRdOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGcm9tTWF0cml4U2NhbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZyb21NYXRyaXhTY2FsZShtKSB7CiAgICAgIHZhciBzeCA9IHRoaXMuc2V0RnJvbU1hdHJpeENvbHVtbihtLCAwKS5sZW5ndGgoKTsKICAgICAgdmFyIHN5ID0gdGhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKG0sIDEpLmxlbmd0aCgpOwogICAgICB2YXIgc3ogPSB0aGlzLnNldEZyb21NYXRyaXhDb2x1bW4obSwgMikubGVuZ3RoKCk7CiAgICAgIHRoaXMueCA9IHN4OwogICAgICB0aGlzLnkgPSBzeTsKICAgICAgdGhpcy56ID0gc3o7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21NYXRyaXhDb2x1bW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZyb21NYXRyaXhDb2x1bW4obSwgaW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMuZnJvbUFycmF5KG0uZWxlbWVudHMsIGluZGV4ICogNCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXF1YWxzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlcXVhbHModikgewogICAgICByZXR1cm4gdi54ID09PSB0aGlzLnggJiYgdi55ID09PSB0aGlzLnkgJiYgdi56ID09PSB0aGlzLno7CiAgICB9CiAgfSwgewogICAga2V5OiAiZnJvbUFycmF5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmcm9tQXJyYXkoYXJyYXksIG9mZnNldCkgewogICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7CiAgICAgIHRoaXMueCA9IGFycmF5W29mZnNldF07CiAgICAgIHRoaXMueSA9IGFycmF5W29mZnNldCArIDFdOwogICAgICB0aGlzLnogPSBhcnJheVtvZmZzZXQgKyAyXTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAidG9BcnJheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9BcnJheShhcnJheSwgb2Zmc2V0KSB7CiAgICAgIGlmIChhcnJheSA9PT0gdW5kZWZpbmVkKSBhcnJheSA9IFtdOwogICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7CiAgICAgIGFycmF5W29mZnNldF0gPSB0aGlzLng7CiAgICAgIGFycmF5W29mZnNldCArIDFdID0gdGhpcy55OwogICAgICBhcnJheVtvZmZzZXQgKyAyXSA9IHRoaXMuejsKICAgICAgcmV0dXJuIGFycmF5OwogICAgfQogIH0sIHsKICAgIGtleTogImZyb21CdWZmZXJBdHRyaWJ1dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZyb21CdWZmZXJBdHRyaWJ1dGUoYXR0cmlidXRlLCBpbmRleCwgb2Zmc2V0KSB7CiAgICAgIGlmIChvZmZzZXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnNvbGUud2FybignVEhSRUUuVmVjdG9yMzogb2Zmc2V0IGhhcyBiZWVuIHJlbW92ZWQgZnJvbSAuZnJvbUJ1ZmZlckF0dHJpYnV0ZSgpLicpOwogICAgICB9CgogICAgICB0aGlzLnggPSBhdHRyaWJ1dGUuZ2V0WChpbmRleCk7CiAgICAgIHRoaXMueSA9IGF0dHJpYnV0ZS5nZXRZKGluZGV4KTsKICAgICAgdGhpcy56ID0gYXR0cmlidXRlLmdldFooaW5kZXgpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9XSk7CgogIHJldHVybiBWZWN0b3IzOwp9KCk7CgovKioKICogQGF1dGhvciBiaG91c3RvbiAvIGh0dHA6Ly9jbGFyYS5pbwogKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tLwogKi8KCnZhciBTcGhlcmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFNwaGVyZShjZW50ZXIsIHJhZGl1cykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwaGVyZSk7CgogICAgdGhpcy5jZW50ZXIgPSBjZW50ZXIgIT09IHVuZGVmaW5lZCA/IGNlbnRlciA6IG5ldyBWZWN0b3IzKCk7CiAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cyAhPT0gdW5kZWZpbmVkID8gcmFkaXVzIDogMDsKICB9CgogIF9jcmVhdGVDbGFzcyhTcGhlcmUsIFt7CiAgICBrZXk6ICJzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldChjZW50ZXIsIHJhZGl1cykgewogICAgICB0aGlzLmNlbnRlci5jb3B5KGNlbnRlcik7CiAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGcm9tUG9pbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGcm9tUG9pbnRzKHBvaW50cywgb3B0aW9uYWxDZW50ZXIpIHsKICAgICAgdmFyIGJveCA9IG5ldyBCb3gzKCk7CiAgICAgIHZhciBjZW50ZXIgPSB0aGlzLmNlbnRlcjsKCiAgICAgIGlmIChvcHRpb25hbENlbnRlciAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY2VudGVyLmNvcHkob3B0aW9uYWxDZW50ZXIpOwogICAgICB9IGVsc2UgewogICAgICAgIGJveC5zZXRGcm9tUG9pbnRzKHBvaW50cykuZ2V0Q2VudGVyKGNlbnRlcik7CiAgICAgIH0KCiAgICAgIHZhciBtYXhSYWRpdXNTcSA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWwgPSBwb2ludHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgIG1heFJhZGl1c1NxID0gTWF0aC5tYXgobWF4UmFkaXVzU3EsIGNlbnRlci5kaXN0YW5jZVRvU3F1YXJlZChwb2ludHNbaV0pKTsKICAgICAgfQoKICAgICAgdGhpcy5yYWRpdXMgPSBNYXRoLnNxcnQobWF4UmFkaXVzU3EpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpLmNvcHkodGhpcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29weSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29weShzcGhlcmUpIHsKICAgICAgdGhpcy5jZW50ZXIuY29weShzcGhlcmUuY2VudGVyKTsKICAgICAgdGhpcy5yYWRpdXMgPSBzcGhlcmUucmFkaXVzOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJlbXB0eSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZW1wdHkoKSB7CiAgICAgIHJldHVybiB0aGlzLnJhZGl1cyA8PSAwOwogICAgfQogIH0sIHsKICAgIGtleTogImNvbnRhaW5zUG9pbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnRhaW5zUG9pbnQocG9pbnQpIHsKICAgICAgcmV0dXJuIHBvaW50LmRpc3RhbmNlVG9TcXVhcmVkKHRoaXMuY2VudGVyKSA8PSB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzOwogICAgfQogIH0sIHsKICAgIGtleTogImRpc3RhbmNlVG9Qb2ludCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzdGFuY2VUb1BvaW50KHBvaW50KSB7CiAgICAgIHJldHVybiBwb2ludC5kaXN0YW5jZVRvKHRoaXMuY2VudGVyKSAtIHRoaXMucmFkaXVzOwogICAgfQogIH0sIHsKICAgIGtleTogImludGVyc2VjdHNTcGhlcmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGludGVyc2VjdHNTcGhlcmUoc3BoZXJlKSB7CiAgICAgIHZhciByYWRpdXNTdW0gPSB0aGlzLnJhZGl1cyArIHNwaGVyZS5yYWRpdXM7CiAgICAgIHJldHVybiBzcGhlcmUuY2VudGVyLmRpc3RhbmNlVG9TcXVhcmVkKHRoaXMuY2VudGVyKSA8PSByYWRpdXNTdW0gKiByYWRpdXNTdW07CiAgICB9CiAgfSwgewogICAga2V5OiAiaW50ZXJzZWN0c0JveCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW50ZXJzZWN0c0JveChib3gpIHsKICAgICAgcmV0dXJuIGJveC5pbnRlcnNlY3RzU3BoZXJlKHRoaXMpOwogICAgfQogIH0sIHsKICAgIGtleTogImludGVyc2VjdHNQbGFuZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW50ZXJzZWN0c1BsYW5lKHBsYW5lKSB7CiAgICAgIHJldHVybiBNYXRoLmFicyhwbGFuZS5kaXN0YW5jZVRvUG9pbnQodGhpcy5jZW50ZXIpKSA8PSB0aGlzLnJhZGl1czsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbGFtcFBvaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGFtcFBvaW50KHBvaW50LCB0YXJnZXQpIHsKICAgICAgdmFyIGRlbHRhTGVuZ3RoU3EgPSB0aGlzLmNlbnRlci5kaXN0YW5jZVRvU3F1YXJlZChwb2ludCk7CgogICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLlNwaGVyZTogLmNsYW1wUG9pbnQoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkJyk7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlY3RvcjMoKTsKICAgICAgfQoKICAgICAgdGFyZ2V0LmNvcHkocG9pbnQpOwoKICAgICAgaWYgKGRlbHRhTGVuZ3RoU3EgPiB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzKSB7CiAgICAgICAgdGFyZ2V0LnN1Yih0aGlzLmNlbnRlcikubm9ybWFsaXplKCk7CiAgICAgICAgdGFyZ2V0Lm11bHRpcGx5U2NhbGFyKHRoaXMucmFkaXVzKS5hZGQodGhpcy5jZW50ZXIpOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogIH0sIHsKICAgIGtleTogImdldEJvdW5kaW5nQm94IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCb3VuZGluZ0JveCh0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdUSFJFRS5TcGhlcmU6IC5nZXRCb3VuZGluZ0JveCgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWQnKTsKICAgICAgICB0YXJnZXQgPSBuZXcgQm94MygpOwogICAgICB9CgogICAgICB0YXJnZXQuc2V0KHRoaXMuY2VudGVyLCB0aGlzLmNlbnRlcik7CiAgICAgIHRhcmdldC5leHBhbmRCeVNjYWxhcih0aGlzLnJhZGl1cyk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiYXBwbHlNYXRyaXg0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseU1hdHJpeDQobWF0cml4KSB7CiAgICAgIHRoaXMuY2VudGVyLmFwcGx5TWF0cml4NChtYXRyaXgpOwogICAgICB0aGlzLnJhZGl1cyA9IHRoaXMucmFkaXVzICogbWF0cml4LmdldE1heFNjYWxlT25BeGlzKCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInRyYW5zbGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdHJhbnNsYXRlKG9mZnNldCkgewogICAgICB0aGlzLmNlbnRlci5hZGQob2Zmc2V0KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXF1YWxzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlcXVhbHMoc3BoZXJlKSB7CiAgICAgIHJldHVybiBzcGhlcmUuY2VudGVyLmVxdWFscyh0aGlzLmNlbnRlcikgJiYgc3BoZXJlLnJhZGl1cyA9PT0gdGhpcy5yYWRpdXM7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU3BoZXJlOwp9KCk7CgovKioKICogQGF1dGhvciBiaG91c3RvbiAvIGh0dHA6Ly9jbGFyYS5pbwogKiBAYXV0aG9yIFdlc3RMYW5nbGV5IC8gaHR0cDovL2dpdGh1Yi5jb20vV2VzdExhbmdsZXkKICovCgp2YXIgQm94MyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQm94MyhtaW4sIG1heCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJveDMpOwoKICAgIHRoaXMubWluID0gbWluICE9PSB1bmRlZmluZWQgPyBtaW4gOiBuZXcgVmVjdG9yMygrSW5maW5pdHksICtJbmZpbml0eSwgK0luZmluaXR5KTsKICAgIHRoaXMubWF4ID0gbWF4ICE9PSB1bmRlZmluZWQgPyBtYXggOiBuZXcgVmVjdG9yMygtSW5maW5pdHksIC1JbmZpbml0eSwgLUluZmluaXR5KTsKICAgIHRoaXMuaXNCb3gzID0gdHJ1ZTsKICB9CgogIF9jcmVhdGVDbGFzcyhCb3gzLCBbewogICAga2V5OiAic2V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXQobWluLCBtYXgpIHsKICAgICAgdGhpcy5taW4uY29weShtaW4pOwogICAgICB0aGlzLm1heC5jb3B5KG1heCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21BcnJheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbUFycmF5KGFycmF5KSB7CiAgICAgIHZhciBtaW5YID0gK0luZmluaXR5OwogICAgICB2YXIgbWluWSA9ICtJbmZpbml0eTsKICAgICAgdmFyIG1pblogPSArSW5maW5pdHk7CiAgICAgIHZhciBtYXhYID0gLUluZmluaXR5OwogICAgICB2YXIgbWF4WSA9IC1JbmZpbml0eTsKICAgICAgdmFyIG1heFogPSAtSW5maW5pdHk7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkgKz0gMykgewogICAgICAgIHZhciB4ID0gYXJyYXlbaV07CiAgICAgICAgdmFyIHkgPSBhcnJheVtpICsgMV07CiAgICAgICAgdmFyIHogPSBhcnJheVtpICsgMl07CiAgICAgICAgaWYgKHggPCBtaW5YKSBtaW5YID0geDsKICAgICAgICBpZiAoeSA8IG1pblkpIG1pblkgPSB5OwogICAgICAgIGlmICh6IDwgbWluWikgbWluWiA9IHo7CiAgICAgICAgaWYgKHggPiBtYXhYKSBtYXhYID0geDsKICAgICAgICBpZiAoeSA+IG1heFkpIG1heFkgPSB5OwogICAgICAgIGlmICh6ID4gbWF4WikgbWF4WiA9IHo7CiAgICAgIH0KCiAgICAgIHRoaXMubWluLnNldChtaW5YLCBtaW5ZLCBtaW5aKTsKICAgICAgdGhpcy5tYXguc2V0KG1heFgsIG1heFksIG1heFopOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGcm9tQnVmZmVyQXR0cmlidXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGcm9tQnVmZmVyQXR0cmlidXRlKGF0dHJpYnV0ZSkgewogICAgICB2YXIgbWluWCA9ICtJbmZpbml0eTsKICAgICAgdmFyIG1pblkgPSArSW5maW5pdHk7CiAgICAgIHZhciBtaW5aID0gK0luZmluaXR5OwogICAgICB2YXIgbWF4WCA9IC1JbmZpbml0eTsKICAgICAgdmFyIG1heFkgPSAtSW5maW5pdHk7CiAgICAgIHZhciBtYXhaID0gLUluZmluaXR5OwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBhdHRyaWJ1dGUuY291bnQ7IGkgPCBsOyBpKyspIHsKICAgICAgICB2YXIgeCA9IGF0dHJpYnV0ZS5nZXRYKGkpOwogICAgICAgIHZhciB5ID0gYXR0cmlidXRlLmdldFkoaSk7CiAgICAgICAgdmFyIHogPSBhdHRyaWJ1dGUuZ2V0WihpKTsKICAgICAgICBpZiAoeCA8IG1pblgpIG1pblggPSB4OwogICAgICAgIGlmICh5IDwgbWluWSkgbWluWSA9IHk7CiAgICAgICAgaWYgKHogPCBtaW5aKSBtaW5aID0gejsKICAgICAgICBpZiAoeCA+IG1heFgpIG1heFggPSB4OwogICAgICAgIGlmICh5ID4gbWF4WSkgbWF4WSA9IHk7CiAgICAgICAgaWYgKHogPiBtYXhaKSBtYXhaID0gejsKICAgICAgfQoKICAgICAgdGhpcy5taW4uc2V0KG1pblgsIG1pblksIG1pblopOwogICAgICB0aGlzLm1heC5zZXQobWF4WCwgbWF4WSwgbWF4Wik7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21Qb2ludHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZyb21Qb2ludHMocG9pbnRzKSB7CiAgICAgIHRoaXMubWFrZUVtcHR5KCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWwgPSBwb2ludHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgIHRoaXMuZXhwYW5kQnlQb2ludChwb2ludHNbaV0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGcm9tQ2VudGVyQW5kU2l6ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbUNlbnRlckFuZFNpemUoY2VudGVyLCBzaXplKSB7CiAgICAgIHZhciBoYWxmU2l6ZSA9IHNpemUuY2xvbmUoKS5tdWx0aXBseVNjYWxhcigwLjUpOwogICAgICB0aGlzLm1pbi5jb3B5KGNlbnRlcikuc3ViKGhhbGZTaXplKTsKICAgICAgdGhpcy5tYXguY29weShjZW50ZXIpLmFkZChoYWxmU2l6ZSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZyb21PYmplY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZyb21PYmplY3Qob2JqZWN0KSB7CiAgICAgIHRoaXMubWFrZUVtcHR5KCk7CiAgICAgIHJldHVybiB0aGlzLmV4cGFuZEJ5T2JqZWN0KG9iamVjdCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xvbmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkgewogICAgICByZXR1cm4gbmV3IEJveDMoKS5jb3B5KHRoaXMpOwogICAgfQogIH0sIHsKICAgIGtleTogImNvcHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvcHkoYm94KSB7CiAgICAgIHRoaXMubWluLmNvcHkoYm94Lm1pbik7CiAgICAgIHRoaXMubWF4LmNvcHkoYm94Lm1heCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogIm1ha2VFbXB0eSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZUVtcHR5KCkgewogICAgICB0aGlzLm1pbi54ID0gdGhpcy5taW4ueSA9IHRoaXMubWluLnogPSArSW5maW5pdHk7CiAgICAgIHRoaXMubWF4LnggPSB0aGlzLm1heC55ID0gdGhpcy5tYXgueiA9IC1JbmZpbml0eTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNFbXB0eSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNFbXB0eSgpIHsKICAgICAgLy8gdGhpcyBpcyBhIG1vcmUgcm9idXN0IGNoZWNrIGZvciBlbXB0eSB0aGFuICggdm9sdW1lIDw9IDAgKSBiZWNhdXNlIHZvbHVtZSBjYW4gZ2V0IHBvc2l0aXZlIHdpdGggdHdvIG5lZ2F0aXZlIGF4ZXMKICAgICAgcmV0dXJuIHRoaXMubWF4LnggPCB0aGlzLm1pbi54IHx8IHRoaXMubWF4LnkgPCB0aGlzLm1pbi55IHx8IHRoaXMubWF4LnogPCB0aGlzLm1pbi56OwogICAgfQogIH0sIHsKICAgIGtleTogImdldENlbnRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VudGVyKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJveDM6IC5nZXRDZW50ZXIoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkJyk7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlY3RvcjMoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuaXNFbXB0eSgpID8gdGFyZ2V0LnNldCgwLCAwLCAwKSA6IHRhcmdldC5hZGRWZWN0b3JzKHRoaXMubWluLCB0aGlzLm1heCkubXVsdGlwbHlTY2FsYXIoMC41KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTaXplIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTaXplKCkgewogICAgICB2YXIgdGFyZ2V0ID0gbmV3IFZlY3RvcjMoKTsKICAgICAgcmV0dXJuIHRoaXMuaXNFbXB0eSgpID8gdGFyZ2V0LnNldCgwLCAwLCAwKSA6IHRhcmdldC5zdWJWZWN0b3JzKHRoaXMubWF4LCB0aGlzLm1pbik7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXhwYW5kQnlQb2ludCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZXhwYW5kQnlQb2ludChwb2ludCkgewogICAgICB0aGlzLm1pbi5taW4ocG9pbnQpOwogICAgICB0aGlzLm1heC5tYXgocG9pbnQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJleHBhbmRCeVZlY3RvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZXhwYW5kQnlWZWN0b3IodmVjdG9yKSB7CiAgICAgIHRoaXMubWluLnN1Yih2ZWN0b3IpOwogICAgICB0aGlzLm1heC5hZGQodmVjdG9yKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXhwYW5kQnlTY2FsYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV4cGFuZEJ5U2NhbGFyKHNjYWxhcikgewogICAgICB0aGlzLm1pbi5hZGRTY2FsYXIoLXNjYWxhcik7CiAgICAgIHRoaXMubWF4LmFkZFNjYWxhcihzY2FsYXIpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJleHBhbmRCeU9iamVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZXhwYW5kQnlPYmplY3Qob2JqZWN0KSB7CiAgICAgIHZhciB2MSA9IG5ldyBWZWN0b3IzKCk7CgogICAgICBmdW5jdGlvbiB0cmF2ZXJzZShub2RlKSB7CiAgICAgICAgdmFyIGdlb21ldHJ5ID0gbm9kZS5nZW9tZXRyeTsKCiAgICAgICAgaWYgKGdlb21ldHJ5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmIChnZW9tZXRyeS5pc0dlb21ldHJ5KSB7CiAgICAgICAgICAgIHZhciB2ZXJ0aWNlcyA9IGdlb21ldHJ5LnZlcnRpY2VzOwoKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSB2ZXJ0aWNlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgICAgICB2MS5jb3B5KHZlcnRpY2VzW2ldKTsKICAgICAgICAgICAgICB2MS5hcHBseU1hdHJpeDQobm9kZS5tYXRyaXhXb3JsZCk7CiAgICAgICAgICAgICAgdGhpcy5leHBhbmRCeVBvaW50KHYxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChnZW9tZXRyeS5pc0J1ZmZlckdlb21ldHJ5KSB7CiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uOwoKICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfbCA9IGF0dHJpYnV0ZS5jb3VudDsgX2kgPCBfbDsgX2krKykgewogICAgICAgICAgICAgICAgdjEuZnJvbUJ1ZmZlckF0dHJpYnV0ZShhdHRyaWJ1dGUsIF9pKS5hcHBseU1hdHJpeDQobm9kZS5tYXRyaXhXb3JsZCk7CiAgICAgICAgICAgICAgICB0aGlzLmV4cGFuZEJ5UG9pbnQodjEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgb2JqZWN0LnVwZGF0ZU1hdHJpeFdvcmxkKHRydWUpOwogICAgICBvYmplY3QudHJhdmVyc2UodHJhdmVyc2UpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb250YWluc1BvaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb250YWluc1BvaW50KHBvaW50KSB7CiAgICAgIHJldHVybiAhKHBvaW50LnggPCB0aGlzLm1pbi54IHx8IHBvaW50LnggPiB0aGlzLm1heC54IHx8IHBvaW50LnkgPCB0aGlzLm1pbi55IHx8IHBvaW50LnkgPiB0aGlzLm1heC55IHx8IHBvaW50LnogPCB0aGlzLm1pbi56IHx8IHBvaW50LnogPiB0aGlzLm1heC56KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb250YWluc0JveCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29udGFpbnNCb3goYm94KSB7CiAgICAgIHJldHVybiB0aGlzLm1pbi54IDw9IGJveC5taW4ueCAmJiBib3gubWF4LnggPD0gdGhpcy5tYXgueCAmJiB0aGlzLm1pbi55IDw9IGJveC5taW4ueSAmJiBib3gubWF4LnkgPD0gdGhpcy5tYXgueSAmJiB0aGlzLm1pbi56IDw9IGJveC5taW4ueiAmJiBib3gubWF4LnogPD0gdGhpcy5tYXguejsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQYXJhbWV0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBhcmFtZXRlcihwb2ludCwgdGFyZ2V0KSB7CiAgICAgIC8vIFRoaXMgY2FuIHBvdGVudGlhbGx5IGhhdmUgYSBkaXZpZGUgYnkgemVybyBpZiB0aGUgYm94CiAgICAgIC8vIGhhcyBhIHNpemUgZGltZW5zaW9uIG9mIDAuCiAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnNvbGUud2FybignVEhSRUUuQm94MzogLmdldFBhcmFtZXRlcigpIHRhcmdldCBpcyBub3cgcmVxdWlyZWQnKTsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjdG9yMygpOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0LnNldCgocG9pbnQueCAtIHRoaXMubWluLngpIC8gKHRoaXMubWF4LnggLSB0aGlzLm1pbi54KSwgKHBvaW50LnkgLSB0aGlzLm1pbi55KSAvICh0aGlzLm1heC55IC0gdGhpcy5taW4ueSksIChwb2ludC56IC0gdGhpcy5taW4ueikgLyAodGhpcy5tYXgueiAtIHRoaXMubWluLnopKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbnRlcnNlY3RzQm94IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnRlcnNlY3RzQm94KGJveCkgewogICAgICAvLyB1c2luZyA2IHNwbGl0dGluZyBwbGFuZXMgdG8gcnVsZSBvdXQgaW50ZXJzZWN0aW9ucy4KICAgICAgcmV0dXJuICEoYm94Lm1heC54IDwgdGhpcy5taW4ueCB8fCBib3gubWluLnggPiB0aGlzLm1heC54IHx8IGJveC5tYXgueSA8IHRoaXMubWluLnkgfHwgYm94Lm1pbi55ID4gdGhpcy5tYXgueSB8fCBib3gubWF4LnogPCB0aGlzLm1pbi56IHx8IGJveC5taW4ueiA+IHRoaXMubWF4LnopOwogICAgfQogIH0sIHsKICAgIGtleTogImNsYW1wUG9pbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsYW1wUG9pbnQocG9pbnQsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJveDM6IC5jbGFtcFBvaW50KCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZCcpOwogICAgICAgIHRhcmdldCA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQuY29weShwb2ludCkuY2xhbXAodGhpcy5taW4sIHRoaXMubWF4KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXN0YW5jZVRvUG9pbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3RhbmNlVG9Qb2ludChwb2ludCkgewogICAgICB2YXIgY2xhbXBlZFBvaW50ID0gcG9pbnQuY2xvbmUoKS5jbGFtcCh0aGlzLm1pbiwgdGhpcy5tYXgpOwogICAgICByZXR1cm4gY2xhbXBlZFBvaW50LnN1Yihwb2ludCkubGVuZ3RoKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Qm91bmRpbmdTcGhlcmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJvdW5kaW5nU3BoZXJlKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJveDM6IC5nZXRCb3VuZGluZ1NwaGVyZSgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWQnKTsKICAgICAgICB0YXJnZXQgPSBuZXcgU3BoZXJlKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuZ2V0Q2VudGVyKHRhcmdldC5jZW50ZXIpOwogICAgICB0YXJnZXQucmFkaXVzID0gdGhpcy5nZXRTaXplKCkubGVuZ3RoKCkgKiAwLjU7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW50ZXJzZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnRlcnNlY3QoYm94KSB7CiAgICAgIHRoaXMubWluLm1heChib3gubWluKTsKICAgICAgdGhpcy5tYXgubWluKGJveC5tYXgpOyAvLyBlbnN1cmUgdGhhdCBpZiB0aGVyZSBpcyBubyBvdmVybGFwLCB0aGUgcmVzdWx0IGlzIGZ1bGx5IGVtcHR5LCBub3Qgc2xpZ2h0bHkgZW1wdHkgd2l0aCBub24taW5mLytpbmYgdmFsdWVzIHRoYXQgd2lsbCBjYXVzZSBzdWJzZXF1ZW5jZSBpbnRlcnNlY3RzIHRvIGVycm9uZW91c2x5IHJldHVybiB2YWxpZCB2YWx1ZXMuCgogICAgICBpZiAodGhpcy5pc0VtcHR5KCkpIHRoaXMubWFrZUVtcHR5KCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInVuaW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1bmlvbihib3gpIHsKICAgICAgdGhpcy5taW4ubWluKGJveC5taW4pOwogICAgICB0aGlzLm1heC5tYXgoYm94Lm1heCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImFwcGx5TWF0cml4NCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlNYXRyaXg0KG1hdHJpeCkgewogICAgICAvLyB0cmFuc2Zvcm0gb2YgZW1wdHkgYm94IGlzIGFuIGVtcHR5IGJveC4KICAgICAgaWYgKHRoaXMuaXNFbXB0eSgpKSByZXR1cm4gdGhpczsKICAgICAgdmFyIHBvaW50cyA9IFtuZXcgVmVjdG9yMygpLCBuZXcgVmVjdG9yMygpLCBuZXcgVmVjdG9yMygpLCBuZXcgVmVjdG9yMygpLCBuZXcgVmVjdG9yMygpLCBuZXcgVmVjdG9yMygpLCBuZXcgVmVjdG9yMygpLCBuZXcgVmVjdG9yMygpXTsgLy8gTk9URTogSSBhbSB1c2luZyBhIGJpbmFyeSBwYXR0ZXJuIHRvIHNwZWNpZnkgYWxsIDJeMyBjb21iaW5hdGlvbnMgYmVsb3cKCiAgICAgIHBvaW50c1swXS5zZXQodGhpcy5taW4ueCwgdGhpcy5taW4ueSwgdGhpcy5taW4ueikuYXBwbHlNYXRyaXg0KG1hdHJpeCk7IC8vIDAwMAoKICAgICAgcG9pbnRzWzFdLnNldCh0aGlzLm1pbi54LCB0aGlzLm1pbi55LCB0aGlzLm1heC56KS5hcHBseU1hdHJpeDQobWF0cml4KTsgLy8gMDAxCgogICAgICBwb2ludHNbMl0uc2V0KHRoaXMubWluLngsIHRoaXMubWF4LnksIHRoaXMubWluLnopLmFwcGx5TWF0cml4NChtYXRyaXgpOyAvLyAwMTAKCiAgICAgIHBvaW50c1szXS5zZXQodGhpcy5taW4ueCwgdGhpcy5tYXgueSwgdGhpcy5tYXgueikuYXBwbHlNYXRyaXg0KG1hdHJpeCk7IC8vIDAxMQoKICAgICAgcG9pbnRzWzRdLnNldCh0aGlzLm1heC54LCB0aGlzLm1pbi55LCB0aGlzLm1pbi56KS5hcHBseU1hdHJpeDQobWF0cml4KTsgLy8gMTAwCgogICAgICBwb2ludHNbNV0uc2V0KHRoaXMubWF4LngsIHRoaXMubWluLnksIHRoaXMubWF4LnopLmFwcGx5TWF0cml4NChtYXRyaXgpOyAvLyAxMDEKCiAgICAgIHBvaW50c1s2XS5zZXQodGhpcy5tYXgueCwgdGhpcy5tYXgueSwgdGhpcy5taW4ueikuYXBwbHlNYXRyaXg0KG1hdHJpeCk7IC8vIDExMAoKICAgICAgcG9pbnRzWzddLnNldCh0aGlzLm1heC54LCB0aGlzLm1heC55LCB0aGlzLm1heC56KS5hcHBseU1hdHJpeDQobWF0cml4KTsgLy8gMTExCgogICAgICB0aGlzLnNldEZyb21Qb2ludHMocG9pbnRzKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAidHJhbnNsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0cmFuc2xhdGUob2Zmc2V0KSB7CiAgICAgIHRoaXMubWluLmFkZChvZmZzZXQpOwogICAgICB0aGlzLm1heC5hZGQob2Zmc2V0KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXF1YWxzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlcXVhbHMoYm94KSB7CiAgICAgIHJldHVybiBib3gubWluLmVxdWFscyh0aGlzLm1pbikgJiYgYm94Lm1heC5lcXVhbHModGhpcy5tYXgpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEJveDM7Cn0oKTsKCi8qKgogKiBodHRwczovL2dpdGh1Yi5jb20vbXJkb29iL2V2ZW50ZGlzcGF0Y2hlci5qcy8KICovCmZ1bmN0aW9uIEV2ZW50RGlzcGF0Y2hlcigpIHt9CgpPYmplY3QuYXNzaWduKEV2ZW50RGlzcGF0Y2hlci5wcm90b3R5cGUsIHsKICBhZGRFdmVudExpc3RlbmVyOiBmdW5jdGlvbiBhZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7CiAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHRoaXMuX2xpc3RlbmVycyA9IHt9OwogICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICBpZiAobGlzdGVuZXJzW3R5cGVdID09PSB1bmRlZmluZWQpIHsKICAgICAgbGlzdGVuZXJzW3R5cGVdID0gW107CiAgICB9CgogICAgaWYgKGxpc3RlbmVyc1t0eXBlXS5pbmRleE9mKGxpc3RlbmVyKSA9PT0gLTEpIHsKICAgICAgbGlzdGVuZXJzW3R5cGVdLnB1c2gobGlzdGVuZXIpOwogICAgfQogIH0sCiAgaGFzRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24gaGFzRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcikgewogICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZmFsc2U7CiAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJzOwogICAgcmV0dXJuIGxpc3RlbmVyc1t0eXBlXSAhPT0gdW5kZWZpbmVkICYmIGxpc3RlbmVyc1t0eXBlXS5pbmRleE9mKGxpc3RlbmVyKSAhPT0gLTE7CiAgfSwKICByZW1vdmVFdmVudExpc3RlbmVyOiBmdW5jdGlvbiByZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyKSB7CiAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHJldHVybjsKICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7CiAgICB2YXIgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1t0eXBlXTsKCiAgICBpZiAobGlzdGVuZXJBcnJheSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhciBpbmRleCA9IGxpc3RlbmVyQXJyYXkuaW5kZXhPZihsaXN0ZW5lcik7CgogICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgbGlzdGVuZXJBcnJheS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CiAgICB9CiAgfSwKICBkaXNwYXRjaEV2ZW50OiBmdW5jdGlvbiBkaXNwYXRjaEV2ZW50KGV2ZW50KSB7CiAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHJldHVybjsKICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7CiAgICB2YXIgbGlzdGVuZXJBcnJheSA9IGxpc3RlbmVyc1tldmVudC50eXBlXTsKCiAgICBpZiAobGlzdGVuZXJBcnJheSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGV2ZW50LnRhcmdldCA9IHRoaXM7CiAgICAgIHZhciBhcnJheSA9IGxpc3RlbmVyQXJyYXkuc2xpY2UoMCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGFycmF5W2ldLmNhbGwodGhpcywgZXZlbnQpOwogICAgICB9CiAgICB9CiAgfQp9KTsKCi8qKgogKiBAYXV0aG9yIHN1cGVyZWdnYmVydCAvIGh0dHA6Ly93d3cucGF1bGJydW50LmNvLnVrLwogKiBAYXV0aG9yIHBoaWxvZ2IgLyBodHRwOi8vYmxvZy50aGVqaXQub3JnLwogKiBAYXV0aG9yIG1pa2FlbCBlbXRpbmdlciAvIGh0dHA6Ly9nb21vLnNlLwogKiBAYXV0aG9yIGVncmFldGhlciAvIGh0dHA6Ly9lZ3JhZXRoZXIuY29tLwogKiBAYXV0aG9yIFdlc3RMYW5nbGV5IC8gaHR0cDovL2dpdGh1Yi5jb20vV2VzdExhbmdsZXkKICovCmZ1bmN0aW9uIFZlY3RvcjQoeCwgeSwgeiwgdykgewogIHRoaXMueCA9IHggfHwgMDsKICB0aGlzLnkgPSB5IHx8IDA7CiAgdGhpcy56ID0geiB8fCAwOwogIHRoaXMudyA9IHcgIT09IHVuZGVmaW5lZCA/IHcgOiAxOwp9CgpPYmplY3QuYXNzaWduKFZlY3RvcjQucHJvdG90eXBlLCB7CiAgaXNWZWN0b3I0OiB0cnVlLAogIHNldDogZnVuY3Rpb24gc2V0KHgsIHksIHosIHcpIHsKICAgIHRoaXMueCA9IHg7CiAgICB0aGlzLnkgPSB5OwogICAgdGhpcy56ID0gejsKICAgIHRoaXMudyA9IHc7CiAgICByZXR1cm4gdGhpczsKICB9LAogIHNldFNjYWxhcjogZnVuY3Rpb24gc2V0U2NhbGFyKHNjYWxhcikgewogICAgdGhpcy54ID0gc2NhbGFyOwogICAgdGhpcy55ID0gc2NhbGFyOwogICAgdGhpcy56ID0gc2NhbGFyOwogICAgdGhpcy53ID0gc2NhbGFyOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBzZXRYOiBmdW5jdGlvbiBzZXRYKHgpIHsKICAgIHRoaXMueCA9IHg7CiAgICByZXR1cm4gdGhpczsKICB9LAogIHNldFk6IGZ1bmN0aW9uIHNldFkoeSkgewogICAgdGhpcy55ID0geTsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgc2V0WjogZnVuY3Rpb24gc2V0Wih6KSB7CiAgICB0aGlzLnogPSB6OwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBzZXRXOiBmdW5jdGlvbiBzZXRXKHcpIHsKICAgIHRoaXMudyA9IHc7CiAgICByZXR1cm4gdGhpczsKICB9LAogIHNldENvbXBvbmVudDogZnVuY3Rpb24gc2V0Q29tcG9uZW50KGluZGV4LCB2YWx1ZSkgewogICAgc3dpdGNoIChpbmRleCkgewogICAgICBjYXNlIDA6CiAgICAgICAgdGhpcy54ID0gdmFsdWU7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDE6CiAgICAgICAgdGhpcy55ID0gdmFsdWU7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDI6CiAgICAgICAgdGhpcy56ID0gdmFsdWU7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDM6CiAgICAgICAgdGhpcy53ID0gdmFsdWU7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBFcnJvcignaW5kZXggaXMgb3V0IG9mIHJhbmdlOiAnICsgaW5kZXgpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCiAgZ2V0Q29tcG9uZW50OiBmdW5jdGlvbiBnZXRDb21wb25lbnQoaW5kZXgpIHsKICAgIHN3aXRjaCAoaW5kZXgpIHsKICAgICAgY2FzZSAwOgogICAgICAgIHJldHVybiB0aGlzLng7CgogICAgICBjYXNlIDE6CiAgICAgICAgcmV0dXJuIHRoaXMueTsKCiAgICAgIGNhc2UgMjoKICAgICAgICByZXR1cm4gdGhpcy56OwoKICAgICAgY2FzZSAzOgogICAgICAgIHJldHVybiB0aGlzLnc7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBFcnJvcignaW5kZXggaXMgb3V0IG9mIHJhbmdlOiAnICsgaW5kZXgpOwogICAgfQogIH0sCiAgY2xvbmU6IGZ1bmN0aW9uIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMudyk7CiAgfSwKICBjb3B5OiBmdW5jdGlvbiBjb3B5KHYpIHsKICAgIHRoaXMueCA9IHYueDsKICAgIHRoaXMueSA9IHYueTsKICAgIHRoaXMueiA9IHYuejsKICAgIHRoaXMudyA9IHYudyAhPT0gdW5kZWZpbmVkID8gdi53IDogMTsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgYWRkOiBmdW5jdGlvbiBhZGQodiwgdykgewogICAgaWYgKHcgIT09IHVuZGVmaW5lZCkgewogICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLlZlY3RvcjQ6IC5hZGQoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5hZGRWZWN0b3JzKCBhLCBiICkgaW5zdGVhZC4nKTsKICAgICAgcmV0dXJuIHRoaXMuYWRkVmVjdG9ycyh2LCB3KTsKICAgIH0KCiAgICB0aGlzLnggKz0gdi54OwogICAgdGhpcy55ICs9IHYueTsKICAgIHRoaXMueiArPSB2Lno7CiAgICB0aGlzLncgKz0gdi53OwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBhZGRTY2FsYXI6IGZ1bmN0aW9uIGFkZFNjYWxhcihzKSB7CiAgICB0aGlzLnggKz0gczsKICAgIHRoaXMueSArPSBzOwogICAgdGhpcy56ICs9IHM7CiAgICB0aGlzLncgKz0gczsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgYWRkVmVjdG9yczogZnVuY3Rpb24gYWRkVmVjdG9ycyhhLCBiKSB7CiAgICB0aGlzLnggPSBhLnggKyBiLng7CiAgICB0aGlzLnkgPSBhLnkgKyBiLnk7CiAgICB0aGlzLnogPSBhLnogKyBiLno7CiAgICB0aGlzLncgPSBhLncgKyBiLnc7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGFkZFNjYWxlZFZlY3RvcjogZnVuY3Rpb24gYWRkU2NhbGVkVmVjdG9yKHYsIHMpIHsKICAgIHRoaXMueCArPSB2LnggKiBzOwogICAgdGhpcy55ICs9IHYueSAqIHM7CiAgICB0aGlzLnogKz0gdi56ICogczsKICAgIHRoaXMudyArPSB2LncgKiBzOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBzdWI6IGZ1bmN0aW9uIHN1Yih2LCB3KSB7CiAgICBpZiAodyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGNvbnNvbGUud2FybignVEhSRUUuVmVjdG9yNDogLnN1YigpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLnN1YlZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLicpOwogICAgICByZXR1cm4gdGhpcy5zdWJWZWN0b3JzKHYsIHcpOwogICAgfQoKICAgIHRoaXMueCAtPSB2Lng7CiAgICB0aGlzLnkgLT0gdi55OwogICAgdGhpcy56IC09IHYuejsKICAgIHRoaXMudyAtPSB2Lnc7CiAgICByZXR1cm4gdGhpczsKICB9LAogIHN1YlNjYWxhcjogZnVuY3Rpb24gc3ViU2NhbGFyKHMpIHsKICAgIHRoaXMueCAtPSBzOwogICAgdGhpcy55IC09IHM7CiAgICB0aGlzLnogLT0gczsKICAgIHRoaXMudyAtPSBzOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBzdWJWZWN0b3JzOiBmdW5jdGlvbiBzdWJWZWN0b3JzKGEsIGIpIHsKICAgIHRoaXMueCA9IGEueCAtIGIueDsKICAgIHRoaXMueSA9IGEueSAtIGIueTsKICAgIHRoaXMueiA9IGEueiAtIGIuejsKICAgIHRoaXMudyA9IGEudyAtIGIudzsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgbXVsdGlwbHlTY2FsYXI6IGZ1bmN0aW9uIG11bHRpcGx5U2NhbGFyKHNjYWxhcikgewogICAgdGhpcy54ICo9IHNjYWxhcjsKICAgIHRoaXMueSAqPSBzY2FsYXI7CiAgICB0aGlzLnogKj0gc2NhbGFyOwogICAgdGhpcy53ICo9IHNjYWxhcjsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgYXBwbHlNYXRyaXg0OiBmdW5jdGlvbiBhcHBseU1hdHJpeDQobSkgewogICAgdmFyIHggPSB0aGlzLng7CiAgICB2YXIgeSA9IHRoaXMueTsKICAgIHZhciB6ID0gdGhpcy56OwogICAgdmFyIHcgPSB0aGlzLnc7CiAgICB2YXIgZSA9IG0uZWxlbWVudHM7CiAgICB0aGlzLnggPSBlWzBdICogeCArIGVbNF0gKiB5ICsgZVs4XSAqIHogKyBlWzEyXSAqIHc7CiAgICB0aGlzLnkgPSBlWzFdICogeCArIGVbNV0gKiB5ICsgZVs5XSAqIHogKyBlWzEzXSAqIHc7CiAgICB0aGlzLnogPSBlWzJdICogeCArIGVbNl0gKiB5ICsgZVsxMF0gKiB6ICsgZVsxNF0gKiB3OwogICAgdGhpcy53ID0gZVszXSAqIHggKyBlWzddICogeSArIGVbMTFdICogeiArIGVbMTVdICogdzsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgZGl2aWRlU2NhbGFyOiBmdW5jdGlvbiBkaXZpZGVTY2FsYXIoc2NhbGFyKSB7CiAgICByZXR1cm4gdGhpcy5tdWx0aXBseVNjYWxhcigxIC8gc2NhbGFyKTsKICB9LAogIHNldEF4aXNBbmdsZUZyb21RdWF0ZXJuaW9uOiBmdW5jdGlvbiBzZXRBeGlzQW5nbGVGcm9tUXVhdGVybmlvbihxKSB7CiAgICAvLyBodHRwOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9nZW9tZXRyeS9yb3RhdGlvbnMvY29udmVyc2lvbnMvcXVhdGVybmlvblRvQW5nbGUvaW5kZXguaHRtCiAgICAvLyBxIGlzIGFzc3VtZWQgdG8gYmUgbm9ybWFsaXplZAogICAgdGhpcy53ID0gMiAqIE1hdGguYWNvcyhxLncpOwogICAgdmFyIHMgPSBNYXRoLnNxcnQoMSAtIHEudyAqIHEudyk7CgogICAgaWYgKHMgPCAwLjAwMDEpIHsKICAgICAgdGhpcy54ID0gMTsKICAgICAgdGhpcy55ID0gMDsKICAgICAgdGhpcy56ID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMueCA9IHEueCAvIHM7CiAgICAgIHRoaXMueSA9IHEueSAvIHM7CiAgICAgIHRoaXMueiA9IHEueiAvIHM7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBzZXRBeGlzQW5nbGVGcm9tUm90YXRpb25NYXRyaXg6IGZ1bmN0aW9uIHNldEF4aXNBbmdsZUZyb21Sb3RhdGlvbk1hdHJpeChtKSB7CiAgICAvLyBodHRwOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9nZW9tZXRyeS9yb3RhdGlvbnMvY29udmVyc2lvbnMvbWF0cml4VG9BbmdsZS9pbmRleC5odG0KICAgIC8vIGFzc3VtZXMgdGhlIHVwcGVyIDN4MyBvZiBtIGlzIGEgcHVyZSByb3RhdGlvbiBtYXRyaXggKGkuZSwgdW5zY2FsZWQpCiAgICB2YXIgYW5nbGU7CiAgICB2YXIgeDsKICAgIHZhciB5OwogICAgdmFyIHo7IC8vIHZhcmlhYmxlcyBmb3IgcmVzdWx0CgogICAgdmFyIGVwc2lsb24gPSAwLjAxOyAvLyBtYXJnaW4gdG8gYWxsb3cgZm9yIHJvdW5kaW5nIGVycm9ycwoKICAgIHZhciBlcHNpbG9uMiA9IDAuMTsgLy8gbWFyZ2luIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gMCBhbmQgMTgwIGRlZ3JlZXMKCiAgICB2YXIgdGUgPSBtLmVsZW1lbnRzOwogICAgdmFyIG0xMSA9IHRlWzBdOwogICAgdmFyIG0xMiA9IHRlWzRdOwogICAgdmFyIG0xMyA9IHRlWzhdOwogICAgdmFyIG0yMSA9IHRlWzFdOwogICAgdmFyIG0yMiA9IHRlWzVdOwogICAgdmFyIG0yMyA9IHRlWzldOwogICAgdmFyIG0zMSA9IHRlWzJdOwogICAgdmFyIG0zMiA9IHRlWzZdOwogICAgdmFyIG0zMyA9IHRlWzEwXTsKCiAgICBpZiAoTWF0aC5hYnMobTEyIC0gbTIxKSA8IGVwc2lsb24gJiYgTWF0aC5hYnMobTEzIC0gbTMxKSA8IGVwc2lsb24gJiYgTWF0aC5hYnMobTIzIC0gbTMyKSA8IGVwc2lsb24pIHsKICAgICAgLy8gc2luZ3VsYXJpdHkgZm91bmQKICAgICAgLy8gZmlyc3QgY2hlY2sgZm9yIGlkZW50aXR5IG1hdHJpeCB3aGljaCBtdXN0IGhhdmUgKzEgZm9yIGFsbCB0ZXJtcwogICAgICAvLyBpbiBsZWFkaW5nIGRpYWdvbmFsIGFuZCB6ZXJvIGluIG90aGVyIHRlcm1zCiAgICAgIGlmIChNYXRoLmFicyhtMTIgKyBtMjEpIDwgZXBzaWxvbjIgJiYgTWF0aC5hYnMobTEzICsgbTMxKSA8IGVwc2lsb24yICYmIE1hdGguYWJzKG0yMyArIG0zMikgPCBlcHNpbG9uMiAmJiBNYXRoLmFicyhtMTEgKyBtMjIgKyBtMzMgLSAzKSA8IGVwc2lsb24yKSB7CiAgICAgICAgLy8gdGhpcyBzaW5ndWxhcml0eSBpcyBpZGVudGl0eSBtYXRyaXggc28gYW5nbGUgPSAwCiAgICAgICAgdGhpcy5zZXQoMSwgMCwgMCwgMCk7CiAgICAgICAgcmV0dXJuIHRoaXM7IC8vIHplcm8gYW5nbGUsIGFyYml0cmFyeSBheGlzCiAgICAgIH0gLy8gb3RoZXJ3aXNlIHRoaXMgc2luZ3VsYXJpdHkgaXMgYW5nbGUgPSAxODAKCgogICAgICBhbmdsZSA9IE1hdGguUEk7CiAgICAgIHZhciB4eCA9IChtMTEgKyAxKSAvIDI7CiAgICAgIHZhciB5eSA9IChtMjIgKyAxKSAvIDI7CiAgICAgIHZhciB6eiA9IChtMzMgKyAxKSAvIDI7CiAgICAgIHZhciB4eSA9IChtMTIgKyBtMjEpIC8gNDsKICAgICAgdmFyIHh6ID0gKG0xMyArIG0zMSkgLyA0OwogICAgICB2YXIgeXogPSAobTIzICsgbTMyKSAvIDQ7CgogICAgICBpZiAoeHggPiB5eSAmJiB4eCA+IHp6KSB7CiAgICAgICAgLy8gbTExIGlzIHRoZSBsYXJnZXN0IGRpYWdvbmFsIHRlcm0KICAgICAgICBpZiAoeHggPCBlcHNpbG9uKSB7CiAgICAgICAgICB4ID0gMDsKICAgICAgICAgIHkgPSAwLjcwNzEwNjc4MTsKICAgICAgICAgIHogPSAwLjcwNzEwNjc4MTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgeCA9IE1hdGguc3FydCh4eCk7CiAgICAgICAgICB5ID0geHkgLyB4OwogICAgICAgICAgeiA9IHh6IC8geDsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoeXkgPiB6eikgewogICAgICAgIC8vIG0yMiBpcyB0aGUgbGFyZ2VzdCBkaWFnb25hbCB0ZXJtCiAgICAgICAgaWYgKHl5IDwgZXBzaWxvbikgewogICAgICAgICAgeCA9IDAuNzA3MTA2NzgxOwogICAgICAgICAgeSA9IDA7CiAgICAgICAgICB6ID0gMC43MDcxMDY3ODE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHkgPSBNYXRoLnNxcnQoeXkpOwogICAgICAgICAgeCA9IHh5IC8geTsKICAgICAgICAgIHogPSB5eiAvIHk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIG0zMyBpcyB0aGUgbGFyZ2VzdCBkaWFnb25hbCB0ZXJtIHNvIGJhc2UgcmVzdWx0IG9uIHRoaXMKICAgICAgICBpZiAoenogPCBlcHNpbG9uKSB7CiAgICAgICAgICB4ID0gMC43MDcxMDY3ODE7CiAgICAgICAgICB5ID0gMC43MDcxMDY3ODE7CiAgICAgICAgICB6ID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgeiA9IE1hdGguc3FydCh6eik7CiAgICAgICAgICB4ID0geHogLyB6OwogICAgICAgICAgeSA9IHl6IC8gejsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuc2V0KHgsIHksIHosIGFuZ2xlKTsKICAgICAgcmV0dXJuIHRoaXM7IC8vIHJldHVybiAxODAgZGVnIHJvdGF0aW9uCiAgICB9IC8vIGFzIHdlIGhhdmUgcmVhY2hlZCBoZXJlIHRoZXJlIGFyZSBubyBzaW5ndWxhcml0aWVzIHNvIHdlIGNhbiBoYW5kbGUgbm9ybWFsbHkKCgogICAgdmFyIHMgPSBNYXRoLnNxcnQoKG0zMiAtIG0yMykgKiAobTMyIC0gbTIzKSArIChtMTMgLSBtMzEpICogKG0xMyAtIG0zMSkgKyAobTIxIC0gbTEyKSAqIChtMjEgLSBtMTIpKTsgLy8gdXNlZCB0byBub3JtYWxpemUKCiAgICBpZiAoTWF0aC5hYnMocykgPCAwLjAwMSkgcyA9IDE7IC8vIHByZXZlbnQgZGl2aWRlIGJ5IHplcm8sIHNob3VsZCBub3QgaGFwcGVuIGlmIG1hdHJpeCBpcyBvcnRob2dvbmFsIGFuZCBzaG91bGQgYmUKICAgIC8vIGNhdWdodCBieSBzaW5ndWxhcml0eSB0ZXN0IGFib3ZlLCBidXQgSSd2ZSBsZWZ0IGl0IGluIGp1c3QgaW4gY2FzZQoKICAgIHRoaXMueCA9IChtMzIgLSBtMjMpIC8gczsKICAgIHRoaXMueSA9IChtMTMgLSBtMzEpIC8gczsKICAgIHRoaXMueiA9IChtMjEgLSBtMTIpIC8gczsKICAgIHRoaXMudyA9IE1hdGguYWNvcygobTExICsgbTIyICsgbTMzIC0gMSkgLyAyKTsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgbWluOiBmdW5jdGlvbiBtaW4odikgewogICAgdGhpcy54ID0gTWF0aC5taW4odGhpcy54LCB2LngpOwogICAgdGhpcy55ID0gTWF0aC5taW4odGhpcy55LCB2LnkpOwogICAgdGhpcy56ID0gTWF0aC5taW4odGhpcy56LCB2LnopOwogICAgdGhpcy53ID0gTWF0aC5taW4odGhpcy53LCB2LncpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBtYXg6IGZ1bmN0aW9uIG1heCh2KSB7CiAgICB0aGlzLnggPSBNYXRoLm1heCh0aGlzLngsIHYueCk7CiAgICB0aGlzLnkgPSBNYXRoLm1heCh0aGlzLnksIHYueSk7CiAgICB0aGlzLnogPSBNYXRoLm1heCh0aGlzLnosIHYueik7CiAgICB0aGlzLncgPSBNYXRoLm1heCh0aGlzLncsIHYudyk7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGNsYW1wOiBmdW5jdGlvbiBjbGFtcChtaW4sIG1heCkgewogICAgLy8gYXNzdW1lcyBtaW4gPCBtYXgsIGNvbXBvbmVudHdpc2UKICAgIHRoaXMueCA9IE1hdGgubWF4KG1pbi54LCBNYXRoLm1pbihtYXgueCwgdGhpcy54KSk7CiAgICB0aGlzLnkgPSBNYXRoLm1heChtaW4ueSwgTWF0aC5taW4obWF4LnksIHRoaXMueSkpOwogICAgdGhpcy56ID0gTWF0aC5tYXgobWluLnosIE1hdGgubWluKG1heC56LCB0aGlzLnopKTsKICAgIHRoaXMudyA9IE1hdGgubWF4KG1pbi53LCBNYXRoLm1pbihtYXgudywgdGhpcy53KSk7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGNsYW1wU2NhbGFyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgbWluLCBtYXg7CiAgICByZXR1cm4gZnVuY3Rpb24gY2xhbXBTY2FsYXIobWluVmFsLCBtYXhWYWwpIHsKICAgICAgaWYgKG1pbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgbWluID0gbmV3IFZlY3RvcjQoKTsKICAgICAgICBtYXggPSBuZXcgVmVjdG9yNCgpOwogICAgICB9CgogICAgICBtaW4uc2V0KG1pblZhbCwgbWluVmFsLCBtaW5WYWwsIG1pblZhbCk7CiAgICAgIG1heC5zZXQobWF4VmFsLCBtYXhWYWwsIG1heFZhbCwgbWF4VmFsKTsKICAgICAgcmV0dXJuIHRoaXMuY2xhbXAobWluLCBtYXgpOwogICAgfTsKICB9KCksCiAgY2xhbXBMZW5ndGg6IGZ1bmN0aW9uIGNsYW1wTGVuZ3RoKG1pbiwgbWF4KSB7CiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTsKICAgIHJldHVybiB0aGlzLmRpdmlkZVNjYWxhcihsZW5ndGggfHwgMSkubXVsdGlwbHlTY2FsYXIoTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIGxlbmd0aCkpKTsKICB9LAogIGZsb29yOiBmdW5jdGlvbiBmbG9vcigpIHsKICAgIHRoaXMueCA9IE1hdGguZmxvb3IodGhpcy54KTsKICAgIHRoaXMueSA9IE1hdGguZmxvb3IodGhpcy55KTsKICAgIHRoaXMueiA9IE1hdGguZmxvb3IodGhpcy56KTsKICAgIHRoaXMudyA9IE1hdGguZmxvb3IodGhpcy53KTsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgY2VpbDogZnVuY3Rpb24gY2VpbCgpIHsKICAgIHRoaXMueCA9IE1hdGguY2VpbCh0aGlzLngpOwogICAgdGhpcy55ID0gTWF0aC5jZWlsKHRoaXMueSk7CiAgICB0aGlzLnogPSBNYXRoLmNlaWwodGhpcy56KTsKICAgIHRoaXMudyA9IE1hdGguY2VpbCh0aGlzLncpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICByb3VuZDogZnVuY3Rpb24gcm91bmQoKSB7CiAgICB0aGlzLnggPSBNYXRoLnJvdW5kKHRoaXMueCk7CiAgICB0aGlzLnkgPSBNYXRoLnJvdW5kKHRoaXMueSk7CiAgICB0aGlzLnogPSBNYXRoLnJvdW5kKHRoaXMueik7CiAgICB0aGlzLncgPSBNYXRoLnJvdW5kKHRoaXMudyk7CiAgICByZXR1cm4gdGhpczsKICB9LAogIHJvdW5kVG9aZXJvOiBmdW5jdGlvbiByb3VuZFRvWmVybygpIHsKICAgIHRoaXMueCA9IHRoaXMueCA8IDAgPyBNYXRoLmNlaWwodGhpcy54KSA6IE1hdGguZmxvb3IodGhpcy54KTsKICAgIHRoaXMueSA9IHRoaXMueSA8IDAgPyBNYXRoLmNlaWwodGhpcy55KSA6IE1hdGguZmxvb3IodGhpcy55KTsKICAgIHRoaXMueiA9IHRoaXMueiA8IDAgPyBNYXRoLmNlaWwodGhpcy56KSA6IE1hdGguZmxvb3IodGhpcy56KTsKICAgIHRoaXMudyA9IHRoaXMudyA8IDAgPyBNYXRoLmNlaWwodGhpcy53KSA6IE1hdGguZmxvb3IodGhpcy53KTsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgbmVnYXRlOiBmdW5jdGlvbiBuZWdhdGUoKSB7CiAgICB0aGlzLnggPSAtdGhpcy54OwogICAgdGhpcy55ID0gLXRoaXMueTsKICAgIHRoaXMueiA9IC10aGlzLno7CiAgICB0aGlzLncgPSAtdGhpcy53OwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBkb3Q6IGZ1bmN0aW9uIGRvdCh2KSB7CiAgICByZXR1cm4gdGhpcy54ICogdi54ICsgdGhpcy55ICogdi55ICsgdGhpcy56ICogdi56ICsgdGhpcy53ICogdi53OwogIH0sCiAgbGVuZ3RoU3E6IGZ1bmN0aW9uIGxlbmd0aFNxKCkgewogICAgcmV0dXJuIHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMueiArIHRoaXMudyAqIHRoaXMudzsKICB9LAogIGxlbmd0aDogZnVuY3Rpb24gbGVuZ3RoKCkgewogICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpOwogIH0sCiAgbWFuaGF0dGFuTGVuZ3RoOiBmdW5jdGlvbiBtYW5oYXR0YW5MZW5ndGgoKSB7CiAgICByZXR1cm4gTWF0aC5hYnModGhpcy54KSArIE1hdGguYWJzKHRoaXMueSkgKyBNYXRoLmFicyh0aGlzLnopICsgTWF0aC5hYnModGhpcy53KTsKICB9LAogIG5vcm1hbGl6ZTogZnVuY3Rpb24gbm9ybWFsaXplKCkgewogICAgcmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKHRoaXMubGVuZ3RoKCkgfHwgMSk7CiAgfSwKICBzZXRMZW5ndGg6IGZ1bmN0aW9uIHNldExlbmd0aChsZW5ndGgpIHsKICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZSgpLm11bHRpcGx5U2NhbGFyKGxlbmd0aCk7CiAgfSwKICBsZXJwOiBmdW5jdGlvbiBsZXJwKHYsIGFscGhhKSB7CiAgICB0aGlzLnggKz0gKHYueCAtIHRoaXMueCkgKiBhbHBoYTsKICAgIHRoaXMueSArPSAodi55IC0gdGhpcy55KSAqIGFscGhhOwogICAgdGhpcy56ICs9ICh2LnogLSB0aGlzLnopICogYWxwaGE7CiAgICB0aGlzLncgKz0gKHYudyAtIHRoaXMudykgKiBhbHBoYTsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgbGVycFZlY3RvcnM6IGZ1bmN0aW9uIGxlcnBWZWN0b3JzKHYxLCB2MiwgYWxwaGEpIHsKICAgIHJldHVybiB0aGlzLnN1YlZlY3RvcnModjIsIHYxKS5tdWx0aXBseVNjYWxhcihhbHBoYSkuYWRkKHYxKTsKICB9LAogIGVxdWFsczogZnVuY3Rpb24gZXF1YWxzKHYpIHsKICAgIHJldHVybiB2LnggPT09IHRoaXMueCAmJiB2LnkgPT09IHRoaXMueSAmJiB2LnogPT09IHRoaXMueiAmJiB2LncgPT09IHRoaXMudzsKICB9LAogIGZyb21BcnJheTogZnVuY3Rpb24gZnJvbUFycmF5KGFycmF5LCBvZmZzZXQpIHsKICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDsKICAgIHRoaXMueCA9IGFycmF5W29mZnNldF07CiAgICB0aGlzLnkgPSBhcnJheVtvZmZzZXQgKyAxXTsKICAgIHRoaXMueiA9IGFycmF5W29mZnNldCArIDJdOwogICAgdGhpcy53ID0gYXJyYXlbb2Zmc2V0ICsgM107CiAgICByZXR1cm4gdGhpczsKICB9LAogIHRvQXJyYXk6IGZ1bmN0aW9uIHRvQXJyYXkoYXJyYXksIG9mZnNldCkgewogICAgaWYgKGFycmF5ID09PSB1bmRlZmluZWQpIGFycmF5ID0gW107CiAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7CiAgICBhcnJheVtvZmZzZXRdID0gdGhpcy54OwogICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSB0aGlzLnk7CiAgICBhcnJheVtvZmZzZXQgKyAyXSA9IHRoaXMuejsKICAgIGFycmF5W29mZnNldCArIDNdID0gdGhpcy53OwogICAgcmV0dXJuIGFycmF5OwogIH0sCiAgZnJvbUJ1ZmZlckF0dHJpYnV0ZTogZnVuY3Rpb24gZnJvbUJ1ZmZlckF0dHJpYnV0ZShhdHRyaWJ1dGUsIGluZGV4LCBvZmZzZXQpIHsKICAgIGlmIChvZmZzZXQgIT09IHVuZGVmaW5lZCkgewogICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLlZlY3RvcjQ6IG9mZnNldCBoYXMgYmVlbiByZW1vdmVkIGZyb20gLmZyb21CdWZmZXJBdHRyaWJ1dGUoKS4nKTsKICAgIH0KCiAgICB0aGlzLnggPSBhdHRyaWJ1dGUuZ2V0WChpbmRleCk7CiAgICB0aGlzLnkgPSBhdHRyaWJ1dGUuZ2V0WShpbmRleCk7CiAgICB0aGlzLnogPSBhdHRyaWJ1dGUuZ2V0WihpbmRleCk7CiAgICB0aGlzLncgPSBhdHRyaWJ1dGUuZ2V0VyhpbmRleCk7CiAgICByZXR1cm4gdGhpczsKICB9Cn0pOwoKLyoqCiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb20vCiAqLwoKZnVuY3Rpb24gQnVmZmVyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCkgewogIGlmIChBcnJheS5pc0FycmF5KGFycmF5KSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVEhSRUUuQnVmZmVyQXR0cmlidXRlOiBhcnJheSBzaG91bGQgYmUgYSBUeXBlZCBBcnJheS4nKTsKICB9CgogIHRoaXMubmFtZSA9ICcnOwogIHRoaXMuYXJyYXkgPSBhcnJheTsKICB0aGlzLml0ZW1TaXplID0gaXRlbVNpemU7CiAgdGhpcy5jb3VudCA9IGFycmF5ICE9PSB1bmRlZmluZWQgPyBhcnJheS5sZW5ndGggLyBpdGVtU2l6ZSA6IDA7CiAgdGhpcy5ub3JtYWxpemVkID0gbm9ybWFsaXplZCA9PT0gdHJ1ZTsKICB0aGlzLmR5bmFtaWMgPSBmYWxzZTsKICB0aGlzLnVwZGF0ZVJhbmdlID0gewogICAgb2Zmc2V0OiAwLAogICAgY291bnQ6IC0xCiAgfTsKICB0aGlzLnZlcnNpb24gPSAwOwp9CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZSwgJ25lZWRzVXBkYXRlJywgewogIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09IHRydWUpIHRoaXMudmVyc2lvbisrOwogIH0KfSk7Ck9iamVjdC5hc3NpZ24oQnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZSwgewogIGlzQnVmZmVyQXR0cmlidXRlOiB0cnVlLAogIG9uVXBsb2FkQ2FsbGJhY2s6IGZ1bmN0aW9uIG9uVXBsb2FkQ2FsbGJhY2soKSB7fSwKICBzZXRBcnJheTogZnVuY3Rpb24gc2V0QXJyYXkoYXJyYXkpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGFycmF5KSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUSFJFRS5CdWZmZXJBdHRyaWJ1dGU6IGFycmF5IHNob3VsZCBiZSBhIFR5cGVkIEFycmF5LicpOwogICAgfQoKICAgIHRoaXMuY291bnQgPSBhcnJheSAhPT0gdW5kZWZpbmVkID8gYXJyYXkubGVuZ3RoIC8gdGhpcy5pdGVtU2l6ZSA6IDA7CiAgICB0aGlzLmFycmF5ID0gYXJyYXk7CiAgICByZXR1cm4gdGhpczsKICB9LAogIHNldER5bmFtaWM6IGZ1bmN0aW9uIHNldER5bmFtaWModmFsdWUpIHsKICAgIHRoaXMuZHluYW1pYyA9IHZhbHVlOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBjb3B5OiBmdW5jdGlvbiBjb3B5KHNvdXJjZSkgewogICAgdGhpcy5uYW1lID0gc291cmNlLm5hbWU7CiAgICB0aGlzLmFycmF5ID0gbmV3IHNvdXJjZS5hcnJheS5jb25zdHJ1Y3Rvcihzb3VyY2UuYXJyYXkpOwogICAgdGhpcy5pdGVtU2l6ZSA9IHNvdXJjZS5pdGVtU2l6ZTsKICAgIHRoaXMuY291bnQgPSBzb3VyY2UuY291bnQ7CiAgICB0aGlzLm5vcm1hbGl6ZWQgPSBzb3VyY2Uubm9ybWFsaXplZDsKICAgIHRoaXMuZHluYW1pYyA9IHNvdXJjZS5keW5hbWljOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBjb3B5QXQ6IGZ1bmN0aW9uIGNvcHlBdChpbmRleDEsIGF0dHJpYnV0ZSwgaW5kZXgyKSB7CiAgICBpbmRleDEgKj0gdGhpcy5pdGVtU2l6ZTsKICAgIGluZGV4MiAqPSBhdHRyaWJ1dGUuaXRlbVNpemU7CgogICAgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLml0ZW1TaXplOyBpIDwgbDsgaSsrKSB7CiAgICAgIHRoaXMuYXJyYXlbaW5kZXgxICsgaV0gPSBhdHRyaWJ1dGUuYXJyYXlbaW5kZXgyICsgaV07CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBjb3B5QXJyYXk6IGZ1bmN0aW9uIGNvcHlBcnJheShhcnJheSkgewogICAgdGhpcy5hcnJheS5zZXQoYXJyYXkpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBjb3B5VmVjdG9yMnNBcnJheTogZnVuY3Rpb24gY29weVZlY3RvcjJzQXJyYXkodmVjdG9ycykgewogICAgdmFyIGFycmF5ID0gdGhpcy5hcnJheTsKICAgIHZhciBvZmZzZXQgPSAwOwoKICAgIGZvciAodmFyIGkgPSAwLCBsID0gdmVjdG9ycy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmFyIHZlY3RvciA9IHZlY3RvcnNbaV07CgogICAgICBpZiAodmVjdG9yID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJ1ZmZlckF0dHJpYnV0ZS5jb3B5VmVjdG9yMnNBcnJheSgpOiB2ZWN0b3IgaXMgdW5kZWZpbmVkJywgaSk7CiAgICAgICAgdmVjdG9yID0gbmV3IFZlY3RvcjIoKTsKICAgICAgfQoKICAgICAgYXJyYXlbb2Zmc2V0KytdID0gdmVjdG9yLng7CiAgICAgIGFycmF5W29mZnNldCsrXSA9IHZlY3Rvci55OwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCiAgY29weVZlY3RvcjNzQXJyYXk6IGZ1bmN0aW9uIGNvcHlWZWN0b3Izc0FycmF5KHZlY3RvcnMpIHsKICAgIHZhciBhcnJheSA9IHRoaXMuYXJyYXk7CiAgICB2YXIgb2Zmc2V0ID0gMDsKCiAgICBmb3IgKHZhciBpID0gMCwgbCA9IHZlY3RvcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHZhciB2ZWN0b3IgPSB2ZWN0b3JzW2ldOwoKICAgICAgaWYgKHZlY3RvciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdUSFJFRS5CdWZmZXJBdHRyaWJ1dGUuY29weVZlY3RvcjNzQXJyYXkoKTogdmVjdG9yIGlzIHVuZGVmaW5lZCcsIGkpOwogICAgICAgIHZlY3RvciA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIH0KCiAgICAgIGFycmF5W29mZnNldCsrXSA9IHZlY3Rvci54OwogICAgICBhcnJheVtvZmZzZXQrK10gPSB2ZWN0b3IueTsKICAgICAgYXJyYXlbb2Zmc2V0KytdID0gdmVjdG9yLno7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBjb3B5VmVjdG9yNHNBcnJheTogZnVuY3Rpb24gY29weVZlY3RvcjRzQXJyYXkodmVjdG9ycykgewogICAgdmFyIGFycmF5ID0gdGhpcy5hcnJheTsKICAgIHZhciBvZmZzZXQgPSAwOwoKICAgIGZvciAodmFyIGkgPSAwLCBsID0gdmVjdG9ycy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmFyIHZlY3RvciA9IHZlY3RvcnNbaV07CgogICAgICBpZiAodmVjdG9yID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJ1ZmZlckF0dHJpYnV0ZS5jb3B5VmVjdG9yNHNBcnJheSgpOiB2ZWN0b3IgaXMgdW5kZWZpbmVkJywgaSk7CiAgICAgICAgdmVjdG9yID0gbmV3IFZlY3RvcjQoKTsKICAgICAgfQoKICAgICAgYXJyYXlbb2Zmc2V0KytdID0gdmVjdG9yLng7CiAgICAgIGFycmF5W29mZnNldCsrXSA9IHZlY3Rvci55OwogICAgICBhcnJheVtvZmZzZXQrK10gPSB2ZWN0b3IuejsKICAgICAgYXJyYXlbb2Zmc2V0KytdID0gdmVjdG9yLnc7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSwgb2Zmc2V0KSB7CiAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7CiAgICB0aGlzLmFycmF5LnNldCh2YWx1ZSwgb2Zmc2V0KTsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgZ2V0WDogZnVuY3Rpb24gZ2V0WChpbmRleCkgewogICAgcmV0dXJuIHRoaXMuYXJyYXlbaW5kZXggKiB0aGlzLml0ZW1TaXplXTsKICB9LAogIHNldFg6IGZ1bmN0aW9uIHNldFgoaW5kZXgsIHgpIHsKICAgIHRoaXMuYXJyYXlbaW5kZXggKiB0aGlzLml0ZW1TaXplXSA9IHg7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGdldFk6IGZ1bmN0aW9uIGdldFkoaW5kZXgpIHsKICAgIHJldHVybiB0aGlzLmFycmF5W2luZGV4ICogdGhpcy5pdGVtU2l6ZSArIDFdOwogIH0sCiAgc2V0WTogZnVuY3Rpb24gc2V0WShpbmRleCwgeSkgewogICAgdGhpcy5hcnJheVtpbmRleCAqIHRoaXMuaXRlbVNpemUgKyAxXSA9IHk7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGdldFo6IGZ1bmN0aW9uIGdldFooaW5kZXgpIHsKICAgIHJldHVybiB0aGlzLmFycmF5W2luZGV4ICogdGhpcy5pdGVtU2l6ZSArIDJdOwogIH0sCiAgc2V0WjogZnVuY3Rpb24gc2V0WihpbmRleCwgeikgewogICAgdGhpcy5hcnJheVtpbmRleCAqIHRoaXMuaXRlbVNpemUgKyAyXSA9IHo7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGdldFc6IGZ1bmN0aW9uIGdldFcoaW5kZXgpIHsKICAgIHJldHVybiB0aGlzLmFycmF5W2luZGV4ICogdGhpcy5pdGVtU2l6ZSArIDNdOwogIH0sCiAgc2V0VzogZnVuY3Rpb24gc2V0VyhpbmRleCwgdykgewogICAgdGhpcy5hcnJheVtpbmRleCAqIHRoaXMuaXRlbVNpemUgKyAzXSA9IHc7CiAgICByZXR1cm4gdGhpczsKICB9LAogIHNldFhZOiBmdW5jdGlvbiBzZXRYWShpbmRleCwgeCwgeSkgewogICAgaW5kZXggKj0gdGhpcy5pdGVtU2l6ZTsKICAgIHRoaXMuYXJyYXlbaW5kZXggKyAwXSA9IHg7CiAgICB0aGlzLmFycmF5W2luZGV4ICsgMV0gPSB5OwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBzZXRYWVo6IGZ1bmN0aW9uIHNldFhZWihpbmRleCwgeCwgeSwgeikgewogICAgaW5kZXggKj0gdGhpcy5pdGVtU2l6ZTsKICAgIHRoaXMuYXJyYXlbaW5kZXggKyAwXSA9IHg7CiAgICB0aGlzLmFycmF5W2luZGV4ICsgMV0gPSB5OwogICAgdGhpcy5hcnJheVtpbmRleCArIDJdID0gejsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgc2V0WFlaVzogZnVuY3Rpb24gc2V0WFlaVyhpbmRleCwgeCwgeSwgeiwgdykgewogICAgaW5kZXggKj0gdGhpcy5pdGVtU2l6ZTsKICAgIHRoaXMuYXJyYXlbaW5kZXggKyAwXSA9IHg7CiAgICB0aGlzLmFycmF5W2luZGV4ICsgMV0gPSB5OwogICAgdGhpcy5hcnJheVtpbmRleCArIDJdID0gejsKICAgIHRoaXMuYXJyYXlbaW5kZXggKyAzXSA9IHc7CiAgICByZXR1cm4gdGhpczsKICB9LAogIG9uVXBsb2FkOiBmdW5jdGlvbiBvblVwbG9hZChjYWxsYmFjaykgewogICAgdGhpcy5vblVwbG9hZENhbGxiYWNrID0gY2FsbGJhY2s7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGNsb25lOiBmdW5jdGlvbiBjbG9uZSgpIHsKICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLmFycmF5LCB0aGlzLml0ZW1TaXplKS5jb3B5KHRoaXMpOwogIH0KfSk7IC8vCgpmdW5jdGlvbiBJbnQ4QnVmZmVyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCkgewogIEJ1ZmZlckF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5ldyBJbnQ4QXJyYXkoYXJyYXkpLCBpdGVtU2l6ZSwgbm9ybWFsaXplZCk7Cn0KCkludDhCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlKTsKSW50OEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBJbnQ4QnVmZmVyQXR0cmlidXRlOwoKZnVuY3Rpb24gVWludDhCdWZmZXJBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplLCBub3JtYWxpemVkKSB7CiAgQnVmZmVyQXR0cmlidXRlLmNhbGwodGhpcywgbmV3IFVpbnQ4QXJyYXkoYXJyYXkpLCBpdGVtU2l6ZSwgbm9ybWFsaXplZCk7Cn0KClVpbnQ4QnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZSk7ClVpbnQ4QnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFVpbnQ4QnVmZmVyQXR0cmlidXRlOwoKZnVuY3Rpb24gVWludDhDbGFtcGVkQnVmZmVyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCkgewogIEJ1ZmZlckF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5ldyBVaW50OENsYW1wZWRBcnJheShhcnJheSksIGl0ZW1TaXplLCBub3JtYWxpemVkKTsKfQoKVWludDhDbGFtcGVkQnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZSk7ClVpbnQ4Q2xhbXBlZEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBVaW50OENsYW1wZWRCdWZmZXJBdHRyaWJ1dGU7CgpmdW5jdGlvbiBJbnQxNkJ1ZmZlckF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpIHsKICBCdWZmZXJBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuZXcgSW50MTZBcnJheShhcnJheSksIGl0ZW1TaXplLCBub3JtYWxpemVkKTsKfQoKSW50MTZCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlKTsKSW50MTZCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSW50MTZCdWZmZXJBdHRyaWJ1dGU7CgpmdW5jdGlvbiBVaW50MTZCdWZmZXJBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplLCBub3JtYWxpemVkKSB7CiAgQnVmZmVyQXR0cmlidXRlLmNhbGwodGhpcywgbmV3IFVpbnQxNkFycmF5KGFycmF5KSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpOwp9CgpVaW50MTZCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlKTsKVWludDE2QnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFVpbnQxNkJ1ZmZlckF0dHJpYnV0ZTsKCmZ1bmN0aW9uIEludDMyQnVmZmVyQXR0cmlidXRlKGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCkgewogIEJ1ZmZlckF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5ldyBJbnQzMkFycmF5KGFycmF5KSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpOwp9CgpJbnQzMkJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUpOwpJbnQzMkJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBJbnQzMkJ1ZmZlckF0dHJpYnV0ZTsKCmZ1bmN0aW9uIFVpbnQzMkJ1ZmZlckF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpIHsKICBCdWZmZXJBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuZXcgVWludDMyQXJyYXkoYXJyYXkpLCBpdGVtU2l6ZSwgbm9ybWFsaXplZCk7Cn0KClVpbnQzMkJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUpOwpVaW50MzJCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVWludDMyQnVmZmVyQXR0cmlidXRlOwoKZnVuY3Rpb24gRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShhcnJheSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpIHsKICBCdWZmZXJBdHRyaWJ1dGUuY2FsbCh0aGlzLCBuZXcgRmxvYXQzMkFycmF5KGFycmF5KSwgaXRlbVNpemUsIG5vcm1hbGl6ZWQpOwp9CgpGbG9hdDMyQnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZSk7CkZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZTsKCmZ1bmN0aW9uIEZsb2F0NjRCdWZmZXJBdHRyaWJ1dGUoYXJyYXksIGl0ZW1TaXplLCBub3JtYWxpemVkKSB7CiAgQnVmZmVyQXR0cmlidXRlLmNhbGwodGhpcywgbmV3IEZsb2F0NjRBcnJheShhcnJheSksIGl0ZW1TaXplLCBub3JtYWxpemVkKTsKfQoKRmxvYXQ2NEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEJ1ZmZlckF0dHJpYnV0ZS5wcm90b3R5cGUpOwpGbG9hdDY0QnVmZmVyQXR0cmlidXRlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEZsb2F0NjRCdWZmZXJBdHRyaWJ1dGU7IC8vCgovKiBlc2xpbnQtZGlzYWJsZSAqLwoKZnVuY3Rpb24gRGlyZWN0R2VvbWV0cnkoKSB7CiAgdGhpcy52ZXJ0aWNlcyA9IFtdOwogIHRoaXMubm9ybWFscyA9IFtdOwogIHRoaXMudXZzID0gW107CiAgdGhpcy51dnMyID0gW107CiAgdGhpcy5ncm91cHMgPSBbXTsKICB0aGlzLm1vcnBoVGFyZ2V0cyA9IHt9OwogIHRoaXMuc2tpbldlaWdodHMgPSBbXTsKICB0aGlzLnNraW5JbmRpY2VzID0gW107IC8vIHRoaXMubGluZURpc3RhbmNlcyA9IFtdOwoKICB0aGlzLmJvdW5kaW5nQm94ID0gbnVsbDsKICB0aGlzLmJvdW5kaW5nU3BoZXJlID0gbnVsbDsgLy8gdXBkYXRlIGZsYWdzCgogIHRoaXMudmVydGljZXNOZWVkVXBkYXRlID0gZmFsc2U7CiAgdGhpcy5ub3JtYWxzTmVlZFVwZGF0ZSA9IGZhbHNlOwogIHRoaXMudXZzTmVlZFVwZGF0ZSA9IGZhbHNlOwogIHRoaXMuZ3JvdXBzTmVlZFVwZGF0ZSA9IGZhbHNlOwp9CgpPYmplY3QuYXNzaWduKERpcmVjdEdlb21ldHJ5LnByb3RvdHlwZSwgewogIGNvbXB1dGVHcm91cHM6IGZ1bmN0aW9uIGNvbXB1dGVHcm91cHMoZ2VvbWV0cnkpIHsKICAgIHZhciBncm91cDsKICAgIHZhciBncm91cHMgPSBbXTsKICAgIHZhciBtYXRlcmlhbEluZGV4ID0gdW5kZWZpbmVkOwogICAgdmFyIGZhY2VzID0gZ2VvbWV0cnkuZmFjZXM7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYWNlcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZmFjZSA9IGZhY2VzW2ldOyAvLyBtYXRlcmlhbHMKCiAgICAgIGlmIChmYWNlLm1hdGVyaWFsSW5kZXggIT09IG1hdGVyaWFsSW5kZXgpIHsKICAgICAgICBtYXRlcmlhbEluZGV4ID0gZmFjZS5tYXRlcmlhbEluZGV4OwoKICAgICAgICBpZiAoZ3JvdXAgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgZ3JvdXAuY291bnQgPSBpICogMyAtIGdyb3VwLnN0YXJ0OwogICAgICAgICAgZ3JvdXBzLnB1c2goZ3JvdXApOwogICAgICAgIH0KCiAgICAgICAgZ3JvdXAgPSB7CiAgICAgICAgICBzdGFydDogaSAqIDMsCiAgICAgICAgICBtYXRlcmlhbEluZGV4OiBtYXRlcmlhbEluZGV4CiAgICAgICAgfTsKICAgICAgfQogICAgfQoKICAgIGlmIChncm91cCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGdyb3VwLmNvdW50ID0gaSAqIDMgLSBncm91cC5zdGFydDsKICAgICAgZ3JvdXBzLnB1c2goZ3JvdXApOwogICAgfQoKICAgIHRoaXMuZ3JvdXBzID0gZ3JvdXBzOwogIH0sCiAgZnJvbUdlb21ldHJ5OiBmdW5jdGlvbiBmcm9tR2VvbWV0cnkoZ2VvbWV0cnkpIHsKICAgIHZhciBmYWNlcyA9IGdlb21ldHJ5LmZhY2VzOwogICAgdmFyIHZlcnRpY2VzID0gZ2VvbWV0cnkudmVydGljZXM7CiAgICB2YXIgZmFjZVZlcnRleFV2cyA9IGdlb21ldHJ5LmZhY2VWZXJ0ZXhVdnM7CiAgICB2YXIgaGFzRmFjZVZlcnRleFV2ID0gZmFjZVZlcnRleFV2c1swXSAmJiBmYWNlVmVydGV4VXZzWzBdLmxlbmd0aCA+IDA7CiAgICB2YXIgaGFzRmFjZVZlcnRleFV2MiA9IGZhY2VWZXJ0ZXhVdnNbMV0gJiYgZmFjZVZlcnRleFV2c1sxXS5sZW5ndGggPiAwOyAvLyBtb3JwaHMKCiAgICB2YXIgbW9ycGhUYXJnZXRzID0gZ2VvbWV0cnkubW9ycGhUYXJnZXRzOwogICAgdmFyIG1vcnBoVGFyZ2V0c0xlbmd0aCA9IG1vcnBoVGFyZ2V0cy5sZW5ndGg7CiAgICB2YXIgbW9ycGhUYXJnZXRzUG9zaXRpb247CgogICAgaWYgKG1vcnBoVGFyZ2V0c0xlbmd0aCA+IDApIHsKICAgICAgbW9ycGhUYXJnZXRzUG9zaXRpb24gPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW9ycGhUYXJnZXRzTGVuZ3RoOyBpKyspIHsKICAgICAgICBtb3JwaFRhcmdldHNQb3NpdGlvbltpXSA9IHsKICAgICAgICAgIG5hbWU6IG1vcnBoVGFyZ2V0c1tpXS5uYW1lLAogICAgICAgICAgZGF0YTogW10KICAgICAgICB9OwogICAgICB9CgogICAgICB0aGlzLm1vcnBoVGFyZ2V0cy5wb3NpdGlvbiA9IG1vcnBoVGFyZ2V0c1Bvc2l0aW9uOwogICAgfQoKICAgIHZhciBtb3JwaE5vcm1hbHMgPSBnZW9tZXRyeS5tb3JwaE5vcm1hbHM7CiAgICB2YXIgbW9ycGhOb3JtYWxzTGVuZ3RoID0gbW9ycGhOb3JtYWxzLmxlbmd0aDsKICAgIHZhciBtb3JwaFRhcmdldHNOb3JtYWw7CgogICAgaWYgKG1vcnBoTm9ybWFsc0xlbmd0aCA+IDApIHsKICAgICAgbW9ycGhUYXJnZXRzTm9ybWFsID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vcnBoTm9ybWFsc0xlbmd0aDsgaSsrKSB7CiAgICAgICAgbW9ycGhUYXJnZXRzTm9ybWFsW2ldID0gewogICAgICAgICAgbmFtZTogbW9ycGhOb3JtYWxzW2ldLm5hbWUsCiAgICAgICAgICBkYXRhOiBbXQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHRoaXMubW9ycGhUYXJnZXRzLm5vcm1hbCA9IG1vcnBoVGFyZ2V0c05vcm1hbDsKICAgIH0gLy8gc2tpbnMKCgogICAgdmFyIHNraW5JbmRpY2VzID0gZ2VvbWV0cnkuc2tpbkluZGljZXM7CiAgICB2YXIgc2tpbldlaWdodHMgPSBnZW9tZXRyeS5za2luV2VpZ2h0czsKICAgIHZhciBoYXNTa2luSW5kaWNlcyA9IHNraW5JbmRpY2VzLmxlbmd0aCA9PT0gdmVydGljZXMubGVuZ3RoOwogICAgdmFyIGhhc1NraW5XZWlnaHRzID0gc2tpbldlaWdodHMubGVuZ3RoID09PSB2ZXJ0aWNlcy5sZW5ndGg7IC8vCgogICAgaWYgKHZlcnRpY2VzLmxlbmd0aCA+IDAgJiYgZmFjZXMubGVuZ3RoID09PSAwKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RIUkVFLkRpcmVjdEdlb21ldHJ5OiBGYWNlbGVzcyBnZW9tZXRyaWVzIGFyZSBub3Qgc3VwcG9ydGVkLicpOwogICAgfQoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGZhY2UgPSBmYWNlc1tpXTsKICAgICAgdGhpcy52ZXJ0aWNlcy5wdXNoKHZlcnRpY2VzW2ZhY2UuYV0sIHZlcnRpY2VzW2ZhY2UuYl0sIHZlcnRpY2VzW2ZhY2UuY10pOwogICAgICB2YXIgdmVydGV4Tm9ybWFscyA9IGZhY2UudmVydGV4Tm9ybWFsczsKCiAgICAgIGlmICh2ZXJ0ZXhOb3JtYWxzLmxlbmd0aCA9PT0gMykgewogICAgICAgIHRoaXMubm9ybWFscy5wdXNoKHZlcnRleE5vcm1hbHNbMF0sIHZlcnRleE5vcm1hbHNbMV0sIHZlcnRleE5vcm1hbHNbMl0pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBub3JtYWwgPSBmYWNlLm5vcm1hbDsKICAgICAgICB0aGlzLm5vcm1hbHMucHVzaChub3JtYWwsIG5vcm1hbCwgbm9ybWFsKTsKICAgICAgfQoKICAgICAgaWYgKGhhc0ZhY2VWZXJ0ZXhVdiA9PT0gdHJ1ZSkgewogICAgICAgIHZhciB2ZXJ0ZXhVdnMgPSBmYWNlVmVydGV4VXZzWzBdW2ldOwoKICAgICAgICBpZiAodmVydGV4VXZzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRoaXMudXZzLnB1c2godmVydGV4VXZzWzBdLCB2ZXJ0ZXhVdnNbMV0sIHZlcnRleFV2c1syXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUud2FybignVEhSRUUuRGlyZWN0R2VvbWV0cnkuZnJvbUdlb21ldHJ5KCk6IFVuZGVmaW5lZCB2ZXJ0ZXhVdiAnLCBpKTsKICAgICAgICAgIHRoaXMudXZzLnB1c2gobmV3IFZlY3RvcjIoKSwgbmV3IFZlY3RvcjIoKSwgbmV3IFZlY3RvcjIoKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoaGFzRmFjZVZlcnRleFV2MiA9PT0gdHJ1ZSkgewogICAgICAgIHZhciB2ZXJ0ZXhVdnMgPSBmYWNlVmVydGV4VXZzWzFdW2ldOwoKICAgICAgICBpZiAodmVydGV4VXZzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRoaXMudXZzMi5wdXNoKHZlcnRleFV2c1swXSwgdmVydGV4VXZzWzFdLCB2ZXJ0ZXhVdnNbMl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkRpcmVjdEdlb21ldHJ5LmZyb21HZW9tZXRyeSgpOiBVbmRlZmluZWQgdmVydGV4VXYyICcsIGkpOwogICAgICAgICAgdGhpcy51dnMyLnB1c2gobmV3IFZlY3RvcjIoKSwgbmV3IFZlY3RvcjIoKSwgbmV3IFZlY3RvcjIoKSk7CiAgICAgICAgfQogICAgICB9IC8vIG1vcnBocwoKCiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbW9ycGhUYXJnZXRzTGVuZ3RoOyBqKyspIHsKICAgICAgICB2YXIgbW9ycGhUYXJnZXQgPSBtb3JwaFRhcmdldHNbal0udmVydGljZXM7CiAgICAgICAgbW9ycGhUYXJnZXRzUG9zaXRpb25bal0uZGF0YS5wdXNoKG1vcnBoVGFyZ2V0W2ZhY2UuYV0sIG1vcnBoVGFyZ2V0W2ZhY2UuYl0sIG1vcnBoVGFyZ2V0W2ZhY2UuY10pOwogICAgICB9CgogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1vcnBoTm9ybWFsc0xlbmd0aDsgaisrKSB7CiAgICAgICAgdmFyIG1vcnBoTm9ybWFsID0gbW9ycGhOb3JtYWxzW2pdLnZlcnRleE5vcm1hbHNbaV07CiAgICAgICAgbW9ycGhUYXJnZXRzTm9ybWFsW2pdLmRhdGEucHVzaChtb3JwaE5vcm1hbC5hLCBtb3JwaE5vcm1hbC5iLCBtb3JwaE5vcm1hbC5jKTsKICAgICAgfSAvLyBza2lucwoKCiAgICAgIGlmIChoYXNTa2luSW5kaWNlcykgewogICAgICAgIHRoaXMuc2tpbkluZGljZXMucHVzaChza2luSW5kaWNlc1tmYWNlLmFdLCBza2luSW5kaWNlc1tmYWNlLmJdLCBza2luSW5kaWNlc1tmYWNlLmNdKTsKICAgICAgfQoKICAgICAgaWYgKGhhc1NraW5XZWlnaHRzKSB7CiAgICAgICAgdGhpcy5za2luV2VpZ2h0cy5wdXNoKHNraW5XZWlnaHRzW2ZhY2UuYV0sIHNraW5XZWlnaHRzW2ZhY2UuYl0sIHNraW5XZWlnaHRzW2ZhY2UuY10pOwogICAgICB9CiAgICB9CgogICAgdGhpcy5jb21wdXRlR3JvdXBzKGdlb21ldHJ5KTsKICAgIHRoaXMudmVydGljZXNOZWVkVXBkYXRlID0gZ2VvbWV0cnkudmVydGljZXNOZWVkVXBkYXRlOwogICAgdGhpcy5ub3JtYWxzTmVlZFVwZGF0ZSA9IGdlb21ldHJ5Lm5vcm1hbHNOZWVkVXBkYXRlOwogICAgdGhpcy51dnNOZWVkVXBkYXRlID0gZ2VvbWV0cnkudXZzTmVlZFVwZGF0ZTsKICAgIHRoaXMuZ3JvdXBzTmVlZFVwZGF0ZSA9IGdlb21ldHJ5Lmdyb3Vwc05lZWRVcGRhdGU7CiAgICByZXR1cm4gdGhpczsKICB9Cn0pOwoKLyoqCiAqIEBhdXRob3IgYWx0ZXJlZHEgLyBodHRwOi8vYWx0ZXJlZHF1YWxpYS5jb20vCiAqIEBhdXRob3IgV2VzdExhbmdsZXkgLyBodHRwOi8vZ2l0aHViLmNvbS9XZXN0TGFuZ2xleQogKiBAYXV0aG9yIGJob3VzdG9uIC8gaHR0cDovL2NsYXJhLmlvCiAqIEBhdXRob3IgdHNjaHcKICovCgp2YXIgTWF0cml4MyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTWF0cml4MygpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNYXRyaXgzKTsKCiAgICB0aGlzLmVsZW1lbnRzID0gWzEsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDFdOwogICAgdGhpcy5pc01hdHJpeDMgPSB0cnVlOwogIH0KCiAgX2NyZWF0ZUNsYXNzKE1hdHJpeDMsIFt7CiAgICBrZXk6ICJzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldChuMTEsIG4xMiwgbjEzLCBuMjEsIG4yMiwgbjIzLCBuMzEsIG4zMiwgbjMzKSB7CiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIHRlWzBdID0gbjExOwogICAgICB0ZVsxXSA9IG4yMTsKICAgICAgdGVbMl0gPSBuMzE7CiAgICAgIHRlWzNdID0gbjEyOwogICAgICB0ZVs0XSA9IG4yMjsKICAgICAgdGVbNV0gPSBuMzI7CiAgICAgIHRlWzZdID0gbjEzOwogICAgICB0ZVs3XSA9IG4yMzsKICAgICAgdGVbOF0gPSBuMzM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImlkZW50aXR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpZGVudGl0eSgpIHsKICAgICAgdGhpcy5zZXQoMSwgMCwgMCwgMCwgMSwgMCwgMCwgMCwgMSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImNsb25lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHsKICAgICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKCkuZnJvbUFycmF5KHRoaXMuZWxlbWVudHMpOwogICAgfQogIH0sIHsKICAgIGtleTogImNvcHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvcHkobSkgewogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB2YXIgbWUgPSBtLmVsZW1lbnRzOwogICAgICB0ZVswXSA9IG1lWzBdOwogICAgICB0ZVsxXSA9IG1lWzFdOwogICAgICB0ZVsyXSA9IG1lWzJdOwogICAgICB0ZVszXSA9IG1lWzNdOwogICAgICB0ZVs0XSA9IG1lWzRdOwogICAgICB0ZVs1XSA9IG1lWzVdOwogICAgICB0ZVs2XSA9IG1lWzZdOwogICAgICB0ZVs3XSA9IG1lWzddOwogICAgICB0ZVs4XSA9IG1lWzhdOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGcm9tTWF0cml4NCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RnJvbU1hdHJpeDQobSkgewogICAgICB2YXIgbWUgPSBtLmVsZW1lbnRzOwogICAgICB0aGlzLnNldChtZVswXSwgbWVbNF0sIG1lWzhdLCBtZVsxXSwgbWVbNV0sIG1lWzldLCBtZVsyXSwgbWVbNl0sIG1lWzEwXSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImFwcGx5VG9CdWZmZXJBdHRyaWJ1dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5VG9CdWZmZXJBdHRyaWJ1dGUoYXR0cmlidXRlKSB7CiAgICAgIHZhciB2MSA9IG5ldyBWZWN0b3IzKCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGF0dHJpYnV0ZS5jb3VudDsgaSA8IGw7IGkrKykgewogICAgICAgIHYxLnggPSBhdHRyaWJ1dGUuZ2V0WChpKTsKICAgICAgICB2MS55ID0gYXR0cmlidXRlLmdldFkoaSk7CiAgICAgICAgdjEueiA9IGF0dHJpYnV0ZS5nZXRaKGkpOwogICAgICAgIHYxLmFwcGx5TWF0cml4Myh0aGlzKTsKICAgICAgICBhdHRyaWJ1dGUuc2V0WFlaKGksIHYxLngsIHYxLnksIHYxLnopOwogICAgICB9CgogICAgICByZXR1cm4gYXR0cmlidXRlOwogICAgfQogIH0sIHsKICAgIGtleTogIm11bHRpcGx5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtdWx0aXBseShtKSB7CiAgICAgIHJldHVybiB0aGlzLm11bHRpcGx5TWF0cmljZXModGhpcywgbSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJlbXVsdGlwbHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZW11bHRpcGx5KG0pIHsKICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHlNYXRyaWNlcyhtLCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtdWx0aXBseU1hdHJpY2VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtdWx0aXBseU1hdHJpY2VzKGEsIGIpIHsKICAgICAgdmFyIGFlID0gYS5lbGVtZW50czsKICAgICAgdmFyIGJlID0gYi5lbGVtZW50czsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIGExMSA9IGFlWzBdOwogICAgICB2YXIgYTEyID0gYWVbM107CiAgICAgIHZhciBhMTMgPSBhZVs2XTsKICAgICAgdmFyIGEyMSA9IGFlWzFdOwogICAgICB2YXIgYTIyID0gYWVbNF07CiAgICAgIHZhciBhMjMgPSBhZVs3XTsKICAgICAgdmFyIGEzMSA9IGFlWzJdOwogICAgICB2YXIgYTMyID0gYWVbNV07CiAgICAgIHZhciBhMzMgPSBhZVs4XTsKICAgICAgdmFyIGIxMSA9IGJlWzBdOwogICAgICB2YXIgYjEyID0gYmVbM107CiAgICAgIHZhciBiMTMgPSBiZVs2XTsKICAgICAgdmFyIGIyMSA9IGJlWzFdOwogICAgICB2YXIgYjIyID0gYmVbNF07CiAgICAgIHZhciBiMjMgPSBiZVs3XTsKICAgICAgdmFyIGIzMSA9IGJlWzJdOwogICAgICB2YXIgYjMyID0gYmVbNV07CiAgICAgIHZhciBiMzMgPSBiZVs4XTsKICAgICAgdGVbMF0gPSBhMTEgKiBiMTEgKyBhMTIgKiBiMjEgKyBhMTMgKiBiMzE7CiAgICAgIHRlWzNdID0gYTExICogYjEyICsgYTEyICogYjIyICsgYTEzICogYjMyOwogICAgICB0ZVs2XSA9IGExMSAqIGIxMyArIGExMiAqIGIyMyArIGExMyAqIGIzMzsKICAgICAgdGVbMV0gPSBhMjEgKiBiMTEgKyBhMjIgKiBiMjEgKyBhMjMgKiBiMzE7CiAgICAgIHRlWzRdID0gYTIxICogYjEyICsgYTIyICogYjIyICsgYTIzICogYjMyOwogICAgICB0ZVs3XSA9IGEyMSAqIGIxMyArIGEyMiAqIGIyMyArIGEyMyAqIGIzMzsKICAgICAgdGVbMl0gPSBhMzEgKiBiMTEgKyBhMzIgKiBiMjEgKyBhMzMgKiBiMzE7CiAgICAgIHRlWzVdID0gYTMxICogYjEyICsgYTMyICogYjIyICsgYTMzICogYjMyOwogICAgICB0ZVs4XSA9IGEzMSAqIGIxMyArIGEzMiAqIGIyMyArIGEzMyAqIGIzMzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibXVsdGlwbHlTY2FsYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG11bHRpcGx5U2NhbGFyKHMpIHsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdGVbMF0gKj0gczsKICAgICAgdGVbM10gKj0gczsKICAgICAgdGVbNl0gKj0gczsKICAgICAgdGVbMV0gKj0gczsKICAgICAgdGVbNF0gKj0gczsKICAgICAgdGVbN10gKj0gczsKICAgICAgdGVbMl0gKj0gczsKICAgICAgdGVbNV0gKj0gczsKICAgICAgdGVbOF0gKj0gczsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGV0ZXJtaW5hbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRldGVybWluYW50KCkgewogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB2YXIgYSA9IHRlWzBdOwogICAgICB2YXIgYiA9IHRlWzFdOwogICAgICB2YXIgYyA9IHRlWzJdOwogICAgICB2YXIgZCA9IHRlWzNdOwogICAgICB2YXIgZSA9IHRlWzRdOwogICAgICB2YXIgZiA9IHRlWzVdOwogICAgICB2YXIgZyA9IHRlWzZdOwogICAgICB2YXIgaCA9IHRlWzddOwogICAgICB2YXIgaSA9IHRlWzhdOwogICAgICByZXR1cm4gYSAqIGUgKiBpIC0gYSAqIGYgKiBoIC0gYiAqIGQgKiBpICsgYiAqIGYgKiBnICsgYyAqIGQgKiBoIC0gYyAqIGUgKiBnOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEludmVyc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEludmVyc2UobWF0cml4LCB0aHJvd09uRGVnZW5lcmF0ZSkgewogICAgICBpZiAobWF0cml4ICYmIG1hdHJpeC5pc01hdHJpeDQpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdUSFJFRS5NYXRyaXgzOiAuZ2V0SW52ZXJzZSgpIG5vIGxvbmdlciB0YWtlcyBhIE1hdHJpeDQgYXJndW1lbnQuJyk7CiAgICAgIH0KCiAgICAgIHZhciBtZSA9IG1hdHJpeC5lbGVtZW50czsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIG4xMSA9IG1lWzBdOwogICAgICB2YXIgbjIxID0gbWVbMV07CiAgICAgIHZhciBuMzEgPSBtZVsyXTsKICAgICAgdmFyIG4xMiA9IG1lWzNdOwogICAgICB2YXIgbjIyID0gbWVbNF07CiAgICAgIHZhciBuMzIgPSBtZVs1XTsKICAgICAgdmFyIG4xMyA9IG1lWzZdOwogICAgICB2YXIgbjIzID0gbWVbN107CiAgICAgIHZhciBuMzMgPSBtZVs4XTsKICAgICAgdmFyIHQxMSA9IG4zMyAqIG4yMiAtIG4zMiAqIG4yMzsKICAgICAgdmFyIHQxMiA9IG4zMiAqIG4xMyAtIG4zMyAqIG4xMjsKICAgICAgdmFyIHQxMyA9IG4yMyAqIG4xMiAtIG4yMiAqIG4xMzsKICAgICAgdmFyIGRldCA9IG4xMSAqIHQxMSArIG4yMSAqIHQxMiArIG4zMSAqIHQxMzsKCiAgICAgIGlmIChkZXQgPT09IDApIHsKICAgICAgICB2YXIgbXNnID0gIlRIUkVFLk1hdHJpeDM6IC5nZXRJbnZlcnNlKCkgY2FuJ3QgaW52ZXJ0IG1hdHJpeCwgZGV0ZXJtaW5hbnQgaXMgMCI7CgogICAgICAgIGlmICh0aHJvd09uRGVnZW5lcmF0ZSA9PT0gdHJ1ZSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUud2Fybihtc2cpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXMuaWRlbnRpdHkoKTsKICAgICAgfQoKICAgICAgdmFyIGRldEludiA9IDEgLyBkZXQ7CiAgICAgIHRlWzBdID0gdDExICogZGV0SW52OwogICAgICB0ZVsxXSA9IChuMzEgKiBuMjMgLSBuMzMgKiBuMjEpICogZGV0SW52OwogICAgICB0ZVsyXSA9IChuMzIgKiBuMjEgLSBuMzEgKiBuMjIpICogZGV0SW52OwogICAgICB0ZVszXSA9IHQxMiAqIGRldEludjsKICAgICAgdGVbNF0gPSAobjMzICogbjExIC0gbjMxICogbjEzKSAqIGRldEludjsKICAgICAgdGVbNV0gPSAobjMxICogbjEyIC0gbjMyICogbjExKSAqIGRldEludjsKICAgICAgdGVbNl0gPSB0MTMgKiBkZXRJbnY7CiAgICAgIHRlWzddID0gKG4yMSAqIG4xMyAtIG4yMyAqIG4xMSkgKiBkZXRJbnY7CiAgICAgIHRlWzhdID0gKG4yMiAqIG4xMSAtIG4yMSAqIG4xMikgKiBkZXRJbnY7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInRyYW5zcG9zZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdHJhbnNwb3NlKCkgewogICAgICB2YXIgdG1wOwogICAgICB2YXIgbSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIHRtcCA9IG1bMV07CiAgICAgIG1bMV0gPSBtWzNdOwogICAgICBtWzNdID0gdG1wOwogICAgICB0bXAgPSBtWzJdOwogICAgICBtWzJdID0gbVs2XTsKICAgICAgbVs2XSA9IHRtcDsKICAgICAgdG1wID0gbVs1XTsKICAgICAgbVs1XSA9IG1bN107CiAgICAgIG1bN10gPSB0bXA7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImdldE5vcm1hbE1hdHJpeCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Tm9ybWFsTWF0cml4KG1hdHJpeDQpIHsKICAgICAgcmV0dXJuIHRoaXMuc2V0RnJvbU1hdHJpeDQobWF0cml4NCkuZ2V0SW52ZXJzZSh0aGlzKS50cmFuc3Bvc2UoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0cmFuc3Bvc2VJbnRvQXJyYXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRyYW5zcG9zZUludG9BcnJheShyKSB7CiAgICAgIHZhciBtID0gdGhpcy5lbGVtZW50czsKICAgICAgclswXSA9IG1bMF07CiAgICAgIHJbMV0gPSBtWzNdOwogICAgICByWzJdID0gbVs2XTsKICAgICAgclszXSA9IG1bMV07CiAgICAgIHJbNF0gPSBtWzRdOwogICAgICByWzVdID0gbVs3XTsKICAgICAgcls2XSA9IG1bMl07CiAgICAgIHJbN10gPSBtWzVdOwogICAgICByWzhdID0gbVs4XTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0VXZUcmFuc2Zvcm0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFV2VHJhbnNmb3JtKHR4LCB0eSwgc3gsIHN5LCByb3RhdGlvbiwgY3gsIGN5KSB7CiAgICAgIHZhciBjID0gTWF0aC5jb3Mocm90YXRpb24pOwogICAgICB2YXIgcyA9IE1hdGguc2luKHJvdGF0aW9uKTsKICAgICAgdGhpcy5zZXQoc3ggKiBjLCBzeCAqIHMsIC1zeCAqIChjICogY3ggKyBzICogY3kpICsgY3ggKyB0eCwgLXN5ICogcywgc3kgKiBjLCAtc3kgKiAoLXMgKiBjeCArIGMgKiBjeSkgKyBjeSArIHR5LCAwLCAwLCAxKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzY2FsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2NhbGUoc3gsIHN5KSB7CiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIHRlWzBdICo9IHN4OwogICAgICB0ZVszXSAqPSBzeDsKICAgICAgdGVbNl0gKj0gc3g7CiAgICAgIHRlWzFdICo9IHN5OwogICAgICB0ZVs0XSAqPSBzeTsKICAgICAgdGVbN10gKj0gc3k7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInJvdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcm90YXRlKHRoZXRhKSB7CiAgICAgIHZhciBjID0gTWF0aC5jb3ModGhldGEpOwogICAgICB2YXIgcyA9IE1hdGguc2luKHRoZXRhKTsKICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50czsKICAgICAgdmFyIGExMSA9IHRlWzBdOwogICAgICB2YXIgYTEyID0gdGVbM107CiAgICAgIHZhciBhMTMgPSB0ZVs2XTsKICAgICAgdmFyIGEyMSA9IHRlWzFdOwogICAgICB2YXIgYTIyID0gdGVbNF07CiAgICAgIHZhciBhMjMgPSB0ZVs3XTsKICAgICAgdGVbMF0gPSBjICogYTExICsgcyAqIGEyMTsKICAgICAgdGVbM10gPSBjICogYTEyICsgcyAqIGEyMjsKICAgICAgdGVbNl0gPSBjICogYTEzICsgcyAqIGEyMzsKICAgICAgdGVbMV0gPSAtcyAqIGExMSArIGMgKiBhMjE7CiAgICAgIHRlWzRdID0gLXMgKiBhMTIgKyBjICogYTIyOwogICAgICB0ZVs3XSA9IC1zICogYTEzICsgYyAqIGEyMzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAidHJhbnNsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0cmFuc2xhdGUodHgsIHR5KSB7CiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIHRlWzBdICs9IHR4ICogdGVbMl07CiAgICAgIHRlWzNdICs9IHR4ICogdGVbNV07CiAgICAgIHRlWzZdICs9IHR4ICogdGVbOF07CiAgICAgIHRlWzFdICs9IHR5ICogdGVbMl07CiAgICAgIHRlWzRdICs9IHR5ICogdGVbNV07CiAgICAgIHRlWzddICs9IHR5ICogdGVbOF07CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImVxdWFscyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZXF1YWxzKG1hdHJpeCkgewogICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB2YXIgbWUgPSBtYXRyaXguZWxlbWVudHM7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDk7IGkrKykgewogICAgICAgIGlmICh0ZVtpXSAhPT0gbWVbaV0pIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZnJvbUFycmF5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmcm9tQXJyYXkoYXJyYXksIG9mZnNldCkgewogICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDk7IGkrKykgewogICAgICAgIHRoaXMuZWxlbWVudHNbaV0gPSBhcnJheVtpICsgb2Zmc2V0XTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAidG9BcnJheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9BcnJheShhcnJheSwgb2Zmc2V0KSB7CiAgICAgIGlmIChhcnJheSA9PT0gdW5kZWZpbmVkKSBhcnJheSA9IFtdOwogICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7CiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGFycmF5W29mZnNldF0gPSB0ZVswXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgMV0gPSB0ZVsxXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgMl0gPSB0ZVsyXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgM10gPSB0ZVszXTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgNF0gPSB0ZVs0XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgNV0gPSB0ZVs1XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgNl0gPSB0ZVs2XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgN10gPSB0ZVs3XTsKICAgICAgYXJyYXlbb2Zmc2V0ICsgOF0gPSB0ZVs4XTsKICAgICAgcmV0dXJuIGFycmF5OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE1hdHJpeDM7Cn0oKTsKCi8qKgogKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tLwogKi8KCmZ1bmN0aW9uIGFycmF5TWF4KGFycmF5KSB7CiAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIC1JbmZpbml0eTsKICB2YXIgbWF4ID0gYXJyYXlbMF07CgogIGZvciAodmFyIGkgPSAxLCBsID0gYXJyYXkubGVuZ3RoOyBpIDwgbDsgKytpKSB7CiAgICBpZiAoYXJyYXlbaV0gPiBtYXgpIG1heCA9IGFycmF5W2ldOwogIH0KCiAgcmV0dXJuIG1heDsKfQoKdmFyIGFycmF5V2l0aG91dEhvbGVzID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkgewogIGZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnJheUxpa2VUb0FycmF5KGFycik7CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IF9hcnJheVdpdGhvdXRIb2xlcywgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKfSk7CnVud3JhcEV4cG9ydHMoYXJyYXlXaXRob3V0SG9sZXMpOwoKdmFyIGl0ZXJhYmxlVG9BcnJheSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICBmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsKICAgIGlmICh0eXBlb2YgU3ltYm9sICE9PSAidW5kZWZpbmVkIiAmJiBpdGVyW1N5bWJvbC5pdGVyYXRvcl0gIT0gbnVsbCB8fCBpdGVyWyJAQGl0ZXJhdG9yIl0gIT0gbnVsbCkgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IF9pdGVyYWJsZVRvQXJyYXksIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp1bndyYXBFeHBvcnRzKGl0ZXJhYmxlVG9BcnJheSk7Cgp2YXIgbm9uSXRlcmFibGVTcHJlYWQgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7CiAgZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IF9ub25JdGVyYWJsZVNwcmVhZCwgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKfSk7CnVud3JhcEV4cG9ydHMobm9uSXRlcmFibGVTcHJlYWQpOwoKdmFyIHRvQ29uc3VtYWJsZUFycmF5ID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkgewogIGZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsKICAgIHJldHVybiBhcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IGl0ZXJhYmxlVG9BcnJheShhcnIpIHx8IHVuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgbm9uSXRlcmFibGVTcHJlYWQoKTsKICB9CgogIG1vZHVsZS5leHBvcnRzID0gX3RvQ29uc3VtYWJsZUFycmF5LCBtb2R1bGUuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZSwgbW9kdWxlLmV4cG9ydHNbImRlZmF1bHQiXSA9IG1vZHVsZS5leHBvcnRzOwp9KTsKdmFyIF90b0NvbnN1bWFibGVBcnJheSA9IHVud3JhcEV4cG9ydHModG9Db25zdW1hYmxlQXJyYXkpOwoKdmFyIGRlZmluZVByb3BlcnR5ID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkgewogIGZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICAgIGlmIChrZXkgaW4gb2JqKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIG9ialtrZXldID0gdmFsdWU7CiAgICB9CgogICAgcmV0dXJuIG9iajsKICB9CgogIG1vZHVsZS5leHBvcnRzID0gX2RlZmluZVByb3BlcnR5LCBtb2R1bGUuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZSwgbW9kdWxlLmV4cG9ydHNbImRlZmF1bHQiXSA9IG1vZHVsZS5leHBvcnRzOwp9KTsKdW53cmFwRXhwb3J0cyhkZWZpbmVQcm9wZXJ0eSk7Cgp2YXIgX3R5cGVvZl8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkgewogIGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7CiAgICAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOwoKICAgIHJldHVybiAobW9kdWxlLmV4cG9ydHMgPSBfdHlwZW9mID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAob2JqKSB7CiAgICAgIHJldHVybiB0eXBlb2Ygb2JqOwogICAgfSA6IGZ1bmN0aW9uIChvYmopIHsKICAgICAgcmV0dXJuIG9iaiAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOwogICAgfSwgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0cyksIF90eXBlb2Yob2JqKTsKICB9CgogIG1vZHVsZS5leHBvcnRzID0gX3R5cGVvZiwgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKfSk7Cgp2YXIgX3R5cGVvZiA9IHVud3JhcEV4cG9ydHMoX3R5cGVvZl8xKTsKCi8qKgogKiBIZWxwZXJzLgogKi8KdmFyIHMgPSAxMDAwOwp2YXIgbSA9IHMgKiA2MDsKdmFyIGggPSBtICogNjA7CnZhciBkID0gaCAqIDI0Owp2YXIgdyA9IGQgKiA3Owp2YXIgeSA9IGQgKiAzNjUuMjU7Ci8qKgogKiBQYXJzZSBvciBmb3JtYXQgdGhlIGdpdmVuIGB2YWxgLgogKgogKiBPcHRpb25zOgogKgogKiAgLSBgbG9uZ2AgdmVyYm9zZSBmb3JtYXR0aW5nIFtmYWxzZV0KICoKICogQHBhcmFtIHtTdHJpbmd8TnVtYmVyfSB2YWwKICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXQogKiBAdGhyb3dzIHtFcnJvcn0gdGhyb3cgYW4gZXJyb3IgaWYgdmFsIGlzIG5vdCBhIG5vbi1lbXB0eSBzdHJpbmcgb3IgYSBudW1iZXIKICogQHJldHVybiB7U3RyaW5nfE51bWJlcn0KICogQGFwaSBwdWJsaWMKICovCgp2YXIgbXMgPSBmdW5jdGlvbiBtcyh2YWwsIG9wdGlvbnMpIHsKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgdmFyIHR5cGUgPSBfdHlwZW9mKHZhbCk7CgogIGlmICh0eXBlID09PSAnc3RyaW5nJyAmJiB2YWwubGVuZ3RoID4gMCkgewogICAgcmV0dXJuIHBhcnNlKHZhbCk7CiAgfSBlbHNlIGlmICh0eXBlID09PSAnbnVtYmVyJyAmJiBpc0Zpbml0ZSh2YWwpKSB7CiAgICByZXR1cm4gb3B0aW9uc1sibG9uZyJdID8gZm10TG9uZyh2YWwpIDogZm10U2hvcnQodmFsKTsKICB9CgogIHRocm93IG5ldyBFcnJvcigndmFsIGlzIG5vdCBhIG5vbi1lbXB0eSBzdHJpbmcgb3IgYSB2YWxpZCBudW1iZXIuIHZhbD0nICsgSlNPTi5zdHJpbmdpZnkodmFsKSk7Cn07Ci8qKgogKiBQYXJzZSB0aGUgZ2l2ZW4gYHN0cmAgYW5kIHJldHVybiBtaWxsaXNlY29uZHMuCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIKICogQHJldHVybiB7TnVtYmVyfQogKiBAYXBpIHByaXZhdGUKICovCgoKZnVuY3Rpb24gcGFyc2Uoc3RyKSB7CiAgc3RyID0gU3RyaW5nKHN0cik7CgogIGlmIChzdHIubGVuZ3RoID4gMTAwKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgbWF0Y2ggPSAvXigtPyg/OlxkKyk/XC4/XGQrKSAqKG1pbGxpc2Vjb25kcz98bXNlY3M/fG1zfHNlY29uZHM/fHNlY3M/fHN8bWludXRlcz98bWlucz98bXxob3Vycz98aHJzP3xofGRheXM/fGR8d2Vla3M/fHd8eWVhcnM/fHlycz98eSk/JC9pLmV4ZWMoc3RyKTsKCiAgaWYgKCFtYXRjaCkgewogICAgcmV0dXJuOwogIH0KCiAgdmFyIG4gPSBwYXJzZUZsb2F0KG1hdGNoWzFdKTsKICB2YXIgdHlwZSA9IChtYXRjaFsyXSB8fCAnbXMnKS50b0xvd2VyQ2FzZSgpOwoKICBzd2l0Y2ggKHR5cGUpIHsKICAgIGNhc2UgJ3llYXJzJzoKICAgIGNhc2UgJ3llYXInOgogICAgY2FzZSAneXJzJzoKICAgIGNhc2UgJ3lyJzoKICAgIGNhc2UgJ3knOgogICAgICByZXR1cm4gbiAqIHk7CgogICAgY2FzZSAnd2Vla3MnOgogICAgY2FzZSAnd2Vlayc6CiAgICBjYXNlICd3JzoKICAgICAgcmV0dXJuIG4gKiB3OwoKICAgIGNhc2UgJ2RheXMnOgogICAgY2FzZSAnZGF5JzoKICAgIGNhc2UgJ2QnOgogICAgICByZXR1cm4gbiAqIGQ7CgogICAgY2FzZSAnaG91cnMnOgogICAgY2FzZSAnaG91cic6CiAgICBjYXNlICdocnMnOgogICAgY2FzZSAnaHInOgogICAgY2FzZSAnaCc6CiAgICAgIHJldHVybiBuICogaDsKCiAgICBjYXNlICdtaW51dGVzJzoKICAgIGNhc2UgJ21pbnV0ZSc6CiAgICBjYXNlICdtaW5zJzoKICAgIGNhc2UgJ21pbic6CiAgICBjYXNlICdtJzoKICAgICAgcmV0dXJuIG4gKiBtOwoKICAgIGNhc2UgJ3NlY29uZHMnOgogICAgY2FzZSAnc2Vjb25kJzoKICAgIGNhc2UgJ3NlY3MnOgogICAgY2FzZSAnc2VjJzoKICAgIGNhc2UgJ3MnOgogICAgICByZXR1cm4gbiAqIHM7CgogICAgY2FzZSAnbWlsbGlzZWNvbmRzJzoKICAgIGNhc2UgJ21pbGxpc2Vjb25kJzoKICAgIGNhc2UgJ21zZWNzJzoKICAgIGNhc2UgJ21zZWMnOgogICAgY2FzZSAnbXMnOgogICAgICByZXR1cm4gbjsKCiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KfQovKioKICogU2hvcnQgZm9ybWF0IGZvciBgbXNgLgogKgogKiBAcGFyYW0ge051bWJlcn0gbXMKICogQHJldHVybiB7U3RyaW5nfQogKiBAYXBpIHByaXZhdGUKICovCgoKZnVuY3Rpb24gZm10U2hvcnQobXMpIHsKICB2YXIgbXNBYnMgPSBNYXRoLmFicyhtcyk7CgogIGlmIChtc0FicyA+PSBkKSB7CiAgICByZXR1cm4gTWF0aC5yb3VuZChtcyAvIGQpICsgJ2QnOwogIH0KCiAgaWYgKG1zQWJzID49IGgpIHsKICAgIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gaCkgKyAnaCc7CiAgfQoKICBpZiAobXNBYnMgPj0gbSkgewogICAgcmV0dXJuIE1hdGgucm91bmQobXMgLyBtKSArICdtJzsKICB9CgogIGlmIChtc0FicyA+PSBzKSB7CiAgICByZXR1cm4gTWF0aC5yb3VuZChtcyAvIHMpICsgJ3MnOwogIH0KCiAgcmV0dXJuIG1zICsgJ21zJzsKfQovKioKICogTG9uZyBmb3JtYXQgZm9yIGBtc2AuCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBtcwogKiBAcmV0dXJuIHtTdHJpbmd9CiAqIEBhcGkgcHJpdmF0ZQogKi8KCgpmdW5jdGlvbiBmbXRMb25nKG1zKSB7CiAgdmFyIG1zQWJzID0gTWF0aC5hYnMobXMpOwoKICBpZiAobXNBYnMgPj0gZCkgewogICAgcmV0dXJuIHBsdXJhbChtcywgbXNBYnMsIGQsICdkYXknKTsKICB9CgogIGlmIChtc0FicyA+PSBoKSB7CiAgICByZXR1cm4gcGx1cmFsKG1zLCBtc0FicywgaCwgJ2hvdXInKTsKICB9CgogIGlmIChtc0FicyA+PSBtKSB7CiAgICByZXR1cm4gcGx1cmFsKG1zLCBtc0FicywgbSwgJ21pbnV0ZScpOwogIH0KCiAgaWYgKG1zQWJzID49IHMpIHsKICAgIHJldHVybiBwbHVyYWwobXMsIG1zQWJzLCBzLCAnc2Vjb25kJyk7CiAgfQoKICByZXR1cm4gbXMgKyAnIG1zJzsKfQovKioKICogUGx1cmFsaXphdGlvbiBoZWxwZXIuCiAqLwoKCmZ1bmN0aW9uIHBsdXJhbChtcywgbXNBYnMsIG4sIG5hbWUpIHsKICB2YXIgaXNQbHVyYWwgPSBtc0FicyA+PSBuICogMS41OwogIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gbikgKyAnICcgKyBuYW1lICsgKGlzUGx1cmFsID8gJ3MnIDogJycpOwp9CgovKioKICogVGhpcyBpcyB0aGUgY29tbW9uIGxvZ2ljIGZvciBib3RoIHRoZSBOb2RlLmpzIGFuZCB3ZWIgYnJvd3NlcgogKiBpbXBsZW1lbnRhdGlvbnMgb2YgYGRlYnVnKClgLgogKi8KCmZ1bmN0aW9uIHNldHVwKGVudikgewogIGNyZWF0ZURlYnVnLmRlYnVnID0gY3JlYXRlRGVidWc7CiAgY3JlYXRlRGVidWdbImRlZmF1bHQiXSA9IGNyZWF0ZURlYnVnOwogIGNyZWF0ZURlYnVnLmNvZXJjZSA9IGNvZXJjZTsKICBjcmVhdGVEZWJ1Zy5kaXNhYmxlID0gZGlzYWJsZTsKICBjcmVhdGVEZWJ1Zy5lbmFibGUgPSBlbmFibGU7CiAgY3JlYXRlRGVidWcuZW5hYmxlZCA9IGVuYWJsZWQ7CiAgY3JlYXRlRGVidWcuaHVtYW5pemUgPSBtczsKICBjcmVhdGVEZWJ1Zy5kZXN0cm95ID0gZGVzdHJveTsKICBPYmplY3Qua2V5cyhlbnYpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgY3JlYXRlRGVidWdba2V5XSA9IGVudltrZXldOwogIH0pOwogIC8qKgogICogVGhlIGN1cnJlbnRseSBhY3RpdmUgZGVidWcgbW9kZSBuYW1lcywgYW5kIG5hbWVzIHRvIHNraXAuCiAgKi8KCiAgY3JlYXRlRGVidWcubmFtZXMgPSBbXTsKICBjcmVhdGVEZWJ1Zy5za2lwcyA9IFtdOwogIC8qKgogICogTWFwIG9mIHNwZWNpYWwgIiVuIiBoYW5kbGluZyBmdW5jdGlvbnMsIGZvciB0aGUgZGVidWcgImZvcm1hdCIgYXJndW1lbnQuCiAgKgogICogVmFsaWQga2V5IG5hbWVzIGFyZSBhIHNpbmdsZSwgbG93ZXIgb3IgdXBwZXItY2FzZSBsZXR0ZXIsIGkuZS4gIm4iIGFuZCAiTiIuCiAgKi8KCiAgY3JlYXRlRGVidWcuZm9ybWF0dGVycyA9IHt9OwogIC8qKgogICogU2VsZWN0cyBhIGNvbG9yIGZvciBhIGRlYnVnIG5hbWVzcGFjZQogICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIHN0cmluZyBmb3IgdGhlIGRlYnVnIGluc3RhbmNlIHRvIGJlIGNvbG9yZWQKICAqIEByZXR1cm4ge051bWJlcnxTdHJpbmd9IEFuIEFOU0kgY29sb3IgY29kZSBmb3IgdGhlIGdpdmVuIG5hbWVzcGFjZQogICogQGFwaSBwcml2YXRlCiAgKi8KCiAgZnVuY3Rpb24gc2VsZWN0Q29sb3IobmFtZXNwYWNlKSB7CiAgICB2YXIgaGFzaCA9IDA7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuYW1lc3BhY2UubGVuZ3RoOyBpKyspIHsKICAgICAgaGFzaCA9IChoYXNoIDw8IDUpIC0gaGFzaCArIG5hbWVzcGFjZS5jaGFyQ29kZUF0KGkpOwogICAgICBoYXNoIHw9IDA7IC8vIENvbnZlcnQgdG8gMzJiaXQgaW50ZWdlcgogICAgfQoKICAgIHJldHVybiBjcmVhdGVEZWJ1Zy5jb2xvcnNbTWF0aC5hYnMoaGFzaCkgJSBjcmVhdGVEZWJ1Zy5jb2xvcnMubGVuZ3RoXTsKICB9CgogIGNyZWF0ZURlYnVnLnNlbGVjdENvbG9yID0gc2VsZWN0Q29sb3I7CiAgLyoqCiAgKiBDcmVhdGUgYSBkZWJ1Z2dlciB3aXRoIHRoZSBnaXZlbiBgbmFtZXNwYWNlYC4KICAqCiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlCiAgKiBAcmV0dXJuIHtGdW5jdGlvbn0KICAqIEBhcGkgcHVibGljCiAgKi8KCiAgZnVuY3Rpb24gY3JlYXRlRGVidWcobmFtZXNwYWNlKSB7CiAgICB2YXIgcHJldlRpbWU7CiAgICB2YXIgZW5hYmxlT3ZlcnJpZGUgPSBudWxsOwogICAgdmFyIG5hbWVzcGFjZXNDYWNoZTsKICAgIHZhciBlbmFibGVkQ2FjaGU7CgogICAgZnVuY3Rpb24gZGVidWcoKSB7CiAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICAgIH0KCiAgICAgIC8vIERpc2FibGVkPwogICAgICBpZiAoIWRlYnVnLmVuYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBzZWxmID0gZGVidWc7IC8vIFNldCBgZGlmZmAgdGltZXN0YW1wCgogICAgICB2YXIgY3VyciA9IE51bWJlcihuZXcgRGF0ZSgpKTsKICAgICAgdmFyIG1zID0gY3VyciAtIChwcmV2VGltZSB8fCBjdXJyKTsKICAgICAgc2VsZi5kaWZmID0gbXM7CiAgICAgIHNlbGYucHJldiA9IHByZXZUaW1lOwogICAgICBzZWxmLmN1cnIgPSBjdXJyOwogICAgICBwcmV2VGltZSA9IGN1cnI7CiAgICAgIGFyZ3NbMF0gPSBjcmVhdGVEZWJ1Zy5jb2VyY2UoYXJnc1swXSk7CgogICAgICBpZiAodHlwZW9mIGFyZ3NbMF0gIT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy8gQW55dGhpbmcgZWxzZSBsZXQncyBpbnNwZWN0IHdpdGggJU8KICAgICAgICBhcmdzLnVuc2hpZnQoJyVPJyk7CiAgICAgIH0gLy8gQXBwbHkgYW55IGBmb3JtYXR0ZXJzYCB0cmFuc2Zvcm1hdGlvbnMKCgogICAgICB2YXIgaW5kZXggPSAwOwogICAgICBhcmdzWzBdID0gYXJnc1swXS5yZXBsYWNlKC8lKFthLXpBLVolXSkvZywgZnVuY3Rpb24gKG1hdGNoLCBmb3JtYXQpIHsKICAgICAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgYW4gZXNjYXBlZCAlIHRoZW4gZG9uJ3QgaW5jcmVhc2UgdGhlIGFycmF5IGluZGV4CiAgICAgICAgaWYgKG1hdGNoID09PSAnJSUnKSB7CiAgICAgICAgICByZXR1cm4gJyUnOwogICAgICAgIH0KCiAgICAgICAgaW5kZXgrKzsKICAgICAgICB2YXIgZm9ybWF0dGVyID0gY3JlYXRlRGVidWcuZm9ybWF0dGVyc1tmb3JtYXRdOwoKICAgICAgICBpZiAodHlwZW9mIGZvcm1hdHRlciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgdmFyIHZhbCA9IGFyZ3NbaW5kZXhdOwogICAgICAgICAgbWF0Y2ggPSBmb3JtYXR0ZXIuY2FsbChzZWxmLCB2YWwpOyAvLyBOb3cgd2UgbmVlZCB0byByZW1vdmUgYGFyZ3NbaW5kZXhdYCBzaW5jZSBpdCdzIGlubGluZWQgaW4gdGhlIGBmb3JtYXRgCgogICAgICAgICAgYXJncy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgaW5kZXgtLTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBtYXRjaDsKICAgICAgfSk7IC8vIEFwcGx5IGVudi1zcGVjaWZpYyBmb3JtYXR0aW5nIChjb2xvcnMsIGV0Yy4pCgogICAgICBjcmVhdGVEZWJ1Zy5mb3JtYXRBcmdzLmNhbGwoc2VsZiwgYXJncyk7CiAgICAgIHZhciBsb2dGbiA9IHNlbGYubG9nIHx8IGNyZWF0ZURlYnVnLmxvZzsKICAgICAgbG9nRm4uYXBwbHkoc2VsZiwgYXJncyk7CiAgICB9CgogICAgZGVidWcubmFtZXNwYWNlID0gbmFtZXNwYWNlOwogICAgZGVidWcudXNlQ29sb3JzID0gY3JlYXRlRGVidWcudXNlQ29sb3JzKCk7CiAgICBkZWJ1Zy5jb2xvciA9IGNyZWF0ZURlYnVnLnNlbGVjdENvbG9yKG5hbWVzcGFjZSk7CiAgICBkZWJ1Zy5leHRlbmQgPSBleHRlbmQ7CiAgICBkZWJ1Zy5kZXN0cm95ID0gY3JlYXRlRGVidWcuZGVzdHJveTsgLy8gWFhYIFRlbXBvcmFyeS4gV2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UuCgogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRlYnVnLCAnZW5hYmxlZCcsIHsKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgaWYgKGVuYWJsZU92ZXJyaWRlICE9PSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gZW5hYmxlT3ZlcnJpZGU7CiAgICAgICAgfQoKICAgICAgICBpZiAobmFtZXNwYWNlc0NhY2hlICE9PSBjcmVhdGVEZWJ1Zy5uYW1lc3BhY2VzKSB7CiAgICAgICAgICBuYW1lc3BhY2VzQ2FjaGUgPSBjcmVhdGVEZWJ1Zy5uYW1lc3BhY2VzOwogICAgICAgICAgZW5hYmxlZENhY2hlID0gY3JlYXRlRGVidWcuZW5hYmxlZChuYW1lc3BhY2UpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGVuYWJsZWRDYWNoZTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodikgewogICAgICAgIGVuYWJsZU92ZXJyaWRlID0gdjsKICAgICAgfQogICAgfSk7IC8vIEVudi1zcGVjaWZpYyBpbml0aWFsaXphdGlvbiBsb2dpYyBmb3IgZGVidWcgaW5zdGFuY2VzCgogICAgaWYgKHR5cGVvZiBjcmVhdGVEZWJ1Zy5pbml0ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGNyZWF0ZURlYnVnLmluaXQoZGVidWcpOwogICAgfQoKICAgIHJldHVybiBkZWJ1ZzsKICB9CgogIGZ1bmN0aW9uIGV4dGVuZChuYW1lc3BhY2UsIGRlbGltaXRlcikgewogICAgdmFyIG5ld0RlYnVnID0gY3JlYXRlRGVidWcodGhpcy5uYW1lc3BhY2UgKyAodHlwZW9mIGRlbGltaXRlciA9PT0gJ3VuZGVmaW5lZCcgPyAnOicgOiBkZWxpbWl0ZXIpICsgbmFtZXNwYWNlKTsKICAgIG5ld0RlYnVnLmxvZyA9IHRoaXMubG9nOwogICAgcmV0dXJuIG5ld0RlYnVnOwogIH0KICAvKioKICAqIEVuYWJsZXMgYSBkZWJ1ZyBtb2RlIGJ5IG5hbWVzcGFjZXMuIFRoaXMgY2FuIGluY2x1ZGUgbW9kZXMKICAqIHNlcGFyYXRlZCBieSBhIGNvbG9uIGFuZCB3aWxkY2FyZHMuCiAgKgogICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZXMKICAqIEBhcGkgcHVibGljCiAgKi8KCgogIGZ1bmN0aW9uIGVuYWJsZShuYW1lc3BhY2VzKSB7CiAgICBjcmVhdGVEZWJ1Zy5zYXZlKG5hbWVzcGFjZXMpOwogICAgY3JlYXRlRGVidWcubmFtZXNwYWNlcyA9IG5hbWVzcGFjZXM7CiAgICBjcmVhdGVEZWJ1Zy5uYW1lcyA9IFtdOwogICAgY3JlYXRlRGVidWcuc2tpcHMgPSBbXTsKICAgIHZhciBpOwogICAgdmFyIHNwbGl0ID0gKHR5cGVvZiBuYW1lc3BhY2VzID09PSAnc3RyaW5nJyA/IG5hbWVzcGFjZXMgOiAnJykuc3BsaXQoL1tccyxdKy8pOwogICAgdmFyIGxlbiA9IHNwbGl0Lmxlbmd0aDsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgaWYgKCFzcGxpdFtpXSkgewogICAgICAgIC8vIGlnbm9yZSBlbXB0eSBzdHJpbmdzCiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIG5hbWVzcGFjZXMgPSBzcGxpdFtpXS5yZXBsYWNlKC9cKi9nLCAnLio/Jyk7CgogICAgICBpZiAobmFtZXNwYWNlc1swXSA9PT0gJy0nKSB7CiAgICAgICAgY3JlYXRlRGVidWcuc2tpcHMucHVzaChuZXcgUmVnRXhwKCdeJyArIG5hbWVzcGFjZXMuc2xpY2UoMSkgKyAnJCcpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjcmVhdGVEZWJ1Zy5uYW1lcy5wdXNoKG5ldyBSZWdFeHAoJ14nICsgbmFtZXNwYWNlcyArICckJykpOwogICAgICB9CiAgICB9CiAgfQogIC8qKgogICogRGlzYWJsZSBkZWJ1ZyBvdXRwdXQuCiAgKgogICogQHJldHVybiB7U3RyaW5nfSBuYW1lc3BhY2VzCiAgKiBAYXBpIHB1YmxpYwogICovCgoKICBmdW5jdGlvbiBkaXNhYmxlKCkgewogICAgdmFyIG5hbWVzcGFjZXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGNyZWF0ZURlYnVnLm5hbWVzLm1hcCh0b05hbWVzcGFjZSkpLCBfdG9Db25zdW1hYmxlQXJyYXkoY3JlYXRlRGVidWcuc2tpcHMubWFwKHRvTmFtZXNwYWNlKS5tYXAoZnVuY3Rpb24gKG5hbWVzcGFjZSkgewogICAgICByZXR1cm4gJy0nICsgbmFtZXNwYWNlOwogICAgfSkpKS5qb2luKCcsJyk7CiAgICBjcmVhdGVEZWJ1Zy5lbmFibGUoJycpOwogICAgcmV0dXJuIG5hbWVzcGFjZXM7CiAgfQogIC8qKgogICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBtb2RlIG5hbWUgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLgogICoKICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lCiAgKiBAcmV0dXJuIHtCb29sZWFufQogICogQGFwaSBwdWJsaWMKICAqLwoKCiAgZnVuY3Rpb24gZW5hYmxlZChuYW1lKSB7CiAgICBpZiAobmFtZVtuYW1lLmxlbmd0aCAtIDFdID09PSAnKicpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgdmFyIGk7CiAgICB2YXIgbGVuOwoKICAgIGZvciAoaSA9IDAsIGxlbiA9IGNyZWF0ZURlYnVnLnNraXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIGlmIChjcmVhdGVEZWJ1Zy5za2lwc1tpXS50ZXN0KG5hbWUpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgZm9yIChpID0gMCwgbGVuID0gY3JlYXRlRGVidWcubmFtZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgaWYgKGNyZWF0ZURlYnVnLm5hbWVzW2ldLnRlc3QobmFtZSkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9CiAgLyoqCiAgKiBDb252ZXJ0IHJlZ2V4cCB0byBuYW1lc3BhY2UKICAqCiAgKiBAcGFyYW0ge1JlZ0V4cH0gcmVneGVwCiAgKiBAcmV0dXJuIHtTdHJpbmd9IG5hbWVzcGFjZQogICogQGFwaSBwcml2YXRlCiAgKi8KCgogIGZ1bmN0aW9uIHRvTmFtZXNwYWNlKHJlZ2V4cCkgewogICAgcmV0dXJuIHJlZ2V4cC50b1N0cmluZygpLnN1YnN0cmluZygyLCByZWdleHAudG9TdHJpbmcoKS5sZW5ndGggLSAyKS5yZXBsYWNlKC9cLlwqXD8kLywgJyonKTsKICB9CiAgLyoqCiAgKiBDb2VyY2UgYHZhbGAuCiAgKgogICogQHBhcmFtIHtNaXhlZH0gdmFsCiAgKiBAcmV0dXJuIHtNaXhlZH0KICAqIEBhcGkgcHJpdmF0ZQogICovCgoKICBmdW5jdGlvbiBjb2VyY2UodmFsKSB7CiAgICBpZiAodmFsIGluc3RhbmNlb2YgRXJyb3IpIHsKICAgICAgcmV0dXJuIHZhbC5zdGFjayB8fCB2YWwubWVzc2FnZTsKICAgIH0KCiAgICByZXR1cm4gdmFsOwogIH0KICAvKioKICAqIFhYWCBETyBOT1QgVVNFLiBUaGlzIGlzIGEgdGVtcG9yYXJ5IHN0dWIgZnVuY3Rpb24uCiAgKiBYWFggSXQgV0lMTCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UuCiAgKi8KCgogIGZ1bmN0aW9uIGRlc3Ryb3koKSB7CiAgICBjb25zb2xlLndhcm4oJ0luc3RhbmNlIG1ldGhvZCBgZGVidWcuZGVzdHJveSgpYCBpcyBkZXByZWNhdGVkIGFuZCBubyBsb25nZXIgZG9lcyBhbnl0aGluZy4gSXQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHZlcnNpb24gb2YgYGRlYnVnYC4nKTsKICB9CgogIGNyZWF0ZURlYnVnLmVuYWJsZShjcmVhdGVEZWJ1Zy5sb2FkKCkpOwogIHJldHVybiBjcmVhdGVEZWJ1ZzsKfQoKdmFyIGNvbW1vbiA9IHNldHVwOwoKdmFyIGJyb3dzZXIgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7CiAgLyogZXNsaW50LWVudiBicm93c2VyICovCgogIC8qKgogICAqIFRoaXMgaXMgdGhlIHdlYiBicm93c2VyIGltcGxlbWVudGF0aW9uIG9mIGBkZWJ1ZygpYC4KICAgKi8KICBleHBvcnRzLmZvcm1hdEFyZ3MgPSBmb3JtYXRBcmdzOwogIGV4cG9ydHMuc2F2ZSA9IHNhdmU7CiAgZXhwb3J0cy5sb2FkID0gbG9hZDsKICBleHBvcnRzLnVzZUNvbG9ycyA9IHVzZUNvbG9yczsKICBleHBvcnRzLnN0b3JhZ2UgPSBsb2NhbHN0b3JhZ2UoKTsKCiAgZXhwb3J0cy5kZXN0cm95ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHdhcm5lZCA9IGZhbHNlOwogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF3YXJuZWQpIHsKICAgICAgICB3YXJuZWQgPSB0cnVlOwogICAgICAgIGNvbnNvbGUud2FybignSW5zdGFuY2UgbWV0aG9kIGBkZWJ1Zy5kZXN0cm95KClgIGlzIGRlcHJlY2F0ZWQgYW5kIG5vIGxvbmdlciBkb2VzIGFueXRoaW5nLiBJdCB3aWxsIGJlIHJlbW92ZWQgaW4gdGhlIG5leHQgbWFqb3IgdmVyc2lvbiBvZiBgZGVidWdgLicpOwogICAgICB9CiAgICB9OwogIH0oKTsKICAvKioKICAgKiBDb2xvcnMuCiAgICovCgoKICBleHBvcnRzLmNvbG9ycyA9IFsnIzAwMDBDQycsICcjMDAwMEZGJywgJyMwMDMzQ0MnLCAnIzAwMzNGRicsICcjMDA2NkNDJywgJyMwMDY2RkYnLCAnIzAwOTlDQycsICcjMDA5OUZGJywgJyMwMENDMDAnLCAnIzAwQ0MzMycsICcjMDBDQzY2JywgJyMwMENDOTknLCAnIzAwQ0NDQycsICcjMDBDQ0ZGJywgJyMzMzAwQ0MnLCAnIzMzMDBGRicsICcjMzMzM0NDJywgJyMzMzMzRkYnLCAnIzMzNjZDQycsICcjMzM2NkZGJywgJyMzMzk5Q0MnLCAnIzMzOTlGRicsICcjMzNDQzAwJywgJyMzM0NDMzMnLCAnIzMzQ0M2NicsICcjMzNDQzk5JywgJyMzM0NDQ0MnLCAnIzMzQ0NGRicsICcjNjYwMENDJywgJyM2NjAwRkYnLCAnIzY2MzNDQycsICcjNjYzM0ZGJywgJyM2NkNDMDAnLCAnIzY2Q0MzMycsICcjOTkwMENDJywgJyM5OTAwRkYnLCAnIzk5MzNDQycsICcjOTkzM0ZGJywgJyM5OUNDMDAnLCAnIzk5Q0MzMycsICcjQ0MwMDAwJywgJyNDQzAwMzMnLCAnI0NDMDA2NicsICcjQ0MwMDk5JywgJyNDQzAwQ0MnLCAnI0NDMDBGRicsICcjQ0MzMzAwJywgJyNDQzMzMzMnLCAnI0NDMzM2NicsICcjQ0MzMzk5JywgJyNDQzMzQ0MnLCAnI0NDMzNGRicsICcjQ0M2NjAwJywgJyNDQzY2MzMnLCAnI0NDOTkwMCcsICcjQ0M5OTMzJywgJyNDQ0NDMDAnLCAnI0NDQ0MzMycsICcjRkYwMDAwJywgJyNGRjAwMzMnLCAnI0ZGMDA2NicsICcjRkYwMDk5JywgJyNGRjAwQ0MnLCAnI0ZGMDBGRicsICcjRkYzMzAwJywgJyNGRjMzMzMnLCAnI0ZGMzM2NicsICcjRkYzMzk5JywgJyNGRjMzQ0MnLCAnI0ZGMzNGRicsICcjRkY2NjAwJywgJyNGRjY2MzMnLCAnI0ZGOTkwMCcsICcjRkY5OTMzJywgJyNGRkNDMDAnLCAnI0ZGQ0MzMyddOwogIC8qKgogICAqIEN1cnJlbnRseSBvbmx5IFdlYktpdC1iYXNlZCBXZWIgSW5zcGVjdG9ycywgRmlyZWZveCA+PSB2MzEsCiAgICogYW5kIHRoZSBGaXJlYnVnIGV4dGVuc2lvbiAoYW55IEZpcmVmb3ggdmVyc2lvbikgYXJlIGtub3duCiAgICogdG8gc3VwcG9ydCAiJWMiIENTUyBjdXN0b21pemF0aW9ucy4KICAgKgogICAqIFRPRE86IGFkZCBhIGBsb2NhbFN0b3JhZ2VgIHZhcmlhYmxlIHRvIGV4cGxpY2l0bHkgZW5hYmxlL2Rpc2FibGUgY29sb3JzCiAgICovCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHkKCiAgZnVuY3Rpb24gdXNlQ29sb3JzKCkgewogICAgLy8gTkI6IEluIGFuIEVsZWN0cm9uIHByZWxvYWQgc2NyaXB0LCBkb2N1bWVudCB3aWxsIGJlIGRlZmluZWQgYnV0IG5vdCBmdWxseQogICAgLy8gaW5pdGlhbGl6ZWQuIFNpbmNlIHdlIGtub3cgd2UncmUgaW4gQ2hyb21lLCB3ZSdsbCBqdXN0IGRldGVjdCB0aGlzIGNhc2UKICAgIC8vIGV4cGxpY2l0bHkKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucHJvY2VzcyAmJiAod2luZG93LnByb2Nlc3MudHlwZSA9PT0gJ3JlbmRlcmVyJyB8fCB3aW5kb3cucHJvY2Vzcy5fX253anMpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSAvLyBJbnRlcm5ldCBFeHBsb3JlciBhbmQgRWRnZSBkbyBub3Qgc3VwcG9ydCBjb2xvcnMuCgoKICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IudXNlckFnZW50ICYmIG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvKGVkZ2V8dHJpZGVudClcLyhcZCspLykpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSAvLyBJcyB3ZWJraXQ/IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzE2NDU5NjA2LzM3Njc3MwogICAgLy8gZG9jdW1lbnQgaXMgdW5kZWZpbmVkIGluIHJlYWN0LW5hdGl2ZTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0LW5hdGl2ZS9wdWxsLzE2MzIKCgogICAgcmV0dXJuIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuV2Via2l0QXBwZWFyYW5jZSB8fCAvLyBJcyBmaXJlYnVnPyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zOTgxMjAvMzc2NzczCiAgICB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuY29uc29sZSAmJiAod2luZG93LmNvbnNvbGUuZmlyZWJ1ZyB8fCB3aW5kb3cuY29uc29sZS5leGNlcHRpb24gJiYgd2luZG93LmNvbnNvbGUudGFibGUpIHx8IC8vIElzIGZpcmVmb3ggPj0gdjMxPwogICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9Ub29scy9XZWJfQ29uc29sZSNTdHlsaW5nX21lc3NhZ2VzCiAgICB0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IudXNlckFnZW50ICYmIG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvZmlyZWZveFwvKFxkKykvKSAmJiBwYXJzZUludChSZWdFeHAuJDEsIDEwKSA+PSAzMSB8fCAvLyBEb3VibGUgY2hlY2sgd2Via2l0IGluIHVzZXJBZ2VudCBqdXN0IGluIGNhc2Ugd2UgYXJlIGluIGEgd29ya2VyCiAgICB0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IudXNlckFnZW50ICYmIG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvYXBwbGV3ZWJraXRcLyhcZCspLyk7CiAgfQogIC8qKgogICAqIENvbG9yaXplIGxvZyBhcmd1bWVudHMgaWYgZW5hYmxlZC4KICAgKgogICAqIEBhcGkgcHVibGljCiAgICovCgoKICBmdW5jdGlvbiBmb3JtYXRBcmdzKGFyZ3MpIHsKICAgIGFyZ3NbMF0gPSAodGhpcy51c2VDb2xvcnMgPyAnJWMnIDogJycpICsgdGhpcy5uYW1lc3BhY2UgKyAodGhpcy51c2VDb2xvcnMgPyAnICVjJyA6ICcgJykgKyBhcmdzWzBdICsgKHRoaXMudXNlQ29sb3JzID8gJyVjICcgOiAnICcpICsgJysnICsgbW9kdWxlLmV4cG9ydHMuaHVtYW5pemUodGhpcy5kaWZmKTsKCiAgICBpZiAoIXRoaXMudXNlQ29sb3JzKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgYyA9ICdjb2xvcjogJyArIHRoaXMuY29sb3I7CiAgICBhcmdzLnNwbGljZSgxLCAwLCBjLCAnY29sb3I6IGluaGVyaXQnKTsgLy8gVGhlIGZpbmFsICIlYyIgaXMgc29tZXdoYXQgdHJpY2t5LCBiZWNhdXNlIHRoZXJlIGNvdWxkIGJlIG90aGVyCiAgICAvLyBhcmd1bWVudHMgcGFzc2VkIGVpdGhlciBiZWZvcmUgb3IgYWZ0ZXIgdGhlICVjLCBzbyB3ZSBuZWVkIHRvCiAgICAvLyBmaWd1cmUgb3V0IHRoZSBjb3JyZWN0IGluZGV4IHRvIGluc2VydCB0aGUgQ1NTIGludG8KCiAgICB2YXIgaW5kZXggPSAwOwogICAgdmFyIGxhc3RDID0gMDsKICAgIGFyZ3NbMF0ucmVwbGFjZSgvJVthLXpBLVolXS9nLCBmdW5jdGlvbiAobWF0Y2gpIHsKICAgICAgaWYgKG1hdGNoID09PSAnJSUnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpbmRleCsrOwoKICAgICAgaWYgKG1hdGNoID09PSAnJWMnKSB7CiAgICAgICAgLy8gV2Ugb25seSBhcmUgaW50ZXJlc3RlZCBpbiB0aGUgKmxhc3QqICVjCiAgICAgICAgLy8gKHRoZSB1c2VyIG1heSBoYXZlIHByb3ZpZGVkIHRoZWlyIG93bikKICAgICAgICBsYXN0QyA9IGluZGV4OwogICAgICB9CiAgICB9KTsKICAgIGFyZ3Muc3BsaWNlKGxhc3RDLCAwLCBjKTsKICB9CiAgLyoqCiAgICogSW52b2tlcyBgY29uc29sZS5kZWJ1ZygpYCB3aGVuIGF2YWlsYWJsZS4KICAgKiBOby1vcCB3aGVuIGBjb25zb2xlLmRlYnVnYCBpcyBub3QgYSAiZnVuY3Rpb24iLgogICAqIElmIGBjb25zb2xlLmRlYnVnYCBpcyBub3QgYXZhaWxhYmxlLCBmYWxscyBiYWNrCiAgICogdG8gYGNvbnNvbGUubG9nYC4KICAgKgogICAqIEBhcGkgcHVibGljCiAgICovCgoKICBleHBvcnRzLmxvZyA9IGNvbnNvbGUuZGVidWcgfHwgY29uc29sZS5sb2cgfHwgZnVuY3Rpb24gKCkge307CiAgLyoqCiAgICogU2F2ZSBgbmFtZXNwYWNlc2AuCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlcwogICAqIEBhcGkgcHJpdmF0ZQogICAqLwoKCiAgZnVuY3Rpb24gc2F2ZShuYW1lc3BhY2VzKSB7CiAgICB0cnkgewogICAgICBpZiAobmFtZXNwYWNlcykgewogICAgICAgIGV4cG9ydHMuc3RvcmFnZS5zZXRJdGVtKCdkZWJ1ZycsIG5hbWVzcGFjZXMpOwogICAgICB9IGVsc2UgewogICAgICAgIGV4cG9ydHMuc3RvcmFnZS5yZW1vdmVJdGVtKCdkZWJ1ZycpOwogICAgICB9CiAgICB9IGNhdGNoIChlcnJvcikgey8vIFN3YWxsb3cKICAgICAgLy8gWFhYIChAUWl4LSkgc2hvdWxkIHdlIGJlIGxvZ2dpbmcgdGhlc2U/CiAgICB9CiAgfQogIC8qKgogICAqIExvYWQgYG5hbWVzcGFjZXNgLgogICAqCiAgICogQHJldHVybiB7U3RyaW5nfSByZXR1cm5zIHRoZSBwcmV2aW91c2x5IHBlcnNpc3RlZCBkZWJ1ZyBtb2RlcwogICAqIEBhcGkgcHJpdmF0ZQogICAqLwoKCiAgZnVuY3Rpb24gbG9hZCgpIHsKICAgIHZhciByOwoKICAgIHRyeSB7CiAgICAgIHIgPSBleHBvcnRzLnN0b3JhZ2UuZ2V0SXRlbSgnZGVidWcnKTsKICAgIH0gY2F0Y2ggKGVycm9yKSB7Ly8gU3dhbGxvdwogICAgICAvLyBYWFggKEBRaXgtKSBzaG91bGQgd2UgYmUgbG9nZ2luZyB0aGVzZT8KICAgIH0gLy8gSWYgZGVidWcgaXNuJ3Qgc2V0IGluIExTLCBhbmQgd2UncmUgaW4gRWxlY3Ryb24sIHRyeSB0byBsb2FkICRERUJVRwoKCiAgICBpZiAoIXIgJiYgdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmICdlbnYnIGluIHByb2Nlc3MpIHsKICAgICAgciA9IHByb2Nlc3MuZW52LkRFQlVHOwogICAgfQoKICAgIHJldHVybiByOwogIH0KICAvKioKICAgKiBMb2NhbHN0b3JhZ2UgYXR0ZW1wdHMgdG8gcmV0dXJuIHRoZSBsb2NhbHN0b3JhZ2UuCiAgICoKICAgKiBUaGlzIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHNhZmFyaSB0aHJvd3MKICAgKiB3aGVuIGEgdXNlciBkaXNhYmxlcyBjb29raWVzL2xvY2Fsc3RvcmFnZQogICAqIGFuZCB5b3UgYXR0ZW1wdCB0byBhY2Nlc3MgaXQuCiAgICoKICAgKiBAcmV0dXJuIHtMb2NhbFN0b3JhZ2V9CiAgICogQGFwaSBwcml2YXRlCiAgICovCgoKICBmdW5jdGlvbiBsb2NhbHN0b3JhZ2UoKSB7CiAgICB0cnkgewogICAgICAvLyBUVk1MS2l0IChBcHBsZSBUViBKUyBSdW50aW1lKSBkb2VzIG5vdCBoYXZlIGEgd2luZG93IG9iamVjdCwganVzdCBsb2NhbFN0b3JhZ2UgaW4gdGhlIGdsb2JhbCBjb250ZXh0CiAgICAgIC8vIFRoZSBCcm93c2VyIGFsc28gaGFzIGxvY2FsU3RvcmFnZSBpbiB0aGUgZ2xvYmFsIGNvbnRleHQuCiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2U7CiAgICB9IGNhdGNoIChlcnJvcikgey8vIFN3YWxsb3cKICAgICAgLy8gWFhYIChAUWl4LSkgc2hvdWxkIHdlIGJlIGxvZ2dpbmcgdGhlc2U/CiAgICB9CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IGNvbW1vbihleHBvcnRzKTsKICB2YXIgZm9ybWF0dGVycyA9IG1vZHVsZS5leHBvcnRzLmZvcm1hdHRlcnM7CiAgLyoqCiAgICogTWFwICVqIHRvIGBKU09OLnN0cmluZ2lmeSgpYCwgc2luY2Ugbm8gV2ViIEluc3BlY3RvcnMgZG8gdGhhdCBieSBkZWZhdWx0LgogICAqLwoKICBmb3JtYXR0ZXJzLmogPSBmdW5jdGlvbiAodikgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHYpOwogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgcmV0dXJuICdbVW5leHBlY3RlZEpTT05QYXJzZUVycm9yXTogJyArIGVycm9yLm1lc3NhZ2U7CiAgICB9CiAgfTsKfSk7CmJyb3dzZXIuZm9ybWF0QXJnczsKYnJvd3Nlci5zYXZlOwpicm93c2VyLmxvYWQ7CmJyb3dzZXIudXNlQ29sb3JzOwpicm93c2VyLnN0b3JhZ2U7CmJyb3dzZXIuZGVzdHJveTsKYnJvd3Nlci5jb2xvcnM7CmJyb3dzZXIubG9nOwoKdmFyIFBBQ0tBR0VfTkFNRSA9ICd0aHJlZS1mb250LXBhcnNlcic7Cgp2YXIgZGVidWcgPSB7CiAgcm9vdE5hbWU6IFBBQ0tBR0VfTkFNRSwKICBfc3RvcmU6IG5ldyBNYXAoKSwKICBfY3JlYXRlRGVidWc6IGZ1bmN0aW9uIF9jcmVhdGVEZWJ1ZygpIHsKICAgIHZhciBuYW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnJzsKICAgIHJldHVybiBicm93c2VyKFt0aGlzLnJvb3ROYW1lLCBuYW1lXS5qb2luKCc6JykpOwogIH0sCiAgX2ZpcmU6IGZ1bmN0aW9uIF9maXJlKGRlYnVnKSB7CiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgZGF0YSA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGRhdGFbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIGRlYnVnLmFwcGx5KHZvaWQgMCwgW2RhdGFbMF0gfHwgJyddLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZGF0YS5zbGljZSgxKSkpKTsKICB9LAogIGxvZzogZnVuY3Rpb24gbG9nKG1zZykgewogICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBkYXRhID0gbmV3IEFycmF5KF9sZW4yID4gMSA/IF9sZW4yIC0gMSA6IDApLCBfa2V5MiA9IDE7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHsKICAgICAgZGF0YVtfa2V5MiAtIDFdID0gYXJndW1lbnRzW19rZXkyXTsKICAgIH0KCiAgICB0aGlzLl9maXJlLmFwcGx5KHRoaXMsIFt0aGlzLl9jcmVhdGVEZWJ1Zyhtc2cpXS5jb25jYXQoZGF0YSkpOwogIH0sCiAgdGltZTogZnVuY3Rpb24gdGltZShtc2cpIHsKICAgIHZhciBkZWJ1ZyA9IHRoaXMuX2NyZWF0ZURlYnVnKG1zZyk7CgogICAgaWYgKHRoaXMuX3N0b3JlLmdldChtc2cpKSB7CiAgICAgIGNvbnNvbGUud2FybigidGltZXIgIi5jb25jYXQobXNnLCAiIGFscmVhZHkgZXhpc3RzIikpOwogICAgfQoKICAgIHRoaXMuX3N0b3JlLnNldChtc2csIGRlYnVnKTsKCiAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGRhdGEgPSBuZXcgQXJyYXkoX2xlbjMgPiAxID8gX2xlbjMgLSAxIDogMCksIF9rZXkzID0gMTsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykgewogICAgICBkYXRhW19rZXkzIC0gMV0gPSBhcmd1bWVudHNbX2tleTNdOwogICAgfQoKICAgIHRoaXMuX2ZpcmUuYXBwbHkodGhpcywgW2RlYnVnXS5jb25jYXQoZGF0YSkpOwogIH0sCiAgdGltZUVuZDogZnVuY3Rpb24gdGltZUVuZChtc2cpIHsKICAgIHZhciBkZWJ1ZyA9IHRoaXMuX3N0b3JlLmdldChtc2cpOwoKICAgIGlmIChkZWJ1ZykgewogICAgICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIGRhdGEgPSBuZXcgQXJyYXkoX2xlbjQgPiAxID8gX2xlbjQgLSAxIDogMCksIF9rZXk0ID0gMTsgX2tleTQgPCBfbGVuNDsgX2tleTQrKykgewogICAgICAgIGRhdGFbX2tleTQgLSAxXSA9IGFyZ3VtZW50c1tfa2V5NF07CiAgICAgIH0KCiAgICAgIHRoaXMuX2ZpcmUuYXBwbHkodGhpcywgW2RlYnVnXS5jb25jYXQoZGF0YSkpOwoKICAgICAgdGhpcy5fc3RvcmUuc2V0KG1zZywgbnVsbCk7CiAgICB9IGVsc2UgewogICAgICBjb25zb2xlLndhcm4oInRpbWVyICIuY29uY2F0KG1zZywgIiBub3QgZXhpc3RzIikpOwogICAgfQogIH0KfTsKCi8qKgogKiBAYXV0aG9yIGFsdGVyZWRxIC8gaHR0cDovL2FsdGVyZWRxdWFsaWEuY29tLwogKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tLwogKi8KCnZhciBidWZmZXJHZW9tZXRyeUlkID0gMTsgLy8gQnVmZmVyR2VvbWV0cnkgdXNlcyBvZGQgbnVtYmVycyBhcyBJZAoKZnVuY3Rpb24gQnVmZmVyR2VvbWV0cnkoKSB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdpZCcsIHsKICAgIHZhbHVlOiBidWZmZXJHZW9tZXRyeUlkICs9IDIKICB9KTsKICB0aGlzLnV1aWQgPSBfTWF0aC5nZW5lcmF0ZVVVSUQoKTsKICB0aGlzLm5hbWUgPSAnJzsKICB0aGlzLnR5cGUgPSAnQnVmZmVyR2VvbWV0cnknOwogIHRoaXMuaW5kZXggPSBudWxsOwogIHRoaXMuYXR0cmlidXRlcyA9IHt9OwogIHRoaXMubW9ycGhBdHRyaWJ1dGVzID0ge307CiAgdGhpcy5ncm91cHMgPSBbXTsKICB0aGlzLmJvdW5kaW5nQm94ID0gbnVsbDsKICB0aGlzLmJvdW5kaW5nU3BoZXJlID0gbnVsbDsKICB0aGlzLmRyYXdSYW5nZSA9IHsKICAgIHN0YXJ0OiAwLAogICAgY291bnQ6IEluZmluaXR5CiAgfTsKICB0aGlzLnVzZXJEYXRhID0ge307IC8vIHl1bnlhbmcKCiAgdGhpcy5jaGFyVmVydGV4RmxhZ0FycmF5ID0gW107CiAgdGhpcy5jaGFyQ2VudGVyQXJyYXkgPSBbXTsKICB0aGlzLmNoYXJDZW50ZXJBcnJheVQgPSBbXTsKICB0aGlzLmNoYXJWZXJ0ZXhDb3VudEFycmF5ID0gW107CiAgdGhpcy5jaGFyQkJveEFycmF5ID0gW107Cn0KCkJ1ZmZlckdlb21ldHJ5LnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShFdmVudERpc3BhdGNoZXIucHJvdG90eXBlKSwgewogIGNvbnN0cnVjdG9yOiBCdWZmZXJHZW9tZXRyeSwKICBpc0J1ZmZlckdlb21ldHJ5OiB0cnVlLAogIGdldEluZGV4OiBmdW5jdGlvbiBnZXRJbmRleCgpIHsKICAgIHJldHVybiB0aGlzLmluZGV4OwogIH0sCiAgc2V0SW5kZXg6IGZ1bmN0aW9uIHNldEluZGV4KGluZGV4KSB7CiAgICBpZiAoQXJyYXkuaXNBcnJheShpbmRleCkpIHsKICAgICAgdGhpcy5pbmRleCA9IG5ldyAoYXJyYXlNYXgoaW5kZXgpID4gNjU1MzUgPyBVaW50MzJCdWZmZXJBdHRyaWJ1dGUgOiBVaW50MTZCdWZmZXJBdHRyaWJ1dGUpKGluZGV4LCAxKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaW5kZXggPSBpbmRleDsKICAgIH0KICB9LAogIHNldEluZGV4WXVueWFuZzogZnVuY3Rpb24gc2V0SW5kZXhZdW55YW5nKGluZGV4KSB7CiAgICBpZiAoQXJyYXkuaXNBcnJheShpbmRleCkpIHsKICAgICAgdGhpcy5pbmRleCA9IG5ldyBVaW50MzJCdWZmZXJBdHRyaWJ1dGUoaW5kZXgsIDEpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5pbmRleCA9IGluZGV4OwogICAgfQogIH0sCiAgYWRkQXR0cmlidXRlOiBmdW5jdGlvbiBhZGRBdHRyaWJ1dGUobmFtZSwgYXR0cmlidXRlKSB7CiAgICBpZiAoIShhdHRyaWJ1dGUgJiYgYXR0cmlidXRlLmlzQnVmZmVyQXR0cmlidXRlKSAmJiAhKGF0dHJpYnV0ZSAmJiBhdHRyaWJ1dGUuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSkpIHsKICAgICAgY29uc29sZS53YXJuKCdUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmFkZEF0dHJpYnV0ZSgpIG5vdyBleHBlY3RzICggbmFtZSwgYXR0cmlidXRlICkuJyk7CiAgICAgIHJldHVybiB0aGlzLmFkZEF0dHJpYnV0ZShuYW1lLCBuZXcgQnVmZmVyQXR0cmlidXRlKGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKSk7CiAgICB9CgogICAgaWYgKG5hbWUgPT09ICdpbmRleCcpIHsKICAgICAgY29uc29sZS53YXJuKCdUSFJFRS5CdWZmZXJHZW9tZXRyeS5hZGRBdHRyaWJ1dGU6IFVzZSAuc2V0SW5kZXgoKSBmb3IgaW5kZXggYXR0cmlidXRlLicpOwogICAgICB0aGlzLnNldEluZGV4KGF0dHJpYnV0ZSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHRoaXMuYXR0cmlidXRlc1tuYW1lXSA9IGF0dHJpYnV0ZTsKICAgIHJldHVybiB0aGlzOwogIH0sCiAgZ2V0QXR0cmlidXRlOiBmdW5jdGlvbiBnZXRBdHRyaWJ1dGUobmFtZSkgewogICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlc1tuYW1lXTsKICB9LAogIHJlbW92ZUF0dHJpYnV0ZTogZnVuY3Rpb24gcmVtb3ZlQXR0cmlidXRlKG5hbWUpIHsKICAgIGRlbGV0ZSB0aGlzLmF0dHJpYnV0ZXNbbmFtZV07CiAgICByZXR1cm4gdGhpczsKICB9LAogIGFkZEdyb3VwOiBmdW5jdGlvbiBhZGRHcm91cChzdGFydCwgY291bnQsIG1hdGVyaWFsSW5kZXgpIHsKICAgIHRoaXMuZ3JvdXBzLnB1c2goewogICAgICBzdGFydDogc3RhcnQsCiAgICAgIGNvdW50OiBjb3VudCwKICAgICAgbWF0ZXJpYWxJbmRleDogbWF0ZXJpYWxJbmRleCAhPT0gdW5kZWZpbmVkID8gbWF0ZXJpYWxJbmRleCA6IDAKICAgIH0pOwogIH0sCiAgY2xlYXJHcm91cHM6IGZ1bmN0aW9uIGNsZWFyR3JvdXBzKCkgewogICAgdGhpcy5ncm91cHMgPSBbXTsKICB9LAogIHNldERyYXdSYW5nZTogZnVuY3Rpb24gc2V0RHJhd1JhbmdlKHN0YXJ0LCBjb3VudCkgewogICAgdGhpcy5kcmF3UmFuZ2Uuc3RhcnQgPSBzdGFydDsKICAgIHRoaXMuZHJhd1JhbmdlLmNvdW50ID0gY291bnQ7CiAgfSwKICBhcHBseU1hdHJpeDogZnVuY3Rpb24gYXBwbHlNYXRyaXgobWF0cml4KSB7CiAgICB2YXIgcG9zaXRpb24gPSB0aGlzLmF0dHJpYnV0ZXMucG9zaXRpb247CgogICAgaWYgKHBvc2l0aW9uICE9PSB1bmRlZmluZWQpIHsKICAgICAgbWF0cml4LmFwcGx5VG9CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb24pOwogICAgICBwb3NpdGlvbi5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICB9CgogICAgdmFyIG5vcm1hbCA9IHRoaXMuYXR0cmlidXRlcy5ub3JtYWw7CgogICAgaWYgKG5vcm1hbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhciBub3JtYWxNYXRyaXggPSBuZXcgTWF0cml4MygpLmdldE5vcm1hbE1hdHJpeChtYXRyaXgpOwogICAgICBub3JtYWxNYXRyaXguYXBwbHlUb0J1ZmZlckF0dHJpYnV0ZShub3JtYWwpOwogICAgICBub3JtYWwubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgfQoKICAgIGlmICh0aGlzLmJvdW5kaW5nQm94ICE9PSBudWxsKSB7CiAgICAgIHRoaXMuY29tcHV0ZUJvdW5kaW5nQm94KCk7CiAgICB9CgogICAgaWYgKHRoaXMuYm91bmRpbmdTcGhlcmUgIT09IG51bGwpIHsKICAgICAgdGhpcy5jb21wdXRlQm91bmRpbmdTcGhlcmUoKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9LAogIHRyYW5zbGF0ZTogZnVuY3Rpb24gKCkgewogICAgLy8gdHJhbnNsYXRlIGdlb21ldHJ5CiAgICB2YXIgbTEgPSBuZXcgTWF0cml4NCgpOwogICAgcmV0dXJuIGZ1bmN0aW9uIHRyYW5zbGF0ZSh4LCB5LCB6KSB7CiAgICAgIG0xLm1ha2VUcmFuc2xhdGlvbih4LCB5LCB6KTsKICAgICAgdGhpcy5hcHBseU1hdHJpeChtMSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfTsKICB9KCksCiAgc2NhbGU6IGZ1bmN0aW9uICgpIHsKICAgIC8vIHNjYWxlIGdlb21ldHJ5CiAgICB2YXIgbTEgPSBuZXcgTWF0cml4NCgpOwogICAgcmV0dXJuIGZ1bmN0aW9uIHNjYWxlKHgsIHksIHopIHsKICAgICAgbTEubWFrZVNjYWxlKHgsIHksIHopOwogICAgICB0aGlzLmFwcGx5TWF0cml4KG0xKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9OwogIH0oKSwKICBjZW50ZXI6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBvZmZzZXQgPSBuZXcgVmVjdG9yMygpOwogICAgcmV0dXJuIGZ1bmN0aW9uIGNlbnRlcigpIHsKICAgICAgdGhpcy5jb21wdXRlQm91bmRpbmdCb3goKTsKICAgICAgdGhpcy5ib3VuZGluZ0JveC5nZXRDZW50ZXIob2Zmc2V0KS5uZWdhdGUoKTsKICAgICAgdGhpcy50cmFuc2xhdGUob2Zmc2V0LngsIG9mZnNldC55LCBvZmZzZXQueik7CiAgICAgIHJldHVybiB0aGlzOwogICAgfTsKICB9KCksCiAgc2V0RnJvbU9iamVjdDogZnVuY3Rpb24gc2V0RnJvbU9iamVjdChvYmplY3QpIHsKICAgIC8vIGRlYnVnLmxvZyggJ1RIUkVFLkJ1ZmZlckdlb21ldHJ5LnNldEZyb21PYmplY3QoKS4gQ29udmVydGluZycsIG9iamVjdCwgdGhpcyApOwogICAgdmFyIGdlb21ldHJ5ID0gb2JqZWN0Lmdlb21ldHJ5OwoKICAgIGlmIChvYmplY3QuaXNQb2ludHMgfHwgb2JqZWN0LmlzTGluZSkgewogICAgICB2YXIgcG9zaXRpb25zID0gbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoZ2VvbWV0cnkudmVydGljZXMubGVuZ3RoICogMywgMyk7CiAgICAgIHRoaXMuYWRkQXR0cmlidXRlKCdwb3NpdGlvbicsIHBvc2l0aW9ucy5jb3B5VmVjdG9yM3NBcnJheShnZW9tZXRyeS52ZXJ0aWNlcykpOwoKICAgICAgaWYgKGdlb21ldHJ5LmxpbmVEaXN0YW5jZXMgJiYgZ2VvbWV0cnkubGluZURpc3RhbmNlcy5sZW5ndGggPT09IGdlb21ldHJ5LnZlcnRpY2VzLmxlbmd0aCkgewogICAgICAgIHZhciBsaW5lRGlzdGFuY2VzID0gbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUoZ2VvbWV0cnkubGluZURpc3RhbmNlcy5sZW5ndGgsIDEpOwogICAgICAgIHRoaXMuYWRkQXR0cmlidXRlKCdsaW5lRGlzdGFuY2UnLCBsaW5lRGlzdGFuY2VzLmNvcHlBcnJheShnZW9tZXRyeS5saW5lRGlzdGFuY2VzKSk7CiAgICAgIH0KCiAgICAgIGlmIChnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZSAhPT0gbnVsbCkgewogICAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmUgPSBnZW9tZXRyeS5ib3VuZGluZ1NwaGVyZS5jbG9uZSgpOwogICAgICB9CgogICAgICBpZiAoZ2VvbWV0cnkuYm91bmRpbmdCb3ggIT09IG51bGwpIHsKICAgICAgICB0aGlzLmJvdW5kaW5nQm94ID0gZ2VvbWV0cnkuYm91bmRpbmdCb3guY2xvbmUoKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChvYmplY3QuaXNNZXNoKSB7CiAgICAgIGlmIChnZW9tZXRyeSAmJiBnZW9tZXRyeS5pc0dlb21ldHJ5KSB7CiAgICAgICAgdGhpcy5mcm9tR2VvbWV0cnkoZ2VvbWV0cnkpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBzZXRGcm9tUG9pbnRzOiBmdW5jdGlvbiBzZXRGcm9tUG9pbnRzKHBvaW50cykgewogICAgdmFyIHBvc2l0aW9uID0gW107CgogICAgZm9yICh2YXIgaSA9IDAsIGwgPSBwb2ludHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHZhciBwb2ludCA9IHBvaW50c1tpXTsKICAgICAgcG9zaXRpb24ucHVzaChwb2ludC54LCBwb2ludC55LCBwb2ludC56IHx8IDApOwogICAgfQoKICAgIHRoaXMuYWRkQXR0cmlidXRlKCdwb3NpdGlvbicsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHBvc2l0aW9uLCAzKSk7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGZyb21HZW9tZXRyeTogZnVuY3Rpb24gZnJvbUdlb21ldHJ5KGdlb21ldHJ5KSB7CiAgICBnZW9tZXRyeS5fX2RpcmVjdEdlb21ldHJ5ID0gbmV3IERpcmVjdEdlb21ldHJ5KCkuZnJvbUdlb21ldHJ5KGdlb21ldHJ5KTsKICAgIHJldHVybiB0aGlzLmZyb21EaXJlY3RHZW9tZXRyeShnZW9tZXRyeS5fX2RpcmVjdEdlb21ldHJ5KTsKICB9LAogIGNvbXB1dGVCb3VuZGluZ0JveDogZnVuY3Rpb24gY29tcHV0ZUJvdW5kaW5nQm94KCkgewogICAgaWYgKCF0aGlzLmJvdW5kaW5nQm94KSB7CiAgICAgIHRoaXMuYm91bmRpbmdCb3ggPSBuZXcgQm94MygpOwogICAgfQoKICAgIHZhciBwb3NpdGlvbiA9IHRoaXMuYXR0cmlidXRlcy5wb3NpdGlvbjsKCiAgICBpZiAocG9zaXRpb24gIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLmJvdW5kaW5nQm94LnNldEZyb21CdWZmZXJBdHRyaWJ1dGUocG9zaXRpb24pOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5ib3VuZGluZ0JveC5tYWtlRW1wdHkoKTsKICAgIH0KCiAgICBpZiAoaXNOYU4odGhpcy5ib3VuZGluZ0JveC5taW4ueCkgfHwgaXNOYU4odGhpcy5ib3VuZGluZ0JveC5taW4ueSkgfHwgaXNOYU4odGhpcy5ib3VuZGluZ0JveC5taW4ueikpIHsKICAgICAgY29uc29sZS5lcnJvcignVEhSRUUuQnVmZmVyR2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nQm94OiBDb21wdXRlZCBtaW4vbWF4IGhhdmUgTmFOIHZhbHVlcy4gVGhlICJwb3NpdGlvbiIgYXR0cmlidXRlIGlzIGxpa2VseSB0byBoYXZlIE5hTiB2YWx1ZXMuJywgdGhpcyk7CiAgICB9CiAgfSwKICBjb21wdXRlRmFjZU5vcm1hbHM6IGZ1bmN0aW9uIGNvbXB1dGVGYWNlTm9ybWFscygpIHsvLyBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eQogIH0sCiAgY29tcHV0ZVZlcnRleE5vcm1hbHM6IGZ1bmN0aW9uIGNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCkgewogICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleDsKICAgIHZhciBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzOwoKICAgIGlmIChhdHRyaWJ1dGVzLnBvc2l0aW9uKSB7CiAgICAgIHZhciBwb3NpdGlvbnMgPSBhdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5OwoKICAgICAgaWYgKGF0dHJpYnV0ZXMubm9ybWFsID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLmFkZEF0dHJpYnV0ZSgnbm9ybWFsJywgbmV3IEJ1ZmZlckF0dHJpYnV0ZShuZXcgRmxvYXQzMkFycmF5KHBvc2l0aW9ucy5sZW5ndGgpLCAzKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gcmVzZXQgZXhpc3Rpbmcgbm9ybWFscyB0byB6ZXJvCiAgICAgICAgdmFyIGFycmF5ID0gYXR0cmlidXRlcy5ub3JtYWwuYXJyYXk7CgogICAgICAgIGZvciAodmFyIGkgPSAwLCBpbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICAgIGFycmF5W2ldID0gMDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBub3JtYWxzID0gYXR0cmlidXRlcy5ub3JtYWwuYXJyYXk7CiAgICAgIHZhciB2QSwgdkIsIHZDOwogICAgICB2YXIgcEEgPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgcEIgPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgcEMgPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgY2IgPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgYWIgPSBuZXcgVmVjdG9yMygpOyAvLyBpbmRleGVkIGVsZW1lbnRzCgogICAgICBpZiAoaW5kZXgpIHsKICAgICAgICB2YXIgaW5kaWNlcyA9IGluZGV4LmFycmF5OwoKICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9pbCA9IGluZGV4LmNvdW50OyBfaSA8IF9pbDsgX2kgKz0gMykgewogICAgICAgICAgdkEgPSBpbmRpY2VzW19pICsgMF0gKiAzOwogICAgICAgICAgdkIgPSBpbmRpY2VzW19pICsgMV0gKiAzOwogICAgICAgICAgdkMgPSBpbmRpY2VzW19pICsgMl0gKiAzOwogICAgICAgICAgcEEuZnJvbUFycmF5KHBvc2l0aW9ucywgdkEpOwogICAgICAgICAgcEIuZnJvbUFycmF5KHBvc2l0aW9ucywgdkIpOwogICAgICAgICAgcEMuZnJvbUFycmF5KHBvc2l0aW9ucywgdkMpOwogICAgICAgICAgY2Iuc3ViVmVjdG9ycyhwQywgcEIpOwogICAgICAgICAgYWIuc3ViVmVjdG9ycyhwQSwgcEIpOwogICAgICAgICAgY2IuY3Jvc3MoYWIpOwogICAgICAgICAgbm9ybWFsc1t2QV0gKz0gY2IueDsKICAgICAgICAgIG5vcm1hbHNbdkEgKyAxXSArPSBjYi55OwogICAgICAgICAgbm9ybWFsc1t2QSArIDJdICs9IGNiLno7CiAgICAgICAgICBub3JtYWxzW3ZCXSArPSBjYi54OwogICAgICAgICAgbm9ybWFsc1t2QiArIDFdICs9IGNiLnk7CiAgICAgICAgICBub3JtYWxzW3ZCICsgMl0gKz0gY2IuejsKICAgICAgICAgIG5vcm1hbHNbdkNdICs9IGNiLng7CiAgICAgICAgICBub3JtYWxzW3ZDICsgMV0gKz0gY2IueTsKICAgICAgICAgIG5vcm1hbHNbdkMgKyAyXSArPSBjYi56OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBub24taW5kZXhlZCBlbGVtZW50cyAodW5jb25uZWN0ZWQgdHJpYW5nbGUgc291cCkKICAgICAgICBmb3IgKHZhciBfaTIgPSAwLCBfaWwyID0gcG9zaXRpb25zLmxlbmd0aDsgX2kyIDwgX2lsMjsgX2kyICs9IDkpIHsKICAgICAgICAgIHBBLmZyb21BcnJheShwb3NpdGlvbnMsIF9pMik7CiAgICAgICAgICBwQi5mcm9tQXJyYXkocG9zaXRpb25zLCBfaTIgKyAzKTsKICAgICAgICAgIHBDLmZyb21BcnJheShwb3NpdGlvbnMsIF9pMiArIDYpOwogICAgICAgICAgY2Iuc3ViVmVjdG9ycyhwQywgcEIpOwogICAgICAgICAgYWIuc3ViVmVjdG9ycyhwQSwgcEIpOwogICAgICAgICAgY2IuY3Jvc3MoYWIpOwogICAgICAgICAgbm9ybWFsc1tfaTJdID0gY2IueDsKICAgICAgICAgIG5vcm1hbHNbX2kyICsgMV0gPSBjYi55OwogICAgICAgICAgbm9ybWFsc1tfaTIgKyAyXSA9IGNiLno7CiAgICAgICAgICBub3JtYWxzW19pMiArIDNdID0gY2IueDsKICAgICAgICAgIG5vcm1hbHNbX2kyICsgNF0gPSBjYi55OwogICAgICAgICAgbm9ybWFsc1tfaTIgKyA1XSA9IGNiLno7CiAgICAgICAgICBub3JtYWxzW19pMiArIDZdID0gY2IueDsKICAgICAgICAgIG5vcm1hbHNbX2kyICsgN10gPSBjYi55OwogICAgICAgICAgbm9ybWFsc1tfaTIgKyA4XSA9IGNiLno7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLm5vcm1hbGl6ZU5vcm1hbHMoKTsKICAgICAgYXR0cmlidXRlcy5ub3JtYWwubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgfQogIH0sCiAgY29tcHV0ZVZlcnRleE5vcm1hbHM0VGV4dGdlb21ldHJ5WXVueWFuZzogZnVuY3Rpb24gY29tcHV0ZVZlcnRleE5vcm1hbHM0VGV4dGdlb21ldHJ5WXVueWFuZyhzaGFkaW5nU21vb3RoQW5nbGUpIHsKICAgIC8vIGRlYnVnLmxvZygiU1RBUlQgY29tcHV0ZVZlcnRleE5vcm1hbHM0VGV4dGdlb21ldHJ5WXVueWFuZyIpOwogICAgdmFyIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXM7CgogICAgaWYgKGF0dHJpYnV0ZXMucG9zaXRpb24pIHsKICAgICAgdmFyIHBvc2l0aW9ucyA9IGF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXk7CgogICAgICBpZiAoYXR0cmlidXRlcy5ub3JtYWwgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuYWRkQXR0cmlidXRlKCdub3JtYWwnLCBuZXcgQnVmZmVyQXR0cmlidXRlKG5ldyBGbG9hdDMyQXJyYXkocG9zaXRpb25zLmxlbmd0aCksIDMpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyByZXNldCBleGlzdGluZyBub3JtYWxzIHRvIHplcm8KICAgICAgICB2YXIgYXJyYXkgPSBhdHRyaWJ1dGVzLm5vcm1hbC5hcnJheTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlsID0gYXJyYXkubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICAgICAgYXJyYXlbaV0gPSAwOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIG5vcm1hbHMgPSBhdHRyaWJ1dGVzLm5vcm1hbC5hcnJheTsgLy8gbGV0IHZBLCB2QiwgdkM7CiAgICAgIC8vIGxldCBwQSA9IG5ldyBWZWN0b3IzKCksIHBCID0gbmV3IFZlY3RvcjMoKSwgcEMgPSBuZXcgVmVjdG9yMygpOwogICAgICAvLyBsZXQgY2IgPSBuZXcgVmVjdG9yMygpLCBhYiA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIC8vIGxldCBmbG9hdFBvaW50TnVtYiA9IDM7CiAgICAgIC8vIG5vbi1pbmRleGVkIGVsZW1lbnRzICh1bmNvbm5lY3RlZCB0cmlhbmdsZSBzb3VwKQogICAgICAvLyBsZXQgbm9ybWFsTWFwID0gbmV3IE1hcCgpOwoKICAgICAgdmFyIGZhY2VJZEFuZE5vcm1hbE1hcCA9IHt9OyAvLyBuZXcgTWFwKCk7CgogICAgICB2YXIgcG9zaXRpb25JZEFuZEtleU1hcCA9IHt9OyAvLyBuZXcgTWFwKCk7CiAgICAgIC8vIGxldCBwb3NpdGlvbklkQW5kRmFjZUlkTWFwID0ge307Ly9uZXcgTWFwKCk7CgogICAgICB2YXIgS2V5QW5kUG9zaXRpb25JZE1hcCA9IHt9OyAvLyBuZXcgTWFwKCk7CiAgICAgIC8vIGl0ZXJhdGUgcG9pbnRzCiAgICAgIC8vIGRlYnVnLmxvZygiaXRlcmF0ZSBwb2ludHMiKTsKCiAgICAgIHZhciBwQSA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIHZhciBtYXRlcmlhbElEcyA9IFtdOwoKICAgICAgZm9yICh2YXIgX2kzID0gMCwgX2lsMyA9IHBvc2l0aW9ucy5sZW5ndGg7IF9pMyA8IF9pbDM7IF9pMyArPSAzKSB7CiAgICAgICAgcEEuZnJvbUFycmF5KHBvc2l0aW9ucywgX2kzKTsKICAgICAgICB2YXIgaWQgPSBfaTMgLyAzOwogICAgICAgIHZhciBtYXRlcmlhbElkID0gLTE7CgogICAgICAgIGZvciAodmFyIGdJZCA9IDA7IGdJZCA8IHRoaXMuZ3JvdXBzLmxlbmd0aDsgZ0lkKyspIHsKICAgICAgICAgIGlmIChpZCA+PSB0aGlzLmdyb3Vwc1tnSWRdLnN0YXJ0ICYmIGlkIDw9IHRoaXMuZ3JvdXBzW2dJZF0uc3RhcnQgKyB0aGlzLmdyb3Vwc1tnSWRdLmNvdW50IC0gMSkgewogICAgICAgICAgICBtYXRlcmlhbElkID0gdGhpcy5ncm91cHNbZ0lkXS5tYXRlcmlhbEluZGV4OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChtYXRlcmlhbElkID09PSAtMSkgewogICAgICAgICAgY29uc29sZS5sb2coJ21hdGVyaWFsX2lkID09PSAtMScpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG1hdGVyaWFsSWQgPT09IDIpIG1hdGVyaWFsSWQgPSAxOwogICAgICAgIG1hdGVyaWFsSURzLnB1c2gobWF0ZXJpYWxJZCk7IC8vIGxldCBrZXkgPSBwQS54LnRvRml4ZWQoZmxvYXRQb2ludE51bWIpKycrJytwQS55LnRvRml4ZWQoZmxvYXRQb2ludE51bWIpKycrJytwQS56LnRvRml4ZWQoZmxvYXRQb2ludE51bWIpKycrJysgbWF0ZXJpYWxfaWQ7Ly8rIHBCLngrcEIueStwQi56KyBwQy54K3BDLnkrcEMuejsKCiAgICAgICAgdmFyIGtleSA9ICcnICsgTWF0aC5mbG9vcihwQS54ICogMTAwMDApICsgTWF0aC5mbG9vcihwQS55ICogMTAwMDApICsgTWF0aC5mbG9vcihwQS56ICogMTAwMDApICsgbWF0ZXJpYWxJZDsgLy8gbm9ybWFsTWFwLnNldChrZXksIG5ldyBWZWN0b3IzKDAsMCwwKSk7CiAgICAgICAgLy8gcG9zaXRpb25JZEFuZEtleU1hcC5zZXQoaWQsIGtleSk7CgogICAgICAgIHBvc2l0aW9uSWRBbmRLZXlNYXBbaWRdID0ga2V5OwoKICAgICAgICBpZiAoIUtleUFuZFBvc2l0aW9uSWRNYXBba2V5XSkgewogICAgICAgICAgS2V5QW5kUG9zaXRpb25JZE1hcFtrZXldID0gW107CiAgICAgICAgfQoKICAgICAgICBLZXlBbmRQb3NpdGlvbklkTWFwW2tleV0ucHVzaChpZCk7CiAgICAgIH0gLy8gZGVidWcubG9nKCJpdGVyYXRlIHBvaW50cyIpOwogICAgICAvLyBpdGVyYXRlIGZhY2VzCiAgICAgIC8vIGRlYnVnLmxvZygiaXRlcmF0ZSBmYWNlcyIpOwogICAgICAvLyBsZXQgcEEgPSBuZXcgVmVjdG9yMygpOwoKCiAgICAgIHZhciBwQiA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIHZhciBwQyA9IG5ldyBWZWN0b3IzKCk7CgogICAgICBmb3IgKHZhciBfaTQgPSAwLCBfaWw0ID0gcG9zaXRpb25zLmxlbmd0aDsgX2k0IDwgX2lsNDsgX2k0ICs9IDkpIHsKICAgICAgICAvLyBsZXQgdkEsIHZCLCB2QzsKICAgICAgICB2YXIgY2IgPSBuZXcgVmVjdG9yMygpOwogICAgICAgIHZhciBhYiA9IG5ldyBWZWN0b3IzKCk7CiAgICAgICAgcEEuZnJvbUFycmF5KHBvc2l0aW9ucywgX2k0KTsKICAgICAgICBwQi5mcm9tQXJyYXkocG9zaXRpb25zLCBfaTQgKyAzKTsKICAgICAgICBwQy5mcm9tQXJyYXkocG9zaXRpb25zLCBfaTQgKyA2KTsKICAgICAgICBjYi5zdWJWZWN0b3JzKHBDLCBwQik7CiAgICAgICAgYWIuc3ViVmVjdG9ycyhwQSwgcEIpOwogICAgICAgIGNiLmNyb3NzKGFiKTsKICAgICAgICBjYi5ub3JtYWxpemUoKTsKICAgICAgICB2YXIgZmFjZUlkID0gfn4oX2k0IC8gOSk7CiAgICAgICAgZmFjZUlkQW5kTm9ybWFsTWFwW2ZhY2VJZF0gPSBjYjsgLy8gcG9zaXRpb25JZEFuZEZhY2VJZE1hcFtpZDFdID0gZmFjZUlkOwogICAgICAgIC8vIHBvc2l0aW9uSWRBbmRGYWNlSWRNYXBbaWQyXSA9IGZhY2VJZDsKICAgICAgICAvLyBwb3NpdGlvbklkQW5kRmFjZUlkTWFwW2lkM10gPSBmYWNlSWQ7CiAgICAgIH0gLy8gZGVidWcubG9nKCJpdGVyYXRlIGZhY2VzIik7CiAgICAgIC8vIGFzc2lnbiBub3JtYWwgdG8gZWFjaCBwb2ludAogICAgICAvLyBkZWJ1Zy5sb2coImFzc2lnbiBub3JtYWwgdG8gZWFjaCBwb2ludCIpOwoKCiAgICAgIHZhciByYWQyZGVncmVlID0gMTgwIC8gTWF0aC5QSTsKCiAgICAgIGZvciAodmFyIF9pNSA9IDAsIF9pbDUgPSBwb3NpdGlvbnMubGVuZ3RoOyBfaTUgPCBfaWw1OyBfaTUgKz0gMykgewogICAgICAgIHZhciB0aGlzUG9zaXRpb25JZCA9IF9pNSAvIDM7CiAgICAgICAgdmFyIF9rZXkgPSBwb3NpdGlvbklkQW5kS2V5TWFwW3RoaXNQb3NpdGlvbklkXTsKICAgICAgICB2YXIgdGhpc0ZhY2VJZCA9IHBhcnNlSW50KHRoaXNQb3NpdGlvbklkIC8gMyk7IC8vIHBvc2l0aW9uSWRBbmRGYWNlSWRNYXBbdGhpc1Bvc2l0aW9uSWRdOwoKICAgICAgICB2YXIgdGhpc05vcm1hbCA9IGZhY2VJZEFuZE5vcm1hbE1hcFt0aGlzRmFjZUlkXTsKICAgICAgICB2YXIgc3VtTm9ybWFsID0gbmV3IFZlY3RvcjMoMCwgMCwgMCk7CiAgICAgICAgdmFyIHBvc2l0aW9uSWRMaXN0ID0gS2V5QW5kUG9zaXRpb25JZE1hcFtfa2V5XTsKCiAgICAgICAgZm9yICh2YXIgbSA9IDA7IG0gPCBwb3NpdGlvbklkTGlzdC5sZW5ndGg7IG0rKykgewogICAgICAgICAgLy8gaWYocG9zaXRpb25JZExpc3RbbV0gPT0gdGhpc1Bvc2l0aW9uSWQpIGNvbnRpbnVlOwogICAgICAgICAgdmFyIF9mYWNlSWQgPSBwYXJzZUludChwb3NpdGlvbklkTGlzdFttXSAvIDMpOyAvLyBwb3NpdGlvbklkQW5kRmFjZUlkTWFwW3Bvc2l0aW9uSWRMaXN0W21dXTsKCgogICAgICAgICAgdmFyIGZhY2VOb3JtYWwgPSBmYWNlSWRBbmROb3JtYWxNYXBbX2ZhY2VJZF07CiAgICAgICAgICB2YXIgYW5nbGUgPSB0aGlzTm9ybWFsLmFuZ2xlVG8oZmFjZU5vcm1hbCkgKiByYWQyZGVncmVlOwoKICAgICAgICAgIGlmIChhbmdsZSA8IHNoYWRpbmdTbW9vdGhBbmdsZSkgewogICAgICAgICAgICBzdW1Ob3JtYWwuYWRkKGZhY2VOb3JtYWwpOwogICAgICAgICAgfSAvLyBkZWJ1Zy5sb2coaSwgbSwgdGhpc05vcm1hbCwgZmFjZU5vcm1hbCwgYW5nbGUpOwoKICAgICAgICB9IC8vIGNiID0gdGhpc05vcm1hbDsvL25vcm1hbE1hcC5nZXQocG9zaXRpb25JZEFuZEtleU1hcC5nZXQoaWQpKTsKCgogICAgICAgIHN1bU5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICBub3JtYWxzW19pNV0gPSBzdW1Ob3JtYWwueDsKICAgICAgICBub3JtYWxzW19pNSArIDFdID0gc3VtTm9ybWFsLnk7CiAgICAgICAgbm9ybWFsc1tfaTUgKyAyXSA9IHN1bU5vcm1hbC56OwogICAgICB9IC8vIGRlYnVnLmxvZygiYXNzaWduIG5vcm1hbCB0byBlYWNoIHBvaW50Iik7CiAgICAgIC8vIGRlYnVnLmxvZygibm9ybWFsaXplTm9ybWFscyIpOwogICAgICAvLyB0aGlzLm5vcm1hbGl6ZU5vcm1hbHMoKTsKICAgICAgLy8gZGVidWcubG9nKCJub3JtYWxpemVOb3JtYWxzIik7CgoKICAgICAgYXR0cmlidXRlcy5ub3JtYWwubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgfQogIH0sCiAgLy8gUHJlQ2FsY3VsYXRpb246IGZ1bmN0aW9uICggcGFyYW1ldGVycyApCiAgcGVyQ2hhckNhbGN1bGF0aW9uOiBmdW5jdGlvbiBwZXJDaGFyQ2FsY3VsYXRpb24oKSB7CiAgICAvLyBjb25zb2xlLnRpbWUoJ3BlckNoYXJDYWxjdWxhdGlvbicpOwogICAgdmFyIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXM7CiAgICB2YXIgcG9zaXRpb25zID0gYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTsKICAgIHZhciB2ZXJ0ZXhOdW1iID0gcGFyc2VJbnQocG9zaXRpb25zLmxlbmd0aCAvIDMpOyAvLyBsZXQgY2VudGVyPSBuZXcgVmVjdG9yMygpOy8vIG1pblgsIG1heFgsIG1pblksIG1heFksIG1pblosIG1heFo7CiAgICAvLyBbIGNlbnRlciwgbWluWCwgbWF4WCwgbWluWSwgbWF4WSwgbWluWiwgbWF4Wl0gPSB0aGlzLkNhbGN1bGF0ZUJvdW5kaW5nQm94QW5kQ2VudGVyKGdlb21ldHJ5KTsKCiAgICBpZiAodGhpcy5ib3VuZGluZ0JveCA9PT0gbnVsbCkgewogICAgICB0aGlzLmNvbXB1dGVCb3VuZGluZ0JveCgpOwogICAgfQoKICAgIHZhciBjZW50ZXIgPSBuZXcgVmVjdG9yMygpOwogICAgdGhpcy5ib3VuZGluZ0JveC5nZXRDZW50ZXIoY2VudGVyKTsKICAgIHZhciBtaW5YID0gdGhpcy5ib3VuZGluZ0JveC5taW4ueDsKICAgIHZhciBtYXhYID0gdGhpcy5ib3VuZGluZ0JveC5tYXgueDsgLy8gbGV0IGNoYXJDZW50ZXJBcnJheSA9IFtdOy8vPSBuZXcgQXJyYXkoZ2VvbWV0cnkuY2hhclZlcnRleEZsYWdBcnJheVtnZW9tZXRyeS5jaGFyVmVydGV4RmxhZ0FycmF5Lmxlbmd0aC0xXSk7CiAgICAvLyBsZXQgY2hhclZlcnRleENvdW50QXJyYXkgPSBbXTsKICAgIC8vIGxldCBjaGFyQ2VudGVyQXJyYXlUID0gW107CiAgICAvLwogICAgLy8gY2FsY3VsYXRlIGNlbnRlciBhbmQgYmJ4IGZvciBlYWNoIGNoYXIKICAgIC8vCgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZXJ0ZXhOdW1iOyBpKyspIHsKICAgICAgLy8gbmV3VmVydGljZXNbaV0gPSBnZW9tZXRyeS52ZXJ0aWNlc1tpXS5jbG9uZSgpOy8vbmV3IFZlY3RvcjMoKTsKICAgICAgdmFyIGNoYXJJRCA9IHRoaXMuY2hhclZlcnRleEZsYWdBcnJheVtpXTsKCiAgICAgIGlmICh0aGlzLmNoYXJCQm94QXJyYXlbY2hhcklEXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpcy5jaGFyQkJveEFycmF5W2NoYXJJRF0gPSBuZXcgQm94MygpOwogICAgICB9CgogICAgICBpZiAodGhpcy5jaGFyQ2VudGVyQXJyYXlbY2hhcklEXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpcy5jaGFyQ2VudGVyQXJyYXlbY2hhcklEXSA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIH0KCiAgICAgIHZhciB0ZW1wUG9zaXRpb24gPSBuZXcgVmVjdG9yMygpOwogICAgICB0ZW1wUG9zaXRpb24uZnJvbUFycmF5KHBvc2l0aW9ucywgaSAqIDMpOyAvLyB0aGlzLmNoYXJDZW50ZXJBcnJheVtjaGFySURdLmFkZCh0ZW1wUG9zaXRpb24pOy8vIGdlb21ldHJ5LnZlcnRpY2VzW2ldKTsKCiAgICAgIHRoaXMuY2hhckJCb3hBcnJheVtjaGFySURdLmV4cGFuZEJ5UG9pbnQodGVtcFBvc2l0aW9uKTsKCiAgICAgIGlmICh0aGlzLmNoYXJWZXJ0ZXhDb3VudEFycmF5W2NoYXJJRF0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuY2hhclZlcnRleENvdW50QXJyYXlbY2hhcklEXSA9IDA7CiAgICAgIH0KCiAgICAgIHRoaXMuY2hhclZlcnRleENvdW50QXJyYXlbY2hhcklEXSA9IHRoaXMuY2hhclZlcnRleENvdW50QXJyYXlbY2hhcklEXSArIDE7CiAgICB9CgogICAgZm9yICh2YXIgX2k2ID0gMDsgX2k2IDwgdGhpcy5jaGFyVmVydGV4Q291bnRBcnJheS5sZW5ndGg7IF9pNisrKSB7CiAgICAgIHZhciBfY2hhcklEID0gX2k2OyAvLyB0aGlzLmNoYXJDZW50ZXJBcnJheVtpXS5kaXZpZGVTY2FsYXIodGhpcy5jaGFyVmVydGV4Q291bnRBcnJheVtpXSk7CgogICAgICB0aGlzLmNoYXJCQm94QXJyYXlbX2NoYXJJRF0uZ2V0Q2VudGVyKHRoaXMuY2hhckNlbnRlckFycmF5W19jaGFySURdKTsgLy8gdGhpcy5jaGFyQ2VudGVyQXJyYXlbaV0ueSA9IGNlbnRlci55OwogICAgICAvLyBjaGFyQ2VudGVyQXJyYXlULnB1c2goIChjaGFyQ2VudGVyQXJyYXlbaV0ueC0gbWluWCkgLyAoIG1heFggLSBtaW5YKSArIHBhcmFtZXRlcnMub2Zmc2V0WCk7CgoKICAgICAgdGhpcy5jaGFyQ2VudGVyQXJyYXlULnB1c2goKHRoaXMuY2hhckNlbnRlckFycmF5W19jaGFySURdLnggLSBtaW5YKSAvIChtYXhYIC0gbWluWCkpOwogICAgfSAvLyByZXR1cm4gW2NlbnRlciwgbWluWCwgbWF4WCwgbWluWSwgbWF4WSwgbWluWiwgbWF4WiwgY2hhckNlbnRlckFycmF5LCBjaGFyQ2VudGVyQXJyYXlUXQogICAgLy8gY29uc29sZS50aW1lRW5kKCdwZXJDaGFyQ2FsY3VsYXRpb24nKTsKCiAgfSwKICBtZXJnZVNhbWVWZXJ0ZXg6IGZ1bmN0aW9uIG1lcmdlU2FtZVZlcnRleCgpIHsKICAgIGRlYnVnLnRpbWUoJ21lcmdlU2FtZVZlcnRleCcpOwogICAgdmFyIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXM7CiAgICB2YXIgcG9zaXRpb25zID0gYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTsKICAgIHZhciBub3JtYWxzID0gYXR0cmlidXRlcy5ub3JtYWwuYXJyYXk7CiAgICB2YXIgdXZzID0gYXR0cmlidXRlcy51di5hcnJheTsKICAgIGRlYnVnLmxvZygnYmVmb3JlIG1lcmdlIHRoZSB2ZXJ0ZXggbnVtYmVyIGlzICcgKyBwb3NpdGlvbnMubGVuZ3RoKTsgLy8gZGVidWcubG9nKHBvc2l0aW9ucyk7CiAgICAvLyBkZWJ1Zy5sb2cobm9ybWFscyk7CiAgICAvLyBkZWJ1Zy5sb2codXZzKTsKICAgIC8vIGlmICggYXR0cmlidXRlcy5ub3JtYWwgPT09IHVuZGVmaW5lZCApIHsKICAgIC8vIHRoaXMuYWRkQXR0cmlidXRlKCAnbm9ybWFsJywgbmV3IEJ1ZmZlckF0dHJpYnV0ZSggbmV3IEZsb2F0MzJBcnJheSggcG9zaXRpb25zLmxlbmd0aCApLCAzICkgKTsKICAgIC8vIH0gZWxzZSB7CiAgICAvLyAvLyByZXNldCBleGlzdGluZyBub3JtYWxzIHRvIHplcm8KICAgIC8vIGxldCBhcnJheSA9IGF0dHJpYnV0ZXMubm9ybWFsLmFycmF5OwogICAgLy8gZm9yICggbGV0IGkgPSAwLCBpbCA9IGFycmF5Lmxlbmd0aDsgaSA8IGlsOyBpICsrICkgewogICAgLy8gYXJyYXlbIGkgXSA9IDA7CiAgICAvLyB9CiAgICAvLyB9CgogICAgdmFyIGluZGV4TnVtYiA9IHBhcnNlSW50KHBvc2l0aW9ucy5sZW5ndGggLyAzKTsgLy8gbGV0IGZhY2VJZEFuZE5vcm1hbE1hcCA9IHt9Oy8vbmV3IE1hcCgpOwogICAgLy8gbGV0IHBvc2l0aW9uSWRBbmRLZXlNYXAgPSB7fTsvL25ldyBNYXAoKTsKICAgIC8vIGxldCBwb3NpdGlvbklkQW5kRmFjZUlkTWFwID0ge307Ly9uZXcgTWFwKCk7CgogICAgdmFyIEtleUFuZFBvc2l0aW9uSWRNYXAgPSB7fTsgLy8gbmV3IE1hcCgpOwogICAgLy8gaXRlcmF0ZSBwb2ludHMKCiAgICB2YXIgbmV3SW5kZXggPSBbXTsKICAgIHZhciBuZXdQb3NpdGlvbnMgPSBbXTsKICAgIHZhciBuZXdOb3JtYWxzID0gW107CiAgICB2YXIgbmV3VXZzID0gW107CiAgICB2YXIgbmV3Q2hhclZlcnRleEZsYWdBcnJheSA9IFtdOyAvLyBbXTsKCiAgICB2YXIgbmV3SW5kZXhDb3VudCA9IDA7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRleE51bWI7IGkrKykgewogICAgICB2YXIgdGVtcFBvc2l0aW9uID0gbmV3IFZlY3RvcjMoKTsKICAgICAgdmFyIHRlbXBOb3JtYWwgPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgdGVtcFV2ID0gbmV3IFZlY3RvcjIoKTsKICAgICAgdmFyIHRlbXBDaGFyVmVydGV4RmxhZyA9IHRoaXMuY2hhclZlcnRleEZsYWdBcnJheVtpXTsKICAgICAgdGVtcFBvc2l0aW9uLmZyb21BcnJheShwb3NpdGlvbnMsIGkgKiAzKTsKICAgICAgdGVtcE5vcm1hbC5mcm9tQXJyYXkobm9ybWFscywgaSAqIDMpOwogICAgICB0ZW1wVXYuZnJvbUFycmF5KHV2cywgaSAqIDIpOwogICAgICB2YXIgbWF0ZXJpYWxJZCA9IDE7CgogICAgICBmb3IgKHZhciBnSWQgPSAwOyBnSWQgPCB0aGlzLmdyb3Vwcy5sZW5ndGg7IGdJZCA9IGdJZCArIDIpIHsKICAgICAgICBpZiAoaSA+PSB0aGlzLmdyb3Vwc1tnSWRdLnN0YXJ0ICYmIGkgPD0gdGhpcy5ncm91cHNbZ0lkXS5zdGFydCArIHRoaXMuZ3JvdXBzW2dJZF0uY291bnQgLSAxKSB7CiAgICAgICAgICBtYXRlcmlhbElkID0gMDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSAvLyBsZXQga2V5ID0gcEEueC50b0ZpeGVkKGZsb2F0UG9pbnROdW1iKSsnKycrcEEueS50b0ZpeGVkKGZsb2F0UG9pbnROdW1iKSsnKycrcEEuei50b0ZpeGVkKGZsb2F0UG9pbnROdW1iKSsnKycrIG1hdGVyaWFsX2lkOy8vKyBwQi54K3BCLnkrcEIueisgcEMueCtwQy55K3BDLno7CgoKICAgICAgdmFyIGtleSA9ICcnICsgTWF0aC5mbG9vcih0ZW1wUG9zaXRpb24ueCAqIDEwMDAwKSArIE1hdGguZmxvb3IodGVtcFBvc2l0aW9uLnkgKiAxMDAwMCkgKyBNYXRoLmZsb29yKHRlbXBQb3NpdGlvbi56ICogMTAwMDApICsgTWF0aC5mbG9vcih0ZW1wTm9ybWFsLnggKiAxMDAwMCkgKyBNYXRoLmZsb29yKHRlbXBOb3JtYWwueSAqIDEwMDAwKSArIE1hdGguZmxvb3IodGVtcE5vcm1hbC56ICogMTAwMDApICsgTWF0aC5mbG9vcih0ZW1wVXYueCAqIDEwMDAwKSArIE1hdGguZmxvb3IodGVtcFV2LnkgKiAxMDAwMCkgKyBtYXRlcmlhbElkOwoKICAgICAgaWYgKCFLZXlBbmRQb3NpdGlvbklkTWFwW2tleV0pIHsKICAgICAgICBLZXlBbmRQb3NpdGlvbklkTWFwW2tleV0gPSBuZXdJbmRleENvdW50OwogICAgICAgIG5ld1Bvc2l0aW9ucy5wdXNoKHRlbXBQb3NpdGlvbik7CiAgICAgICAgbmV3Tm9ybWFscy5wdXNoKHRlbXBOb3JtYWwpOwogICAgICAgIG5ld1V2cy5wdXNoKHRlbXBVdik7CiAgICAgICAgbmV3SW5kZXgucHVzaChuZXdJbmRleENvdW50KTsKICAgICAgICBuZXdJbmRleENvdW50Kys7CiAgICAgICAgbmV3Q2hhclZlcnRleEZsYWdBcnJheS5wdXNoKHRlbXBDaGFyVmVydGV4RmxhZyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV3SW5kZXgucHVzaChLZXlBbmRQb3NpdGlvbklkTWFwW2tleV0pOwogICAgICB9CiAgICB9IC8vIGxldCBuZXdJbmRleEJ1ZmZlckF0dHJpYnV0ZSA9IG5ldyBVaW50MzJCdWZmZXJBdHRyaWJ1dGUoIG5ldyBVaW50MzJBcnJheSggbmV3SW5kZXgubGVuZ3RoICksIDEgKTsKICAgIC8vIG5ld0luZGV4QnVmZmVyQXR0cmlidXRlLmNvcHlBcnJheSggbmV3SW5kZXggKTsKCgogICAgdmFyIG5ld1Bvc2l0aW9uQnVmZmVyQXR0cmlidXRlID0gbmV3IEZsb2F0MzJCdWZmZXJBdHRyaWJ1dGUobmV3IEZsb2F0MzJBcnJheShuZXdQb3NpdGlvbnMubGVuZ3RoICogMyksIDMpOwogICAgbmV3UG9zaXRpb25CdWZmZXJBdHRyaWJ1dGUuY29weVZlY3RvcjNzQXJyYXkobmV3UG9zaXRpb25zKTsKICAgIHZhciBuZXdOb3JtYWxCdWZmZXJBdHRyaWJ1dGUgPSBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShuZXcgRmxvYXQzMkFycmF5KG5ld1Bvc2l0aW9ucy5sZW5ndGggKiAzKSwgMyk7CiAgICBuZXdOb3JtYWxCdWZmZXJBdHRyaWJ1dGUuY29weVZlY3RvcjNzQXJyYXkobmV3Tm9ybWFscyk7CiAgICB2YXIgbmV3VXZCdWZmZXJBdHRyaWJ1dGUgPSBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZShuZXcgRmxvYXQzMkFycmF5KG5ld1V2cy5sZW5ndGggKiAyKSwgMik7CiAgICBuZXdVdkJ1ZmZlckF0dHJpYnV0ZS5jb3B5VmVjdG9yMnNBcnJheShuZXdVdnMpOwogICAgdGhpcy5zZXRJbmRleFl1bnlhbmcobmV3SW5kZXgpOwogICAgYXR0cmlidXRlcy5wb3NpdGlvbi5jb3B5KG5ld1Bvc2l0aW9uQnVmZmVyQXR0cmlidXRlKTsKICAgIGF0dHJpYnV0ZXMubm9ybWFsLmNvcHkobmV3Tm9ybWFsQnVmZmVyQXR0cmlidXRlKTsKICAgIGF0dHJpYnV0ZXMudXYuY29weShuZXdVdkJ1ZmZlckF0dHJpYnV0ZSk7CiAgICBhdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgIGF0dHJpYnV0ZXMubm9ybWFsLm5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgIGF0dHJpYnV0ZXMudXYubmVlZHNVcGRhdGUgPSB0cnVlOwogICAgdGhpcy5jaGFyVmVydGV4RmxhZ0FycmF5ID0gbmV3Q2hhclZlcnRleEZsYWdBcnJheTsKICAgIGRlYnVnLmxvZygnYWZ0ZXIgbWVyZ2UgdGhlIHZlcnRleCBudW1iZXIgaXMgOiAnICsgbmV3UG9zaXRpb25zLmxlbmd0aCk7IC8vIGRlYnVnLmxvZyh0aGlzLmluZGV4KTsKICAgIC8vIGRlYnVnLmxvZyhuZXdQb3NpdGlvbkJ1ZmZlckF0dHJpYnV0ZSk7CiAgICAvLyBkZWJ1Zy5sb2cobmV3Tm9ybWFsQnVmZmVyQXR0cmlidXRlKTsKICAgIC8vIGRlYnVnLmxvZyhuZXdVdkJ1ZmZlckF0dHJpYnV0ZSk7CgogICAgZGVidWcudGltZUVuZCgnbWVyZ2VTYW1lVmVydGV4Jyk7CiAgfSwKICBtZXJnZTogZnVuY3Rpb24gbWVyZ2UoZ2VvbWV0cnksIG9mZnNldCkgewogICAgaWYgKCEoZ2VvbWV0cnkgJiYgZ2VvbWV0cnkuaXNCdWZmZXJHZW9tZXRyeSkpIHsKICAgICAgY29uc29sZS5lcnJvcignVEhSRUUuQnVmZmVyR2VvbWV0cnkubWVyZ2UoKTogZ2VvbWV0cnkgbm90IGFuIGluc3RhbmNlIG9mIFRIUkVFLkJ1ZmZlckdlb21ldHJ5LicsIGdlb21ldHJ5KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgewogICAgICBvZmZzZXQgPSAwOwogICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJ1ZmZlckdlb21ldHJ5Lm1lcmdlKCk6IE92ZXJ3cml0aW5nIG9yaWdpbmFsIGdlb21ldHJ5LCBzdGFydGluZyBhdCBvZmZzZXQ9MC4gJyArICdVc2UgQnVmZmVyR2VvbWV0cnlVdGlscy5tZXJnZUJ1ZmZlckdlb21ldHJpZXMoKSBmb3IgbG9zc2xlc3MgbWVyZ2UuJyk7CiAgICB9CgogICAgdmFyIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXM7CgogICAgZm9yICh2YXIga2V5IGluIGF0dHJpYnV0ZXMpIHsKICAgICAgaWYgKGdlb21ldHJ5LmF0dHJpYnV0ZXNba2V5XSA9PT0gdW5kZWZpbmVkKSBjb250aW51ZTsKICAgICAgdmFyIGF0dHJpYnV0ZTEgPSBhdHRyaWJ1dGVzW2tleV07CiAgICAgIHZhciBhdHRyaWJ1dGVBcnJheTEgPSBhdHRyaWJ1dGUxLmFycmF5OwogICAgICB2YXIgYXR0cmlidXRlMiA9IGdlb21ldHJ5LmF0dHJpYnV0ZXNba2V5XTsKICAgICAgdmFyIGF0dHJpYnV0ZUFycmF5MiA9IGF0dHJpYnV0ZTIuYXJyYXk7CiAgICAgIHZhciBhdHRyaWJ1dGVTaXplID0gYXR0cmlidXRlMi5pdGVtU2l6ZTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBqID0gYXR0cmlidXRlU2l6ZSAqIG9mZnNldDsgaSA8IGF0dHJpYnV0ZUFycmF5Mi5sZW5ndGg7IGkrKywgaisrKSB7CiAgICAgICAgYXR0cmlidXRlQXJyYXkxW2pdID0gYXR0cmlidXRlQXJyYXkyW2ldOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBub3JtYWxpemVOb3JtYWxzOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgdmVjdG9yID0gbmV3IFZlY3RvcjMoKTsKICAgIHJldHVybiBmdW5jdGlvbiBub3JtYWxpemVOb3JtYWxzKCkgewogICAgICB2YXIgbm9ybWFscyA9IHRoaXMuYXR0cmlidXRlcy5ub3JtYWw7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWwgPSBub3JtYWxzLmNvdW50OyBpIDwgaWw7IGkrKykgewogICAgICAgIHZlY3Rvci54ID0gbm9ybWFscy5nZXRYKGkpOwogICAgICAgIHZlY3Rvci55ID0gbm9ybWFscy5nZXRZKGkpOwogICAgICAgIHZlY3Rvci56ID0gbm9ybWFscy5nZXRaKGkpOwogICAgICAgIHZlY3Rvci5ub3JtYWxpemUoKTsKICAgICAgICBub3JtYWxzLnNldFhZWihpLCB2ZWN0b3IueCwgdmVjdG9yLnksIHZlY3Rvci56KTsKICAgICAgfQogICAgfTsKICB9KCksCiAgdG9Ob25JbmRleGVkOiBmdW5jdGlvbiB0b05vbkluZGV4ZWQoKSB7CiAgICBpZiAodGhpcy5pbmRleCA9PT0gbnVsbCkgewogICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJ1ZmZlckdlb21ldHJ5LnRvTm9uSW5kZXhlZCgpOiBHZW9tZXRyeSBpcyBhbHJlYWR5IG5vbi1pbmRleGVkLicpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICB2YXIgZ2VvbWV0cnkyID0gbmV3IEJ1ZmZlckdlb21ldHJ5KCk7CiAgICB2YXIgaW5kaWNlcyA9IHRoaXMuaW5kZXguYXJyYXk7CiAgICB2YXIgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlczsKCiAgICBmb3IgKHZhciBuYW1lIGluIGF0dHJpYnV0ZXMpIHsKICAgICAgdmFyIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbbmFtZV07CiAgICAgIHZhciBhcnJheSA9IGF0dHJpYnV0ZS5hcnJheTsKICAgICAgdmFyIGl0ZW1TaXplID0gYXR0cmlidXRlLml0ZW1TaXplOwogICAgICB2YXIgYXJyYXkyID0gbmV3IGFycmF5LmNvbnN0cnVjdG9yKGluZGljZXMubGVuZ3RoICogaXRlbVNpemUpOwogICAgICB2YXIgaW5kZXggPSAwOwogICAgICB2YXIgaW5kZXgyID0gMDsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gaW5kaWNlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBpbmRleCA9IGluZGljZXNbaV0gKiBpdGVtU2l6ZTsKCiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpdGVtU2l6ZTsgaisrKSB7CiAgICAgICAgICBhcnJheTJbaW5kZXgyKytdID0gYXJyYXlbaW5kZXgrK107CiAgICAgICAgfQogICAgICB9CgogICAgICBnZW9tZXRyeTIuYWRkQXR0cmlidXRlKG5hbWUsIG5ldyBCdWZmZXJBdHRyaWJ1dGUoYXJyYXkyLCBpdGVtU2l6ZSkpOwogICAgfQoKICAgIHZhciBncm91cHMgPSB0aGlzLmdyb3VwczsKCiAgICBmb3IgKHZhciBfaTcgPSAwLCBfbCA9IGdyb3Vwcy5sZW5ndGg7IF9pNyA8IF9sOyBfaTcrKykgewogICAgICB2YXIgZ3JvdXAgPSBncm91cHNbX2k3XTsKICAgICAgZ2VvbWV0cnkyLmFkZEdyb3VwKGdyb3VwLnN0YXJ0LCBncm91cC5jb3VudCwgZ3JvdXAubWF0ZXJpYWxJbmRleCk7CiAgICB9CgogICAgcmV0dXJuIGdlb21ldHJ5MjsKICB9LAogIHRvSlNPTjogZnVuY3Rpb24gdG9KU09OKCkgewogICAgdmFyIGRhdGEgPSB7CiAgICAgIG1ldGFkYXRhOiB7CiAgICAgICAgdmVyc2lvbjogNC41LAogICAgICAgIHR5cGU6ICdCdWZmZXJHZW9tZXRyeScsCiAgICAgICAgZ2VuZXJhdG9yOiAnQnVmZmVyR2VvbWV0cnkudG9KU09OJwogICAgICB9CiAgICB9OyAvLyBzdGFuZGFyZCBCdWZmZXJHZW9tZXRyeSBzZXJpYWxpemF0aW9uCgogICAgZGF0YS51dWlkID0gdGhpcy51dWlkOwogICAgZGF0YS50eXBlID0gdGhpcy50eXBlOwogICAgaWYgKHRoaXMubmFtZSAhPT0gJycpIGRhdGEubmFtZSA9IHRoaXMubmFtZTsKICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLnVzZXJEYXRhKS5sZW5ndGggPiAwKSBkYXRhLnVzZXJEYXRhID0gdGhpcy51c2VyRGF0YTsKCiAgICBpZiAodGhpcy5wYXJhbWV0ZXJzICE9PSB1bmRlZmluZWQpIHsKICAgICAgdmFyIHBhcmFtZXRlcnMgPSB0aGlzLnBhcmFtZXRlcnM7CgogICAgICBmb3IgKHZhciBrZXkgaW4gcGFyYW1ldGVycykgewogICAgICAgIGlmIChwYXJhbWV0ZXJzW2tleV0gIT09IHVuZGVmaW5lZCkgZGF0YVtrZXldID0gcGFyYW1ldGVyc1trZXldOwogICAgICB9CgogICAgICByZXR1cm4gZGF0YTsKICAgIH0KCiAgICBkYXRhLmRhdGEgPSB7CiAgICAgIGF0dHJpYnV0ZXM6IHt9CiAgICB9OwogICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleDsKCiAgICBpZiAoaW5kZXggIT09IG51bGwpIHsKICAgICAgdmFyIGFycmF5ID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoaW5kZXguYXJyYXkpOwogICAgICBkYXRhLmRhdGEuaW5kZXggPSB7CiAgICAgICAgdHlwZTogaW5kZXguYXJyYXkuY29uc3RydWN0b3IubmFtZSwKICAgICAgICBhcnJheTogYXJyYXkKICAgICAgfTsKICAgIH0KCiAgICB2YXIgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlczsKCiAgICBmb3IgKHZhciBfa2V5MiBpbiBhdHRyaWJ1dGVzKSB7CiAgICAgIHZhciBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW19rZXkyXTsKCiAgICAgIHZhciBfYXJyYXkgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhdHRyaWJ1dGUuYXJyYXkpOwoKICAgICAgZGF0YS5kYXRhLmF0dHJpYnV0ZXNbX2tleTJdID0gewogICAgICAgIGl0ZW1TaXplOiBhdHRyaWJ1dGUuaXRlbVNpemUsCiAgICAgICAgdHlwZTogYXR0cmlidXRlLmFycmF5LmNvbnN0cnVjdG9yLm5hbWUsCiAgICAgICAgYXJyYXk6IF9hcnJheSwKICAgICAgICBub3JtYWxpemVkOiBhdHRyaWJ1dGUubm9ybWFsaXplZAogICAgICB9OwogICAgfQoKICAgIHZhciBncm91cHMgPSB0aGlzLmdyb3VwczsKCiAgICBpZiAoZ3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgZGF0YS5kYXRhLmdyb3VwcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZ3JvdXBzKSk7CiAgICB9CgogICAgdmFyIGJvdW5kaW5nU3BoZXJlID0gdGhpcy5ib3VuZGluZ1NwaGVyZTsKCiAgICBpZiAoYm91bmRpbmdTcGhlcmUgIT09IG51bGwpIHsKICAgICAgZGF0YS5kYXRhLmJvdW5kaW5nU3BoZXJlID0gewogICAgICAgIGNlbnRlcjogYm91bmRpbmdTcGhlcmUuY2VudGVyLnRvQXJyYXkoKSwKICAgICAgICByYWRpdXM6IGJvdW5kaW5nU3BoZXJlLnJhZGl1cwogICAgICB9OwogICAgfQoKICAgIHJldHVybiBkYXRhOwogIH0sCiAgY2xvbmU6IGZ1bmN0aW9uIGNsb25lKCkgewogICAgcmV0dXJuIG5ldyBCdWZmZXJHZW9tZXRyeSgpLmNvcHkodGhpcyk7CiAgfSwKICBjb3B5OiBmdW5jdGlvbiBjb3B5KHNvdXJjZSkgewogICAgdmFyIG5hbWUsIGksIGw7IC8vIHJlc2V0CgogICAgdGhpcy5pbmRleCA9IG51bGw7CiAgICB0aGlzLmF0dHJpYnV0ZXMgPSB7fTsKICAgIHRoaXMubW9ycGhBdHRyaWJ1dGVzID0ge307CiAgICB0aGlzLmdyb3VwcyA9IFtdOwogICAgdGhpcy5ib3VuZGluZ0JveCA9IG51bGw7CiAgICB0aGlzLmJvdW5kaW5nU3BoZXJlID0gbnVsbDsgLy8gbmFtZQoKICAgIHRoaXMubmFtZSA9IHNvdXJjZS5uYW1lOyAvLyBpbmRleAoKICAgIHZhciBpbmRleCA9IHNvdXJjZS5pbmRleDsKCiAgICBpZiAoaW5kZXggIT09IG51bGwpIHsKICAgICAgdGhpcy5zZXRJbmRleChpbmRleC5jbG9uZSgpKTsKICAgIH0gLy8gYXR0cmlidXRlcwoKCiAgICB2YXIgYXR0cmlidXRlcyA9IHNvdXJjZS5hdHRyaWJ1dGVzOwoKICAgIGZvciAobmFtZSBpbiBhdHRyaWJ1dGVzKSB7CiAgICAgIHZhciBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW25hbWVdOwogICAgICB0aGlzLmFkZEF0dHJpYnV0ZShuYW1lLCBhdHRyaWJ1dGUuY2xvbmUoKSk7CiAgICB9IC8vIG1vcnBoIGF0dHJpYnV0ZXMKCgogICAgdmFyIG1vcnBoQXR0cmlidXRlcyA9IHNvdXJjZS5tb3JwaEF0dHJpYnV0ZXM7CgogICAgZm9yIChuYW1lIGluIG1vcnBoQXR0cmlidXRlcykgewogICAgICB2YXIgYXJyYXkgPSBbXTsKICAgICAgdmFyIG1vcnBoQXR0cmlidXRlID0gbW9ycGhBdHRyaWJ1dGVzW25hbWVdOyAvLyBtb3JwaEF0dHJpYnV0ZTogYXJyYXkgb2YgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZXMKCiAgICAgIGZvciAoaSA9IDAsIGwgPSBtb3JwaEF0dHJpYnV0ZS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBhcnJheS5wdXNoKG1vcnBoQXR0cmlidXRlW2ldLmNsb25lKCkpOwogICAgICB9CgogICAgICB0aGlzLm1vcnBoQXR0cmlidXRlc1tuYW1lXSA9IGFycmF5OwogICAgfSAvLyBncm91cHMKCgogICAgdmFyIGdyb3VwcyA9IHNvdXJjZS5ncm91cHM7CgogICAgZm9yIChpID0gMCwgbCA9IGdyb3Vwcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmFyIGdyb3VwID0gZ3JvdXBzW2ldOwogICAgICB0aGlzLmFkZEdyb3VwKGdyb3VwLnN0YXJ0LCBncm91cC5jb3VudCwgZ3JvdXAubWF0ZXJpYWxJbmRleCk7CiAgICB9IC8vIGJvdW5kaW5nIGJveAoKCiAgICB2YXIgYm91bmRpbmdCb3ggPSBzb3VyY2UuYm91bmRpbmdCb3g7CgogICAgaWYgKGJvdW5kaW5nQm94ICE9PSBudWxsKSB7CiAgICAgIHRoaXMuYm91bmRpbmdCb3ggPSBib3VuZGluZ0JveC5jbG9uZSgpOwogICAgfSAvLyBib3VuZGluZyBzcGhlcmUKCgogICAgdmFyIGJvdW5kaW5nU3BoZXJlID0gc291cmNlLmJvdW5kaW5nU3BoZXJlOwoKICAgIGlmIChib3VuZGluZ1NwaGVyZSAhPT0gbnVsbCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlID0gYm91bmRpbmdTcGhlcmUuY2xvbmUoKTsKICAgIH0gLy8gZHJhdyByYW5nZQoKCiAgICB0aGlzLmRyYXdSYW5nZS5zdGFydCA9IHNvdXJjZS5kcmF3UmFuZ2Uuc3RhcnQ7CiAgICB0aGlzLmRyYXdSYW5nZS5jb3VudCA9IHNvdXJjZS5kcmF3UmFuZ2UuY291bnQ7IC8vIHVzZXIgZGF0YQoKICAgIHRoaXMudXNlckRhdGEgPSBzb3VyY2UudXNlckRhdGE7CiAgICByZXR1cm4gdGhpczsKICB9LAogIGRpc3Bvc2U6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoewogICAgICB0eXBlOiAnZGlzcG9zZScKICAgIH0pOwogIH0KfSk7CgovKioKICogQGF1dGhvciBiaG91c3RvbiAvIGh0dHA6Ly9jbGFyYS5pbwogKi8KCnZhciBCb3gyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBCb3gyKG1pbiwgbWF4KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQm94Mik7CgogICAgdGhpcy5taW4gPSBtaW4gIT09IHVuZGVmaW5lZCA/IG1pbiA6IG5ldyBWZWN0b3IyKCtJbmZpbml0eSwgK0luZmluaXR5KTsKICAgIHRoaXMubWF4ID0gbWF4ICE9PSB1bmRlZmluZWQgPyBtYXggOiBuZXcgVmVjdG9yMigtSW5maW5pdHksIC1JbmZpbml0eSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQm94MiwgW3sKICAgIGtleTogInNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0KG1pbiwgbWF4KSB7CiAgICAgIHRoaXMubWluLmNvcHkobWluKTsKICAgICAgdGhpcy5tYXguY29weShtYXgpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRGcm9tUG9pbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGcm9tUG9pbnRzKHBvaW50cykgewogICAgICB0aGlzLm1ha2VFbXB0eSgpOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGlsID0gcG9pbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHsKICAgICAgICB0aGlzLmV4cGFuZEJ5UG9pbnQocG9pbnRzW2ldKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0RnJvbUNlbnRlckFuZFNpemUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZyb21DZW50ZXJBbmRTaXplKGNlbnRlciwgc2l6ZSkgewogICAgICB2YXIgaGFsZlNpemUgPSBzaXplLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoMC41KTsKICAgICAgdGhpcy5taW4uY29weShjZW50ZXIpLnN1YihoYWxmU2l6ZSk7CiAgICAgIHRoaXMubWF4LmNvcHkoY2VudGVyKS5hZGQoaGFsZlNpemUpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpLmNvcHkodGhpcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29weSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29weShib3gpIHsKICAgICAgdGhpcy5taW4uY29weShib3gubWluKTsKICAgICAgdGhpcy5tYXguY29weShib3gubWF4KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZUVtcHR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYWtlRW1wdHkoKSB7CiAgICAgIHRoaXMubWluLnggPSB0aGlzLm1pbi55ID0gK0luZmluaXR5OwogICAgICB0aGlzLm1heC54ID0gdGhpcy5tYXgueSA9IC1JbmZpbml0eTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNFbXB0eSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNFbXB0eSgpIHsKICAgICAgLy8gdGhpcyBpcyBhIG1vcmUgcm9idXN0IGNoZWNrIGZvciBlbXB0eSB0aGFuICggdm9sdW1lIDw9IDAgKSBiZWNhdXNlIHZvbHVtZSBjYW4gZ2V0IHBvc2l0aXZlIHdpdGggdHdvIG5lZ2F0aXZlIGF4ZXMKICAgICAgcmV0dXJuIHRoaXMubWF4LnggPCB0aGlzLm1pbi54IHx8IHRoaXMubWF4LnkgPCB0aGlzLm1pbi55OwogICAgfQogIH0sIHsKICAgIGtleTogImdldENlbnRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VudGVyKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJveDI6IC5nZXRDZW50ZXIoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkJyk7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlY3RvcjIoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuaXNFbXB0eSgpID8gdGFyZ2V0LnNldCgwLCAwKSA6IHRhcmdldC5hZGRWZWN0b3JzKHRoaXMubWluLCB0aGlzLm1heCkubXVsdGlwbHlTY2FsYXIoMC41KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTaXplIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTaXplKHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJveDI6IC5nZXRTaXplKCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZCcpOwogICAgICAgIHRhcmdldCA9IG5ldyBWZWN0b3IyKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmlzRW1wdHkoKSA/IHRhcmdldC5zZXQoMCwgMCkgOiB0YXJnZXQuc3ViVmVjdG9ycyh0aGlzLm1heCwgdGhpcy5taW4pOwogICAgfQogIH0sIHsKICAgIGtleTogImV4cGFuZEJ5UG9pbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV4cGFuZEJ5UG9pbnQocG9pbnQpIHsKICAgICAgdGhpcy5taW4ubWluKHBvaW50KTsKICAgICAgdGhpcy5tYXgubWF4KHBvaW50KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXhwYW5kQnlWZWN0b3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV4cGFuZEJ5VmVjdG9yKHZlY3RvcikgewogICAgICB0aGlzLm1pbi5zdWIodmVjdG9yKTsKICAgICAgdGhpcy5tYXguYWRkKHZlY3Rvcik7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogImV4cGFuZEJ5U2NhbGFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBleHBhbmRCeVNjYWxhcihzY2FsYXIpIHsKICAgICAgdGhpcy5taW4uYWRkU2NhbGFyKC1zY2FsYXIpOwogICAgICB0aGlzLm1heC5hZGRTY2FsYXIoc2NhbGFyKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29udGFpbnNQb2ludCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29udGFpbnNQb2ludChwb2ludCkgewogICAgICByZXR1cm4gIShwb2ludC54IDwgdGhpcy5taW4ueCB8fCBwb2ludC54ID4gdGhpcy5tYXgueCB8fCBwb2ludC55IDwgdGhpcy5taW4ueSB8fCBwb2ludC55ID4gdGhpcy5tYXgueSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29udGFpbnNCb3giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnRhaW5zQm94KGJveCkgewogICAgICByZXR1cm4gdGhpcy5taW4ueCA8PSBib3gubWluLnggJiYgYm94Lm1heC54IDw9IHRoaXMubWF4LnggJiYgdGhpcy5taW4ueSA8PSBib3gubWluLnkgJiYgYm94Lm1heC55IDw9IHRoaXMubWF4Lnk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UGFyYW1ldGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQYXJhbWV0ZXIocG9pbnQsIHRhcmdldCkgewogICAgICAvLyBUaGlzIGNhbiBwb3RlbnRpYWxseSBoYXZlIGEgZGl2aWRlIGJ5IHplcm8gaWYgdGhlIGJveAogICAgICAvLyBoYXMgYSBzaXplIGRpbWVuc2lvbiBvZiAwLgogICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1RIUkVFLkJveDI6IC5nZXRQYXJhbWV0ZXIoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkJyk7CiAgICAgICAgdGFyZ2V0ID0gbmV3IFZlY3RvcjIoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRhcmdldC5zZXQoKHBvaW50LnggLSB0aGlzLm1pbi54KSAvICh0aGlzLm1heC54IC0gdGhpcy5taW4ueCksIChwb2ludC55IC0gdGhpcy5taW4ueSkgLyAodGhpcy5tYXgueSAtIHRoaXMubWluLnkpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbnRlcnNlY3RzQm94IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnRlcnNlY3RzQm94KGJveCkgewogICAgICByZXR1cm4gIShib3gubWF4LnggPCB0aGlzLm1pbi54IHx8IGJveC5taW4ueCA+IHRoaXMubWF4LnggfHwgYm94Lm1heC55IDwgdGhpcy5taW4ueSB8fCBib3gubWluLnkgPiB0aGlzLm1heC55KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbGFtcFBvaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGFtcFBvaW50KHBvaW50LCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29uc29sZS53YXJuKCdUSFJFRS5Cb3gyOiAuY2xhbXBQb2ludCgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWQnKTsKICAgICAgICB0YXJnZXQgPSBuZXcgVmVjdG9yMigpOwogICAgICB9CgogICAgICByZXR1cm4gdGFyZ2V0LmNvcHkocG9pbnQpLmNsYW1wKHRoaXMubWluLCB0aGlzLm1heCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzdGFuY2VUb1BvaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXN0YW5jZVRvUG9pbnQocG9pbnQpIHsKICAgICAgdmFyIGNsYW1wZWRQb2ludCA9IHBvaW50LmNsb25lKCkuY2xhbXAodGhpcy5taW4sIHRoaXMubWF4KTsKICAgICAgcmV0dXJuIGNsYW1wZWRQb2ludC5zdWIocG9pbnQpLmxlbmd0aCgpOwogICAgfQogIH0sIHsKICAgIGtleTogImludGVyc2VjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW50ZXJzZWN0KGJveCkgewogICAgICB0aGlzLm1pbi5tYXgoYm94Lm1pbik7CiAgICAgIHRoaXMubWF4Lm1pbihib3gubWF4KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAidW5pb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVuaW9uKGJveCkgewogICAgICB0aGlzLm1pbi5taW4oYm94Lm1pbik7CiAgICAgIHRoaXMubWF4Lm1heChib3gubWF4KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAidHJhbnNsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0cmFuc2xhdGUob2Zmc2V0KSB7CiAgICAgIHRoaXMubWluLmFkZChvZmZzZXQpOwogICAgICB0aGlzLm1heC5hZGQob2Zmc2V0KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXF1YWxzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlcXVhbHMoYm94KSB7CiAgICAgIHJldHVybiBib3gubWluLmVxdWFscyh0aGlzLm1pbikgJiYgYm94Lm1heC5lcXVhbHModGhpcy5tYXgpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEJveDI7Cn0oKTsKCnZhciBlYXJjdXRfMSA9IGVhcmN1dDsKdmFyIGRlZmF1bHRfMSA9IGVhcmN1dDsKCmZ1bmN0aW9uIGVhcmN1dChkYXRhLCBob2xlSW5kaWNlcywgZGltKSB7CiAgZGltID0gZGltIHx8IDI7CiAgdmFyIGhhc0hvbGVzID0gaG9sZUluZGljZXMgJiYgaG9sZUluZGljZXMubGVuZ3RoLAogICAgICBvdXRlckxlbiA9IGhhc0hvbGVzID8gaG9sZUluZGljZXNbMF0gKiBkaW0gOiBkYXRhLmxlbmd0aCwKICAgICAgb3V0ZXJOb2RlID0gbGlua2VkTGlzdChkYXRhLCAwLCBvdXRlckxlbiwgZGltLCB0cnVlKSwKICAgICAgdHJpYW5nbGVzID0gW107CiAgaWYgKCFvdXRlck5vZGUgfHwgb3V0ZXJOb2RlLm5leHQgPT09IG91dGVyTm9kZS5wcmV2KSByZXR1cm4gdHJpYW5nbGVzOwogIHZhciBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZLCB4LCB5LCBpbnZTaXplOwogIGlmIChoYXNIb2xlcykgb3V0ZXJOb2RlID0gZWxpbWluYXRlSG9sZXMoZGF0YSwgaG9sZUluZGljZXMsIG91dGVyTm9kZSwgZGltKTsgLy8gaWYgdGhlIHNoYXBlIGlzIG5vdCB0b28gc2ltcGxlLCB3ZSdsbCB1c2Ugei1vcmRlciBjdXJ2ZSBoYXNoIGxhdGVyOyBjYWxjdWxhdGUgcG9seWdvbiBiYm94CgogIGlmIChkYXRhLmxlbmd0aCA+IDgwICogZGltKSB7CiAgICBtaW5YID0gbWF4WCA9IGRhdGFbMF07CiAgICBtaW5ZID0gbWF4WSA9IGRhdGFbMV07CgogICAgZm9yICh2YXIgaSA9IGRpbTsgaSA8IG91dGVyTGVuOyBpICs9IGRpbSkgewogICAgICB4ID0gZGF0YVtpXTsKICAgICAgeSA9IGRhdGFbaSArIDFdOwogICAgICBpZiAoeCA8IG1pblgpIG1pblggPSB4OwogICAgICBpZiAoeSA8IG1pblkpIG1pblkgPSB5OwogICAgICBpZiAoeCA+IG1heFgpIG1heFggPSB4OwogICAgICBpZiAoeSA+IG1heFkpIG1heFkgPSB5OwogICAgfSAvLyBtaW5YLCBtaW5ZIGFuZCBpbnZTaXplIGFyZSBsYXRlciB1c2VkIHRvIHRyYW5zZm9ybSBjb29yZHMgaW50byBpbnRlZ2VycyBmb3Igei1vcmRlciBjYWxjdWxhdGlvbgoKCiAgICBpbnZTaXplID0gTWF0aC5tYXgobWF4WCAtIG1pblgsIG1heFkgLSBtaW5ZKTsKICAgIGludlNpemUgPSBpbnZTaXplICE9PSAwID8gMSAvIGludlNpemUgOiAwOwogIH0KCiAgZWFyY3V0TGlua2VkKG91dGVyTm9kZSwgdHJpYW5nbGVzLCBkaW0sIG1pblgsIG1pblksIGludlNpemUpOwogIHJldHVybiB0cmlhbmdsZXM7Cn0gLy8gY3JlYXRlIGEgY2lyY3VsYXIgZG91Ymx5IGxpbmtlZCBsaXN0IGZyb20gcG9seWdvbiBwb2ludHMgaW4gdGhlIHNwZWNpZmllZCB3aW5kaW5nIG9yZGVyCgoKZnVuY3Rpb24gbGlua2VkTGlzdChkYXRhLCBzdGFydCwgZW5kLCBkaW0sIGNsb2Nrd2lzZSkgewogIHZhciBpLCBsYXN0OwoKICBpZiAoY2xvY2t3aXNlID09PSBzaWduZWRBcmVhKGRhdGEsIHN0YXJ0LCBlbmQsIGRpbSkgPiAwKSB7CiAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSBkaW0pIHsKICAgICAgbGFzdCA9IGluc2VydE5vZGUoaSwgZGF0YVtpXSwgZGF0YVtpICsgMV0sIGxhc3QpOwogICAgfQogIH0gZWxzZSB7CiAgICBmb3IgKGkgPSBlbmQgLSBkaW07IGkgPj0gc3RhcnQ7IGkgLT0gZGltKSB7CiAgICAgIGxhc3QgPSBpbnNlcnROb2RlKGksIGRhdGFbaV0sIGRhdGFbaSArIDFdLCBsYXN0KTsKICAgIH0KICB9CgogIGlmIChsYXN0ICYmIGVxdWFscyQxKGxhc3QsIGxhc3QubmV4dCkpIHsKICAgIHJlbW92ZU5vZGUobGFzdCk7CiAgICBsYXN0ID0gbGFzdC5uZXh0OwogIH0KCiAgcmV0dXJuIGxhc3Q7Cn0gLy8gZWxpbWluYXRlIGNvbGluZWFyIG9yIGR1cGxpY2F0ZSBwb2ludHMKCgpmdW5jdGlvbiBmaWx0ZXJQb2ludHMoc3RhcnQsIGVuZCkgewogIGlmICghc3RhcnQpIHJldHVybiBzdGFydDsKICBpZiAoIWVuZCkgZW5kID0gc3RhcnQ7CiAgdmFyIHAgPSBzdGFydCwKICAgICAgYWdhaW47CgogIGRvIHsKICAgIGFnYWluID0gZmFsc2U7CgogICAgaWYgKCFwLnN0ZWluZXIgJiYgKGVxdWFscyQxKHAsIHAubmV4dCkgfHwgYXJlYShwLnByZXYsIHAsIHAubmV4dCkgPT09IDApKSB7CiAgICAgIHJlbW92ZU5vZGUocCk7CiAgICAgIHAgPSBlbmQgPSBwLnByZXY7CiAgICAgIGlmIChwID09PSBwLm5leHQpIGJyZWFrOwogICAgICBhZ2FpbiA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICBwID0gcC5uZXh0OwogICAgfQogIH0gd2hpbGUgKGFnYWluIHx8IHAgIT09IGVuZCk7CgogIHJldHVybiBlbmQ7Cn0gLy8gbWFpbiBlYXIgc2xpY2luZyBsb29wIHdoaWNoIHRyaWFuZ3VsYXRlcyBhIHBvbHlnb24gKGdpdmVuIGFzIGEgbGlua2VkIGxpc3QpCgoKZnVuY3Rpb24gZWFyY3V0TGlua2VkKGVhciwgdHJpYW5nbGVzLCBkaW0sIG1pblgsIG1pblksIGludlNpemUsIHBhc3MpIHsKICBpZiAoIWVhcikgcmV0dXJuOyAvLyBpbnRlcmxpbmsgcG9seWdvbiBub2RlcyBpbiB6LW9yZGVyCgogIGlmICghcGFzcyAmJiBpbnZTaXplKSBpbmRleEN1cnZlKGVhciwgbWluWCwgbWluWSwgaW52U2l6ZSk7CiAgdmFyIHN0b3AgPSBlYXIsCiAgICAgIHByZXYsCiAgICAgIG5leHQ7IC8vIGl0ZXJhdGUgdGhyb3VnaCBlYXJzLCBzbGljaW5nIHRoZW0gb25lIGJ5IG9uZQoKICB3aGlsZSAoZWFyLnByZXYgIT09IGVhci5uZXh0KSB7CiAgICBwcmV2ID0gZWFyLnByZXY7CiAgICBuZXh0ID0gZWFyLm5leHQ7CgogICAgaWYgKGludlNpemUgPyBpc0Vhckhhc2hlZChlYXIsIG1pblgsIG1pblksIGludlNpemUpIDogaXNFYXIoZWFyKSkgewogICAgICAvLyBjdXQgb2ZmIHRoZSB0cmlhbmdsZQogICAgICB0cmlhbmdsZXMucHVzaChwcmV2LmkgLyBkaW0pOwogICAgICB0cmlhbmdsZXMucHVzaChlYXIuaSAvIGRpbSk7CiAgICAgIHRyaWFuZ2xlcy5wdXNoKG5leHQuaSAvIGRpbSk7CiAgICAgIHJlbW92ZU5vZGUoZWFyKTsgLy8gc2tpcHBpbmcgdGhlIG5leHQgdmVydGV4IGxlYWRzIHRvIGxlc3Mgc2xpdmVyIHRyaWFuZ2xlcwoKICAgICAgZWFyID0gbmV4dC5uZXh0OwogICAgICBzdG9wID0gbmV4dC5uZXh0OwogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBlYXIgPSBuZXh0OyAvLyBpZiB3ZSBsb29wZWQgdGhyb3VnaCB0aGUgd2hvbGUgcmVtYWluaW5nIHBvbHlnb24gYW5kIGNhbid0IGZpbmQgYW55IG1vcmUgZWFycwoKICAgIGlmIChlYXIgPT09IHN0b3ApIHsKICAgICAgLy8gdHJ5IGZpbHRlcmluZyBwb2ludHMgYW5kIHNsaWNpbmcgYWdhaW4KICAgICAgaWYgKCFwYXNzKSB7CiAgICAgICAgZWFyY3V0TGlua2VkKGZpbHRlclBvaW50cyhlYXIpLCB0cmlhbmdsZXMsIGRpbSwgbWluWCwgbWluWSwgaW52U2l6ZSwgMSk7IC8vIGlmIHRoaXMgZGlkbid0IHdvcmssIHRyeSBjdXJpbmcgYWxsIHNtYWxsIHNlbGYtaW50ZXJzZWN0aW9ucyBsb2NhbGx5CiAgICAgIH0gZWxzZSBpZiAocGFzcyA9PT0gMSkgewogICAgICAgIGVhciA9IGN1cmVMb2NhbEludGVyc2VjdGlvbnMoZmlsdGVyUG9pbnRzKGVhciksIHRyaWFuZ2xlcywgZGltKTsKICAgICAgICBlYXJjdXRMaW5rZWQoZWFyLCB0cmlhbmdsZXMsIGRpbSwgbWluWCwgbWluWSwgaW52U2l6ZSwgMik7IC8vIGFzIGEgbGFzdCByZXNvcnQsIHRyeSBzcGxpdHRpbmcgdGhlIHJlbWFpbmluZyBwb2x5Z29uIGludG8gdHdvCiAgICAgIH0gZWxzZSBpZiAocGFzcyA9PT0gMikgewogICAgICAgIHNwbGl0RWFyY3V0KGVhciwgdHJpYW5nbGVzLCBkaW0sIG1pblgsIG1pblksIGludlNpemUpOwogICAgICB9CgogICAgICBicmVhazsKICAgIH0KICB9Cn0gLy8gY2hlY2sgd2hldGhlciBhIHBvbHlnb24gbm9kZSBmb3JtcyBhIHZhbGlkIGVhciB3aXRoIGFkamFjZW50IG5vZGVzCgoKZnVuY3Rpb24gaXNFYXIoZWFyKSB7CiAgdmFyIGEgPSBlYXIucHJldiwKICAgICAgYiA9IGVhciwKICAgICAgYyA9IGVhci5uZXh0OwogIGlmIChhcmVhKGEsIGIsIGMpID49IDApIHJldHVybiBmYWxzZTsgLy8gcmVmbGV4LCBjYW4ndCBiZSBhbiBlYXIKICAvLyBub3cgbWFrZSBzdXJlIHdlIGRvbid0IGhhdmUgb3RoZXIgcG9pbnRzIGluc2lkZSB0aGUgcG90ZW50aWFsIGVhcgoKICB2YXIgcCA9IGVhci5uZXh0Lm5leHQ7CgogIHdoaWxlIChwICE9PSBlYXIucHJldikgewogICAgaWYgKHBvaW50SW5UcmlhbmdsZShhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBwLngsIHAueSkgJiYgYXJlYShwLnByZXYsIHAsIHAubmV4dCkgPj0gMCkgcmV0dXJuIGZhbHNlOwogICAgcCA9IHAubmV4dDsKICB9CgogIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBpc0Vhckhhc2hlZChlYXIsIG1pblgsIG1pblksIGludlNpemUpIHsKICB2YXIgYSA9IGVhci5wcmV2LAogICAgICBiID0gZWFyLAogICAgICBjID0gZWFyLm5leHQ7CiAgaWYgKGFyZWEoYSwgYiwgYykgPj0gMCkgcmV0dXJuIGZhbHNlOyAvLyByZWZsZXgsIGNhbid0IGJlIGFuIGVhcgogIC8vIHRyaWFuZ2xlIGJib3g7IG1pbiAmIG1heCBhcmUgY2FsY3VsYXRlZCBsaWtlIHRoaXMgZm9yIHNwZWVkCgogIHZhciBtaW5UWCA9IGEueCA8IGIueCA/IGEueCA8IGMueCA/IGEueCA6IGMueCA6IGIueCA8IGMueCA/IGIueCA6IGMueCwKICAgICAgbWluVFkgPSBhLnkgPCBiLnkgPyBhLnkgPCBjLnkgPyBhLnkgOiBjLnkgOiBiLnkgPCBjLnkgPyBiLnkgOiBjLnksCiAgICAgIG1heFRYID0gYS54ID4gYi54ID8gYS54ID4gYy54ID8gYS54IDogYy54IDogYi54ID4gYy54ID8gYi54IDogYy54LAogICAgICBtYXhUWSA9IGEueSA+IGIueSA/IGEueSA+IGMueSA/IGEueSA6IGMueSA6IGIueSA+IGMueSA/IGIueSA6IGMueTsgLy8gei1vcmRlciByYW5nZSBmb3IgdGhlIGN1cnJlbnQgdHJpYW5nbGUgYmJveDsKCiAgdmFyIG1pblogPSB6T3JkZXIobWluVFgsIG1pblRZLCBtaW5YLCBtaW5ZLCBpbnZTaXplKSwKICAgICAgbWF4WiA9IHpPcmRlcihtYXhUWCwgbWF4VFksIG1pblgsIG1pblksIGludlNpemUpOwogIHZhciBwID0gZWFyLnByZXZaLAogICAgICBuID0gZWFyLm5leHRaOyAvLyBsb29rIGZvciBwb2ludHMgaW5zaWRlIHRoZSB0cmlhbmdsZSBpbiBib3RoIGRpcmVjdGlvbnMKCiAgd2hpbGUgKHAgJiYgcC56ID49IG1pblogJiYgbiAmJiBuLnogPD0gbWF4WikgewogICAgaWYgKHAgIT09IGVhci5wcmV2ICYmIHAgIT09IGVhci5uZXh0ICYmIHBvaW50SW5UcmlhbmdsZShhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBwLngsIHAueSkgJiYgYXJlYShwLnByZXYsIHAsIHAubmV4dCkgPj0gMCkgcmV0dXJuIGZhbHNlOwogICAgcCA9IHAucHJldlo7CiAgICBpZiAobiAhPT0gZWFyLnByZXYgJiYgbiAhPT0gZWFyLm5leHQgJiYgcG9pbnRJblRyaWFuZ2xlKGEueCwgYS55LCBiLngsIGIueSwgYy54LCBjLnksIG4ueCwgbi55KSAmJiBhcmVhKG4ucHJldiwgbiwgbi5uZXh0KSA+PSAwKSByZXR1cm4gZmFsc2U7CiAgICBuID0gbi5uZXh0WjsKICB9IC8vIGxvb2sgZm9yIHJlbWFpbmluZyBwb2ludHMgaW4gZGVjcmVhc2luZyB6LW9yZGVyCgoKICB3aGlsZSAocCAmJiBwLnogPj0gbWluWikgewogICAgaWYgKHAgIT09IGVhci5wcmV2ICYmIHAgIT09IGVhci5uZXh0ICYmIHBvaW50SW5UcmlhbmdsZShhLngsIGEueSwgYi54LCBiLnksIGMueCwgYy55LCBwLngsIHAueSkgJiYgYXJlYShwLnByZXYsIHAsIHAubmV4dCkgPj0gMCkgcmV0dXJuIGZhbHNlOwogICAgcCA9IHAucHJldlo7CiAgfSAvLyBsb29rIGZvciByZW1haW5pbmcgcG9pbnRzIGluIGluY3JlYXNpbmcgei1vcmRlcgoKCiAgd2hpbGUgKG4gJiYgbi56IDw9IG1heFopIHsKICAgIGlmIChuICE9PSBlYXIucHJldiAmJiBuICE9PSBlYXIubmV4dCAmJiBwb2ludEluVHJpYW5nbGUoYS54LCBhLnksIGIueCwgYi55LCBjLngsIGMueSwgbi54LCBuLnkpICYmIGFyZWEobi5wcmV2LCBuLCBuLm5leHQpID49IDApIHJldHVybiBmYWxzZTsKICAgIG4gPSBuLm5leHRaOwogIH0KCiAgcmV0dXJuIHRydWU7Cn0gLy8gZ28gdGhyb3VnaCBhbGwgcG9seWdvbiBub2RlcyBhbmQgY3VyZSBzbWFsbCBsb2NhbCBzZWxmLWludGVyc2VjdGlvbnMKCgpmdW5jdGlvbiBjdXJlTG9jYWxJbnRlcnNlY3Rpb25zKHN0YXJ0LCB0cmlhbmdsZXMsIGRpbSkgewogIHZhciBwID0gc3RhcnQ7CgogIGRvIHsKICAgIHZhciBhID0gcC5wcmV2LAogICAgICAgIGIgPSBwLm5leHQubmV4dDsKCiAgICBpZiAoIWVxdWFscyQxKGEsIGIpICYmIGludGVyc2VjdHMoYSwgcCwgcC5uZXh0LCBiKSAmJiBsb2NhbGx5SW5zaWRlKGEsIGIpICYmIGxvY2FsbHlJbnNpZGUoYiwgYSkpIHsKICAgICAgdHJpYW5nbGVzLnB1c2goYS5pIC8gZGltKTsKICAgICAgdHJpYW5nbGVzLnB1c2gocC5pIC8gZGltKTsKICAgICAgdHJpYW5nbGVzLnB1c2goYi5pIC8gZGltKTsgLy8gcmVtb3ZlIHR3byBub2RlcyBpbnZvbHZlZAoKICAgICAgcmVtb3ZlTm9kZShwKTsKICAgICAgcmVtb3ZlTm9kZShwLm5leHQpOwogICAgICBwID0gc3RhcnQgPSBiOwogICAgfQoKICAgIHAgPSBwLm5leHQ7CiAgfSB3aGlsZSAocCAhPT0gc3RhcnQpOwoKICByZXR1cm4gZmlsdGVyUG9pbnRzKHApOwp9IC8vIHRyeSBzcGxpdHRpbmcgcG9seWdvbiBpbnRvIHR3byBhbmQgdHJpYW5ndWxhdGUgdGhlbSBpbmRlcGVuZGVudGx5CgoKZnVuY3Rpb24gc3BsaXRFYXJjdXQoc3RhcnQsIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplKSB7CiAgLy8gbG9vayBmb3IgYSB2YWxpZCBkaWFnb25hbCB0aGF0IGRpdmlkZXMgdGhlIHBvbHlnb24gaW50byB0d28KICB2YXIgYSA9IHN0YXJ0OwoKICBkbyB7CiAgICB2YXIgYiA9IGEubmV4dC5uZXh0OwoKICAgIHdoaWxlIChiICE9PSBhLnByZXYpIHsKICAgICAgaWYgKGEuaSAhPT0gYi5pICYmIGlzVmFsaWREaWFnb25hbChhLCBiKSkgewogICAgICAgIC8vIHNwbGl0IHRoZSBwb2x5Z29uIGluIHR3byBieSB0aGUgZGlhZ29uYWwKICAgICAgICB2YXIgYyA9IHNwbGl0UG9seWdvbihhLCBiKTsgLy8gZmlsdGVyIGNvbGluZWFyIHBvaW50cyBhcm91bmQgdGhlIGN1dHMKCiAgICAgICAgYSA9IGZpbHRlclBvaW50cyhhLCBhLm5leHQpOwogICAgICAgIGMgPSBmaWx0ZXJQb2ludHMoYywgYy5uZXh0KTsgLy8gcnVuIGVhcmN1dCBvbiBlYWNoIGhhbGYKCiAgICAgICAgZWFyY3V0TGlua2VkKGEsIHRyaWFuZ2xlcywgZGltLCBtaW5YLCBtaW5ZLCBpbnZTaXplKTsKICAgICAgICBlYXJjdXRMaW5rZWQoYywgdHJpYW5nbGVzLCBkaW0sIG1pblgsIG1pblksIGludlNpemUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgYiA9IGIubmV4dDsKICAgIH0KCiAgICBhID0gYS5uZXh0OwogIH0gd2hpbGUgKGEgIT09IHN0YXJ0KTsKfSAvLyBsaW5rIGV2ZXJ5IGhvbGUgaW50byB0aGUgb3V0ZXIgbG9vcCwgcHJvZHVjaW5nIGEgc2luZ2xlLXJpbmcgcG9seWdvbiB3aXRob3V0IGhvbGVzCgoKZnVuY3Rpb24gZWxpbWluYXRlSG9sZXMoZGF0YSwgaG9sZUluZGljZXMsIG91dGVyTm9kZSwgZGltKSB7CiAgdmFyIHF1ZXVlID0gW10sCiAgICAgIGksCiAgICAgIGxlbiwKICAgICAgc3RhcnQsCiAgICAgIGVuZCwKICAgICAgbGlzdDsKCiAgZm9yIChpID0gMCwgbGVuID0gaG9sZUluZGljZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgIHN0YXJ0ID0gaG9sZUluZGljZXNbaV0gKiBkaW07CiAgICBlbmQgPSBpIDwgbGVuIC0gMSA/IGhvbGVJbmRpY2VzW2kgKyAxXSAqIGRpbSA6IGRhdGEubGVuZ3RoOwogICAgbGlzdCA9IGxpbmtlZExpc3QoZGF0YSwgc3RhcnQsIGVuZCwgZGltLCBmYWxzZSk7CiAgICBpZiAobGlzdCA9PT0gbGlzdC5uZXh0KSBsaXN0LnN0ZWluZXIgPSB0cnVlOwogICAgcXVldWUucHVzaChnZXRMZWZ0bW9zdChsaXN0KSk7CiAgfQoKICBxdWV1ZS5zb3J0KGNvbXBhcmVYKTsgLy8gcHJvY2VzcyBob2xlcyBmcm9tIGxlZnQgdG8gcmlnaHQKCiAgZm9yIChpID0gMDsgaSA8IHF1ZXVlLmxlbmd0aDsgaSsrKSB7CiAgICBlbGltaW5hdGVIb2xlKHF1ZXVlW2ldLCBvdXRlck5vZGUpOwogICAgb3V0ZXJOb2RlID0gZmlsdGVyUG9pbnRzKG91dGVyTm9kZSwgb3V0ZXJOb2RlLm5leHQpOwogIH0KCiAgcmV0dXJuIG91dGVyTm9kZTsKfQoKZnVuY3Rpb24gY29tcGFyZVgoYSwgYikgewogIHJldHVybiBhLnggLSBiLng7Cn0gLy8gZmluZCBhIGJyaWRnZSBiZXR3ZWVuIHZlcnRpY2VzIHRoYXQgY29ubmVjdHMgaG9sZSB3aXRoIGFuIG91dGVyIHJpbmcgYW5kIGFuZCBsaW5rIGl0CgoKZnVuY3Rpb24gZWxpbWluYXRlSG9sZShob2xlLCBvdXRlck5vZGUpIHsKICBvdXRlck5vZGUgPSBmaW5kSG9sZUJyaWRnZShob2xlLCBvdXRlck5vZGUpOwoKICBpZiAob3V0ZXJOb2RlKSB7CiAgICB2YXIgYiA9IHNwbGl0UG9seWdvbihvdXRlck5vZGUsIGhvbGUpOyAvLyBmaWx0ZXIgY29sbGluZWFyIHBvaW50cyBhcm91bmQgdGhlIGN1dHMKCiAgICBmaWx0ZXJQb2ludHMob3V0ZXJOb2RlLCBvdXRlck5vZGUubmV4dCk7CiAgICBmaWx0ZXJQb2ludHMoYiwgYi5uZXh0KTsKICB9Cn0gLy8gRGF2aWQgRWJlcmx5J3MgYWxnb3JpdGhtIGZvciBmaW5kaW5nIGEgYnJpZGdlIGJldHdlZW4gaG9sZSBhbmQgb3V0ZXIgcG9seWdvbgoKCmZ1bmN0aW9uIGZpbmRIb2xlQnJpZGdlKGhvbGUsIG91dGVyTm9kZSkgewogIHZhciBwID0gb3V0ZXJOb2RlLAogICAgICBoeCA9IGhvbGUueCwKICAgICAgaHkgPSBob2xlLnksCiAgICAgIHF4ID0gLUluZmluaXR5LAogICAgICBtOyAvLyBmaW5kIGEgc2VnbWVudCBpbnRlcnNlY3RlZCBieSBhIHJheSBmcm9tIHRoZSBob2xlJ3MgbGVmdG1vc3QgcG9pbnQgdG8gdGhlIGxlZnQ7CiAgLy8gc2VnbWVudCdzIGVuZHBvaW50IHdpdGggbGVzc2VyIHggd2lsbCBiZSBwb3RlbnRpYWwgY29ubmVjdGlvbiBwb2ludAoKICBkbyB7CiAgICBpZiAoaHkgPD0gcC55ICYmIGh5ID49IHAubmV4dC55ICYmIHAubmV4dC55ICE9PSBwLnkpIHsKICAgICAgdmFyIHggPSBwLnggKyAoaHkgLSBwLnkpICogKHAubmV4dC54IC0gcC54KSAvIChwLm5leHQueSAtIHAueSk7CgogICAgICBpZiAoeCA8PSBoeCAmJiB4ID4gcXgpIHsKICAgICAgICBxeCA9IHg7CgogICAgICAgIGlmICh4ID09PSBoeCkgewogICAgICAgICAgaWYgKGh5ID09PSBwLnkpIHJldHVybiBwOwogICAgICAgICAgaWYgKGh5ID09PSBwLm5leHQueSkgcmV0dXJuIHAubmV4dDsKICAgICAgICB9CgogICAgICAgIG0gPSBwLnggPCBwLm5leHQueCA/IHAgOiBwLm5leHQ7CiAgICAgIH0KICAgIH0KCiAgICBwID0gcC5uZXh0OwogIH0gd2hpbGUgKHAgIT09IG91dGVyTm9kZSk7CgogIGlmICghbSkgcmV0dXJuIG51bGw7CiAgaWYgKGh4ID09PSBxeCkgcmV0dXJuIG07IC8vIGhvbGUgdG91Y2hlcyBvdXRlciBzZWdtZW50OyBwaWNrIGxlZnRtb3N0IGVuZHBvaW50CiAgLy8gbG9vayBmb3IgcG9pbnRzIGluc2lkZSB0aGUgdHJpYW5nbGUgb2YgaG9sZSBwb2ludCwgc2VnbWVudCBpbnRlcnNlY3Rpb24gYW5kIGVuZHBvaW50OwogIC8vIGlmIHRoZXJlIGFyZSBubyBwb2ludHMgZm91bmQsIHdlIGhhdmUgYSB2YWxpZCBjb25uZWN0aW9uOwogIC8vIG90aGVyd2lzZSBjaG9vc2UgdGhlIHBvaW50IG9mIHRoZSBtaW5pbXVtIGFuZ2xlIHdpdGggdGhlIHJheSBhcyBjb25uZWN0aW9uIHBvaW50CgogIHZhciBzdG9wID0gbSwKICAgICAgbXggPSBtLngsCiAgICAgIG15ID0gbS55LAogICAgICB0YW5NaW4gPSBJbmZpbml0eSwKICAgICAgdGFuOwogIHAgPSBtOwoKICBkbyB7CiAgICBpZiAoaHggPj0gcC54ICYmIHAueCA+PSBteCAmJiBoeCAhPT0gcC54ICYmIHBvaW50SW5UcmlhbmdsZShoeSA8IG15ID8gaHggOiBxeCwgaHksIG14LCBteSwgaHkgPCBteSA/IHF4IDogaHgsIGh5LCBwLngsIHAueSkpIHsKICAgICAgdGFuID0gTWF0aC5hYnMoaHkgLSBwLnkpIC8gKGh4IC0gcC54KTsgLy8gdGFuZ2VudGlhbAoKICAgICAgaWYgKGxvY2FsbHlJbnNpZGUocCwgaG9sZSkgJiYgKHRhbiA8IHRhbk1pbiB8fCB0YW4gPT09IHRhbk1pbiAmJiAocC54ID4gbS54IHx8IHAueCA9PT0gbS54ICYmIHNlY3RvckNvbnRhaW5zU2VjdG9yKG0sIHApKSkpIHsKICAgICAgICBtID0gcDsKICAgICAgICB0YW5NaW4gPSB0YW47CiAgICAgIH0KICAgIH0KCiAgICBwID0gcC5uZXh0OwogIH0gd2hpbGUgKHAgIT09IHN0b3ApOwoKICByZXR1cm4gbTsKfSAvLyB3aGV0aGVyIHNlY3RvciBpbiB2ZXJ0ZXggbSBjb250YWlucyBzZWN0b3IgaW4gdmVydGV4IHAgaW4gdGhlIHNhbWUgY29vcmRpbmF0ZXMKCgpmdW5jdGlvbiBzZWN0b3JDb250YWluc1NlY3RvcihtLCBwKSB7CiAgcmV0dXJuIGFyZWEobS5wcmV2LCBtLCBwLnByZXYpIDwgMCAmJiBhcmVhKHAubmV4dCwgbSwgbS5uZXh0KSA8IDA7Cn0gLy8gaW50ZXJsaW5rIHBvbHlnb24gbm9kZXMgaW4gei1vcmRlcgoKCmZ1bmN0aW9uIGluZGV4Q3VydmUoc3RhcnQsIG1pblgsIG1pblksIGludlNpemUpIHsKICB2YXIgcCA9IHN0YXJ0OwoKICBkbyB7CiAgICBpZiAocC56ID09PSBudWxsKSBwLnogPSB6T3JkZXIocC54LCBwLnksIG1pblgsIG1pblksIGludlNpemUpOwogICAgcC5wcmV2WiA9IHAucHJldjsKICAgIHAubmV4dFogPSBwLm5leHQ7CiAgICBwID0gcC5uZXh0OwogIH0gd2hpbGUgKHAgIT09IHN0YXJ0KTsKCiAgcC5wcmV2Wi5uZXh0WiA9IG51bGw7CiAgcC5wcmV2WiA9IG51bGw7CiAgc29ydExpbmtlZChwKTsKfSAvLyBTaW1vbiBUYXRoYW0ncyBsaW5rZWQgbGlzdCBtZXJnZSBzb3J0IGFsZ29yaXRobQovLyBodHRwOi8vd3d3LmNoaWFyay5ncmVlbmVuZC5vcmcudWsvfnNndGF0aGFtL2FsZ29yaXRobXMvbGlzdHNvcnQuaHRtbAoKCmZ1bmN0aW9uIHNvcnRMaW5rZWQobGlzdCkgewogIHZhciBpLAogICAgICBwLAogICAgICBxLAogICAgICBlLAogICAgICB0YWlsLAogICAgICBudW1NZXJnZXMsCiAgICAgIHBTaXplLAogICAgICBxU2l6ZSwKICAgICAgaW5TaXplID0gMTsKCiAgZG8gewogICAgcCA9IGxpc3Q7CiAgICBsaXN0ID0gbnVsbDsKICAgIHRhaWwgPSBudWxsOwogICAgbnVtTWVyZ2VzID0gMDsKCiAgICB3aGlsZSAocCkgewogICAgICBudW1NZXJnZXMrKzsKICAgICAgcSA9IHA7CiAgICAgIHBTaXplID0gMDsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBpblNpemU7IGkrKykgewogICAgICAgIHBTaXplKys7CiAgICAgICAgcSA9IHEubmV4dFo7CiAgICAgICAgaWYgKCFxKSBicmVhazsKICAgICAgfQoKICAgICAgcVNpemUgPSBpblNpemU7CgogICAgICB3aGlsZSAocFNpemUgPiAwIHx8IHFTaXplID4gMCAmJiBxKSB7CiAgICAgICAgaWYgKHBTaXplICE9PSAwICYmIChxU2l6ZSA9PT0gMCB8fCAhcSB8fCBwLnogPD0gcS56KSkgewogICAgICAgICAgZSA9IHA7CiAgICAgICAgICBwID0gcC5uZXh0WjsKICAgICAgICAgIHBTaXplLS07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGUgPSBxOwogICAgICAgICAgcSA9IHEubmV4dFo7CiAgICAgICAgICBxU2l6ZS0tOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRhaWwpIHRhaWwubmV4dFogPSBlO2Vsc2UgbGlzdCA9IGU7CiAgICAgICAgZS5wcmV2WiA9IHRhaWw7CiAgICAgICAgdGFpbCA9IGU7CiAgICAgIH0KCiAgICAgIHAgPSBxOwogICAgfQoKICAgIHRhaWwubmV4dFogPSBudWxsOwogICAgaW5TaXplICo9IDI7CiAgfSB3aGlsZSAobnVtTWVyZ2VzID4gMSk7CgogIHJldHVybiBsaXN0Owp9IC8vIHotb3JkZXIgb2YgYSBwb2ludCBnaXZlbiBjb29yZHMgYW5kIGludmVyc2Ugb2YgdGhlIGxvbmdlciBzaWRlIG9mIGRhdGEgYmJveAoKCmZ1bmN0aW9uIHpPcmRlcih4LCB5LCBtaW5YLCBtaW5ZLCBpbnZTaXplKSB7CiAgLy8gY29vcmRzIGFyZSB0cmFuc2Zvcm1lZCBpbnRvIG5vbi1uZWdhdGl2ZSAxNS1iaXQgaW50ZWdlciByYW5nZQogIHggPSAzMjc2NyAqICh4IC0gbWluWCkgKiBpbnZTaXplOwogIHkgPSAzMjc2NyAqICh5IC0gbWluWSkgKiBpbnZTaXplOwogIHggPSAoeCB8IHggPDwgOCkgJiAweDAwRkYwMEZGOwogIHggPSAoeCB8IHggPDwgNCkgJiAweDBGMEYwRjBGOwogIHggPSAoeCB8IHggPDwgMikgJiAweDMzMzMzMzMzOwogIHggPSAoeCB8IHggPDwgMSkgJiAweDU1NTU1NTU1OwogIHkgPSAoeSB8IHkgPDwgOCkgJiAweDAwRkYwMEZGOwogIHkgPSAoeSB8IHkgPDwgNCkgJiAweDBGMEYwRjBGOwogIHkgPSAoeSB8IHkgPDwgMikgJiAweDMzMzMzMzMzOwogIHkgPSAoeSB8IHkgPDwgMSkgJiAweDU1NTU1NTU1OwogIHJldHVybiB4IHwgeSA8PCAxOwp9IC8vIGZpbmQgdGhlIGxlZnRtb3N0IG5vZGUgb2YgYSBwb2x5Z29uIHJpbmcKCgpmdW5jdGlvbiBnZXRMZWZ0bW9zdChzdGFydCkgewogIHZhciBwID0gc3RhcnQsCiAgICAgIGxlZnRtb3N0ID0gc3RhcnQ7CgogIGRvIHsKICAgIGlmIChwLnggPCBsZWZ0bW9zdC54IHx8IHAueCA9PT0gbGVmdG1vc3QueCAmJiBwLnkgPCBsZWZ0bW9zdC55KSBsZWZ0bW9zdCA9IHA7CiAgICBwID0gcC5uZXh0OwogIH0gd2hpbGUgKHAgIT09IHN0YXJ0KTsKCiAgcmV0dXJuIGxlZnRtb3N0Owp9IC8vIGNoZWNrIGlmIGEgcG9pbnQgbGllcyB3aXRoaW4gYSBjb252ZXggdHJpYW5nbGUKCgpmdW5jdGlvbiBwb2ludEluVHJpYW5nbGUoYXgsIGF5LCBieCwgYnksIGN4LCBjeSwgcHgsIHB5KSB7CiAgcmV0dXJuIChjeCAtIHB4KSAqIChheSAtIHB5KSAtIChheCAtIHB4KSAqIChjeSAtIHB5KSA+PSAwICYmIChheCAtIHB4KSAqIChieSAtIHB5KSAtIChieCAtIHB4KSAqIChheSAtIHB5KSA+PSAwICYmIChieCAtIHB4KSAqIChjeSAtIHB5KSAtIChjeCAtIHB4KSAqIChieSAtIHB5KSA+PSAwOwp9IC8vIGNoZWNrIGlmIGEgZGlhZ29uYWwgYmV0d2VlbiB0d28gcG9seWdvbiBub2RlcyBpcyB2YWxpZCAobGllcyBpbiBwb2x5Z29uIGludGVyaW9yKQoKCmZ1bmN0aW9uIGlzVmFsaWREaWFnb25hbChhLCBiKSB7CiAgcmV0dXJuIGEubmV4dC5pICE9PSBiLmkgJiYgYS5wcmV2LmkgIT09IGIuaSAmJiAhaW50ZXJzZWN0c1BvbHlnb24oYSwgYikgJiYgKCAvLyBkb25lcyd0IGludGVyc2VjdCBvdGhlciBlZGdlcwogIGxvY2FsbHlJbnNpZGUoYSwgYikgJiYgbG9jYWxseUluc2lkZShiLCBhKSAmJiBtaWRkbGVJbnNpZGUoYSwgYikgJiYgKCAvLyBsb2NhbGx5IHZpc2libGUKICBhcmVhKGEucHJldiwgYSwgYi5wcmV2KSB8fCBhcmVhKGEsIGIucHJldiwgYikpIHx8IC8vIGRvZXMgbm90IGNyZWF0ZSBvcHBvc2l0ZS1mYWNpbmcgc2VjdG9ycwogIGVxdWFscyQxKGEsIGIpICYmIGFyZWEoYS5wcmV2LCBhLCBhLm5leHQpID4gMCAmJiBhcmVhKGIucHJldiwgYiwgYi5uZXh0KSA+IDApOyAvLyBzcGVjaWFsIHplcm8tbGVuZ3RoIGNhc2UKfSAvLyBzaWduZWQgYXJlYSBvZiBhIHRyaWFuZ2xlCgoKZnVuY3Rpb24gYXJlYShwLCBxLCByKSB7CiAgcmV0dXJuIChxLnkgLSBwLnkpICogKHIueCAtIHEueCkgLSAocS54IC0gcC54KSAqIChyLnkgLSBxLnkpOwp9IC8vIGNoZWNrIGlmIHR3byBwb2ludHMgYXJlIGVxdWFsCgoKZnVuY3Rpb24gZXF1YWxzJDEocDEsIHAyKSB7CiAgcmV0dXJuIHAxLnggPT09IHAyLnggJiYgcDEueSA9PT0gcDIueTsKfSAvLyBjaGVjayBpZiB0d28gc2VnbWVudHMgaW50ZXJzZWN0CgoKZnVuY3Rpb24gaW50ZXJzZWN0cyhwMSwgcTEsIHAyLCBxMikgewogIHZhciBvMSA9IHNpZ24oYXJlYShwMSwgcTEsIHAyKSk7CiAgdmFyIG8yID0gc2lnbihhcmVhKHAxLCBxMSwgcTIpKTsKICB2YXIgbzMgPSBzaWduKGFyZWEocDIsIHEyLCBwMSkpOwogIHZhciBvNCA9IHNpZ24oYXJlYShwMiwgcTIsIHExKSk7CiAgaWYgKG8xICE9PSBvMiAmJiBvMyAhPT0gbzQpIHJldHVybiB0cnVlOyAvLyBnZW5lcmFsIGNhc2UKCiAgaWYgKG8xID09PSAwICYmIG9uU2VnbWVudChwMSwgcDIsIHExKSkgcmV0dXJuIHRydWU7IC8vIHAxLCBxMSBhbmQgcDIgYXJlIGNvbGxpbmVhciBhbmQgcDIgbGllcyBvbiBwMXExCgogIGlmIChvMiA9PT0gMCAmJiBvblNlZ21lbnQocDEsIHEyLCBxMSkpIHJldHVybiB0cnVlOyAvLyBwMSwgcTEgYW5kIHEyIGFyZSBjb2xsaW5lYXIgYW5kIHEyIGxpZXMgb24gcDFxMQoKICBpZiAobzMgPT09IDAgJiYgb25TZWdtZW50KHAyLCBwMSwgcTIpKSByZXR1cm4gdHJ1ZTsgLy8gcDIsIHEyIGFuZCBwMSBhcmUgY29sbGluZWFyIGFuZCBwMSBsaWVzIG9uIHAycTIKCiAgaWYgKG80ID09PSAwICYmIG9uU2VnbWVudChwMiwgcTEsIHEyKSkgcmV0dXJuIHRydWU7IC8vIHAyLCBxMiBhbmQgcTEgYXJlIGNvbGxpbmVhciBhbmQgcTEgbGllcyBvbiBwMnEyCgogIHJldHVybiBmYWxzZTsKfSAvLyBmb3IgY29sbGluZWFyIHBvaW50cyBwLCBxLCByLCBjaGVjayBpZiBwb2ludCBxIGxpZXMgb24gc2VnbWVudCBwcgoKCmZ1bmN0aW9uIG9uU2VnbWVudChwLCBxLCByKSB7CiAgcmV0dXJuIHEueCA8PSBNYXRoLm1heChwLngsIHIueCkgJiYgcS54ID49IE1hdGgubWluKHAueCwgci54KSAmJiBxLnkgPD0gTWF0aC5tYXgocC55LCByLnkpICYmIHEueSA+PSBNYXRoLm1pbihwLnksIHIueSk7Cn0KCmZ1bmN0aW9uIHNpZ24obnVtKSB7CiAgcmV0dXJuIG51bSA+IDAgPyAxIDogbnVtIDwgMCA/IC0xIDogMDsKfSAvLyBjaGVjayBpZiBhIHBvbHlnb24gZGlhZ29uYWwgaW50ZXJzZWN0cyBhbnkgcG9seWdvbiBzZWdtZW50cwoKCmZ1bmN0aW9uIGludGVyc2VjdHNQb2x5Z29uKGEsIGIpIHsKICB2YXIgcCA9IGE7CgogIGRvIHsKICAgIGlmIChwLmkgIT09IGEuaSAmJiBwLm5leHQuaSAhPT0gYS5pICYmIHAuaSAhPT0gYi5pICYmIHAubmV4dC5pICE9PSBiLmkgJiYgaW50ZXJzZWN0cyhwLCBwLm5leHQsIGEsIGIpKSByZXR1cm4gdHJ1ZTsKICAgIHAgPSBwLm5leHQ7CiAgfSB3aGlsZSAocCAhPT0gYSk7CgogIHJldHVybiBmYWxzZTsKfSAvLyBjaGVjayBpZiBhIHBvbHlnb24gZGlhZ29uYWwgaXMgbG9jYWxseSBpbnNpZGUgdGhlIHBvbHlnb24KCgpmdW5jdGlvbiBsb2NhbGx5SW5zaWRlKGEsIGIpIHsKICByZXR1cm4gYXJlYShhLnByZXYsIGEsIGEubmV4dCkgPCAwID8gYXJlYShhLCBiLCBhLm5leHQpID49IDAgJiYgYXJlYShhLCBhLnByZXYsIGIpID49IDAgOiBhcmVhKGEsIGIsIGEucHJldikgPCAwIHx8IGFyZWEoYSwgYS5uZXh0LCBiKSA8IDA7Cn0gLy8gY2hlY2sgaWYgdGhlIG1pZGRsZSBwb2ludCBvZiBhIHBvbHlnb24gZGlhZ29uYWwgaXMgaW5zaWRlIHRoZSBwb2x5Z29uCgoKZnVuY3Rpb24gbWlkZGxlSW5zaWRlKGEsIGIpIHsKICB2YXIgcCA9IGEsCiAgICAgIGluc2lkZSA9IGZhbHNlLAogICAgICBweCA9IChhLnggKyBiLngpIC8gMiwKICAgICAgcHkgPSAoYS55ICsgYi55KSAvIDI7CgogIGRvIHsKICAgIGlmIChwLnkgPiBweSAhPT0gcC5uZXh0LnkgPiBweSAmJiBwLm5leHQueSAhPT0gcC55ICYmIHB4IDwgKHAubmV4dC54IC0gcC54KSAqIChweSAtIHAueSkgLyAocC5uZXh0LnkgLSBwLnkpICsgcC54KSBpbnNpZGUgPSAhaW5zaWRlOwogICAgcCA9IHAubmV4dDsKICB9IHdoaWxlIChwICE9PSBhKTsKCiAgcmV0dXJuIGluc2lkZTsKfSAvLyBsaW5rIHR3byBwb2x5Z29uIHZlcnRpY2VzIHdpdGggYSBicmlkZ2U7IGlmIHRoZSB2ZXJ0aWNlcyBiZWxvbmcgdG8gdGhlIHNhbWUgcmluZywgaXQgc3BsaXRzIHBvbHlnb24gaW50byB0d287Ci8vIGlmIG9uZSBiZWxvbmdzIHRvIHRoZSBvdXRlciByaW5nIGFuZCBhbm90aGVyIHRvIGEgaG9sZSwgaXQgbWVyZ2VzIGl0IGludG8gYSBzaW5nbGUgcmluZwoKCmZ1bmN0aW9uIHNwbGl0UG9seWdvbihhLCBiKSB7CiAgdmFyIGEyID0gbmV3IE5vZGUkMyhhLmksIGEueCwgYS55KSwKICAgICAgYjIgPSBuZXcgTm9kZSQzKGIuaSwgYi54LCBiLnkpLAogICAgICBhbiA9IGEubmV4dCwKICAgICAgYnAgPSBiLnByZXY7CiAgYS5uZXh0ID0gYjsKICBiLnByZXYgPSBhOwogIGEyLm5leHQgPSBhbjsKICBhbi5wcmV2ID0gYTI7CiAgYjIubmV4dCA9IGEyOwogIGEyLnByZXYgPSBiMjsKICBicC5uZXh0ID0gYjI7CiAgYjIucHJldiA9IGJwOwogIHJldHVybiBiMjsKfSAvLyBjcmVhdGUgYSBub2RlIGFuZCBvcHRpb25hbGx5IGxpbmsgaXQgd2l0aCBwcmV2aW91cyBvbmUgKGluIGEgY2lyY3VsYXIgZG91Ymx5IGxpbmtlZCBsaXN0KQoKCmZ1bmN0aW9uIGluc2VydE5vZGUoaSwgeCwgeSwgbGFzdCkgewogIHZhciBwID0gbmV3IE5vZGUkMyhpLCB4LCB5KTsKCiAgaWYgKCFsYXN0KSB7CiAgICBwLnByZXYgPSBwOwogICAgcC5uZXh0ID0gcDsKICB9IGVsc2UgewogICAgcC5uZXh0ID0gbGFzdC5uZXh0OwogICAgcC5wcmV2ID0gbGFzdDsKICAgIGxhc3QubmV4dC5wcmV2ID0gcDsKICAgIGxhc3QubmV4dCA9IHA7CiAgfQoKICByZXR1cm4gcDsKfQoKZnVuY3Rpb24gcmVtb3ZlTm9kZShwKSB7CiAgcC5uZXh0LnByZXYgPSBwLnByZXY7CiAgcC5wcmV2Lm5leHQgPSBwLm5leHQ7CiAgaWYgKHAucHJldlopIHAucHJldloubmV4dFogPSBwLm5leHRaOwogIGlmIChwLm5leHRaKSBwLm5leHRaLnByZXZaID0gcC5wcmV2WjsKfQoKZnVuY3Rpb24gTm9kZSQzKGksIHgsIHkpIHsKICAvLyB2ZXJ0ZXggaW5kZXggaW4gY29vcmRpbmF0ZXMgYXJyYXkKICB0aGlzLmkgPSBpOyAvLyB2ZXJ0ZXggY29vcmRpbmF0ZXMKCiAgdGhpcy54ID0geDsKICB0aGlzLnkgPSB5OyAvLyBwcmV2aW91cyBhbmQgbmV4dCB2ZXJ0ZXggbm9kZXMgaW4gYSBwb2x5Z29uIHJpbmcKCiAgdGhpcy5wcmV2ID0gbnVsbDsKICB0aGlzLm5leHQgPSBudWxsOyAvLyB6LW9yZGVyIGN1cnZlIHZhbHVlCgogIHRoaXMueiA9IG51bGw7IC8vIHByZXZpb3VzIGFuZCBuZXh0IG5vZGVzIGluIHotb3JkZXIKCiAgdGhpcy5wcmV2WiA9IG51bGw7CiAgdGhpcy5uZXh0WiA9IG51bGw7IC8vIGluZGljYXRlcyB3aGV0aGVyIHRoaXMgaXMgYSBzdGVpbmVyIHBvaW50CgogIHRoaXMuc3RlaW5lciA9IGZhbHNlOwp9IC8vIHJldHVybiBhIHBlcmNlbnRhZ2UgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSBwb2x5Z29uIGFyZWEgYW5kIGl0cyB0cmlhbmd1bGF0aW9uIGFyZWE7Ci8vIHVzZWQgdG8gdmVyaWZ5IGNvcnJlY3RuZXNzIG9mIHRyaWFuZ3VsYXRpb24KCgplYXJjdXQuZGV2aWF0aW9uID0gZnVuY3Rpb24gKGRhdGEsIGhvbGVJbmRpY2VzLCBkaW0sIHRyaWFuZ2xlcykgewogIHZhciBoYXNIb2xlcyA9IGhvbGVJbmRpY2VzICYmIGhvbGVJbmRpY2VzLmxlbmd0aDsKICB2YXIgb3V0ZXJMZW4gPSBoYXNIb2xlcyA/IGhvbGVJbmRpY2VzWzBdICogZGltIDogZGF0YS5sZW5ndGg7CiAgdmFyIHBvbHlnb25BcmVhID0gTWF0aC5hYnMoc2lnbmVkQXJlYShkYXRhLCAwLCBvdXRlckxlbiwgZGltKSk7CgogIGlmIChoYXNIb2xlcykgewogICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGhvbGVJbmRpY2VzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIHZhciBzdGFydCA9IGhvbGVJbmRpY2VzW2ldICogZGltOwogICAgICB2YXIgZW5kID0gaSA8IGxlbiAtIDEgPyBob2xlSW5kaWNlc1tpICsgMV0gKiBkaW0gOiBkYXRhLmxlbmd0aDsKICAgICAgcG9seWdvbkFyZWEgLT0gTWF0aC5hYnMoc2lnbmVkQXJlYShkYXRhLCBzdGFydCwgZW5kLCBkaW0pKTsKICAgIH0KICB9CgogIHZhciB0cmlhbmdsZXNBcmVhID0gMDsKCiAgZm9yIChpID0gMDsgaSA8IHRyaWFuZ2xlcy5sZW5ndGg7IGkgKz0gMykgewogICAgdmFyIGEgPSB0cmlhbmdsZXNbaV0gKiBkaW07CiAgICB2YXIgYiA9IHRyaWFuZ2xlc1tpICsgMV0gKiBkaW07CiAgICB2YXIgYyA9IHRyaWFuZ2xlc1tpICsgMl0gKiBkaW07CiAgICB0cmlhbmdsZXNBcmVhICs9IE1hdGguYWJzKChkYXRhW2FdIC0gZGF0YVtjXSkgKiAoZGF0YVtiICsgMV0gLSBkYXRhW2EgKyAxXSkgLSAoZGF0YVthXSAtIGRhdGFbYl0pICogKGRhdGFbYyArIDFdIC0gZGF0YVthICsgMV0pKTsKICB9CgogIHJldHVybiBwb2x5Z29uQXJlYSA9PT0gMCAmJiB0cmlhbmdsZXNBcmVhID09PSAwID8gMCA6IE1hdGguYWJzKCh0cmlhbmdsZXNBcmVhIC0gcG9seWdvbkFyZWEpIC8gcG9seWdvbkFyZWEpOwp9OwoKZnVuY3Rpb24gc2lnbmVkQXJlYShkYXRhLCBzdGFydCwgZW5kLCBkaW0pIHsKICB2YXIgc3VtID0gMDsKCiAgZm9yICh2YXIgaSA9IHN0YXJ0LCBqID0gZW5kIC0gZGltOyBpIDwgZW5kOyBpICs9IGRpbSkgewogICAgc3VtICs9IChkYXRhW2pdIC0gZGF0YVtpXSkgKiAoZGF0YVtpICsgMV0gKyBkYXRhW2ogKyAxXSk7CiAgICBqID0gaTsKICB9CgogIHJldHVybiBzdW07Cn0gLy8gdHVybiBhIHBvbHlnb24gaW4gYSBtdWx0aS1kaW1lbnNpb25hbCBhcnJheSBmb3JtIChlLmcuIGFzIGluIEdlb0pTT04pIGludG8gYSBmb3JtIEVhcmN1dCBhY2NlcHRzCgoKZWFyY3V0LmZsYXR0ZW4gPSBmdW5jdGlvbiAoZGF0YSkgewogIHZhciBkaW0gPSBkYXRhWzBdWzBdLmxlbmd0aCwKICAgICAgcmVzdWx0ID0gewogICAgdmVydGljZXM6IFtdLAogICAgaG9sZXM6IFtdLAogICAgZGltZW5zaW9uczogZGltCiAgfSwKICAgICAgaG9sZUluZGV4ID0gMDsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7CiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGFbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBkaW07IGQrKykgewogICAgICAgIHJlc3VsdC52ZXJ0aWNlcy5wdXNoKGRhdGFbaV1bal1bZF0pOwogICAgICB9CiAgICB9CgogICAgaWYgKGkgPiAwKSB7CiAgICAgIGhvbGVJbmRleCArPSBkYXRhW2kgLSAxXS5sZW5ndGg7CiAgICAgIHJlc3VsdC5ob2xlcy5wdXNoKGhvbGVJbmRleCk7CiAgICB9CiAgfQoKICByZXR1cm4gcmVzdWx0Owp9OwplYXJjdXRfMVsiZGVmYXVsdCJdID0gZGVmYXVsdF8xOwoKdmFyIHZlcnNpb24gPSAiMS41LjAiOwp2YXIgdmVyc2lvbiQxID0gewoJdmVyc2lvbjogdmVyc2lvbgp9OwoKdmFyIHZlcnNpb24kMiA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCV9fcHJvdG9fXzogbnVsbCwKCXZlcnNpb246IHZlcnNpb24sCgknZGVmYXVsdCc6IHZlcnNpb24kMQp9KTsKCi8qCiAqIFBvbHkyVHJpIENvcHlyaWdodCAoYykgMjAwOS0yMDE0LCBQb2x5MlRyaSBDb250cmlidXRvcnMKICogaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL3BvbHkydHJpLwogKiAKICogcG9seTJ0cmkuanMgKEphdmFTY3JpcHQgcG9ydCkgKGMpIDIwMDktMjAxNCwgUG9seTJUcmkgQ29udHJpYnV0b3JzCiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9yM21pL3BvbHkydHJpLmpzCiAqIAogKiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiAKICogRGlzdHJpYnV0ZWQgdW5kZXIgdGhlIDMtY2xhdXNlIEJTRCBMaWNlbnNlLCBzZWUgTElDRU5TRS50eHQKICovCi8qKgogKiBUaGUgZm9sbG93aW5nIGZ1bmN0aW9ucyBvcGVyYXRlIG9uICJQb2ludCIgb3IgYW55ICJQb2ludCBsaWtlIiBvYmplY3Qgd2l0aCB7eCx5fSwKICogYXMgZGVmaW5lZCBieSB0aGUge0BsaW5rIFhZfSB0eXBlCiAqIChbZHVjayB0eXBpbmdde0BsaW5rIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRHVja190eXBpbmd9KS4KICogQG1vZHVsZQogKiBAcHJpdmF0ZQogKi8KCi8qKgogKiBwb2x5MnRyaS5qcyBzdXBwb3J0cyB1c2luZyBjdXN0b20gcG9pbnQgY2xhc3MgaW5zdGVhZCBvZiB7QGxpbmtjb2RlIFBvaW50fS4KICogQW55ICJQb2ludCBsaWtlIiBvYmplY3Qgd2l0aCA8Y29kZT57eCwgeX08L2NvZGU+IGF0dHJpYnV0ZXMgaXMgc3VwcG9ydGVkCiAqIHRvIGluaXRpYWxpemUgdGhlIFN3ZWVwQ29udGV4dCBwb2x5bGluZXMgYW5kIHBvaW50cwogKiAoW2R1Y2sgdHlwaW5nXXtAbGluayBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0R1Y2tfdHlwaW5nfSkuCiAqCiAqIHBvbHkydHJpLmpzIG1pZ2h0IGFkZCBleHRyYSBmaWVsZHMgdG8gdGhlIHBvaW50IG9iamVjdHMgd2hlbiBjb21wdXRpbmcgdGhlCiAqIHRyaWFuZ3VsYXRpb24gOiB0aGV5IGFyZSBwcmVmaXhlZCB3aXRoIDxjb2RlPl9wMnRfPC9jb2RlPiB0byBhdm9pZCBjb2xsaXNpb25zCiAqIHdpdGggZmllbGRzIGluIHRoZSBjdXN0b20gY2xhc3MuCiAqCiAqIEBleGFtcGxlCiAqICAgICAgdmFyIGNvbnRvdXIgPSBbe3g6MTAwLCB5OjEwMH0sIHt4OjEwMCwgeTozMDB9LCB7eDozMDAsIHk6MzAwfSwge3g6MzAwLCB5OjEwMH1dOwogKiAgICAgIHZhciBzd2N0eCA9IG5ldyBwb2x5MnRyaS5Td2VlcENvbnRleHQoY29udG91cik7CiAqCiAqIEB0eXBlZGVmIHtPYmplY3R9IFhZCiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB4IC0geCBjb29yZGluYXRlCiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB5IC0geSBjb29yZGluYXRlCiAqLwoKLyoqCiAqIFBvaW50IHByZXR0eSBwcmludGluZyA6IHByaW50cyB4IGFuZCB5IGNvb3JkaW5hdGVzLgogKiBAZXhhbXBsZQogKiAgICAgIHh5LnRvU3RyaW5nQmFzZSh7eDo1LCB5OjQyfSkKICogICAgICAvLyDihpIgIig1OzQyKSIKICogQHByb3RlY3RlZAogKiBAcGFyYW0geyFYWX0gcCAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEByZXR1cm5zIHtzdHJpbmd9IDxjb2RlPiIoeDt5KSI8L2NvZGU+CiAqLwoKZnVuY3Rpb24gdG9TdHJpbmdCYXNlKHApIHsKICByZXR1cm4gIigiICsgcC54ICsgIjsiICsgcC55ICsgIikiOwp9Ci8qKgogKiBQb2ludCBwcmV0dHkgcHJpbnRpbmcuIERlbGVnYXRlcyB0byB0aGUgcG9pbnQncyBjdXN0b20gInRvU3RyaW5nKCkiIG1ldGhvZCBpZiBleGlzdHMsCiAqIGVsc2Ugc2ltcGx5IHByaW50cyB4IGFuZCB5IGNvb3JkaW5hdGVzLgogKiBAZXhhbXBsZQogKiAgICAgIHh5LnRvU3RyaW5nKHt4OjUsIHk6NDJ9KQogKiAgICAgIC8vIOKGkiAiKDU7NDIpIgogKiBAZXhhbXBsZQogKiAgICAgIHh5LnRvU3RyaW5nKHt4OjUseTo0Mix0b1N0cmluZzpmdW5jdGlvbigpIHtyZXR1cm4gdGhpcy54KyI6Iit0aGlzLnk7fX0pCiAqICAgICAgLy8g4oaSICI1OjQyIgogKiBAcGFyYW0geyFYWX0gcCAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEByZXR1cm5zIHtzdHJpbmd9IDxjb2RlPiIoeDt5KSI8L2NvZGU+CiAqLwoKCmZ1bmN0aW9uIHRvU3RyaW5nKHApIHsKICAvLyBUcnkgYSBjdXN0b20gdG9TdHJpbmcgZmlyc3QsIGFuZCBmYWxsYmFjayB0byBvd24gaW1wbGVtZW50YXRpb24gaWYgbm9uZQogIHZhciBzID0gcC50b1N0cmluZygpOwogIHJldHVybiBzID09PSAnW29iamVjdCBPYmplY3RdJyA/IHRvU3RyaW5nQmFzZShwKSA6IHM7Cn0KLyoqCiAqIENvbXBhcmUgdHdvIHBvaW50cyBjb21wb25lbnQtd2lzZS4gT3JkZXJlZCBieSB5IGF4aXMgZmlyc3QsIHRoZW4geCBheGlzLgogKiBAcGFyYW0geyFYWX0gYSAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7IVhZfSBiIC0gcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICogQHJldHVybiB7bnVtYmVyfSA8Y29kZT4mbHQ7IDA8L2NvZGU+IGlmIDxjb2RlPmEgJmx0OyBiPC9jb2RlPiwKICogICAgICAgICA8Y29kZT4mZ3Q7IDA8L2NvZGU+IGlmIDxjb2RlPmEgJmd0OyBiPC9jb2RlPiwgCiAqICAgICAgICAgPGNvZGU+MDwvY29kZT4gb3RoZXJ3aXNlLgogKi8KCgpmdW5jdGlvbiBjb21wYXJlKGEsIGIpIHsKICBpZiAoYS55ID09PSBiLnkpIHsKICAgIHJldHVybiBhLnggLSBiLng7CiAgfSBlbHNlIHsKICAgIHJldHVybiBhLnkgLSBiLnk7CiAgfQp9Ci8qKgogKiBUZXN0IHR3byBQb2ludCBvYmplY3RzIGZvciBlcXVhbGl0eS4KICogQHBhcmFtIHshWFl9IGEgLSBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcGFyYW0geyFYWX0gYiAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEByZXR1cm4ge2Jvb2xlYW59IDxjb2RlPlRydWU8L2NvZGU+IGlmIDxjb2RlPmEgPT0gYjwvY29kZT4sIDxjb2RlPmZhbHNlPC9jb2RlPiBvdGhlcndpc2UuCiAqLwoKCmZ1bmN0aW9uIGVxdWFscyhhLCBiKSB7CiAgcmV0dXJuIGEueCA9PT0gYi54ICYmIGEueSA9PT0gYi55Owp9Cgp2YXIgeHkgPSB7CiAgdG9TdHJpbmc6IHRvU3RyaW5nLAogIHRvU3RyaW5nQmFzZTogdG9TdHJpbmdCYXNlLAogIGNvbXBhcmU6IGNvbXBhcmUsCiAgZXF1YWxzOiBlcXVhbHMKfTsKCi8qCiAqIENsYXNzIGFkZGVkIGluIHRoZSBKYXZhU2NyaXB0IHZlcnNpb24gKHdhcyBub3QgcHJlc2VudCBpbiB0aGUgYysrIHZlcnNpb24pCiAqLwoKLyoqCiAqIEN1c3RvbSBleGNlcHRpb24gY2xhc3MgdG8gaW5kaWNhdGUgaW52YWxpZCBQb2ludCB2YWx1ZXMKICogQGNvbnN0cnVjdG9yCiAqIEBwdWJsaWMKICogQGV4dGVuZHMgRXJyb3IKICogQHN0cnVjdAogKiBAcGFyYW0ge3N0cmluZz19IG1lc3NhZ2UgLSBlcnJvciBtZXNzYWdlCiAqIEBwYXJhbSB7QXJyYXkuPFhZPj19IHBvaW50cyAtIGludmFsaWQgcG9pbnRzCiAqLwoKCnZhciBQb2ludEVycm9yID0gZnVuY3Rpb24gUG9pbnRFcnJvcihtZXNzYWdlLCBwb2ludHMpIHsKICB0aGlzLm5hbWUgPSAiUG9pbnRFcnJvciI7CiAgLyoqCiAgICogSW52YWxpZCBwb2ludHMKICAgKiBAcHVibGljCiAgICogQHR5cGUge0FycmF5LjxYWT59CiAgICovCgogIHRoaXMucG9pbnRzID0gcG9pbnRzID0gcG9pbnRzIHx8IFtdOwogIC8qKgogICAqIEVycm9yIG1lc3NhZ2UKICAgKiBAcHVibGljCiAgICogQHR5cGUge3N0cmluZ30KICAgKi8KCiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAiSW52YWxpZCBQb2ludHMhIjsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHsKICAgIHRoaXMubWVzc2FnZSArPSAiICIgKyB4eS50b1N0cmluZyhwb2ludHNbaV0pOwogIH0KfTsKClBvaW50RXJyb3IucHJvdG90eXBlID0gbmV3IEVycm9yKCk7ClBvaW50RXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUG9pbnRFcnJvcjsKdmFyIHBvaW50ZXJyb3IgPSBQb2ludEVycm9yOwoKLyoKICogTm90ZQogKiA9PT09CiAqIHRoZSBzdHJ1Y3R1cmUgb2YgdGhpcyBKYXZhU2NyaXB0IHZlcnNpb24gb2YgcG9seTJ0cmkgaW50ZW50aW9uYWxseSBmb2xsb3dzCiAqIGFzIGNsb3NlbHkgYXMgcG9zc2libGUgdGhlIHN0cnVjdHVyZSBvZiB0aGUgcmVmZXJlbmNlIEMrKyB2ZXJzaW9uLCB0byBtYWtlIGl0IAogKiBlYXNpZXIgdG8ga2VlcCB0aGUgMiB2ZXJzaW9ucyBpbiBzeW5jLgogKi8KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tUG9pbnQKCi8qKgogKiBDb25zdHJ1Y3QgYSBwb2ludAogKiBAZXhhbXBsZQogKiAgICAgIHZhciBwb2ludCA9IG5ldyBwb2x5MnRyaS5Qb2ludCgxNTAsIDE1MCk7CiAqIEBwdWJsaWMKICogQGNvbnN0cnVjdG9yCiAqIEBzdHJ1Y3QKICogQHBhcmFtIHtudW1iZXI9fSB4ICAgIGNvb3JkaW5hdGUgKDAgaWYgdW5kZWZpbmVkKQogKiBAcGFyYW0ge251bWJlcj19IHkgICAgY29vcmRpbmF0ZSAoMCBpZiB1bmRlZmluZWQpCiAqLwoKCnZhciBQb2ludCA9IGZ1bmN0aW9uIFBvaW50KHgsIHkpIHsKICAvKioKICAgKiBAdHlwZSB7bnVtYmVyfQogICAqIEBleHBvc2UKICAgKi8KICB0aGlzLnggPSAreCB8fCAwOwogIC8qKgogICAqIEB0eXBlIHtudW1iZXJ9CiAgICogQGV4cG9zZQogICAqLwoKICB0aGlzLnkgPSAreSB8fCAwOyAvLyBBbGwgZXh0cmEgZmllbGRzIGFkZGVkIHRvIFBvaW50IGFyZSBwcmVmaXhlZCB3aXRoIF9wMnRfCiAgLy8gdG8gYXZvaWQgY29sbGlzaW9ucyBpZiBjdXN0b20gUG9pbnQgY2xhc3MgaXMgdXNlZC4KCiAgLyoqCiAgICogVGhlIGVkZ2VzIHRoaXMgcG9pbnQgY29uc3RpdHV0ZXMgYW4gdXBwZXIgZW5kaW5nIHBvaW50CiAgICogQHByaXZhdGUKICAgKiBAdHlwZSB7QXJyYXkuPEVkZ2U+fQogICAqLwoKICB0aGlzLl9wMnRfZWRnZV9saXN0ID0gbnVsbDsKfTsKLyoqCiAqIEZvciBwcmV0dHkgcHJpbnRpbmcKICogQGV4YW1wbGUKICogICAgICAicD0iICsgbmV3IHBvbHkydHJpLlBvaW50KDUsNDIpCiAqICAgICAgLy8g4oaSICJwPSg1OzQyKSIKICogQHJldHVybnMge3N0cmluZ30gPGNvZGU+Iih4O3kpIjwvY29kZT4KICovCgoKUG9pbnQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB4eS50b1N0cmluZ0Jhc2UodGhpcyk7Cn07Ci8qKgogKiBKU09OIG91dHB1dCwgb25seSBjb29yZGluYXRlcwogKiBAZXhhbXBsZQogKiAgICAgIEpTT04uc3RyaW5naWZ5KG5ldyBwb2x5MnRyaS5Qb2ludCgxLDIpKQogKiAgICAgIC8vIOKGkiAneyJ4IjoxLCJ5IjoyfScKICovCgoKUG9pbnQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gewogICAgeDogdGhpcy54LAogICAgeTogdGhpcy55CiAgfTsKfTsKLyoqCiAqIENyZWF0ZXMgYSBjb3B5IG9mIHRoaXMgUG9pbnQgb2JqZWN0LgogKiBAcmV0dXJuIHtQb2ludH0gbmV3IGNsb25lZCBwb2ludAogKi8KCgpQb2ludC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIG5ldyBQb2ludCh0aGlzLngsIHRoaXMueSk7Cn07Ci8qKgogKiBTZXQgdGhpcyBQb2ludCBpbnN0YW5jZSB0byB0aGUgb3JpZ28uIDxjb2RlPigwOyAwKTwvY29kZT4KICogQHJldHVybiB7UG9pbnR9IHRoaXMgKGZvciBjaGFpbmluZykKICovCgoKUG9pbnQucHJvdG90eXBlLnNldF96ZXJvID0gZnVuY3Rpb24gKCkgewogIHRoaXMueCA9IDAuMDsKICB0aGlzLnkgPSAwLjA7CiAgcmV0dXJuIHRoaXM7IC8vIGZvciBjaGFpbmluZwp9OwovKioKICogU2V0IHRoZSBjb29yZGluYXRlcyBvZiB0aGlzIGluc3RhbmNlLgogKiBAcGFyYW0ge251bWJlcn0geCAgIGNvb3JkaW5hdGUKICogQHBhcmFtIHtudW1iZXJ9IHkgICBjb29yZGluYXRlCiAqIEByZXR1cm4ge1BvaW50fSB0aGlzIChmb3IgY2hhaW5pbmcpCiAqLwoKClBvaW50LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCwgeSkgewogIHRoaXMueCA9ICt4IHx8IDA7CiAgdGhpcy55ID0gK3kgfHwgMDsKICByZXR1cm4gdGhpczsgLy8gZm9yIGNoYWluaW5nCn07Ci8qKgogKiBOZWdhdGUgdGhpcyBQb2ludCBpbnN0YW5jZS4gKGNvbXBvbmVudC13aXNlKQogKiBAcmV0dXJuIHtQb2ludH0gdGhpcyAoZm9yIGNoYWluaW5nKQogKi8KCgpQb2ludC5wcm90b3R5cGUubmVnYXRlID0gZnVuY3Rpb24gKCkgewogIHRoaXMueCA9IC10aGlzLng7CiAgdGhpcy55ID0gLXRoaXMueTsKICByZXR1cm4gdGhpczsgLy8gZm9yIGNoYWluaW5nCn07Ci8qKgogKiBBZGQgYW5vdGhlciBQb2ludCBvYmplY3QgdG8gdGhpcyBpbnN0YW5jZS4gKGNvbXBvbmVudC13aXNlKQogKiBAcGFyYW0geyFQb2ludH0gbiAtIFBvaW50IG9iamVjdC4KICogQHJldHVybiB7UG9pbnR9IHRoaXMgKGZvciBjaGFpbmluZykKICovCgoKUG9pbnQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChuKSB7CiAgdGhpcy54ICs9IG4ueDsKICB0aGlzLnkgKz0gbi55OwogIHJldHVybiB0aGlzOyAvLyBmb3IgY2hhaW5pbmcKfTsKLyoqCiAqIFN1YnRyYWN0IHRoaXMgUG9pbnQgaW5zdGFuY2Ugd2l0aCBhbm90aGVyIHBvaW50IGdpdmVuLiAoY29tcG9uZW50LXdpc2UpCiAqIEBwYXJhbSB7IVBvaW50fSBuIC0gUG9pbnQgb2JqZWN0LgogKiBAcmV0dXJuIHtQb2ludH0gdGhpcyAoZm9yIGNoYWluaW5nKQogKi8KCgpQb2ludC5wcm90b3R5cGUuc3ViID0gZnVuY3Rpb24gKG4pIHsKICB0aGlzLnggLT0gbi54OwogIHRoaXMueSAtPSBuLnk7CiAgcmV0dXJuIHRoaXM7IC8vIGZvciBjaGFpbmluZwp9OwovKioKICogTXVsdGlwbHkgdGhpcyBQb2ludCBpbnN0YW5jZSBieSBhIHNjYWxhci4gKGNvbXBvbmVudC13aXNlKQogKiBAcGFyYW0ge251bWJlcn0gcyAgIHNjYWxhci4KICogQHJldHVybiB7UG9pbnR9IHRoaXMgKGZvciBjaGFpbmluZykKICovCgoKUG9pbnQucHJvdG90eXBlLm11bCA9IGZ1bmN0aW9uIChzKSB7CiAgdGhpcy54ICo9IHM7CiAgdGhpcy55ICo9IHM7CiAgcmV0dXJuIHRoaXM7IC8vIGZvciBjaGFpbmluZwp9OwovKioKICogUmV0dXJuIHRoZSBkaXN0YW5jZSBvZiB0aGlzIFBvaW50IGluc3RhbmNlIGZyb20gdGhlIG9yaWdvLgogKiBAcmV0dXJuIHtudW1iZXJ9IGRpc3RhbmNlCiAqLwoKClBvaW50LnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkpOwp9OwovKioKICogTm9ybWFsaXplIHRoaXMgUG9pbnQgaW5zdGFuY2UgKGFzIGEgdmVjdG9yKS4KICogQHJldHVybiB7bnVtYmVyfSBUaGUgb3JpZ2luYWwgZGlzdGFuY2Ugb2YgdGhpcyBpbnN0YW5jZSBmcm9tIHRoZSBvcmlnby4KICovCgoKUG9pbnQucHJvdG90eXBlLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uICgpIHsKICB2YXIgbGVuID0gdGhpcy5sZW5ndGgoKTsKICB0aGlzLnggLz0gbGVuOwogIHRoaXMueSAvPSBsZW47CiAgcmV0dXJuIGxlbjsKfTsKLyoqCiAqIFRlc3QgdGhpcyBQb2ludCBvYmplY3Qgd2l0aCBhbm90aGVyIGZvciBlcXVhbGl0eS4KICogQHBhcmFtIHshWFl9IHAgLSBhbnkgIlBvaW50IGxpa2UiIG9iamVjdCB3aXRoIHt4LHl9CiAqIEByZXR1cm4ge2Jvb2xlYW59IDxjb2RlPnRydWU8L2NvZGU+IGlmIHNhbWUgeCBhbmQgeSBjb29yZGluYXRlcywgPGNvZGU+ZmFsc2U8L2NvZGU+IG90aGVyd2lzZS4KICovCgoKUG9pbnQucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChwKSB7CiAgcmV0dXJuIHRoaXMueCA9PT0gcC54ICYmIHRoaXMueSA9PT0gcC55Owp9OyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVBvaW50ICgic3RhdGljIiBtZXRob2RzKQoKLyoqCiAqIE5lZ2F0ZSBhIHBvaW50IGNvbXBvbmVudC13aXNlIGFuZCByZXR1cm4gdGhlIHJlc3VsdCBhcyBhIG5ldyBQb2ludCBvYmplY3QuCiAqIEBwYXJhbSB7IVhZfSBwIC0gYW55ICJQb2ludCBsaWtlIiBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcmV0dXJuIHtQb2ludH0gdGhlIHJlc3VsdGluZyBQb2ludCBvYmplY3QuCiAqLwoKClBvaW50Lm5lZ2F0ZSA9IGZ1bmN0aW9uIChwKSB7CiAgcmV0dXJuIG5ldyBQb2ludCgtcC54LCAtcC55KTsKfTsKLyoqCiAqIEFkZCB0d28gcG9pbnRzIGNvbXBvbmVudC13aXNlIGFuZCByZXR1cm4gdGhlIHJlc3VsdCBhcyBhIG5ldyBQb2ludCBvYmplY3QuCiAqIEBwYXJhbSB7IVhZfSBhIC0gYW55ICJQb2ludCBsaWtlIiBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcGFyYW0geyFYWX0gYiAtIGFueSAiUG9pbnQgbGlrZSIgb2JqZWN0IHdpdGgge3gseX0KICogQHJldHVybiB7UG9pbnR9IHRoZSByZXN1bHRpbmcgUG9pbnQgb2JqZWN0LgogKi8KCgpQb2ludC5hZGQgPSBmdW5jdGlvbiAoYSwgYikgewogIHJldHVybiBuZXcgUG9pbnQoYS54ICsgYi54LCBhLnkgKyBiLnkpOwp9OwovKioKICogU3VidHJhY3QgdHdvIHBvaW50cyBjb21wb25lbnQtd2lzZSBhbmQgcmV0dXJuIHRoZSByZXN1bHQgYXMgYSBuZXcgUG9pbnQgb2JqZWN0LgogKiBAcGFyYW0geyFYWX0gYSAtIGFueSAiUG9pbnQgbGlrZSIgb2JqZWN0IHdpdGgge3gseX0KICogQHBhcmFtIHshWFl9IGIgLSBhbnkgIlBvaW50IGxpa2UiIG9iamVjdCB3aXRoIHt4LHl9CiAqIEByZXR1cm4ge1BvaW50fSB0aGUgcmVzdWx0aW5nIFBvaW50IG9iamVjdC4KICovCgoKUG9pbnQuc3ViID0gZnVuY3Rpb24gKGEsIGIpIHsKICByZXR1cm4gbmV3IFBvaW50KGEueCAtIGIueCwgYS55IC0gYi55KTsKfTsKLyoqCiAqIE11bHRpcGx5IGEgcG9pbnQgYnkgYSBzY2FsYXIgYW5kIHJldHVybiB0aGUgcmVzdWx0IGFzIGEgbmV3IFBvaW50IG9iamVjdC4KICogQHBhcmFtIHtudW1iZXJ9IHMgLSB0aGUgc2NhbGFyCiAqIEBwYXJhbSB7IVhZfSBwIC0gYW55ICJQb2ludCBsaWtlIiBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcmV0dXJuIHtQb2ludH0gdGhlIHJlc3VsdGluZyBQb2ludCBvYmplY3QuCiAqLwoKClBvaW50Lm11bCA9IGZ1bmN0aW9uIChzLCBwKSB7CiAgcmV0dXJuIG5ldyBQb2ludChzICogcC54LCBzICogcC55KTsKfTsKLyoqCiAqIFBlcmZvcm0gdGhlIGNyb3NzIHByb2R1Y3Qgb24gZWl0aGVyIHR3byBwb2ludHMgKHRoaXMgcHJvZHVjZXMgYSBzY2FsYXIpCiAqIG9yIGEgcG9pbnQgYW5kIGEgc2NhbGFyICh0aGlzIHByb2R1Y2VzIGEgcG9pbnQpLgogKiBUaGlzIGZ1bmN0aW9uIHJlcXVpcmVzIHR3byBwYXJhbWV0ZXJzLCBlaXRoZXIgbWF5IGJlIGEgUG9pbnQgb2JqZWN0IG9yIGEKICogbnVtYmVyLgogKiBAcGFyYW0gIHtYWXxudW1iZXJ9IGEgLSBQb2ludCBvYmplY3Qgb3Igc2NhbGFyLgogKiBAcGFyYW0gIHtYWXxudW1iZXJ9IGIgLSBQb2ludCBvYmplY3Qgb3Igc2NhbGFyLgogKiBAcmV0dXJuIHtQb2ludHxudW1iZXJ9IGEgUG9pbnQgb2JqZWN0IG9yIGEgbnVtYmVyLCBkZXBlbmRpbmcgb24gdGhlIHBhcmFtZXRlcnMuCiAqLwoKClBvaW50LmNyb3NzID0gZnVuY3Rpb24gKGEsIGIpIHsKICBpZiAodHlwZW9mIGEgPT09ICdudW1iZXInKSB7CiAgICBpZiAodHlwZW9mIGIgPT09ICdudW1iZXInKSB7CiAgICAgIHJldHVybiBhICogYjsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBuZXcgUG9pbnQoLWEgKiBiLnksIGEgKiBiLngpOwogICAgfQogIH0gZWxzZSB7CiAgICBpZiAodHlwZW9mIGIgPT09ICdudW1iZXInKSB7CiAgICAgIHJldHVybiBuZXcgUG9pbnQoYiAqIGEueSwgLWIgKiBhLngpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGEueCAqIGIueSAtIGEueSAqIGIueDsKICAgIH0KICB9Cn07IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIlBvaW50LUxpa2UiCgovKgogKiBUaGUgZm9sbG93aW5nIGZ1bmN0aW9ucyBvcGVyYXRlIG9uICJQb2ludCIgb3IgYW55ICJQb2ludCBsaWtlIiBvYmplY3QgCiAqIHdpdGgge3gseX0gKGR1Y2sgdHlwaW5nKS4KICovCgoKUG9pbnQudG9TdHJpbmcgPSB4eS50b1N0cmluZzsKUG9pbnQuY29tcGFyZSA9IHh5LmNvbXBhcmU7ClBvaW50LmNtcCA9IHh5LmNvbXBhcmU7IC8vIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkKClBvaW50LmVxdWFscyA9IHh5LmVxdWFsczsKLyoqCiAqIFBlZm9ybSB0aGUgZG90IHByb2R1Y3Qgb24gdHdvIHZlY3RvcnMuCiAqIEBwdWJsaWMKICogQHBhcmFtIHshWFl9IGEgLSBhbnkgIlBvaW50IGxpa2UiIG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7IVhZfSBiIC0gYW55ICJQb2ludCBsaWtlIiBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBkb3QgcHJvZHVjdAogKi8KClBvaW50LmRvdCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgcmV0dXJuIGEueCAqIGIueCArIGEueSAqIGIueTsKfTsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRXhwb3J0cyAocHVibGljIEFQSSkKCgp2YXIgcG9pbnQgPSBQb2ludDsKCi8qCiAqIE5vdGUKICogPT09PQogKiB0aGUgc3RydWN0dXJlIG9mIHRoaXMgSmF2YVNjcmlwdCB2ZXJzaW9uIG9mIHBvbHkydHJpIGludGVudGlvbmFsbHkgZm9sbG93cwogKiBhcyBjbG9zZWx5IGFzIHBvc3NpYmxlIHRoZSBzdHJ1Y3R1cmUgb2YgdGhlIHJlZmVyZW5jZSBDKysgdmVyc2lvbiwgdG8gbWFrZSBpdCAKICogZWFzaWVyIHRvIGtlZXAgdGhlIDIgdmVyc2lvbnMgaW4gc3luYy4KICovCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVRyaWFuZ2xlCgovKioKICogVHJpYW5nbGUgY2xhc3MuPGJyPgogKiBUcmlhbmdsZS1iYXNlZCBkYXRhIHN0cnVjdHVyZXMgYXJlIGtub3duIHRvIGhhdmUgYmV0dGVyIHBlcmZvcm1hbmNlIHRoYW4KICogcXVhZC1lZGdlIHN0cnVjdHVyZXMuCiAqIFNlZTogSi4gU2hld2NodWssICJUcmlhbmdsZTogRW5naW5lZXJpbmcgYSAyRCBRdWFsaXR5IE1lc2ggR2VuZXJhdG9yIGFuZAogKiBEZWxhdW5heSBUcmlhbmd1bGF0b3IiLCAiVHJpYW5ndWxhdGlvbnMgaW4gQ0dBTCIKICoKICogQGNvbnN0cnVjdG9yCiAqIEBzdHJ1Y3QKICogQHBhcmFtIHshWFl9IHBhICBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcGFyYW0geyFYWX0gcGIgIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7IVhZfSBwYyAgcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICovCgoKdmFyIFRyaWFuZ2xlID0gZnVuY3Rpb24gVHJpYW5nbGUoYSwgYiwgYykgewogIC8qKgogICAqIFRyaWFuZ2xlIHBvaW50cwogICAqIEBwcml2YXRlCiAgICogQHR5cGUge0FycmF5LjxYWT59CiAgICovCiAgdGhpcy5wb2ludHNfID0gW2EsIGIsIGNdOwogIC8qKgogICAqIE5laWdoYm9yIGxpc3QKICAgKiBAcHJpdmF0ZQogICAqIEB0eXBlIHtBcnJheS48VHJpYW5nbGU+fQogICAqLwoKICB0aGlzLm5laWdoYm9yc18gPSBbbnVsbCwgbnVsbCwgbnVsbF07CiAgLyoqCiAgICogSGFzIHRoaXMgdHJpYW5nbGUgYmVlbiBtYXJrZWQgYXMgYW4gaW50ZXJpb3IgdHJpYW5nbGU/CiAgICogQHByaXZhdGUKICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgKi8KCiAgdGhpcy5pbnRlcmlvcl8gPSBmYWxzZTsKICAvKioKICAgKiBGbGFncyB0byBkZXRlcm1pbmUgaWYgYW4gZWRnZSBpcyBhIENvbnN0cmFpbmVkIGVkZ2UKICAgKiBAcHJpdmF0ZQogICAqIEB0eXBlIHtBcnJheS48Ym9vbGVhbj59CiAgICovCgogIHRoaXMuY29uc3RyYWluZWRfZWRnZSA9IFtmYWxzZSwgZmFsc2UsIGZhbHNlXTsKICAvKioKICAgKiBGbGFncyB0byBkZXRlcm1pbmUgaWYgYW4gZWRnZSBpcyBhIERlbGF1bmV5IGVkZ2UKICAgKiBAcHJpdmF0ZQogICAqIEB0eXBlIHtBcnJheS48Ym9vbGVhbj59CiAgICovCgogIHRoaXMuZGVsYXVuYXlfZWRnZSA9IFtmYWxzZSwgZmFsc2UsIGZhbHNlXTsKfTsKCnZhciBwMnMgPSB4eS50b1N0cmluZzsKLyoqCiAqIEZvciBwcmV0dHkgcHJpbnRpbmcgZXguIDxjb2RlPiJbKDU7NDIpKDEwOzIwKSgyMTszMCldIjwvY29kZT4uCiAqIEBwdWJsaWMKICogQHJldHVybiB7c3RyaW5nfQogKi8KClRyaWFuZ2xlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gIlsiICsgcDJzKHRoaXMucG9pbnRzX1swXSkgKyBwMnModGhpcy5wb2ludHNfWzFdKSArIHAycyh0aGlzLnBvaW50c19bMl0pICsgIl0iOwp9OwovKioKICogR2V0IG9uZSB2ZXJ0aWNlIG9mIHRoZSB0cmlhbmdsZS4KICogVGhlIG91dHB1dCB0cmlhbmdsZXMgb2YgYSB0cmlhbmd1bGF0aW9uIGhhdmUgdmVydGljZXMgd2hpY2ggYXJlIHJlZmVyZW5jZXMKICogdG8gdGhlIGluaXRpYWwgaW5wdXQgcG9pbnRzIChub3QgY29waWVzKTogYW55IGN1c3RvbSBmaWVsZHMgaW4gdGhlCiAqIGluaXRpYWwgcG9pbnRzIGNhbiBiZSByZXRyaWV2ZWQgaW4gdGhlIG91dHB1dCB0cmlhbmdsZXMuCiAqIEBleGFtcGxlCiAqICAgICAgdmFyIGNvbnRvdXIgPSBbe3g6MTAwLCB5OjEwMCwgaWQ6MX0sIHt4OjEwMCwgeTozMDAsIGlkOjJ9LCB7eDozMDAsIHk6MzAwLCBpZDozfV07CiAqICAgICAgdmFyIHN3Y3R4ID0gbmV3IHBvbHkydHJpLlN3ZWVwQ29udGV4dChjb250b3VyKTsKICogICAgICBzd2N0eC50cmlhbmd1bGF0ZSgpOwogKiAgICAgIHZhciB0cmlhbmdsZXMgPSBzd2N0eC5nZXRUcmlhbmdsZXMoKTsKICogICAgICB0eXBlb2YgdHJpYW5nbGVzWzBdLmdldFBvaW50KDApLmlkCiAqICAgICAgLy8g4oaSICJudW1iZXIiCiAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIHZlcnRpY2UgaW5kZXg6IDAsIDEgb3IgMgogKiBAcHVibGljCiAqIEByZXR1cm5zIHtYWX0KICovCgoKVHJpYW5nbGUucHJvdG90eXBlLmdldFBvaW50ID0gZnVuY3Rpb24gKGluZGV4KSB7CiAgcmV0dXJuIHRoaXMucG9pbnRzX1tpbmRleF07Cn07Ci8qKgogKiBGb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eQogKiBAZnVuY3Rpb24KICogQGRlcHJlY2F0ZWQgdXNlIHtAbGlua2NvZGUgVHJpYW5nbGUjZ2V0UG9pbnR9IGluc3RlYWQKICovCgoKVHJpYW5nbGUucHJvdG90eXBlLkdldFBvaW50ID0gVHJpYW5nbGUucHJvdG90eXBlLmdldFBvaW50OwovKioKICogR2V0IGFsbCAzIHZlcnRpY2VzIG9mIHRoZSB0cmlhbmdsZSBhcyBhbiBhcnJheQogKiBAcHVibGljCiAqIEByZXR1cm4ge0FycmF5LjxYWT59CiAqLwovLyBNZXRob2QgYWRkZWQgaW4gdGhlIEphdmFTY3JpcHQgdmVyc2lvbiAod2FzIG5vdCBwcmVzZW50IGluIHRoZSBjKysgdmVyc2lvbikKClRyaWFuZ2xlLnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHRoaXMucG9pbnRzXzsKfTsKLyoqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleAogKiBAcmV0dXJucyB7P1RyaWFuZ2xlfQogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUuZ2V0TmVpZ2hib3IgPSBmdW5jdGlvbiAoaW5kZXgpIHsKICByZXR1cm4gdGhpcy5uZWlnaGJvcnNfW2luZGV4XTsKfTsKLyoqCiAqIFRlc3QgaWYgdGhpcyBUcmlhbmdsZSBjb250YWlucyB0aGUgUG9pbnQgb2JqZWN0IGdpdmVuIGFzIHBhcmFtZXRlciBhcyBvbmUgb2YgaXRzIHZlcnRpY2VzLgogKiBPbmx5IHBvaW50IHJlZmVyZW5jZXMgYXJlIGNvbXBhcmVkLCBub3QgdmFsdWVzLgogKiBAcHVibGljCiAqIEBwYXJhbSB7WFl9IHBvaW50IC0gcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICogQHJldHVybiB7Ym9vbGVhbn0gPGNvZGU+VHJ1ZTwvY29kZT4gaWYgdGhlIFBvaW50IG9iamVjdCBpcyBvZiB0aGUgVHJpYW5nbGUncyB2ZXJ0aWNlcywKICogICAgICAgICA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNlLgogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUuY29udGFpbnNQb2ludCA9IGZ1bmN0aW9uIChwb2ludCkgewogIHZhciBwb2ludHMgPSB0aGlzLnBvaW50c187IC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCgogIHJldHVybiBwb2ludCA9PT0gcG9pbnRzWzBdIHx8IHBvaW50ID09PSBwb2ludHNbMV0gfHwgcG9pbnQgPT09IHBvaW50c1syXTsKfTsKLyoqCiAqIFRlc3QgaWYgdGhpcyBUcmlhbmdsZSBjb250YWlucyB0aGUgRWRnZSBvYmplY3QgZ2l2ZW4gYXMgcGFyYW1ldGVyIGFzIGl0cwogKiBib3VuZGluZyBlZGdlcy4gT25seSBwb2ludCByZWZlcmVuY2VzIGFyZSBjb21wYXJlZCwgbm90IHZhbHVlcy4KICogQHByaXZhdGUKICogQHBhcmFtIHtFZGdlfSBlZGdlCiAqIEByZXR1cm4ge2Jvb2xlYW59IDxjb2RlPlRydWU8L2NvZGU+IGlmIHRoZSBFZGdlIG9iamVjdCBpcyBvZiB0aGUgVHJpYW5nbGUncyBib3VuZGluZwogKiAgICAgICAgIGVkZ2VzLCA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNlLgogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUuY29udGFpbnNFZGdlID0gZnVuY3Rpb24gKGVkZ2UpIHsKICByZXR1cm4gdGhpcy5jb250YWluc1BvaW50KGVkZ2UucCkgJiYgdGhpcy5jb250YWluc1BvaW50KGVkZ2UucSk7Cn07Ci8qKgogKiBUZXN0IGlmIHRoaXMgVHJpYW5nbGUgY29udGFpbnMgdGhlIHR3byBQb2ludCBvYmplY3RzIGdpdmVuIGFzIHBhcmFtZXRlcnMgYW1vbmcgaXRzIHZlcnRpY2VzLgogKiBPbmx5IHBvaW50IHJlZmVyZW5jZXMgYXJlIGNvbXBhcmVkLCBub3QgdmFsdWVzLgogKiBAcGFyYW0ge1hZfSBwMSAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7WFl9IHAyIC0gcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICogQHJldHVybiB7Ym9vbGVhbn0KICovCgoKVHJpYW5nbGUucHJvdG90eXBlLmNvbnRhaW5zUG9pbnRzID0gZnVuY3Rpb24gKHAxLCBwMikgewogIHJldHVybiB0aGlzLmNvbnRhaW5zUG9pbnQocDEpICYmIHRoaXMuY29udGFpbnNQb2ludChwMik7Cn07Ci8qKgogKiBIYXMgdGhpcyB0cmlhbmdsZSBiZWVuIG1hcmtlZCBhcyBhbiBpbnRlcmlvciB0cmlhbmdsZT8KICogQHJldHVybnMge2Jvb2xlYW59CiAqLwoKClRyaWFuZ2xlLnByb3RvdHlwZS5pc0ludGVyaW9yID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzLmludGVyaW9yXzsKfTsKLyoqCiAqIE1hcmsgdGhpcyB0cmlhbmdsZSBhcyBhbiBpbnRlcmlvciB0cmlhbmdsZQogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge2Jvb2xlYW59IGludGVyaW9yCiAqIEByZXR1cm5zIHtUcmlhbmdsZX0gdGhpcwogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUuc2V0SW50ZXJpb3IgPSBmdW5jdGlvbiAoaW50ZXJpb3IpIHsKICB0aGlzLmludGVyaW9yXyA9IGludGVyaW9yOwogIHJldHVybiB0aGlzOwp9OwovKioKICogVXBkYXRlIG5laWdoYm9yIHBvaW50ZXJzLgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1hZfSBwMSAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7WFl9IHAyIC0gcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICogQHBhcmFtIHtUcmlhbmdsZX0gdCBUcmlhbmdsZSBvYmplY3QuCiAqIEB0aHJvd3Mge0Vycm9yfSBpZiBjYW4ndCBmaW5kIG9iamVjdHMKICovCgoKVHJpYW5nbGUucHJvdG90eXBlLm1hcmtOZWlnaGJvclBvaW50ZXJzID0gZnVuY3Rpb24gKHAxLCBwMiwgdCkgewogIHZhciBwb2ludHMgPSB0aGlzLnBvaW50c187IC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCgogIGlmIChwMSA9PT0gcG9pbnRzWzJdICYmIHAyID09PSBwb2ludHNbMV0gfHwgcDEgPT09IHBvaW50c1sxXSAmJiBwMiA9PT0gcG9pbnRzWzJdKSB7CiAgICB0aGlzLm5laWdoYm9yc19bMF0gPSB0OwogIH0gZWxzZSBpZiAocDEgPT09IHBvaW50c1swXSAmJiBwMiA9PT0gcG9pbnRzWzJdIHx8IHAxID09PSBwb2ludHNbMl0gJiYgcDIgPT09IHBvaW50c1swXSkgewogICAgdGhpcy5uZWlnaGJvcnNfWzFdID0gdDsKICB9IGVsc2UgaWYgKHAxID09PSBwb2ludHNbMF0gJiYgcDIgPT09IHBvaW50c1sxXSB8fCBwMSA9PT0gcG9pbnRzWzFdICYmIHAyID09PSBwb2ludHNbMF0pIHsKICAgIHRoaXMubmVpZ2hib3JzX1syXSA9IHQ7CiAgfSBlbHNlIHsKICAgIHRocm93IG5ldyBFcnJvcigncG9seTJ0cmkgSW52YWxpZCBUcmlhbmdsZS5tYXJrTmVpZ2hib3JQb2ludGVycygpIGNhbGwnKTsKICB9Cn07Ci8qKgogKiBFeGhhdXN0aXZlIHNlYXJjaCB0byB1cGRhdGUgbmVpZ2hib3IgcG9pbnRlcnMKICogQHByaXZhdGUKICogQHBhcmFtIHshVHJpYW5nbGV9IHQKICovCgoKVHJpYW5nbGUucHJvdG90eXBlLm1hcmtOZWlnaGJvciA9IGZ1bmN0aW9uICh0KSB7CiAgdmFyIHBvaW50cyA9IHRoaXMucG9pbnRzXzsKCiAgaWYgKHQuY29udGFpbnNQb2ludHMocG9pbnRzWzFdLCBwb2ludHNbMl0pKSB7CiAgICB0aGlzLm5laWdoYm9yc19bMF0gPSB0OwogICAgdC5tYXJrTmVpZ2hib3JQb2ludGVycyhwb2ludHNbMV0sIHBvaW50c1syXSwgdGhpcyk7CiAgfSBlbHNlIGlmICh0LmNvbnRhaW5zUG9pbnRzKHBvaW50c1swXSwgcG9pbnRzWzJdKSkgewogICAgdGhpcy5uZWlnaGJvcnNfWzFdID0gdDsKICAgIHQubWFya05laWdoYm9yUG9pbnRlcnMocG9pbnRzWzBdLCBwb2ludHNbMl0sIHRoaXMpOwogIH0gZWxzZSBpZiAodC5jb250YWluc1BvaW50cyhwb2ludHNbMF0sIHBvaW50c1sxXSkpIHsKICAgIHRoaXMubmVpZ2hib3JzX1syXSA9IHQ7CiAgICB0Lm1hcmtOZWlnaGJvclBvaW50ZXJzKHBvaW50c1swXSwgcG9pbnRzWzFdLCB0aGlzKTsKICB9Cn07CgpUcmlhbmdsZS5wcm90b3R5cGUuY2xlYXJOZWlnaGJvcnMgPSBmdW5jdGlvbiAoKSB7CiAgdGhpcy5uZWlnaGJvcnNfWzBdID0gbnVsbDsKICB0aGlzLm5laWdoYm9yc19bMV0gPSBudWxsOwogIHRoaXMubmVpZ2hib3JzX1syXSA9IG51bGw7Cn07CgpUcmlhbmdsZS5wcm90b3R5cGUuY2xlYXJEZWxhdW5heUVkZ2VzID0gZnVuY3Rpb24gKCkgewogIHRoaXMuZGVsYXVuYXlfZWRnZVswXSA9IGZhbHNlOwogIHRoaXMuZGVsYXVuYXlfZWRnZVsxXSA9IGZhbHNlOwogIHRoaXMuZGVsYXVuYXlfZWRnZVsyXSA9IGZhbHNlOwp9OwovKioKICogUmV0dXJucyB0aGUgcG9pbnQgY2xvY2t3aXNlIHRvIHRoZSBnaXZlbiBwb2ludC4KICogQHByaXZhdGUKICogQHBhcmFtIHtYWX0gcCAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqLwoKClRyaWFuZ2xlLnByb3RvdHlwZS5wb2ludENXID0gZnVuY3Rpb24gKHApIHsKICB2YXIgcG9pbnRzID0gdGhpcy5wb2ludHNfOyAvLyBIZXJlIHdlIGFyZSBjb21wYXJpbmcgcG9pbnQgcmVmZXJlbmNlcywgbm90IHZhbHVlcwoKICBpZiAocCA9PT0gcG9pbnRzWzBdKSB7CiAgICByZXR1cm4gcG9pbnRzWzJdOwogIH0gZWxzZSBpZiAocCA9PT0gcG9pbnRzWzFdKSB7CiAgICByZXR1cm4gcG9pbnRzWzBdOwogIH0gZWxzZSBpZiAocCA9PT0gcG9pbnRzWzJdKSB7CiAgICByZXR1cm4gcG9pbnRzWzFdOwogIH0gZWxzZSB7CiAgICByZXR1cm4gbnVsbDsKICB9Cn07Ci8qKgogKiBSZXR1cm5zIHRoZSBwb2ludCBjb3VudGVyLWNsb2Nrd2lzZSB0byB0aGUgZ2l2ZW4gcG9pbnQuCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7WFl9IHAgLSBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUucG9pbnRDQ1cgPSBmdW5jdGlvbiAocCkgewogIHZhciBwb2ludHMgPSB0aGlzLnBvaW50c187IC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCgogIGlmIChwID09PSBwb2ludHNbMF0pIHsKICAgIHJldHVybiBwb2ludHNbMV07CiAgfSBlbHNlIGlmIChwID09PSBwb2ludHNbMV0pIHsKICAgIHJldHVybiBwb2ludHNbMl07CiAgfSBlbHNlIGlmIChwID09PSBwb2ludHNbMl0pIHsKICAgIHJldHVybiBwb2ludHNbMF07CiAgfSBlbHNlIHsKICAgIHJldHVybiBudWxsOwogIH0KfTsKLyoqCiAqIFJldHVybnMgdGhlIG5laWdoYm9yIGNsb2Nrd2lzZSB0byBnaXZlbiBwb2ludC4KICogQHByaXZhdGUKICogQHBhcmFtIHtYWX0gcCAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqLwoKClRyaWFuZ2xlLnByb3RvdHlwZS5uZWlnaGJvckNXID0gZnVuY3Rpb24gKHApIHsKICAvLyBIZXJlIHdlIGFyZSBjb21wYXJpbmcgcG9pbnQgcmVmZXJlbmNlcywgbm90IHZhbHVlcwogIGlmIChwID09PSB0aGlzLnBvaW50c19bMF0pIHsKICAgIHJldHVybiB0aGlzLm5laWdoYm9yc19bMV07CiAgfSBlbHNlIGlmIChwID09PSB0aGlzLnBvaW50c19bMV0pIHsKICAgIHJldHVybiB0aGlzLm5laWdoYm9yc19bMl07CiAgfSBlbHNlIHsKICAgIHJldHVybiB0aGlzLm5laWdoYm9yc19bMF07CiAgfQp9OwovKioKICogUmV0dXJucyB0aGUgbmVpZ2hib3IgY291bnRlci1jbG9ja3dpc2UgdG8gZ2l2ZW4gcG9pbnQuCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7WFl9IHAgLSBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUubmVpZ2hib3JDQ1cgPSBmdW5jdGlvbiAocCkgewogIC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCiAgaWYgKHAgPT09IHRoaXMucG9pbnRzX1swXSkgewogICAgcmV0dXJuIHRoaXMubmVpZ2hib3JzX1syXTsKICB9IGVsc2UgaWYgKHAgPT09IHRoaXMucG9pbnRzX1sxXSkgewogICAgcmV0dXJuIHRoaXMubmVpZ2hib3JzX1swXTsKICB9IGVsc2UgewogICAgcmV0dXJuIHRoaXMubmVpZ2hib3JzX1sxXTsKICB9Cn07CgpUcmlhbmdsZS5wcm90b3R5cGUuZ2V0Q29uc3RyYWluZWRFZGdlQ1cgPSBmdW5jdGlvbiAocCkgewogIC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCiAgaWYgKHAgPT09IHRoaXMucG9pbnRzX1swXSkgewogICAgcmV0dXJuIHRoaXMuY29uc3RyYWluZWRfZWRnZVsxXTsKICB9IGVsc2UgaWYgKHAgPT09IHRoaXMucG9pbnRzX1sxXSkgewogICAgcmV0dXJuIHRoaXMuY29uc3RyYWluZWRfZWRnZVsyXTsKICB9IGVsc2UgewogICAgcmV0dXJuIHRoaXMuY29uc3RyYWluZWRfZWRnZVswXTsKICB9Cn07CgpUcmlhbmdsZS5wcm90b3R5cGUuZ2V0Q29uc3RyYWluZWRFZGdlQ0NXID0gZnVuY3Rpb24gKHApIHsKICAvLyBIZXJlIHdlIGFyZSBjb21wYXJpbmcgcG9pbnQgcmVmZXJlbmNlcywgbm90IHZhbHVlcwogIGlmIChwID09PSB0aGlzLnBvaW50c19bMF0pIHsKICAgIHJldHVybiB0aGlzLmNvbnN0cmFpbmVkX2VkZ2VbMl07CiAgfSBlbHNlIGlmIChwID09PSB0aGlzLnBvaW50c19bMV0pIHsKICAgIHJldHVybiB0aGlzLmNvbnN0cmFpbmVkX2VkZ2VbMF07CiAgfSBlbHNlIHsKICAgIHJldHVybiB0aGlzLmNvbnN0cmFpbmVkX2VkZ2VbMV07CiAgfQp9OyAvLyBBZGRpdGlvbmFsIGNoZWNrIGZyb20gSmF2YSB2ZXJzaW9uIChzZWUgaXNzdWUgIzg4KQoKClRyaWFuZ2xlLnByb3RvdHlwZS5nZXRDb25zdHJhaW5lZEVkZ2VBY3Jvc3MgPSBmdW5jdGlvbiAocCkgewogIC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCiAgaWYgKHAgPT09IHRoaXMucG9pbnRzX1swXSkgewogICAgcmV0dXJuIHRoaXMuY29uc3RyYWluZWRfZWRnZVswXTsKICB9IGVsc2UgaWYgKHAgPT09IHRoaXMucG9pbnRzX1sxXSkgewogICAgcmV0dXJuIHRoaXMuY29uc3RyYWluZWRfZWRnZVsxXTsKICB9IGVsc2UgewogICAgcmV0dXJuIHRoaXMuY29uc3RyYWluZWRfZWRnZVsyXTsKICB9Cn07CgpUcmlhbmdsZS5wcm90b3R5cGUuc2V0Q29uc3RyYWluZWRFZGdlQ1cgPSBmdW5jdGlvbiAocCwgY2UpIHsKICAvLyBIZXJlIHdlIGFyZSBjb21wYXJpbmcgcG9pbnQgcmVmZXJlbmNlcywgbm90IHZhbHVlcwogIGlmIChwID09PSB0aGlzLnBvaW50c19bMF0pIHsKICAgIHRoaXMuY29uc3RyYWluZWRfZWRnZVsxXSA9IGNlOwogIH0gZWxzZSBpZiAocCA9PT0gdGhpcy5wb2ludHNfWzFdKSB7CiAgICB0aGlzLmNvbnN0cmFpbmVkX2VkZ2VbMl0gPSBjZTsKICB9IGVsc2UgewogICAgdGhpcy5jb25zdHJhaW5lZF9lZGdlWzBdID0gY2U7CiAgfQp9OwoKVHJpYW5nbGUucHJvdG90eXBlLnNldENvbnN0cmFpbmVkRWRnZUNDVyA9IGZ1bmN0aW9uIChwLCBjZSkgewogIC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCiAgaWYgKHAgPT09IHRoaXMucG9pbnRzX1swXSkgewogICAgdGhpcy5jb25zdHJhaW5lZF9lZGdlWzJdID0gY2U7CiAgfSBlbHNlIGlmIChwID09PSB0aGlzLnBvaW50c19bMV0pIHsKICAgIHRoaXMuY29uc3RyYWluZWRfZWRnZVswXSA9IGNlOwogIH0gZWxzZSB7CiAgICB0aGlzLmNvbnN0cmFpbmVkX2VkZ2VbMV0gPSBjZTsKICB9Cn07CgpUcmlhbmdsZS5wcm90b3R5cGUuZ2V0RGVsYXVuYXlFZGdlQ1cgPSBmdW5jdGlvbiAocCkgewogIC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCiAgaWYgKHAgPT09IHRoaXMucG9pbnRzX1swXSkgewogICAgcmV0dXJuIHRoaXMuZGVsYXVuYXlfZWRnZVsxXTsKICB9IGVsc2UgaWYgKHAgPT09IHRoaXMucG9pbnRzX1sxXSkgewogICAgcmV0dXJuIHRoaXMuZGVsYXVuYXlfZWRnZVsyXTsKICB9IGVsc2UgewogICAgcmV0dXJuIHRoaXMuZGVsYXVuYXlfZWRnZVswXTsKICB9Cn07CgpUcmlhbmdsZS5wcm90b3R5cGUuZ2V0RGVsYXVuYXlFZGdlQ0NXID0gZnVuY3Rpb24gKHApIHsKICAvLyBIZXJlIHdlIGFyZSBjb21wYXJpbmcgcG9pbnQgcmVmZXJlbmNlcywgbm90IHZhbHVlcwogIGlmIChwID09PSB0aGlzLnBvaW50c19bMF0pIHsKICAgIHJldHVybiB0aGlzLmRlbGF1bmF5X2VkZ2VbMl07CiAgfSBlbHNlIGlmIChwID09PSB0aGlzLnBvaW50c19bMV0pIHsKICAgIHJldHVybiB0aGlzLmRlbGF1bmF5X2VkZ2VbMF07CiAgfSBlbHNlIHsKICAgIHJldHVybiB0aGlzLmRlbGF1bmF5X2VkZ2VbMV07CiAgfQp9OwoKVHJpYW5nbGUucHJvdG90eXBlLnNldERlbGF1bmF5RWRnZUNXID0gZnVuY3Rpb24gKHAsIGUpIHsKICAvLyBIZXJlIHdlIGFyZSBjb21wYXJpbmcgcG9pbnQgcmVmZXJlbmNlcywgbm90IHZhbHVlcwogIGlmIChwID09PSB0aGlzLnBvaW50c19bMF0pIHsKICAgIHRoaXMuZGVsYXVuYXlfZWRnZVsxXSA9IGU7CiAgfSBlbHNlIGlmIChwID09PSB0aGlzLnBvaW50c19bMV0pIHsKICAgIHRoaXMuZGVsYXVuYXlfZWRnZVsyXSA9IGU7CiAgfSBlbHNlIHsKICAgIHRoaXMuZGVsYXVuYXlfZWRnZVswXSA9IGU7CiAgfQp9OwoKVHJpYW5nbGUucHJvdG90eXBlLnNldERlbGF1bmF5RWRnZUNDVyA9IGZ1bmN0aW9uIChwLCBlKSB7CiAgLy8gSGVyZSB3ZSBhcmUgY29tcGFyaW5nIHBvaW50IHJlZmVyZW5jZXMsIG5vdCB2YWx1ZXMKICBpZiAocCA9PT0gdGhpcy5wb2ludHNfWzBdKSB7CiAgICB0aGlzLmRlbGF1bmF5X2VkZ2VbMl0gPSBlOwogIH0gZWxzZSBpZiAocCA9PT0gdGhpcy5wb2ludHNfWzFdKSB7CiAgICB0aGlzLmRlbGF1bmF5X2VkZ2VbMF0gPSBlOwogIH0gZWxzZSB7CiAgICB0aGlzLmRlbGF1bmF5X2VkZ2VbMV0gPSBlOwogIH0KfTsKLyoqCiAqIFRoZSBuZWlnaGJvciBhY3Jvc3MgdG8gZ2l2ZW4gcG9pbnQuCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7WFl9IHAgLSBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcmV0dXJucyB7VHJpYW5nbGV9CiAqLwoKClRyaWFuZ2xlLnByb3RvdHlwZS5uZWlnaGJvckFjcm9zcyA9IGZ1bmN0aW9uIChwKSB7CiAgLy8gSGVyZSB3ZSBhcmUgY29tcGFyaW5nIHBvaW50IHJlZmVyZW5jZXMsIG5vdCB2YWx1ZXMKICBpZiAocCA9PT0gdGhpcy5wb2ludHNfWzBdKSB7CiAgICByZXR1cm4gdGhpcy5uZWlnaGJvcnNfWzBdOwogIH0gZWxzZSBpZiAocCA9PT0gdGhpcy5wb2ludHNfWzFdKSB7CiAgICByZXR1cm4gdGhpcy5uZWlnaGJvcnNfWzFdOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdGhpcy5uZWlnaGJvcnNfWzJdOwogIH0KfTsKLyoqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7IVRyaWFuZ2xlfSB0IFRyaWFuZ2xlIG9iamVjdC4KICogQHBhcmFtIHtYWX0gcCAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqLwoKClRyaWFuZ2xlLnByb3RvdHlwZS5vcHBvc2l0ZVBvaW50ID0gZnVuY3Rpb24gKHQsIHApIHsKICB2YXIgY3cgPSB0LnBvaW50Q1cocCk7CiAgcmV0dXJuIHRoaXMucG9pbnRDVyhjdyk7Cn07Ci8qKgogKiBMZWdhbGl6ZSB0cmlhbmdsZSBieSByb3RhdGluZyBjbG9ja3dpc2UgYXJvdW5kIG9Qb2ludAogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1hZfSBvcG9pbnQgLSBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcGFyYW0ge1hZfSBucG9pbnQgLSBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAdGhyb3dzIHtFcnJvcn0gaWYgb1BvaW50IGNhbiBub3QgYmUgZm91bmQKICovCgoKVHJpYW5nbGUucHJvdG90eXBlLmxlZ2FsaXplID0gZnVuY3Rpb24gKG9wb2ludCwgbnBvaW50KSB7CiAgdmFyIHBvaW50cyA9IHRoaXMucG9pbnRzXzsgLy8gSGVyZSB3ZSBhcmUgY29tcGFyaW5nIHBvaW50IHJlZmVyZW5jZXMsIG5vdCB2YWx1ZXMKCiAgaWYgKG9wb2ludCA9PT0gcG9pbnRzWzBdKSB7CiAgICBwb2ludHNbMV0gPSBwb2ludHNbMF07CiAgICBwb2ludHNbMF0gPSBwb2ludHNbMl07CiAgICBwb2ludHNbMl0gPSBucG9pbnQ7CiAgfSBlbHNlIGlmIChvcG9pbnQgPT09IHBvaW50c1sxXSkgewogICAgcG9pbnRzWzJdID0gcG9pbnRzWzFdOwogICAgcG9pbnRzWzFdID0gcG9pbnRzWzBdOwogICAgcG9pbnRzWzBdID0gbnBvaW50OwogIH0gZWxzZSBpZiAob3BvaW50ID09PSBwb2ludHNbMl0pIHsKICAgIHBvaW50c1swXSA9IHBvaW50c1syXTsKICAgIHBvaW50c1syXSA9IHBvaW50c1sxXTsKICAgIHBvaW50c1sxXSA9IG5wb2ludDsKICB9IGVsc2UgewogICAgdGhyb3cgbmV3IEVycm9yKCdwb2x5MnRyaSBJbnZhbGlkIFRyaWFuZ2xlLmxlZ2FsaXplKCkgY2FsbCcpOwogIH0KfTsKLyoqCiAqIFJldHVybnMgdGhlIGluZGV4IG9mIGEgcG9pbnQgaW4gdGhlIHRyaWFuZ2xlLiAKICogVGhlIHBvaW50ICptdXN0KiBiZSBhIHJlZmVyZW5jZSB0byBvbmUgb2YgdGhlIHRyaWFuZ2xlJ3MgdmVydGljZXMuCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7WFl9IHAgLSBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcmV0dXJucyB7bnVtYmVyfSBpbmRleCAwLCAxIG9yIDIKICogQHRocm93cyB7RXJyb3J9IGlmIHAgY2FuIG5vdCBiZSBmb3VuZAogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbiAocCkgewogIHZhciBwb2ludHMgPSB0aGlzLnBvaW50c187IC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCgogIGlmIChwID09PSBwb2ludHNbMF0pIHsKICAgIHJldHVybiAwOwogIH0gZWxzZSBpZiAocCA9PT0gcG9pbnRzWzFdKSB7CiAgICByZXR1cm4gMTsKICB9IGVsc2UgaWYgKHAgPT09IHBvaW50c1syXSkgewogICAgcmV0dXJuIDI7CiAgfSBlbHNlIHsKICAgIHRocm93IG5ldyBFcnJvcigncG9seTJ0cmkgSW52YWxpZCBUcmlhbmdsZS5pbmRleCgpIGNhbGwnKTsKICB9Cn07Ci8qKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1hZfSBwMSAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7WFl9IHAyIC0gcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICogQHJldHVybiB7bnVtYmVyfSBpbmRleCAwLCAxIG9yIDIsIG9yIC0xIGlmIGVycnJvcgogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUuZWRnZUluZGV4ID0gZnVuY3Rpb24gKHAxLCBwMikgewogIHZhciBwb2ludHMgPSB0aGlzLnBvaW50c187IC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCgogIGlmIChwMSA9PT0gcG9pbnRzWzBdKSB7CiAgICBpZiAocDIgPT09IHBvaW50c1sxXSkgewogICAgICByZXR1cm4gMjsKICAgIH0gZWxzZSBpZiAocDIgPT09IHBvaW50c1syXSkgewogICAgICByZXR1cm4gMTsKICAgIH0KICB9IGVsc2UgaWYgKHAxID09PSBwb2ludHNbMV0pIHsKICAgIGlmIChwMiA9PT0gcG9pbnRzWzJdKSB7CiAgICAgIHJldHVybiAwOwogICAgfSBlbHNlIGlmIChwMiA9PT0gcG9pbnRzWzBdKSB7CiAgICAgIHJldHVybiAyOwogICAgfQogIH0gZWxzZSBpZiAocDEgPT09IHBvaW50c1syXSkgewogICAgaWYgKHAyID09PSBwb2ludHNbMF0pIHsKICAgICAgcmV0dXJuIDE7CiAgICB9IGVsc2UgaWYgKHAyID09PSBwb2ludHNbMV0pIHsKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgfQoKICByZXR1cm4gLTE7Cn07Ci8qKgogKiBNYXJrIGFuIGVkZ2Ugb2YgdGhpcyB0cmlhbmdsZSBhcyBjb25zdHJhaW5lZC4KICogQHByaXZhdGUKICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gZWRnZSBpbmRleAogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUubWFya0NvbnN0cmFpbmVkRWRnZUJ5SW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHsKICB0aGlzLmNvbnN0cmFpbmVkX2VkZ2VbaW5kZXhdID0gdHJ1ZTsKfTsKLyoqCiAqIE1hcmsgYW4gZWRnZSBvZiB0aGlzIHRyaWFuZ2xlIGFzIGNvbnN0cmFpbmVkLgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge0VkZ2V9IGVkZ2UgaW5zdGFuY2UKICovCgoKVHJpYW5nbGUucHJvdG90eXBlLm1hcmtDb25zdHJhaW5lZEVkZ2VCeUVkZ2UgPSBmdW5jdGlvbiAoZWRnZSkgewogIHRoaXMubWFya0NvbnN0cmFpbmVkRWRnZUJ5UG9pbnRzKGVkZ2UucCwgZWRnZS5xKTsKfTsKLyoqCiAqIE1hcmsgYW4gZWRnZSBvZiB0aGlzIHRyaWFuZ2xlIGFzIGNvbnN0cmFpbmVkLgogKiBUaGlzIG1ldGhvZCB0YWtlcyB0d28gUG9pbnQgaW5zdGFuY2VzIGRlZmluaW5nIHRoZSBlZGdlIG9mIHRoZSB0cmlhbmdsZS4KICogQHByaXZhdGUKICogQHBhcmFtIHtYWX0gcCAtIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7WFl9IHEgLSBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKi8KCgpUcmlhbmdsZS5wcm90b3R5cGUubWFya0NvbnN0cmFpbmVkRWRnZUJ5UG9pbnRzID0gZnVuY3Rpb24gKHAsIHEpIHsKICB2YXIgcG9pbnRzID0gdGhpcy5wb2ludHNfOyAvLyBIZXJlIHdlIGFyZSBjb21wYXJpbmcgcG9pbnQgcmVmZXJlbmNlcywgbm90IHZhbHVlcyAgICAgICAgCgogIGlmIChxID09PSBwb2ludHNbMF0gJiYgcCA9PT0gcG9pbnRzWzFdIHx8IHEgPT09IHBvaW50c1sxXSAmJiBwID09PSBwb2ludHNbMF0pIHsKICAgIHRoaXMuY29uc3RyYWluZWRfZWRnZVsyXSA9IHRydWU7CiAgfSBlbHNlIGlmIChxID09PSBwb2ludHNbMF0gJiYgcCA9PT0gcG9pbnRzWzJdIHx8IHEgPT09IHBvaW50c1syXSAmJiBwID09PSBwb2ludHNbMF0pIHsKICAgIHRoaXMuY29uc3RyYWluZWRfZWRnZVsxXSA9IHRydWU7CiAgfSBlbHNlIGlmIChxID09PSBwb2ludHNbMV0gJiYgcCA9PT0gcG9pbnRzWzJdIHx8IHEgPT09IHBvaW50c1syXSAmJiBwID09PSBwb2ludHNbMV0pIHsKICAgIHRoaXMuY29uc3RyYWluZWRfZWRnZVswXSA9IHRydWU7CiAgfQp9OyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1FeHBvcnRzIChwdWJsaWMgQVBJKQoKCnZhciB0cmlhbmdsZSA9IFRyaWFuZ2xlOwoKLyoKICogUG9seTJUcmkgQ29weXJpZ2h0IChjKSAyMDA5LTIwMTQsIFBvbHkyVHJpIENvbnRyaWJ1dG9ycwogKiBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvcG9seTJ0cmkvCiAqCiAqIHBvbHkydHJpLmpzIChKYXZhU2NyaXB0IHBvcnQpIChjKSAyMDA5LTIwMTQsIFBvbHkyVHJpIENvbnRyaWJ1dG9ycwogKiBodHRwczovL2dpdGh1Yi5jb20vcjNtaS9wb2x5MnRyaS5qcwogKgogKiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKgogKiBEaXN0cmlidXRlZCB1bmRlciB0aGUgMy1jbGF1c2UgQlNEIExpY2Vuc2UsIHNlZSBMSUNFTlNFLnR4dAogKi8KLyoKICogRnVuY3Rpb24gYWRkZWQgaW4gdGhlIEphdmFTY3JpcHQgdmVyc2lvbiAod2FzIG5vdCBwcmVzZW50IGluIHRoZSBjKysgdmVyc2lvbikKICovCgovKioKICogYXNzZXJ0IGFuZCB0aHJvdyBhbiBleGNlcHRpb24uCiAqCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7Ym9vbGVhbn0gY29uZGl0aW9uICAgdGhlIGNvbmRpdGlvbiB3aGljaCBpcyBhc3NlcnRlZAogKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAgICAgIHRoZSBtZXNzYWdlIHdoaWNoIGlzIGRpc3BsYXkgaXMgY29uZGl0aW9uIGlzIGZhbHN5CiAqLwoKZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbWVzc2FnZSkgewogIGlmICghY29uZGl0aW9uKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSB8fCAiQXNzZXJ0IEZhaWxlZCIpOwogIH0KfQoKdmFyIGFzc2VydF8xID0gYXNzZXJ0OwoKLyoKICogUG9seTJUcmkgQ29weXJpZ2h0IChjKSAyMDA5LTIwMTQsIFBvbHkyVHJpIENvbnRyaWJ1dG9ycwogKiBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvcG9seTJ0cmkvCiAqIAogKiBwb2x5MnRyaS5qcyAoSmF2YVNjcmlwdCBwb3J0KSAoYykgMjAwOS0yMDE0LCBQb2x5MlRyaSBDb250cmlidXRvcnMKICogaHR0cHM6Ly9naXRodWIuY29tL3IzbWkvcG9seTJ0cmkuanMKICogCiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqIAogKiBEaXN0cmlidXRlZCB1bmRlciB0aGUgMy1jbGF1c2UgQlNEIExpY2Vuc2UsIHNlZSBMSUNFTlNFLnR4dAogKi8KLyoKICogTm90ZQogKiA9PT09CiAqIHRoZSBzdHJ1Y3R1cmUgb2YgdGhpcyBKYXZhU2NyaXB0IHZlcnNpb24gb2YgcG9seTJ0cmkgaW50ZW50aW9uYWxseSBmb2xsb3dzCiAqIGFzIGNsb3NlbHkgYXMgcG9zc2libGUgdGhlIHN0cnVjdHVyZSBvZiB0aGUgcmVmZXJlbmNlIEMrKyB2ZXJzaW9uLCB0byBtYWtlIGl0IAogKiBlYXNpZXIgdG8ga2VlcCB0aGUgMiB2ZXJzaW9ucyBpbiBzeW5jLgogKi8KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLU5vZGUKCi8qKgogKiBBZHZhbmNpbmcgZnJvbnQgbm9kZQogKiBAY29uc3RydWN0b3IKICogQHByaXZhdGUKICogQHN0cnVjdAogKiBAcGFyYW0geyFYWX0gcCAtIFBvaW50CiAqIEBwYXJhbSB7VHJpYW5nbGU9fSB0IHRyaWFuZ2xlIChvcHRpb25hbCkKICovCgp2YXIgTm9kZSQyID0gZnVuY3Rpb24gTm9kZShwLCB0KSB7CiAgLyoqIEB0eXBlIHtYWX0gKi8KICB0aGlzLnBvaW50ID0gcDsKICAvKiogQHR5cGUge1RyaWFuZ2xlfG51bGx9ICovCgogIHRoaXMudHJpYW5nbGUgPSB0IHx8IG51bGw7CiAgLyoqIEB0eXBlIHtOb2RlfG51bGx9ICovCgogIHRoaXMubmV4dCA9IG51bGw7CiAgLyoqIEB0eXBlIHtOb2RlfG51bGx9ICovCgogIHRoaXMucHJldiA9IG51bGw7CiAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCgogIHRoaXMudmFsdWUgPSBwLng7Cn07IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUFkdmFuY2luZ0Zyb250CgovKioKICogQGNvbnN0cnVjdG9yCiAqIEBwcml2YXRlCiAqIEBzdHJ1Y3QKICogQHBhcmFtIHtOb2RlfSBoZWFkCiAqIEBwYXJhbSB7Tm9kZX0gdGFpbAogKi8KCgp2YXIgQWR2YW5jaW5nRnJvbnQgPSBmdW5jdGlvbiBBZHZhbmNpbmdGcm9udChoZWFkLCB0YWlsKSB7CiAgLyoqIEB0eXBlIHtOb2RlfSAqLwogIHRoaXMuaGVhZF8gPSBoZWFkOwogIC8qKiBAdHlwZSB7Tm9kZX0gKi8KCiAgdGhpcy50YWlsXyA9IHRhaWw7CiAgLyoqIEB0eXBlIHtOb2RlfSAqLwoKICB0aGlzLnNlYXJjaF9ub2RlXyA9IGhlYWQ7Cn07Ci8qKiBAcmV0dXJuIHtOb2RlfSAqLwoKCkFkdmFuY2luZ0Zyb250LnByb3RvdHlwZS5oZWFkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzLmhlYWRfOwp9OwovKiogQHBhcmFtIHtOb2RlfSBub2RlICovCgoKQWR2YW5jaW5nRnJvbnQucHJvdG90eXBlLnNldEhlYWQgPSBmdW5jdGlvbiAobm9kZSkgewogIHRoaXMuaGVhZF8gPSBub2RlOwp9OwovKiogQHJldHVybiB7Tm9kZX0gKi8KCgpBZHZhbmNpbmdGcm9udC5wcm90b3R5cGUudGFpbCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy50YWlsXzsKfTsKLyoqIEBwYXJhbSB7Tm9kZX0gbm9kZSAqLwoKCkFkdmFuY2luZ0Zyb250LnByb3RvdHlwZS5zZXRUYWlsID0gZnVuY3Rpb24gKG5vZGUpIHsKICB0aGlzLnRhaWxfID0gbm9kZTsKfTsKLyoqIEByZXR1cm4ge05vZGV9ICovCgoKQWR2YW5jaW5nRnJvbnQucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy5zZWFyY2hfbm9kZV87Cn07Ci8qKiBAcGFyYW0ge05vZGV9IG5vZGUgKi8KCgpBZHZhbmNpbmdGcm9udC5wcm90b3R5cGUuc2V0U2VhcmNoID0gZnVuY3Rpb24gKG5vZGUpIHsKICB0aGlzLnNlYXJjaF9ub2RlXyA9IG5vZGU7Cn07Ci8qKiBAcmV0dXJuIHtOb2RlfSAqLwoKCkFkdmFuY2luZ0Zyb250LnByb3RvdHlwZS5maW5kU2VhcmNoTm9kZSA9IGZ1bmN0aW9uCiAgLyp4Ki8KKCkgewogIC8vIFRPRE86IGltcGxlbWVudCBCU1QgaW5kZXgKICByZXR1cm4gdGhpcy5zZWFyY2hfbm9kZV87Cn07Ci8qKgogKiBAcGFyYW0ge251bWJlcn0geCB2YWx1ZQogKiBAcmV0dXJuIHtOb2RlfQogKi8KCgpBZHZhbmNpbmdGcm9udC5wcm90b3R5cGUubG9jYXRlTm9kZSA9IGZ1bmN0aW9uICh4KSB7CiAgdmFyIG5vZGUgPSB0aGlzLnNlYXJjaF9ub2RlXzsKICAvKiBqc2hpbnQgYm9zczp0cnVlICovCgogIGlmICh4IDwgbm9kZS52YWx1ZSkgewogICAgd2hpbGUgKG5vZGUgPSBub2RlLnByZXYpIHsKICAgICAgaWYgKHggPj0gbm9kZS52YWx1ZSkgewogICAgICAgIHRoaXMuc2VhcmNoX25vZGVfID0gbm9kZTsKICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfQogICAgfQogIH0gZWxzZSB7CiAgICB3aGlsZSAobm9kZSA9IG5vZGUubmV4dCkgewogICAgICBpZiAoeCA8IG5vZGUudmFsdWUpIHsKICAgICAgICB0aGlzLnNlYXJjaF9ub2RlXyA9IG5vZGUucHJldjsKICAgICAgICByZXR1cm4gbm9kZS5wcmV2OwogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4gbnVsbDsKfTsKLyoqCiAqIEBwYXJhbSB7IVhZfSBwb2ludCAtIFBvaW50CiAqIEByZXR1cm4ge05vZGV9CiAqLwoKCkFkdmFuY2luZ0Zyb250LnByb3RvdHlwZS5sb2NhdGVQb2ludCA9IGZ1bmN0aW9uIChwb2ludCkgewogIHZhciBweCA9IHBvaW50Lng7CiAgdmFyIG5vZGUgPSB0aGlzLmZpbmRTZWFyY2hOb2RlKHB4KTsKICB2YXIgbnggPSBub2RlLnBvaW50Lng7CgogIGlmIChweCA9PT0gbngpIHsKICAgIC8vIEhlcmUgd2UgYXJlIGNvbXBhcmluZyBwb2ludCByZWZlcmVuY2VzLCBub3QgdmFsdWVzCiAgICBpZiAocG9pbnQgIT09IG5vZGUucG9pbnQpIHsKICAgICAgLy8gV2UgbWlnaHQgaGF2ZSB0d28gbm9kZXMgd2l0aCBzYW1lIHggdmFsdWUgZm9yIGEgc2hvcnQgdGltZQogICAgICBpZiAocG9pbnQgPT09IG5vZGUucHJldi5wb2ludCkgewogICAgICAgIG5vZGUgPSBub2RlLnByZXY7CiAgICAgIH0gZWxzZSBpZiAocG9pbnQgPT09IG5vZGUubmV4dC5wb2ludCkgewogICAgICAgIG5vZGUgPSBub2RlLm5leHQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb2x5MnRyaSBJbnZhbGlkIEFkdmFuY2luZ0Zyb250LmxvY2F0ZVBvaW50KCkgY2FsbCcpOwogICAgICB9CiAgICB9CiAgfSBlbHNlIGlmIChweCA8IG54KSB7CiAgICAvKiBqc2hpbnQgYm9zczp0cnVlICovCiAgICB3aGlsZSAobm9kZSA9IG5vZGUucHJldikgewogICAgICBpZiAocG9pbnQgPT09IG5vZGUucG9pbnQpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0gZWxzZSB7CiAgICB3aGlsZSAobm9kZSA9IG5vZGUubmV4dCkgewogICAgICBpZiAocG9pbnQgPT09IG5vZGUucG9pbnQpIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KCiAgaWYgKG5vZGUpIHsKICAgIHRoaXMuc2VhcmNoX25vZGVfID0gbm9kZTsKICB9CgogIHJldHVybiBub2RlOwp9OyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRXhwb3J0cwoKCnZhciBhZHZhbmNpbmdmcm9udCA9IEFkdmFuY2luZ0Zyb250Owp2YXIgTm9kZV8xID0gTm9kZSQyOwphZHZhbmNpbmdmcm9udC5Ob2RlID0gTm9kZV8xOwoKLyoKICogUG9seTJUcmkgQ29weXJpZ2h0IChjKSAyMDA5LTIwMTQsIFBvbHkyVHJpIENvbnRyaWJ1dG9ycwogKiBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvcG9seTJ0cmkvCiAqIAogKiBwb2x5MnRyaS5qcyAoSmF2YVNjcmlwdCBwb3J0KSAoYykgMjAwOS0yMDE0LCBQb2x5MlRyaSBDb250cmlidXRvcnMKICogaHR0cHM6Ly9naXRodWIuY29tL3IzbWkvcG9seTJ0cmkuanMKICogCiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqIAogKiBEaXN0cmlidXRlZCB1bmRlciB0aGUgMy1jbGF1c2UgQlNEIExpY2Vuc2UsIHNlZSBMSUNFTlNFLnR4dAogKi8KLyoqCiAqIFByZWNpc2lvbiB0byBkZXRlY3QgcmVwZWF0ZWQgb3IgY29sbGluZWFyIHBvaW50cwogKiBAcHJpdmF0ZQogKiBAY29uc3Qge251bWJlcn0KICogQGRlZmF1bHQKICovCgp2YXIgRVBTSUxPTiQxID0gMWUtMTI7CnZhciBFUFNJTE9OXzEgPSBFUFNJTE9OJDE7Ci8qKgogKiBAcHJpdmF0ZQogKiBAZW51bSB7bnVtYmVyfQogKiBAcmVhZG9ubHkKICovCgp2YXIgT3JpZW50YXRpb24kMSA9IHsKICAiQ1ciOiAxLAogICJDQ1ciOiAtMSwKICAiQ09MTElORUFSIjogMAp9Owp2YXIgT3JpZW50YXRpb25fMSA9IE9yaWVudGF0aW9uJDE7Ci8qKgogKiBGb3JtdWxhIHRvIGNhbGN1bGF0ZSBzaWduZWQgYXJlYTxicj4KICogUG9zaXRpdmUgaWYgQ0NXPGJyPgogKiBOZWdhdGl2ZSBpZiBDVzxicj4KICogMCBpZiBjb2xsaW5lYXI8YnI+CiAqIDxwcmU+CiAqIEFbUDEsUDIsUDNdICA9ICAoeDEqeTIgLSB5MSp4MikgKyAoeDIqeTMgLSB5Mip4MykgKyAoeDMqeTEgLSB5Myp4MSkKICogICAgICAgICAgICAgID0gICh4MS14MykqKHkyLXkzKSAtICh5MS15MykqKHgyLXgzKQogKiA8L3ByZT4KICoKICogQHByaXZhdGUKICogQHBhcmFtIHshWFl9IHBhICBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcGFyYW0geyFYWX0gcGIgIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7IVhZfSBwYyAgcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICogQHJldHVybiB7T3JpZW50YXRpb259CiAqLwoKZnVuY3Rpb24gb3JpZW50MmQkMShwYSwgcGIsIHBjKSB7CiAgdmFyIGRldGxlZnQgPSAocGEueCAtIHBjLngpICogKHBiLnkgLSBwYy55KTsKICB2YXIgZGV0cmlnaHQgPSAocGEueSAtIHBjLnkpICogKHBiLnggLSBwYy54KTsKICB2YXIgdmFsID0gZGV0bGVmdCAtIGRldHJpZ2h0OwoKICBpZiAodmFsID4gLUVQU0lMT04kMSAmJiB2YWwgPCBFUFNJTE9OJDEpIHsKICAgIHJldHVybiBPcmllbnRhdGlvbiQxLkNPTExJTkVBUjsKICB9IGVsc2UgaWYgKHZhbCA+IDApIHsKICAgIHJldHVybiBPcmllbnRhdGlvbiQxLkNDVzsKICB9IGVsc2UgewogICAgcmV0dXJuIE9yaWVudGF0aW9uJDEuQ1c7CiAgfQp9Cgp2YXIgb3JpZW50MmRfMSA9IG9yaWVudDJkJDE7Ci8qKgogKgogKiBAcHJpdmF0ZQogKiBAcGFyYW0geyFYWX0gcGEgIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7IVhZfSBwYiAgcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICogQHBhcmFtIHshWFl9IHBjICBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcGFyYW0geyFYWX0gcGQgIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEByZXR1cm4ge2Jvb2xlYW59CiAqLwoKZnVuY3Rpb24gaW5TY2FuQXJlYSQxKHBhLCBwYiwgcGMsIHBkKSB7CiAgdmFyIG9hZGIgPSAocGEueCAtIHBiLngpICogKHBkLnkgLSBwYi55KSAtIChwZC54IC0gcGIueCkgKiAocGEueSAtIHBiLnkpOwoKICBpZiAob2FkYiA+PSAtRVBTSUxPTiQxKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB2YXIgb2FkYyA9IChwYS54IC0gcGMueCkgKiAocGQueSAtIHBjLnkpIC0gKHBkLnggLSBwYy54KSAqIChwYS55IC0gcGMueSk7CgogIGlmIChvYWRjIDw9IEVQU0lMT04kMSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgcmV0dXJuIHRydWU7Cn0KCnZhciBpblNjYW5BcmVhXzEgPSBpblNjYW5BcmVhJDE7Ci8qKgogKiBDaGVjayBpZiB0aGUgYW5nbGUgYmV0d2VlbiAocGEscGIpIGFuZCAocGEscGMpIGlzIG9idHVzZSBpLmUuIChhbmdsZSA+IM+ALzIgfHwgYW5nbGUgPCAtz4AvMikKICoKICogQHByaXZhdGUKICogQHBhcmFtIHshWFl9IHBhICBwb2ludCBvYmplY3Qgd2l0aCB7eCx5fQogKiBAcGFyYW0geyFYWX0gcGIgIHBvaW50IG9iamVjdCB3aXRoIHt4LHl9CiAqIEBwYXJhbSB7IVhZfSBwYyAgcG9pbnQgb2JqZWN0IHdpdGgge3gseX0KICogQHJldHVybiB7Ym9vbGVhbn0gdHJ1ZSBpZiBhbmdsZSBpcyBvYnR1c2UKICovCgpmdW5jdGlvbiBpc0FuZ2xlT2J0dXNlJDEocGEsIHBiLCBwYykgewogIHZhciBheCA9IHBiLnggLSBwYS54OwogIHZhciBheSA9IHBiLnkgLSBwYS55OwogIHZhciBieCA9IHBjLnggLSBwYS54OwogIHZhciBieSA9IHBjLnkgLSBwYS55OwogIHJldHVybiBheCAqIGJ4ICsgYXkgKiBieSA8IDA7Cn0KCnZhciBpc0FuZ2xlT2J0dXNlXzEgPSBpc0FuZ2xlT2J0dXNlJDE7CnZhciB1dGlscyA9IHsKICBFUFNJTE9OOiBFUFNJTE9OXzEsCiAgT3JpZW50YXRpb246IE9yaWVudGF0aW9uXzEsCiAgb3JpZW50MmQ6IG9yaWVudDJkXzEsCiAgaW5TY2FuQXJlYTogaW5TY2FuQXJlYV8xLAogIGlzQW5nbGVPYnR1c2U6IGlzQW5nbGVPYnR1c2VfMQp9OwoKLyoqCiAqIFRoaXMgJ1N3ZWVwJyBtb2R1bGUgaXMgcHJlc2VudCBpbiBvcmRlciB0byBrZWVwIHRoaXMgSmF2YVNjcmlwdCB2ZXJzaW9uCiAqIGFzIGNsb3NlIGFzIHBvc3NpYmxlIHRvIHRoZSByZWZlcmVuY2UgQysrIHZlcnNpb24sIGV2ZW4gdGhvdWdoIGFsbW9zdCBhbGwKICogZnVuY3Rpb25zIGNvdWxkIGJlIGRlY2xhcmVkIGFzIG1ldGhvZHMgb24gdGhlIHtAbGlua2NvZGUgbW9kdWxlOnN3ZWVwY29udGV4dH5Td2VlcENvbnRleHR9IG9iamVjdC4KICogQG1vZHVsZQogKiBAcHJpdmF0ZQogKi8KCi8qCiAqIE5vdGUKICogPT09PQogKiB0aGUgc3RydWN0dXJlIG9mIHRoaXMgSmF2YVNjcmlwdCB2ZXJzaW9uIG9mIHBvbHkydHJpIGludGVudGlvbmFsbHkgZm9sbG93cwogKiBhcyBjbG9zZWx5IGFzIHBvc3NpYmxlIHRoZSBzdHJ1Y3R1cmUgb2YgdGhlIHJlZmVyZW5jZSBDKysgdmVyc2lvbiwgdG8gbWFrZSBpdCAKICogZWFzaWVyIHRvIGtlZXAgdGhlIDIgdmVyc2lvbnMgaW4gc3luYy4KICovCgoKdmFyIE5vZGUkMSA9IGFkdmFuY2luZ2Zyb250Lk5vZGU7IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXV0aWxzCgovKiogQGNvbnN0ICovCgp2YXIgRVBTSUxPTiA9IHV0aWxzLkVQU0lMT047Ci8qKiBAY29uc3QgKi8KCnZhciBPcmllbnRhdGlvbiA9IHV0aWxzLk9yaWVudGF0aW9uOwovKiogQGNvbnN0ICovCgp2YXIgb3JpZW50MmQgPSB1dGlscy5vcmllbnQyZDsKLyoqIEBjb25zdCAqLwoKdmFyIGluU2NhbkFyZWEgPSB1dGlscy5pblNjYW5BcmVhOwovKiogQGNvbnN0ICovCgp2YXIgaXNBbmdsZU9idHVzZSA9IHV0aWxzLmlzQW5nbGVPYnR1c2U7IC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVN3ZWVwCgovKioKICogVHJpYW5ndWxhdGUgdGhlIHBvbHlnb24gd2l0aCBob2xlcyBhbmQgU3RlaW5lciBwb2ludHMuCiAqIERvIHRoaXMgQUZURVIgeW91J3ZlIGFkZGVkIHRoZSBwb2x5bGluZSwgaG9sZXMsIGFuZCBTdGVpbmVyIHBvaW50cwogKiBAcHJpdmF0ZQogKiBAcGFyYW0geyFTd2VlcENvbnRleHR9IHRjeCAtIFN3ZWVwQ29udGV4dCBvYmplY3QKICovCgpmdW5jdGlvbiB0cmlhbmd1bGF0ZSh0Y3gpIHsKICB0Y3guaW5pdFRyaWFuZ3VsYXRpb24oKTsKICB0Y3guY3JlYXRlQWR2YW5jaW5nRnJvbnQoKTsgLy8gU3dlZXAgcG9pbnRzOyBidWlsZCBtZXNoCgogIHN3ZWVwUG9pbnRzKHRjeCk7IC8vIENsZWFuIHVwCgogIGZpbmFsaXphdGlvblBvbHlnb24odGN4KTsKfQovKioKICogU3RhcnQgc3dlZXBpbmcgdGhlIFktc29ydGVkIHBvaW50IHNldCBmcm9tIGJvdHRvbSB0byB0b3AKICogQHBhcmFtIHshU3dlZXBDb250ZXh0fSB0Y3ggLSBTd2VlcENvbnRleHQgb2JqZWN0CiAqLwoKCmZ1bmN0aW9uIHN3ZWVwUG9pbnRzKHRjeCkgewogIHZhciBpLAogICAgICBsZW4gPSB0Y3gucG9pbnRDb3VudCgpOwoKICBmb3IgKGkgPSAxOyBpIDwgbGVuOyArK2kpIHsKICAgIHZhciBwb2ludCA9IHRjeC5nZXRQb2ludChpKTsKICAgIHZhciBub2RlID0gcG9pbnRFdmVudCh0Y3gsIHBvaW50KTsKICAgIHZhciBlZGdlcyA9IHBvaW50Ll9wMnRfZWRnZV9saXN0OwoKICAgIGZvciAodmFyIGogPSAwOyBlZGdlcyAmJiBqIDwgZWRnZXMubGVuZ3RoOyArK2opIHsKICAgICAgZWRnZUV2ZW50QnlFZGdlKHRjeCwgZWRnZXNbal0sIG5vZGUpOwogICAgfQogIH0KfQovKioKICogQHBhcmFtIHshU3dlZXBDb250ZXh0fSB0Y3ggLSBTd2VlcENvbnRleHQgb2JqZWN0CiAqLwoKCmZ1bmN0aW9uIGZpbmFsaXphdGlvblBvbHlnb24odGN4KSB7CiAgLy8gR2V0IGFuIEludGVybmFsIHRyaWFuZ2xlIHRvIHN0YXJ0IHdpdGgKICB2YXIgdCA9IHRjeC5mcm9udCgpLmhlYWQoKS5uZXh0LnRyaWFuZ2xlOwogIHZhciBwID0gdGN4LmZyb250KCkuaGVhZCgpLm5leHQucG9pbnQ7CgogIHdoaWxlICghdC5nZXRDb25zdHJhaW5lZEVkZ2VDVyhwKSkgewogICAgdCA9IHQubmVpZ2hib3JDQ1cocCk7CiAgfSAvLyBDb2xsZWN0IGludGVyaW9yIHRyaWFuZ2xlcyBjb25zdHJhaW5lZCBieSBlZGdlcwoKCiAgdGN4Lm1lc2hDbGVhbih0KTsKfQovKioKICogRmluZCBjbG9zZXMgbm9kZSB0byB0aGUgbGVmdCBvZiB0aGUgbmV3IHBvaW50IGFuZAogKiBjcmVhdGUgYSBuZXcgdHJpYW5nbGUuIElmIG5lZWRlZCBuZXcgaG9sZXMgYW5kIGJhc2lucwogKiB3aWxsIGJlIGZpbGxlZCB0by4KICogQHBhcmFtIHshU3dlZXBDb250ZXh0fSB0Y3ggLSBTd2VlcENvbnRleHQgb2JqZWN0CiAqIEBwYXJhbSB7IVhZfSBwb2ludCAgIFBvaW50CiAqLwoKCmZ1bmN0aW9uIHBvaW50RXZlbnQodGN4LCBwb2ludCkgewogIHZhciBub2RlID0gdGN4LmxvY2F0ZU5vZGUocG9pbnQpOwogIHZhciBuZXdfbm9kZSA9IG5ld0Zyb250VHJpYW5nbGUodGN4LCBwb2ludCwgbm9kZSk7IC8vIE9ubHkgbmVlZCB0byBjaGVjayArZXBzaWxvbiBzaW5jZSBwb2ludCBuZXZlciBoYXZlIHNtYWxsZXIKICAvLyB4IHZhbHVlIHRoYW4gbm9kZSBkdWUgdG8gaG93IHdlIGZldGNoIG5vZGVzIGZyb20gdGhlIGZyb250CgogIGlmIChwb2ludC54IDw9IG5vZGUucG9pbnQueCArIEVQU0lMT04pIHsKICAgIGZpbGwodGN4LCBub2RlKTsKICB9IC8vdGN4LkFkZE5vZGUobmV3X25vZGUpOwoKCiAgZmlsbEFkdmFuY2luZ0Zyb250KHRjeCwgbmV3X25vZGUpOwogIHJldHVybiBuZXdfbm9kZTsKfQoKZnVuY3Rpb24gZWRnZUV2ZW50QnlFZGdlKHRjeCwgZWRnZSwgbm9kZSkgewogIHRjeC5lZGdlX2V2ZW50LmNvbnN0cmFpbmVkX2VkZ2UgPSBlZGdlOwogIHRjeC5lZGdlX2V2ZW50LnJpZ2h0ID0gZWRnZS5wLnggPiBlZGdlLnEueDsKCiAgaWYgKGlzRWRnZVNpZGVPZlRyaWFuZ2xlKG5vZGUudHJpYW5nbGUsIGVkZ2UucCwgZWRnZS5xKSkgewogICAgcmV0dXJuOwogIH0gLy8gRm9yIG5vdyB3ZSB3aWxsIGRvIGFsbCBuZWVkZWQgZmlsbGluZwogIC8vIFRPRE86IGludGVncmF0ZSB3aXRoIGZsaXAgcHJvY2VzcyBtaWdodCBnaXZlIHNvbWUgYmV0dGVyIHBlcmZvcm1hbmNlCiAgLy8gICAgICAgYnV0IGZvciBub3cgdGhpcyBhdm9pZCB0aGUgaXNzdWUgd2l0aCBjYXNlcyB0aGF0IG5lZWRzIGJvdGggZmxpcHMgYW5kIGZpbGxzCgoKICBmaWxsRWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSk7CiAgZWRnZUV2ZW50QnlQb2ludHModGN4LCBlZGdlLnAsIGVkZ2UucSwgbm9kZS50cmlhbmdsZSwgZWRnZS5xKTsKfQoKZnVuY3Rpb24gZWRnZUV2ZW50QnlQb2ludHModGN4LCBlcCwgZXEsIHRyaWFuZ2xlLCBwb2ludCkgewogIGlmIChpc0VkZ2VTaWRlT2ZUcmlhbmdsZSh0cmlhbmdsZSwgZXAsIGVxKSkgewogICAgcmV0dXJuOwogIH0KCiAgdmFyIHAxID0gdHJpYW5nbGUucG9pbnRDQ1cocG9pbnQpOwogIHZhciBvMSA9IG9yaWVudDJkKGVxLCBwMSwgZXApOwoKICBpZiAobzEgPT09IE9yaWVudGF0aW9uLkNPTExJTkVBUikgewogICAgLy8gVE9ETyBpbnRlZ3JhdGUgaGVyZSBjaGFuZ2VzIGZyb20gQysrIHZlcnNpb24KICAgIC8vIChDKysgcmVwbyByZXZpc2lvbiAwOTg4MGE4NjkwOTUgZGF0ZWQgTWFyY2ggOCwgMjAxMSkKICAgIHRocm93IG5ldyBwb2ludGVycm9yKCdwb2x5MnRyaSBFZGdlRXZlbnQ6IENvbGxpbmVhciBub3Qgc3VwcG9ydGVkIScsIFtlcSwgcDEsIGVwXSk7CiAgfQoKICB2YXIgcDIgPSB0cmlhbmdsZS5wb2ludENXKHBvaW50KTsKICB2YXIgbzIgPSBvcmllbnQyZChlcSwgcDIsIGVwKTsKCiAgaWYgKG8yID09PSBPcmllbnRhdGlvbi5DT0xMSU5FQVIpIHsKICAgIC8vIFRPRE8gaW50ZWdyYXRlIGhlcmUgY2hhbmdlcyBmcm9tIEMrKyB2ZXJzaW9uCiAgICAvLyAoQysrIHJlcG8gcmV2aXNpb24gMDk4ODBhODY5MDk1IGRhdGVkIE1hcmNoIDgsIDIwMTEpCiAgICB0aHJvdyBuZXcgcG9pbnRlcnJvcigncG9seTJ0cmkgRWRnZUV2ZW50OiBDb2xsaW5lYXIgbm90IHN1cHBvcnRlZCEnLCBbZXEsIHAyLCBlcF0pOwogIH0KCiAgaWYgKG8xID09PSBvMikgewogICAgLy8gTmVlZCB0byBkZWNpZGUgaWYgd2UgYXJlIHJvdGF0aW5nIENXIG9yIENDVyB0byBnZXQgdG8gYSB0cmlhbmdsZQogICAgLy8gdGhhdCB3aWxsIGNyb3NzIGVkZ2UKICAgIGlmIChvMSA9PT0gT3JpZW50YXRpb24uQ1cpIHsKICAgICAgdHJpYW5nbGUgPSB0cmlhbmdsZS5uZWlnaGJvckNDVyhwb2ludCk7CiAgICB9IGVsc2UgewogICAgICB0cmlhbmdsZSA9IHRyaWFuZ2xlLm5laWdoYm9yQ1cocG9pbnQpOwogICAgfQoKICAgIGVkZ2VFdmVudEJ5UG9pbnRzKHRjeCwgZXAsIGVxLCB0cmlhbmdsZSwgcG9pbnQpOwogIH0gZWxzZSB7CiAgICAvLyBUaGlzIHRyaWFuZ2xlIGNyb3NzZXMgY29uc3RyYWludCBzbyBsZXRzIGZsaXBwaW4gc3RhcnQhCiAgICBmbGlwRWRnZUV2ZW50KHRjeCwgZXAsIGVxLCB0cmlhbmdsZSwgcG9pbnQpOwogIH0KfQoKZnVuY3Rpb24gaXNFZGdlU2lkZU9mVHJpYW5nbGUodHJpYW5nbGUsIGVwLCBlcSkgewogIHZhciBpbmRleCA9IHRyaWFuZ2xlLmVkZ2VJbmRleChlcCwgZXEpOwoKICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICB0cmlhbmdsZS5tYXJrQ29uc3RyYWluZWRFZGdlQnlJbmRleChpbmRleCk7CiAgICB2YXIgdCA9IHRyaWFuZ2xlLmdldE5laWdoYm9yKGluZGV4KTsKCiAgICBpZiAodCkgewogICAgICB0Lm1hcmtDb25zdHJhaW5lZEVkZ2VCeVBvaW50cyhlcCwgZXEpOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgcmV0dXJuIGZhbHNlOwp9Ci8qKgogKiBDcmVhdGVzIGEgbmV3IGZyb250IHRyaWFuZ2xlIGFuZCBsZWdhbGl6ZSBpdAogKiBAcGFyYW0geyFTd2VlcENvbnRleHR9IHRjeCAtIFN3ZWVwQ29udGV4dCBvYmplY3QKICovCgoKZnVuY3Rpb24gbmV3RnJvbnRUcmlhbmdsZSh0Y3gsIHBvaW50LCBub2RlKSB7CiAgdmFyIHRyaWFuZ2xlJDEgPSBuZXcgdHJpYW5nbGUocG9pbnQsIG5vZGUucG9pbnQsIG5vZGUubmV4dC5wb2ludCk7CiAgdHJpYW5nbGUkMS5tYXJrTmVpZ2hib3Iobm9kZS50cmlhbmdsZSk7CiAgdGN4LmFkZFRvTWFwKHRyaWFuZ2xlJDEpOwogIHZhciBuZXdfbm9kZSA9IG5ldyBOb2RlJDEocG9pbnQpOwogIG5ld19ub2RlLm5leHQgPSBub2RlLm5leHQ7CiAgbmV3X25vZGUucHJldiA9IG5vZGU7CiAgbm9kZS5uZXh0LnByZXYgPSBuZXdfbm9kZTsKICBub2RlLm5leHQgPSBuZXdfbm9kZTsKCiAgaWYgKCFsZWdhbGl6ZSh0Y3gsIHRyaWFuZ2xlJDEpKSB7CiAgICB0Y3gubWFwVHJpYW5nbGVUb05vZGVzKHRyaWFuZ2xlJDEpOwogIH0KCiAgcmV0dXJuIG5ld19ub2RlOwp9Ci8qKgogKiBBZGRzIGEgdHJpYW5nbGUgdG8gdGhlIGFkdmFuY2luZyBmcm9udCB0byBmaWxsIGEgaG9sZS4KICogQHBhcmFtIHshU3dlZXBDb250ZXh0fSB0Y3ggLSBTd2VlcENvbnRleHQgb2JqZWN0CiAqIEBwYXJhbSBub2RlIC0gbWlkZGxlIG5vZGUsIHRoYXQgaXMgdGhlIGJvdHRvbSBvZiB0aGUgaG9sZQogKi8KCgpmdW5jdGlvbiBmaWxsKHRjeCwgbm9kZSkgewogIHZhciB0cmlhbmdsZSQxID0gbmV3IHRyaWFuZ2xlKG5vZGUucHJldi5wb2ludCwgbm9kZS5wb2ludCwgbm9kZS5uZXh0LnBvaW50KTsgLy8gVE9ETzogc2hvdWxkIGNvcHkgdGhlIGNvbnN0cmFpbmVkX2VkZ2UgdmFsdWUgZnJvbSBuZWlnaGJvciB0cmlhbmdsZXMKICAvLyAgICAgICBmb3Igbm93IGNvbnN0cmFpbmVkX2VkZ2UgdmFsdWVzIGFyZSBjb3BpZWQgZHVyaW5nIHRoZSBsZWdhbGl6ZQoKICB0cmlhbmdsZSQxLm1hcmtOZWlnaGJvcihub2RlLnByZXYudHJpYW5nbGUpOwogIHRyaWFuZ2xlJDEubWFya05laWdoYm9yKG5vZGUudHJpYW5nbGUpOwogIHRjeC5hZGRUb01hcCh0cmlhbmdsZSQxKTsgLy8gVXBkYXRlIHRoZSBhZHZhbmNpbmcgZnJvbnQKCiAgbm9kZS5wcmV2Lm5leHQgPSBub2RlLm5leHQ7CiAgbm9kZS5uZXh0LnByZXYgPSBub2RlLnByZXY7IC8vIElmIGl0IHdhcyBsZWdhbGl6ZWQgdGhlIHRyaWFuZ2xlIGhhcyBhbHJlYWR5IGJlZW4gbWFwcGVkCgogIGlmICghbGVnYWxpemUodGN4LCB0cmlhbmdsZSQxKSkgewogICAgdGN4Lm1hcFRyaWFuZ2xlVG9Ob2Rlcyh0cmlhbmdsZSQxKTsKICB9IC8vdGN4LnJlbW92ZU5vZGUobm9kZSk7Cgp9Ci8qKgogKiBGaWxscyBob2xlcyBpbiB0aGUgQWR2YW5jaW5nIEZyb250CiAqIEBwYXJhbSB7IVN3ZWVwQ29udGV4dH0gdGN4IC0gU3dlZXBDb250ZXh0IG9iamVjdAogKi8KCgpmdW5jdGlvbiBmaWxsQWR2YW5jaW5nRnJvbnQodGN4LCBuKSB7CiAgLy8gRmlsbCByaWdodCBob2xlcwogIHZhciBub2RlID0gbi5uZXh0OwoKICB3aGlsZSAobm9kZS5uZXh0KSB7CiAgICAvLyBUT0RPIGludGVncmF0ZSBoZXJlIGNoYW5nZXMgZnJvbSBDKysgdmVyc2lvbgogICAgLy8gKEMrKyByZXBvIHJldmlzaW9uIGFjZjgxZjFmMTc2NCBkYXRlZCBBcHJpbCA3LCAyMDEyKQogICAgaWYgKGlzQW5nbGVPYnR1c2Uobm9kZS5wb2ludCwgbm9kZS5uZXh0LnBvaW50LCBub2RlLnByZXYucG9pbnQpKSB7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGZpbGwodGN4LCBub2RlKTsKICAgIG5vZGUgPSBub2RlLm5leHQ7CiAgfSAvLyBGaWxsIGxlZnQgaG9sZXMKCgogIG5vZGUgPSBuLnByZXY7CgogIHdoaWxlIChub2RlLnByZXYpIHsKICAgIC8vIFRPRE8gaW50ZWdyYXRlIGhlcmUgY2hhbmdlcyBmcm9tIEMrKyB2ZXJzaW9uCiAgICAvLyAoQysrIHJlcG8gcmV2aXNpb24gYWNmODFmMWYxNzY0IGRhdGVkIEFwcmlsIDcsIDIwMTIpCiAgICBpZiAoaXNBbmdsZU9idHVzZShub2RlLnBvaW50LCBub2RlLm5leHQucG9pbnQsIG5vZGUucHJldi5wb2ludCkpIHsKICAgICAgYnJlYWs7CiAgICB9CgogICAgZmlsbCh0Y3gsIG5vZGUpOwogICAgbm9kZSA9IG5vZGUucHJldjsKICB9IC8vIEZpbGwgcmlnaHQgYmFzaW5zCgoKICBpZiAobi5uZXh0ICYmIG4ubmV4dC5uZXh0KSB7CiAgICBpZiAoaXNCYXNpbkFuZ2xlUmlnaHQobikpIHsKICAgICAgZmlsbEJhc2luKHRjeCwgbik7CiAgICB9CiAgfQp9Ci8qKgogKiBUaGUgYmFzaW4gYW5nbGUgaXMgZGVjaWRlZCBhZ2FpbnN0IHRoZSBob3Jpem9udGFsIGxpbmUgWzEsMF0uCiAqIEBwYXJhbSB7Tm9kZX0gbm9kZQogKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIGFuZ2xlIDwgMyrPgC80CiAqLwoKCmZ1bmN0aW9uIGlzQmFzaW5BbmdsZVJpZ2h0KG5vZGUpIHsKICB2YXIgYXggPSBub2RlLnBvaW50LnggLSBub2RlLm5leHQubmV4dC5wb2ludC54OwogIHZhciBheSA9IG5vZGUucG9pbnQueSAtIG5vZGUubmV4dC5uZXh0LnBvaW50Lnk7CiAgYXNzZXJ0XzEoYXkgPj0gMCwgInVub3JkZXJlZCB5Iik7CiAgcmV0dXJuIGF4ID49IDAgfHwgTWF0aC5hYnMoYXgpIDwgYXk7Cn0KLyoqCiAqIFJldHVybnMgdHJ1ZSBpZiB0cmlhbmdsZSB3YXMgbGVnYWxpemVkCiAqIEBwYXJhbSB7IVN3ZWVwQ29udGV4dH0gdGN4IC0gU3dlZXBDb250ZXh0IG9iamVjdAogKiBAcmV0dXJuIHtib29sZWFufQogKi8KCgpmdW5jdGlvbiBsZWdhbGl6ZSh0Y3gsIHQpIHsKICAvLyBUbyBsZWdhbGl6ZSBhIHRyaWFuZ2xlIHdlIHN0YXJ0IGJ5IGZpbmRpbmcgaWYgYW55IG9mIHRoZSB0aHJlZSBlZGdlcwogIC8vIHZpb2xhdGUgdGhlIERlbGF1bmF5IGNvbmRpdGlvbgogIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgKytpKSB7CiAgICBpZiAodC5kZWxhdW5heV9lZGdlW2ldKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIHZhciBvdCA9IHQuZ2V0TmVpZ2hib3IoaSk7CgogICAgaWYgKG90KSB7CiAgICAgIHZhciBwID0gdC5nZXRQb2ludChpKTsKICAgICAgdmFyIG9wID0gb3Qub3Bwb3NpdGVQb2ludCh0LCBwKTsKICAgICAgdmFyIG9pID0gb3QuaW5kZXgob3ApOyAvLyBJZiB0aGlzIGlzIGEgQ29uc3RyYWluZWQgRWRnZSBvciBhIERlbGF1bmF5IEVkZ2Uob25seSBkdXJpbmcgcmVjdXJzaXZlIGxlZ2FsaXphdGlvbikKICAgICAgLy8gdGhlbiB3ZSBzaG91bGQgbm90IHRyeSB0byBsZWdhbGl6ZQoKICAgICAgaWYgKG90LmNvbnN0cmFpbmVkX2VkZ2Vbb2ldIHx8IG90LmRlbGF1bmF5X2VkZ2Vbb2ldKSB7CiAgICAgICAgdC5jb25zdHJhaW5lZF9lZGdlW2ldID0gb3QuY29uc3RyYWluZWRfZWRnZVtvaV07CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHZhciBpbnNpZGUgPSBpbkNpcmNsZShwLCB0LnBvaW50Q0NXKHApLCB0LnBvaW50Q1cocCksIG9wKTsKCiAgICAgIGlmIChpbnNpZGUpIHsKICAgICAgICAvLyBMZXRzIG1hcmsgdGhpcyBzaGFyZWQgZWRnZSBhcyBEZWxhdW5heQogICAgICAgIHQuZGVsYXVuYXlfZWRnZVtpXSA9IHRydWU7CiAgICAgICAgb3QuZGVsYXVuYXlfZWRnZVtvaV0gPSB0cnVlOyAvLyBMZXRzIHJvdGF0ZSBzaGFyZWQgZWRnZSBvbmUgdmVydGV4IENXIHRvIGxlZ2FsaXplIGl0CgogICAgICAgIHJvdGF0ZVRyaWFuZ2xlUGFpcih0LCBwLCBvdCwgb3ApOyAvLyBXZSBub3cgZ290IG9uZSB2YWxpZCBEZWxhdW5heSBFZGdlIHNoYXJlZCBieSB0d28gdHJpYW5nbGVzCiAgICAgICAgLy8gVGhpcyBnaXZlcyB1cyA0IG5ldyBlZGdlcyB0byBjaGVjayBmb3IgRGVsYXVuYXkKICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0cmlhbmdsZSB0byBub2RlIG1hcHBpbmcgaXMgZG9uZSBvbmx5IG9uZSB0aW1lIGZvciBhIHNwZWNpZmljIHRyaWFuZ2xlCgogICAgICAgIHZhciBub3RfbGVnYWxpemVkID0gIWxlZ2FsaXplKHRjeCwgdCk7CgogICAgICAgIGlmIChub3RfbGVnYWxpemVkKSB7CiAgICAgICAgICB0Y3gubWFwVHJpYW5nbGVUb05vZGVzKHQpOwogICAgICAgIH0KCiAgICAgICAgbm90X2xlZ2FsaXplZCA9ICFsZWdhbGl6ZSh0Y3gsIG90KTsKCiAgICAgICAgaWYgKG5vdF9sZWdhbGl6ZWQpIHsKICAgICAgICAgIHRjeC5tYXBUcmlhbmdsZVRvTm9kZXMob3QpOwogICAgICAgIH0gLy8gUmVzZXQgdGhlIERlbGF1bmF5IGVkZ2VzLCBzaW5jZSB0aGV5IG9ubHkgYXJlIHZhbGlkIERlbGF1bmF5IGVkZ2VzCiAgICAgICAgLy8gdW50aWwgd2UgYWRkIGEgbmV3IHRyaWFuZ2xlIG9yIHBvaW50LgogICAgICAgIC8vIFhYWDogbmVlZCB0byB0aGluayBhYm91dCB0aGlzLiBDYW4gdGhlc2UgZWRnZXMgYmUgdHJpZWQgYWZ0ZXIgd2UKICAgICAgICAvLyAgICAgIHJldHVybiB0byBwcmV2aW91cyByZWN1cnNpdmUgbGV2ZWw/CgoKICAgICAgICB0LmRlbGF1bmF5X2VkZ2VbaV0gPSBmYWxzZTsKICAgICAgICBvdC5kZWxhdW5heV9lZGdlW29pXSA9IGZhbHNlOyAvLyBJZiB0cmlhbmdsZSBoYXZlIGJlZW4gbGVnYWxpemVkIG5vIG5lZWQgdG8gY2hlY2sgdGhlIG90aGVyIGVkZ2VzIHNpbmNlCiAgICAgICAgLy8gdGhlIHJlY3Vyc2l2ZSBsZWdhbGl6YXRpb24gd2lsbCBoYW5kbGVzIHRob3NlIHNvIHdlIGNhbiBlbmQgaGVyZS4KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiBmYWxzZTsKfQovKioKICogPGI+UmVxdWlyZW1lbnQ8L2I+Ojxicj4KICogMS4gYSxiIGFuZCBjIGZvcm0gYSB0cmlhbmdsZS48YnI+CiAqIDIuIGEgYW5kIGQgaXMga25vdyB0byBiZSBvbiBvcHBvc2l0ZSBzaWRlIG9mIGJjPGJyPgogKiA8cHJlPgogKiAgICAgICAgICAgICAgICBhCiAqICAgICAgICAgICAgICAgICsKICogICAgICAgICAgICAgICAvIFwKICogICAgICAgICAgICAgIC8gICBcCiAqICAgICAgICAgICAgYi8gICAgIFxjCiAqICAgICAgICAgICAgKy0tLS0tLS0rCiAqICAgICAgICAgICAvICAgIGQgICAgXAogKiAgICAgICAgICAvICAgICAgICAgICBcCiAqIDwvcHJlPgogKiA8Yj5GYWN0PC9iPjogZCBoYXMgdG8gYmUgaW4gYXJlYSBCIHRvIGhhdmUgYSBjaGFuY2UgdG8gYmUgaW5zaWRlIHRoZSBjaXJjbGUgZm9ybWVkIGJ5CiAqICBhLGIgYW5kIGM8YnI+CiAqICBkIGlzIG91dHNpZGUgQiBpZiBvcmllbnQyZChhLGIsZCkgb3Igb3JpZW50MmQoYyxhLGQpIGlzIENXPGJyPgogKiAgVGhpcyBwcmVrbm93bGVkZ2UgZ2l2ZXMgdXMgYSB3YXkgdG8gb3B0aW1pemUgdGhlIGluY2lyY2xlIHRlc3QKICogQHBhcmFtIHBhIC0gdHJpYW5nbGUgcG9pbnQsIG9wcG9zaXRlIGQKICogQHBhcmFtIHBiIC0gdHJpYW5nbGUgcG9pbnQKICogQHBhcmFtIHBjIC0gdHJpYW5nbGUgcG9pbnQKICogQHBhcmFtIHBkIC0gcG9pbnQgb3Bwb3NpdGUgYQogKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIGQgaXMgaW5zaWRlIGNpcmNsZSwgZmFsc2UgaWYgb24gY2lyY2xlIGVkZ2UKICovCgoKZnVuY3Rpb24gaW5DaXJjbGUocGEsIHBiLCBwYywgcGQpIHsKICB2YXIgYWR4ID0gcGEueCAtIHBkLng7CiAgdmFyIGFkeSA9IHBhLnkgLSBwZC55OwogIHZhciBiZHggPSBwYi54IC0gcGQueDsKICB2YXIgYmR5ID0gcGIueSAtIHBkLnk7CiAgdmFyIGFkeGJkeSA9IGFkeCAqIGJkeTsKICB2YXIgYmR4YWR5ID0gYmR4ICogYWR5OwogIHZhciBvYWJkID0gYWR4YmR5IC0gYmR4YWR5OwoKICBpZiAob2FiZCA8PSAwKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB2YXIgY2R4ID0gcGMueCAtIHBkLng7CiAgdmFyIGNkeSA9IHBjLnkgLSBwZC55OwogIHZhciBjZHhhZHkgPSBjZHggKiBhZHk7CiAgdmFyIGFkeGNkeSA9IGFkeCAqIGNkeTsKICB2YXIgb2NhZCA9IGNkeGFkeSAtIGFkeGNkeTsKCiAgaWYgKG9jYWQgPD0gMCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgdmFyIGJkeGNkeSA9IGJkeCAqIGNkeTsKICB2YXIgY2R4YmR5ID0gY2R4ICogYmR5OwogIHZhciBhbGlmdCA9IGFkeCAqIGFkeCArIGFkeSAqIGFkeTsKICB2YXIgYmxpZnQgPSBiZHggKiBiZHggKyBiZHkgKiBiZHk7CiAgdmFyIGNsaWZ0ID0gY2R4ICogY2R4ICsgY2R5ICogY2R5OwogIHZhciBkZXQgPSBhbGlmdCAqIChiZHhjZHkgLSBjZHhiZHkpICsgYmxpZnQgKiBvY2FkICsgY2xpZnQgKiBvYWJkOwogIHJldHVybiBkZXQgPiAwOwp9Ci8qKgogKiBSb3RhdGVzIGEgdHJpYW5nbGUgcGFpciBvbmUgdmVydGV4IENXCiAqPHByZT4KICogICAgICAgbjIgICAgICAgICAgICAgICAgICAgIG4yCiAqICBQICstLS0tLSsgICAgICAgICAgICAgUCArLS0tLS0rCiAqICAgIHwgdCAgL3wgICAgICAgICAgICAgICB8XCAgdCB8CiAqICAgIHwgICAvIHwgICAgICAgICAgICAgICB8IFwgICB8CiAqICBuMXwgIC8gIHxuMyAgICAgICAgICAgbjF8ICBcICB8bjMKICogICAgfCAvICAgfCAgICBhZnRlciBDVyAgIHwgICBcIHwKICogICAgfC8gb1QgfCAgICAgICAgICAgICAgIHwgb1QgXHwKICogICAgKy0tLS0tKyBvUCAgICAgICAgICAgICstLS0tLSsKICogICAgICAgbjQgICAgICAgICAgICAgICAgICAgIG40CiAqIDwvcHJlPgogKi8KCgpmdW5jdGlvbiByb3RhdGVUcmlhbmdsZVBhaXIodCwgcCwgb3QsIG9wKSB7CiAgdmFyIG4xLCBuMiwgbjMsIG40OwogIG4xID0gdC5uZWlnaGJvckNDVyhwKTsKICBuMiA9IHQubmVpZ2hib3JDVyhwKTsKICBuMyA9IG90Lm5laWdoYm9yQ0NXKG9wKTsKICBuNCA9IG90Lm5laWdoYm9yQ1cob3ApOwogIHZhciBjZTEsIGNlMiwgY2UzLCBjZTQ7CiAgY2UxID0gdC5nZXRDb25zdHJhaW5lZEVkZ2VDQ1cocCk7CiAgY2UyID0gdC5nZXRDb25zdHJhaW5lZEVkZ2VDVyhwKTsKICBjZTMgPSBvdC5nZXRDb25zdHJhaW5lZEVkZ2VDQ1cob3ApOwogIGNlNCA9IG90LmdldENvbnN0cmFpbmVkRWRnZUNXKG9wKTsKICB2YXIgZGUxLCBkZTIsIGRlMywgZGU0OwogIGRlMSA9IHQuZ2V0RGVsYXVuYXlFZGdlQ0NXKHApOwogIGRlMiA9IHQuZ2V0RGVsYXVuYXlFZGdlQ1cocCk7CiAgZGUzID0gb3QuZ2V0RGVsYXVuYXlFZGdlQ0NXKG9wKTsKICBkZTQgPSBvdC5nZXREZWxhdW5heUVkZ2VDVyhvcCk7CiAgdC5sZWdhbGl6ZShwLCBvcCk7CiAgb3QubGVnYWxpemUob3AsIHApOyAvLyBSZW1hcCBkZWxhdW5heV9lZGdlCgogIG90LnNldERlbGF1bmF5RWRnZUNDVyhwLCBkZTEpOwogIHQuc2V0RGVsYXVuYXlFZGdlQ1cocCwgZGUyKTsKICB0LnNldERlbGF1bmF5RWRnZUNDVyhvcCwgZGUzKTsKICBvdC5zZXREZWxhdW5heUVkZ2VDVyhvcCwgZGU0KTsgLy8gUmVtYXAgY29uc3RyYWluZWRfZWRnZQoKICBvdC5zZXRDb25zdHJhaW5lZEVkZ2VDQ1cocCwgY2UxKTsKICB0LnNldENvbnN0cmFpbmVkRWRnZUNXKHAsIGNlMik7CiAgdC5zZXRDb25zdHJhaW5lZEVkZ2VDQ1cob3AsIGNlMyk7CiAgb3Quc2V0Q29uc3RyYWluZWRFZGdlQ1cob3AsIGNlNCk7IC8vIFJlbWFwIG5laWdoYm9ycwogIC8vIFhYWDogbWlnaHQgb3B0aW1pemUgdGhlIG1hcmtOZWlnaGJvciBieSBrZWVwaW5nIHRyYWNrIG9mCiAgLy8gICAgICB3aGF0IHNpZGUgc2hvdWxkIGJlIGFzc2lnbmVkIHRvIHdoYXQgbmVpZ2hib3IgYWZ0ZXIgdGhlCiAgLy8gICAgICByb3RhdGlvbi4gTm93IG1hcmsgbmVpZ2hib3IgZG9lcyBsb3RzIG9mIHRlc3RpbmcgdG8gZmluZAogIC8vICAgICAgdGhlIHJpZ2h0IHNpZGUuCgogIHQuY2xlYXJOZWlnaGJvcnMoKTsKICBvdC5jbGVhck5laWdoYm9ycygpOwoKICBpZiAobjEpIHsKICAgIG90Lm1hcmtOZWlnaGJvcihuMSk7CiAgfQoKICBpZiAobjIpIHsKICAgIHQubWFya05laWdoYm9yKG4yKTsKICB9CgogIGlmIChuMykgewogICAgdC5tYXJrTmVpZ2hib3IobjMpOwogIH0KCiAgaWYgKG40KSB7CiAgICBvdC5tYXJrTmVpZ2hib3IobjQpOwogIH0KCiAgdC5tYXJrTmVpZ2hib3Iob3QpOwp9Ci8qKgogKiBGaWxscyBhIGJhc2luIHRoYXQgaGFzIGZvcm1lZCBvbiB0aGUgQWR2YW5jaW5nIEZyb250IHRvIHRoZSByaWdodAogKiBvZiBnaXZlbiBub2RlLjxicj4KICogRmlyc3Qgd2UgZGVjaWRlIGEgbGVmdCxib3R0b20gYW5kIHJpZ2h0IG5vZGUgdGhhdCBmb3JtcyB0aGUKICogYm91bmRhcmllcyBvZiB0aGUgYmFzaW4uIFRoZW4gd2UgZG8gYSByZXF1cnNpdmUgZmlsbC4KICoKICogQHBhcmFtIHshU3dlZXBDb250ZXh0fSB0Y3ggLSBTd2VlcENvbnRleHQgb2JqZWN0CiAqIEBwYXJhbSBub2RlIC0gc3RhcnRpbmcgbm9kZSwgdGhpcyBvciBuZXh0IG5vZGUgd2lsbCBiZSBsZWZ0IG5vZGUKICovCgoKZnVuY3Rpb24gZmlsbEJhc2luKHRjeCwgbm9kZSkgewogIGlmIChvcmllbnQyZChub2RlLnBvaW50LCBub2RlLm5leHQucG9pbnQsIG5vZGUubmV4dC5uZXh0LnBvaW50KSA9PT0gT3JpZW50YXRpb24uQ0NXKSB7CiAgICB0Y3guYmFzaW4ubGVmdF9ub2RlID0gbm9kZS5uZXh0Lm5leHQ7CiAgfSBlbHNlIHsKICAgIHRjeC5iYXNpbi5sZWZ0X25vZGUgPSBub2RlLm5leHQ7CiAgfSAvLyBGaW5kIHRoZSBib3R0b20gYW5kIHJpZ2h0IG5vZGUKCgogIHRjeC5iYXNpbi5ib3R0b21fbm9kZSA9IHRjeC5iYXNpbi5sZWZ0X25vZGU7CgogIHdoaWxlICh0Y3guYmFzaW4uYm90dG9tX25vZGUubmV4dCAmJiB0Y3guYmFzaW4uYm90dG9tX25vZGUucG9pbnQueSA+PSB0Y3guYmFzaW4uYm90dG9tX25vZGUubmV4dC5wb2ludC55KSB7CiAgICB0Y3guYmFzaW4uYm90dG9tX25vZGUgPSB0Y3guYmFzaW4uYm90dG9tX25vZGUubmV4dDsKICB9CgogIGlmICh0Y3guYmFzaW4uYm90dG9tX25vZGUgPT09IHRjeC5iYXNpbi5sZWZ0X25vZGUpIHsKICAgIC8vIE5vIHZhbGlkIGJhc2luCiAgICByZXR1cm47CiAgfQoKICB0Y3guYmFzaW4ucmlnaHRfbm9kZSA9IHRjeC5iYXNpbi5ib3R0b21fbm9kZTsKCiAgd2hpbGUgKHRjeC5iYXNpbi5yaWdodF9ub2RlLm5leHQgJiYgdGN4LmJhc2luLnJpZ2h0X25vZGUucG9pbnQueSA8IHRjeC5iYXNpbi5yaWdodF9ub2RlLm5leHQucG9pbnQueSkgewogICAgdGN4LmJhc2luLnJpZ2h0X25vZGUgPSB0Y3guYmFzaW4ucmlnaHRfbm9kZS5uZXh0OwogIH0KCiAgaWYgKHRjeC5iYXNpbi5yaWdodF9ub2RlID09PSB0Y3guYmFzaW4uYm90dG9tX25vZGUpIHsKICAgIC8vIE5vIHZhbGlkIGJhc2lucwogICAgcmV0dXJuOwogIH0KCiAgdGN4LmJhc2luLndpZHRoID0gdGN4LmJhc2luLnJpZ2h0X25vZGUucG9pbnQueCAtIHRjeC5iYXNpbi5sZWZ0X25vZGUucG9pbnQueDsKICB0Y3guYmFzaW4ubGVmdF9oaWdoZXN0ID0gdGN4LmJhc2luLmxlZnRfbm9kZS5wb2ludC55ID4gdGN4LmJhc2luLnJpZ2h0X25vZGUucG9pbnQueTsKICBmaWxsQmFzaW5SZXEodGN4LCB0Y3guYmFzaW4uYm90dG9tX25vZGUpOwp9Ci8qKgogKiBSZWN1cnNpdmUgYWxnb3JpdGhtIHRvIGZpbGwgYSBCYXNpbiB3aXRoIHRyaWFuZ2xlcwogKgogKiBAcGFyYW0geyFTd2VlcENvbnRleHR9IHRjeCAtIFN3ZWVwQ29udGV4dCBvYmplY3QKICogQHBhcmFtIG5vZGUgLSBib3R0b21fbm9kZQogKi8KCgpmdW5jdGlvbiBmaWxsQmFzaW5SZXEodGN4LCBub2RlKSB7CiAgLy8gaWYgc2hhbGxvdyBzdG9wIGZpbGxpbmcKICBpZiAoaXNTaGFsbG93KHRjeCwgbm9kZSkpIHsKICAgIHJldHVybjsKICB9CgogIGZpbGwodGN4LCBub2RlKTsKICB2YXIgbzsKCiAgaWYgKG5vZGUucHJldiA9PT0gdGN4LmJhc2luLmxlZnRfbm9kZSAmJiBub2RlLm5leHQgPT09IHRjeC5iYXNpbi5yaWdodF9ub2RlKSB7CiAgICByZXR1cm47CiAgfSBlbHNlIGlmIChub2RlLnByZXYgPT09IHRjeC5iYXNpbi5sZWZ0X25vZGUpIHsKICAgIG8gPSBvcmllbnQyZChub2RlLnBvaW50LCBub2RlLm5leHQucG9pbnQsIG5vZGUubmV4dC5uZXh0LnBvaW50KTsKCiAgICBpZiAobyA9PT0gT3JpZW50YXRpb24uQ1cpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIG5vZGUgPSBub2RlLm5leHQ7CiAgfSBlbHNlIGlmIChub2RlLm5leHQgPT09IHRjeC5iYXNpbi5yaWdodF9ub2RlKSB7CiAgICBvID0gb3JpZW50MmQobm9kZS5wb2ludCwgbm9kZS5wcmV2LnBvaW50LCBub2RlLnByZXYucHJldi5wb2ludCk7CgogICAgaWYgKG8gPT09IE9yaWVudGF0aW9uLkNDVykgewogICAgICByZXR1cm47CiAgICB9CgogICAgbm9kZSA9IG5vZGUucHJldjsKICB9IGVsc2UgewogICAgLy8gQ29udGludWUgd2l0aCB0aGUgbmVpZ2hib3Igbm9kZSB3aXRoIGxvd2VzdCBZIHZhbHVlCiAgICBpZiAobm9kZS5wcmV2LnBvaW50LnkgPCBub2RlLm5leHQucG9pbnQueSkgewogICAgICBub2RlID0gbm9kZS5wcmV2OwogICAgfSBlbHNlIHsKICAgICAgbm9kZSA9IG5vZGUubmV4dDsKICAgIH0KICB9CgogIGZpbGxCYXNpblJlcSh0Y3gsIG5vZGUpOwp9CgpmdW5jdGlvbiBpc1NoYWxsb3codGN4LCBub2RlKSB7CiAgdmFyIGhlaWdodDsKCiAgaWYgKHRjeC5iYXNpbi5sZWZ0X2hpZ2hlc3QpIHsKICAgIGhlaWdodCA9IHRjeC5iYXNpbi5sZWZ0X25vZGUucG9pbnQueSAtIG5vZGUucG9pbnQueTsKICB9IGVsc2UgewogICAgaGVpZ2h0ID0gdGN4LmJhc2luLnJpZ2h0X25vZGUucG9pbnQueSAtIG5vZGUucG9pbnQueTsKICB9IC8vIGlmIHNoYWxsb3cgc3RvcCBmaWxsaW5nCgoKICBpZiAodGN4LmJhc2luLndpZHRoID4gaGVpZ2h0KSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIHJldHVybiBmYWxzZTsKfQoKZnVuY3Rpb24gZmlsbEVkZ2VFdmVudCh0Y3gsIGVkZ2UsIG5vZGUpIHsKICBpZiAodGN4LmVkZ2VfZXZlbnQucmlnaHQpIHsKICAgIGZpbGxSaWdodEFib3ZlRWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSk7CiAgfSBlbHNlIHsKICAgIGZpbGxMZWZ0QWJvdmVFZGdlRXZlbnQodGN4LCBlZGdlLCBub2RlKTsKICB9Cn0KCmZ1bmN0aW9uIGZpbGxSaWdodEFib3ZlRWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSkgewogIHdoaWxlIChub2RlLm5leHQucG9pbnQueCA8IGVkZ2UucC54KSB7CiAgICAvLyBDaGVjayBpZiBuZXh0IG5vZGUgaXMgYmVsb3cgdGhlIGVkZ2UKICAgIGlmIChvcmllbnQyZChlZGdlLnEsIG5vZGUubmV4dC5wb2ludCwgZWRnZS5wKSA9PT0gT3JpZW50YXRpb24uQ0NXKSB7CiAgICAgIGZpbGxSaWdodEJlbG93RWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSk7CiAgICB9IGVsc2UgewogICAgICBub2RlID0gbm9kZS5uZXh0OwogICAgfQogIH0KfQoKZnVuY3Rpb24gZmlsbFJpZ2h0QmVsb3dFZGdlRXZlbnQodGN4LCBlZGdlLCBub2RlKSB7CiAgaWYgKG5vZGUucG9pbnQueCA8IGVkZ2UucC54KSB7CiAgICBpZiAob3JpZW50MmQobm9kZS5wb2ludCwgbm9kZS5uZXh0LnBvaW50LCBub2RlLm5leHQubmV4dC5wb2ludCkgPT09IE9yaWVudGF0aW9uLkNDVykgewogICAgICAvLyBDb25jYXZlCiAgICAgIGZpbGxSaWdodENvbmNhdmVFZGdlRXZlbnQodGN4LCBlZGdlLCBub2RlKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIENvbnZleAogICAgICBmaWxsUmlnaHRDb252ZXhFZGdlRXZlbnQodGN4LCBlZGdlLCBub2RlKTsgLy8gUmV0cnkgdGhpcyBvbmUKCiAgICAgIGZpbGxSaWdodEJlbG93RWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSk7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBmaWxsUmlnaHRDb25jYXZlRWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSkgewogIGZpbGwodGN4LCBub2RlLm5leHQpOwoKICBpZiAobm9kZS5uZXh0LnBvaW50ICE9PSBlZGdlLnApIHsKICAgIC8vIE5leHQgYWJvdmUgb3IgYmVsb3cgZWRnZT8KICAgIGlmIChvcmllbnQyZChlZGdlLnEsIG5vZGUubmV4dC5wb2ludCwgZWRnZS5wKSA9PT0gT3JpZW50YXRpb24uQ0NXKSB7CiAgICAgIC8vIEJlbG93CiAgICAgIGlmIChvcmllbnQyZChub2RlLnBvaW50LCBub2RlLm5leHQucG9pbnQsIG5vZGUubmV4dC5uZXh0LnBvaW50KSA9PT0gT3JpZW50YXRpb24uQ0NXKSB7CiAgICAgICAgLy8gTmV4dCBpcyBjb25jYXZlCiAgICAgICAgZmlsbFJpZ2h0Q29uY2F2ZUVkZ2VFdmVudCh0Y3gsIGVkZ2UsIG5vZGUpOwogICAgICB9CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBmaWxsUmlnaHRDb252ZXhFZGdlRXZlbnQodGN4LCBlZGdlLCBub2RlKSB7CiAgLy8gTmV4dCBjb25jYXZlIG9yIGNvbnZleD8KICBpZiAob3JpZW50MmQobm9kZS5uZXh0LnBvaW50LCBub2RlLm5leHQubmV4dC5wb2ludCwgbm9kZS5uZXh0Lm5leHQubmV4dC5wb2ludCkgPT09IE9yaWVudGF0aW9uLkNDVykgewogICAgLy8gQ29uY2F2ZQogICAgZmlsbFJpZ2h0Q29uY2F2ZUVkZ2VFdmVudCh0Y3gsIGVkZ2UsIG5vZGUubmV4dCk7CiAgfSBlbHNlIHsKICAgIC8vIENvbnZleAogICAgLy8gTmV4dCBhYm92ZSBvciBiZWxvdyBlZGdlPwogICAgaWYgKG9yaWVudDJkKGVkZ2UucSwgbm9kZS5uZXh0Lm5leHQucG9pbnQsIGVkZ2UucCkgPT09IE9yaWVudGF0aW9uLkNDVykgewogICAgICAvLyBCZWxvdwogICAgICBmaWxsUmlnaHRDb252ZXhFZGdlRXZlbnQodGN4LCBlZGdlLCBub2RlLm5leHQpOwogICAgfQogIH0KfQoKZnVuY3Rpb24gZmlsbExlZnRBYm92ZUVkZ2VFdmVudCh0Y3gsIGVkZ2UsIG5vZGUpIHsKICB3aGlsZSAobm9kZS5wcmV2LnBvaW50LnggPiBlZGdlLnAueCkgewogICAgLy8gQ2hlY2sgaWYgbmV4dCBub2RlIGlzIGJlbG93IHRoZSBlZGdlCiAgICBpZiAob3JpZW50MmQoZWRnZS5xLCBub2RlLnByZXYucG9pbnQsIGVkZ2UucCkgPT09IE9yaWVudGF0aW9uLkNXKSB7CiAgICAgIGZpbGxMZWZ0QmVsb3dFZGdlRXZlbnQodGN4LCBlZGdlLCBub2RlKTsKICAgIH0gZWxzZSB7CiAgICAgIG5vZGUgPSBub2RlLnByZXY7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBmaWxsTGVmdEJlbG93RWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSkgewogIGlmIChub2RlLnBvaW50LnggPiBlZGdlLnAueCkgewogICAgaWYgKG9yaWVudDJkKG5vZGUucG9pbnQsIG5vZGUucHJldi5wb2ludCwgbm9kZS5wcmV2LnByZXYucG9pbnQpID09PSBPcmllbnRhdGlvbi5DVykgewogICAgICAvLyBDb25jYXZlCiAgICAgIGZpbGxMZWZ0Q29uY2F2ZUVkZ2VFdmVudCh0Y3gsIGVkZ2UsIG5vZGUpOwogICAgfSBlbHNlIHsKICAgICAgLy8gQ29udmV4CiAgICAgIGZpbGxMZWZ0Q29udmV4RWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSk7IC8vIFJldHJ5IHRoaXMgb25lCgogICAgICBmaWxsTGVmdEJlbG93RWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZSk7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBmaWxsTGVmdENvbnZleEVkZ2VFdmVudCh0Y3gsIGVkZ2UsIG5vZGUpIHsKICAvLyBOZXh0IGNvbmNhdmUgb3IgY29udmV4PwogIGlmIChvcmllbnQyZChub2RlLnByZXYucG9pbnQsIG5vZGUucHJldi5wcmV2LnBvaW50LCBub2RlLnByZXYucHJldi5wcmV2LnBvaW50KSA9PT0gT3JpZW50YXRpb24uQ1cpIHsKICAgIC8vIENvbmNhdmUKICAgIGZpbGxMZWZ0Q29uY2F2ZUVkZ2VFdmVudCh0Y3gsIGVkZ2UsIG5vZGUucHJldik7CiAgfSBlbHNlIHsKICAgIC8vIENvbnZleAogICAgLy8gTmV4dCBhYm92ZSBvciBiZWxvdyBlZGdlPwogICAgaWYgKG9yaWVudDJkKGVkZ2UucSwgbm9kZS5wcmV2LnByZXYucG9pbnQsIGVkZ2UucCkgPT09IE9yaWVudGF0aW9uLkNXKSB7CiAgICAgIC8vIEJlbG93CiAgICAgIGZpbGxMZWZ0Q29udmV4RWRnZUV2ZW50KHRjeCwgZWRnZSwgbm9kZS5wcmV2KTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGZpbGxMZWZ0Q29uY2F2ZUVkZ2VFdmVudCh0Y3gsIGVkZ2UsIG5vZGUpIHsKICBmaWxsKHRjeCwgbm9kZS5wcmV2KTsKCiAgaWYgKG5vZGUucHJldi5wb2ludCAhPT0gZWRnZS5wKSB7CiAgICAvLyBOZXh0IGFib3ZlIG9yIGJlbG93IGVkZ2U/CiAgICBpZiAob3JpZW50MmQoZWRnZS5xLCBub2RlLnByZXYucG9pbnQsIGVkZ2UucCkgPT09IE9yaWVudGF0aW9uLkNXKSB7CiAgICAgIC8vIEJlbG93CiAgICAgIGlmIChvcmllbnQyZChub2RlLnBvaW50LCBub2RlLnByZXYucG9pbnQsIG5vZGUucHJldi5wcmV2LnBvaW50KSA9PT0gT3JpZW50YXRpb24uQ1cpIHsKICAgICAgICAvLyBOZXh0IGlzIGNvbmNhdmUKICAgICAgICBmaWxsTGVmdENvbmNhdmVFZGdlRXZlbnQodGN4LCBlZGdlLCBub2RlKTsKICAgICAgfQogICAgfQogIH0KfQoKZnVuY3Rpb24gZmxpcEVkZ2VFdmVudCh0Y3gsIGVwLCBlcSwgdCwgcCkgewogIHZhciBvdCA9IHQubmVpZ2hib3JBY3Jvc3MocCk7CiAgYXNzZXJ0XzEob3QsICJGTElQIGZhaWxlZCBkdWUgdG8gbWlzc2luZyB0cmlhbmdsZSEiKTsKICB2YXIgb3AgPSBvdC5vcHBvc2l0ZVBvaW50KHQsIHApOyAvLyBBZGRpdGlvbmFsIGNoZWNrIGZyb20gSmF2YSB2ZXJzaW9uIChzZWUgaXNzdWUgIzg4KQoKICBpZiAodC5nZXRDb25zdHJhaW5lZEVkZ2VBY3Jvc3MocCkpIHsKICAgIHZhciBpbmRleCA9IHQuaW5kZXgocCk7CiAgICB0aHJvdyBuZXcgcG9pbnRlcnJvcigicG9seTJ0cmkgSW50ZXJzZWN0aW5nIENvbnN0cmFpbnRzIiwgW3AsIG9wLCB0LmdldFBvaW50KChpbmRleCArIDEpICUgMyksIHQuZ2V0UG9pbnQoKGluZGV4ICsgMikgJSAzKV0pOwogIH0KCiAgaWYgKGluU2NhbkFyZWEocCwgdC5wb2ludENDVyhwKSwgdC5wb2ludENXKHApLCBvcCkpIHsKICAgIC8vIExldHMgcm90YXRlIHNoYXJlZCBlZGdlIG9uZSB2ZXJ0ZXggQ1cKICAgIHJvdGF0ZVRyaWFuZ2xlUGFpcih0LCBwLCBvdCwgb3ApOwogICAgdGN4Lm1hcFRyaWFuZ2xlVG9Ob2Rlcyh0KTsKICAgIHRjeC5tYXBUcmlhbmdsZVRvTm9kZXMob3QpOyAvLyBYWFg6IGluIHRoZSBvcmlnaW5hbCBDKysgY29kZSBmb3IgdGhlIG5leHQgMiBsaW5lcywgd2UgYXJlCiAgICAvLyBjb21wYXJpbmcgcG9pbnQgdmFsdWVzIChhbmQgbm90IHBvaW50ZXJzKS4gSW4gdGhpcyBKYXZhU2NyaXB0CiAgICAvLyBjb2RlLCB3ZSBhcmUgY29tcGFyaW5nIHBvaW50IHJlZmVyZW5jZXMgKHBvaW50ZXJzKS4gVGhpcyB3b3JrcwogICAgLy8gYmVjYXVzZSB3ZSBjYW4ndCBoYXZlIDIgZGlmZmVyZW50IHBvaW50cyB3aXRoIHRoZSBzYW1lIHZhbHVlcy4KICAgIC8vIEJ1dCB0byBiZSByZWFsbHkgZXF1aXZhbGVudCwgd2Ugc2hvdWxkIHVzZSAiUG9pbnQuZXF1YWxzIiBoZXJlLgoKICAgIGlmIChwID09PSBlcSAmJiBvcCA9PT0gZXApIHsKICAgICAgaWYgKGVxID09PSB0Y3guZWRnZV9ldmVudC5jb25zdHJhaW5lZF9lZGdlLnEgJiYgZXAgPT09IHRjeC5lZGdlX2V2ZW50LmNvbnN0cmFpbmVkX2VkZ2UucCkgewogICAgICAgIHQubWFya0NvbnN0cmFpbmVkRWRnZUJ5UG9pbnRzKGVwLCBlcSk7CiAgICAgICAgb3QubWFya0NvbnN0cmFpbmVkRWRnZUJ5UG9pbnRzKGVwLCBlcSk7CiAgICAgICAgbGVnYWxpemUodGN4LCB0KTsKICAgICAgICBsZWdhbGl6ZSh0Y3gsIG90KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdmFyIG8gPSBvcmllbnQyZChlcSwgb3AsIGVwKTsKICAgICAgdCA9IG5leHRGbGlwVHJpYW5nbGUodGN4LCBvLCB0LCBvdCwgcCwgb3ApOwogICAgICBmbGlwRWRnZUV2ZW50KHRjeCwgZXAsIGVxLCB0LCBwKTsKICAgIH0KICB9IGVsc2UgewogICAgdmFyIG5ld1AgPSBuZXh0RmxpcFBvaW50KGVwLCBlcSwgb3QsIG9wKTsKICAgIGZsaXBTY2FuRWRnZUV2ZW50KHRjeCwgZXAsIGVxLCB0LCBvdCwgbmV3UCk7CiAgICBlZGdlRXZlbnRCeVBvaW50cyh0Y3gsIGVwLCBlcSwgdCwgcCk7CiAgfQp9Ci8qKgogKiBBZnRlciBhIGZsaXAgd2UgaGF2ZSB0d28gdHJpYW5nbGVzIGFuZCBrbm93IHRoYXQgb25seSBvbmUgd2lsbCBzdGlsbCBiZQogKiBpbnRlcnNlY3RpbmcgdGhlIGVkZ2UuIFNvIGRlY2lkZSB3aGljaCB0byBjb250aXVuZSB3aXRoIGFuZCBsZWdhbGl6ZSB0aGUgb3RoZXIKICoKICogQHBhcmFtIHshU3dlZXBDb250ZXh0fSB0Y3ggLSBTd2VlcENvbnRleHQgb2JqZWN0CiAqIEBwYXJhbSBvIC0gc2hvdWxkIGJlIHRoZSByZXN1bHQgb2YgYW4gb3JpZW50MmQoIGVxLCBvcCwgZXAgKQogKiBAcGFyYW0gdCAtIHRyaWFuZ2xlIDEKICogQHBhcmFtIG90IC0gdHJpYW5nbGUgMgogKiBAcGFyYW0gcCAtIGEgcG9pbnQgc2hhcmVkIGJ5IGJvdGggdHJpYW5nbGVzCiAqIEBwYXJhbSBvcCAtIGFub3RoZXIgcG9pbnQgc2hhcmVkIGJ5IGJvdGggdHJpYW5nbGVzCiAqIEByZXR1cm4gcmV0dXJucyB0aGUgdHJpYW5nbGUgc3RpbGwgaW50ZXJzZWN0aW5nIHRoZSBlZGdlCiAqLwoKCmZ1bmN0aW9uIG5leHRGbGlwVHJpYW5nbGUodGN4LCBvLCB0LCBvdCwgcCwgb3ApIHsKICB2YXIgZWRnZV9pbmRleDsKCiAgaWYgKG8gPT09IE9yaWVudGF0aW9uLkNDVykgewogICAgLy8gb3QgaXMgbm90IGNyb3NzaW5nIGVkZ2UgYWZ0ZXIgZmxpcAogICAgZWRnZV9pbmRleCA9IG90LmVkZ2VJbmRleChwLCBvcCk7CiAgICBvdC5kZWxhdW5heV9lZGdlW2VkZ2VfaW5kZXhdID0gdHJ1ZTsKICAgIGxlZ2FsaXplKHRjeCwgb3QpOwogICAgb3QuY2xlYXJEZWxhdW5heUVkZ2VzKCk7CiAgICByZXR1cm4gdDsKICB9IC8vIHQgaXMgbm90IGNyb3NzaW5nIGVkZ2UgYWZ0ZXIgZmxpcAoKCiAgZWRnZV9pbmRleCA9IHQuZWRnZUluZGV4KHAsIG9wKTsKICB0LmRlbGF1bmF5X2VkZ2VbZWRnZV9pbmRleF0gPSB0cnVlOwogIGxlZ2FsaXplKHRjeCwgdCk7CiAgdC5jbGVhckRlbGF1bmF5RWRnZXMoKTsKICByZXR1cm4gb3Q7Cn0KLyoqCiAqIFdoZW4gd2UgbmVlZCB0byB0cmF2ZXJzZSBmcm9tIG9uZSB0cmlhbmdsZSB0byB0aGUgbmV4dCB3ZSBuZWVkCiAqIHRoZSBwb2ludCBpbiBjdXJyZW50IHRyaWFuZ2xlIHRoYXQgaXMgdGhlIG9wcG9zaXRlIHBvaW50IHRvIHRoZSBuZXh0CiAqIHRyaWFuZ2xlLgogKi8KCgpmdW5jdGlvbiBuZXh0RmxpcFBvaW50KGVwLCBlcSwgb3QsIG9wKSB7CiAgdmFyIG8yZCA9IG9yaWVudDJkKGVxLCBvcCwgZXApOwoKICBpZiAobzJkID09PSBPcmllbnRhdGlvbi5DVykgewogICAgLy8gUmlnaHQKICAgIHJldHVybiBvdC5wb2ludENDVyhvcCk7CiAgfSBlbHNlIGlmIChvMmQgPT09IE9yaWVudGF0aW9uLkNDVykgewogICAgLy8gTGVmdAogICAgcmV0dXJuIG90LnBvaW50Q1cob3ApOwogIH0gZWxzZSB7CiAgICB0aHJvdyBuZXcgcG9pbnRlcnJvcigicG9seTJ0cmkgW1Vuc3VwcG9ydGVkXSBuZXh0RmxpcFBvaW50OiBvcHBvc2luZyBwb2ludCBvbiBjb25zdHJhaW5lZCBlZGdlISIsIFtlcSwgb3AsIGVwXSk7CiAgfQp9Ci8qKgogKiBTY2FuIHBhcnQgb2YgdGhlIEZsaXBTY2FuIGFsZ29yaXRobTxicj4KICogV2hlbiBhIHRyaWFuZ2xlIHBhaXIgaXNuJ3QgZmxpcHBhYmxlIHdlIHdpbGwgc2NhbiBmb3IgdGhlIG5leHQKICogcG9pbnQgdGhhdCBpcyBpbnNpZGUgdGhlIGZsaXAgdHJpYW5nbGUgc2NhbiBhcmVhLiBXaGVuIGZvdW5kCiAqIHdlIGdlbmVyYXRlIGEgbmV3IGZsaXBFZGdlRXZlbnQKICoKICogQHBhcmFtIHshU3dlZXBDb250ZXh0fSB0Y3ggLSBTd2VlcENvbnRleHQgb2JqZWN0CiAqIEBwYXJhbSBlcCAtIGxhc3QgcG9pbnQgb24gdGhlIGVkZ2Ugd2UgYXJlIHRyYXZlcnNpbmcKICogQHBhcmFtIGVxIC0gZmlyc3QgcG9pbnQgb24gdGhlIGVkZ2Ugd2UgYXJlIHRyYXZlcnNpbmcKICogQHBhcmFtIHshVHJpYW5nbGV9IGZsaXBfdHJpYW5nbGUgLSB0aGUgY3VycmVudCB0cmlhbmdsZSBzaGFyaW5nIHRoZSBwb2ludCBlcSB3aXRoIGVkZ2UKICogQHBhcmFtIHQKICogQHBhcmFtIHAKICovCgoKZnVuY3Rpb24gZmxpcFNjYW5FZGdlRXZlbnQodGN4LCBlcCwgZXEsIGZsaXBfdHJpYW5nbGUsIHQsIHApIHsKICB2YXIgb3QgPSB0Lm5laWdoYm9yQWNyb3NzKHApOwogIGFzc2VydF8xKG90LCAiRkxJUCBmYWlsZWQgZHVlIHRvIG1pc3NpbmcgdHJpYW5nbGUiKTsKICB2YXIgb3AgPSBvdC5vcHBvc2l0ZVBvaW50KHQsIHApOwoKICBpZiAoaW5TY2FuQXJlYShlcSwgZmxpcF90cmlhbmdsZS5wb2ludENDVyhlcSksIGZsaXBfdHJpYW5nbGUucG9pbnRDVyhlcSksIG9wKSkgewogICAgLy8gZmxpcCB3aXRoIG5ldyBlZGdlIG9wLmVxCiAgICBmbGlwRWRnZUV2ZW50KHRjeCwgZXEsIG9wLCBvdCwgb3ApOwogIH0gZWxzZSB7CiAgICB2YXIgbmV3UCA9IG5leHRGbGlwUG9pbnQoZXAsIGVxLCBvdCwgb3ApOwogICAgZmxpcFNjYW5FZGdlRXZlbnQodGN4LCBlcCwgZXEsIGZsaXBfdHJpYW5nbGUsIG90LCBuZXdQKTsKICB9Cn0gLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUV4cG9ydHMKCgp2YXIgdHJpYW5ndWxhdGVfMSA9IHRyaWFuZ3VsYXRlOwp2YXIgc3dlZXAgPSB7CiAgdHJpYW5ndWxhdGU6IHRyaWFuZ3VsYXRlXzEKfTsKCi8qCiAqIE5vdGUKICogPT09PQogKiB0aGUgc3RydWN0dXJlIG9mIHRoaXMgSmF2YVNjcmlwdCB2ZXJzaW9uIG9mIHBvbHkydHJpIGludGVudGlvbmFsbHkgZm9sbG93cwogKiBhcyBjbG9zZWx5IGFzIHBvc3NpYmxlIHRoZSBzdHJ1Y3R1cmUgb2YgdGhlIHJlZmVyZW5jZSBDKysgdmVyc2lvbiwgdG8gbWFrZSBpdCAKICogZWFzaWVyIHRvIGtlZXAgdGhlIDIgdmVyc2lvbnMgaW4gc3luYy4KICovCgoKdmFyIE5vZGUgPSBhZHZhbmNpbmdmcm9udC5Ob2RlOyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS11dGlscwoKLyoqCiAqIEluaXRpYWwgdHJpYW5nbGUgZmFjdG9yLCBzZWVkIHRyaWFuZ2xlIHdpbGwgZXh0ZW5kIDMwJSBvZgogKiBQb2ludFNldCB3aWR0aCB0byBib3RoIGxlZnQgYW5kIHJpZ2h0LgogKiBAcHJpdmF0ZQogKiBAY29uc3QKICovCgp2YXIga0FscGhhID0gMC4zOyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRWRnZQoKLyoqCiAqIFJlcHJlc2VudHMgYSBzaW1wbGUgcG9seWdvbidzIGVkZ2UKICogQGNvbnN0cnVjdG9yCiAqIEBzdHJ1Y3QKICogQHByaXZhdGUKICogQHBhcmFtIHtQb2ludH0gcDEKICogQHBhcmFtIHtQb2ludH0gcDIKICogQHRocm93IHtQb2ludEVycm9yfSBpZiBwMSBpcyBzYW1lIGFzIHAyCiAqLwoKdmFyIEVkZ2UgPSBmdW5jdGlvbiBFZGdlKHAxLCBwMikgewogIHRoaXMucCA9IHAxOwogIHRoaXMucSA9IHAyOwoKICBpZiAocDEueSA+IHAyLnkpIHsKICAgIHRoaXMucSA9IHAxOwogICAgdGhpcy5wID0gcDI7CiAgfSBlbHNlIGlmIChwMS55ID09PSBwMi55KSB7CiAgICBpZiAocDEueCA+IHAyLngpIHsKICAgICAgdGhpcy5xID0gcDE7CiAgICAgIHRoaXMucCA9IHAyOwogICAgfSBlbHNlIGlmIChwMS54ID09PSBwMi54KSB7CiAgICAgIHRocm93IG5ldyBwb2ludGVycm9yKCdwb2x5MnRyaSBJbnZhbGlkIEVkZ2UgY29uc3RydWN0b3I6IHJlcGVhdGVkIHBvaW50cyEnLCBbcDFdKTsKICAgIH0KICB9CgogIGlmICghdGhpcy5xLl9wMnRfZWRnZV9saXN0KSB7CiAgICB0aGlzLnEuX3AydF9lZGdlX2xpc3QgPSBbXTsKICB9CgogIHRoaXMucS5fcDJ0X2VkZ2VfbGlzdC5wdXNoKHRoaXMpOwp9OyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1CYXNpbgoKLyoqCiAqIEBjb25zdHJ1Y3RvcgogKiBAc3RydWN0CiAqIEBwcml2YXRlCiAqLwoKCnZhciBCYXNpbiA9IGZ1bmN0aW9uIEJhc2luKCkgewogIC8qKiBAdHlwZSB7Tm9kZX0gKi8KICB0aGlzLmxlZnRfbm9kZSA9IG51bGw7CiAgLyoqIEB0eXBlIHtOb2RlfSAqLwoKICB0aGlzLmJvdHRvbV9ub2RlID0gbnVsbDsKICAvKiogQHR5cGUge05vZGV9ICovCgogIHRoaXMucmlnaHRfbm9kZSA9IG51bGw7CiAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCgogIHRoaXMud2lkdGggPSAwLjA7CiAgLyoqIEB0eXBlIHtib29sZWFufSAqLwoKICB0aGlzLmxlZnRfaGlnaGVzdCA9IGZhbHNlOwp9OwoKQmFzaW4ucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewogIHRoaXMubGVmdF9ub2RlID0gbnVsbDsKICB0aGlzLmJvdHRvbV9ub2RlID0gbnVsbDsKICB0aGlzLnJpZ2h0X25vZGUgPSBudWxsOwogIHRoaXMud2lkdGggPSAwLjA7CiAgdGhpcy5sZWZ0X2hpZ2hlc3QgPSBmYWxzZTsKfTsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1FZGdlRXZlbnQKCi8qKgogKiBAY29uc3RydWN0b3IKICogQHN0cnVjdAogKiBAcHJpdmF0ZQogKi8KCgp2YXIgRWRnZUV2ZW50ID0gZnVuY3Rpb24gRWRnZUV2ZW50KCkgewogIC8qKiBAdHlwZSB7RWRnZX0gKi8KICB0aGlzLmNvbnN0cmFpbmVkX2VkZ2UgPSBudWxsOwogIC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi8KCiAgdGhpcy5yaWdodCA9IGZhbHNlOwp9OyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tU3dlZXBDb250ZXh0IChwdWJsaWMgQVBJKQoKLyoqCiAqIFN3ZWVwQ29udGV4dCBjb25zdHJ1Y3RvciBvcHRpb24KICogQHR5cGVkZWYge09iamVjdH0gU3dlZXBDb250ZXh0T3B0aW9ucwogKiBAcHJvcGVydHkge2Jvb2xlYW49fSBjbG9uZUFycmF5cyAtIGlmIDxjb2RlPnRydWU8L2NvZGU+LCBkbyBhIHNoYWxsb3cgY29weSBvZiB0aGUgQXJyYXkgcGFyYW1ldGVycwogKiAgICAgICAgICAgICAgICAgIChjb250b3VyLCBob2xlcykuIFBvaW50cyBpbnNpZGUgYXJyYXlzIGFyZSBuZXZlciBjb3BpZWQuCiAqICAgICAgICAgICAgICAgICAgRGVmYXVsdCBpcyA8Y29kZT5mYWxzZTwvY29kZT4gOiBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZSBhcnJheSBhcmd1bWVudHMsCiAqICAgICAgICAgICAgICAgICAgd2hvIHdpbGwgYmUgbW9kaWZpZWQgaW4gcGxhY2UuCiAqLwoKLyoqCiAqIENvbnN0cnVjdG9yIGZvciB0aGUgdHJpYW5ndWxhdGlvbiBjb250ZXh0LgogKiBJdCBhY2NlcHRzIGEgc2ltcGxlIHBvbHlsaW5lICh3aXRoIG5vbiByZXBlYXRpbmcgcG9pbnRzKSwgCiAqIHdoaWNoIGRlZmluZXMgdGhlIGNvbnN0cmFpbmVkIGVkZ2VzLgogKgogKiBAZXhhbXBsZQogKiAgICAgICAgICB2YXIgY29udG91ciA9IFsKICogICAgICAgICAgICAgIG5ldyBwb2x5MnRyaS5Qb2ludCgxMDAsIDEwMCksCiAqICAgICAgICAgICAgICBuZXcgcG9seTJ0cmkuUG9pbnQoMTAwLCAzMDApLAogKiAgICAgICAgICAgICAgbmV3IHBvbHkydHJpLlBvaW50KDMwMCwgMzAwKSwKICogICAgICAgICAgICAgIG5ldyBwb2x5MnRyaS5Qb2ludCgzMDAsIDEwMCkKICogICAgICAgICAgXTsKICogICAgICAgICAgdmFyIHN3Y3R4ID0gbmV3IHBvbHkydHJpLlN3ZWVwQ29udGV4dChjb250b3VyLCB7Y2xvbmVBcnJheXM6IHRydWV9KTsKICogQGV4YW1wbGUKICogICAgICAgICAgdmFyIGNvbnRvdXIgPSBbe3g6MTAwLCB5OjEwMH0sIHt4OjEwMCwgeTozMDB9LCB7eDozMDAsIHk6MzAwfSwge3g6MzAwLCB5OjEwMH1dOwogKiAgICAgICAgICB2YXIgc3djdHggPSBuZXcgcG9seTJ0cmkuU3dlZXBDb250ZXh0KGNvbnRvdXIsIHtjbG9uZUFycmF5czogdHJ1ZX0pOwogKiBAY29uc3RydWN0b3IKICogQHB1YmxpYwogKiBAc3RydWN0CiAqIEBwYXJhbSB7QXJyYXkuPFhZPn0gY29udG91ciAtIGFycmF5IG9mIHBvaW50IG9iamVjdHMuIFRoZSBwb2ludHMgY2FuIGJlIGVpdGhlciB7QGxpbmtjb2RlIFBvaW50fSBpbnN0YW5jZXMsCiAqICAgICAgICAgIG9yIGFueSAiUG9pbnQgbGlrZSIgY3VzdG9tIGNsYXNzIHdpdGggPGNvZGU+e3gsIHl9PC9jb2RlPiBhdHRyaWJ1dGVzLgogKiBAcGFyYW0ge1N3ZWVwQ29udGV4dE9wdGlvbnM9fSBvcHRpb25zIC0gY29uc3RydWN0b3Igb3B0aW9ucwogKi8KCgp2YXIgU3dlZXBDb250ZXh0ID0gZnVuY3Rpb24gU3dlZXBDb250ZXh0KGNvbnRvdXIsIG9wdGlvbnMpIHsKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICB0aGlzLnRyaWFuZ2xlc18gPSBbXTsKICB0aGlzLm1hcF8gPSBbXTsKICB0aGlzLnBvaW50c18gPSBvcHRpb25zLmNsb25lQXJyYXlzID8gY29udG91ci5zbGljZSgwKSA6IGNvbnRvdXI7CiAgdGhpcy5lZGdlX2xpc3QgPSBbXTsgLy8gQm91bmRpbmcgYm94IG9mIGFsbCBwb2ludHMuIENvbXB1dGVkIGF0IHRoZSBzdGFydCBvZiB0aGUgdHJpYW5ndWxhdGlvbiwgCiAgLy8gaXQgaXMgc3RvcmVkIGluIGNhc2UgaXQgaXMgbmVlZGVkIGJ5IHRoZSBjYWxsZXIuCgogIHRoaXMucG1pbl8gPSB0aGlzLnBtYXhfID0gbnVsbDsKICAvKioKICAgKiBBZHZhbmNpbmcgZnJvbnQKICAgKiBAcHJpdmF0ZQogICAqIEB0eXBlIHtBZHZhbmNpbmdGcm9udH0KICAgKi8KCiAgdGhpcy5mcm9udF8gPSBudWxsOwogIC8qKgogICAqIGhlYWQgcG9pbnQgdXNlZCB3aXRoIGFkdmFuY2luZyBmcm9udAogICAqIEBwcml2YXRlCiAgICogQHR5cGUge1BvaW50fQogICAqLwoKICB0aGlzLmhlYWRfID0gbnVsbDsKICAvKioKICAgKiB0YWlsIHBvaW50IHVzZWQgd2l0aCBhZHZhbmNpbmcgZnJvbnQKICAgKiBAcHJpdmF0ZQogICAqIEB0eXBlIHtQb2ludH0KICAgKi8KCiAgdGhpcy50YWlsXyA9IG51bGw7CiAgLyoqCiAgICogQHByaXZhdGUKICAgKiBAdHlwZSB7Tm9kZX0KICAgKi8KCiAgdGhpcy5hZl9oZWFkXyA9IG51bGw7CiAgLyoqCiAgICogQHByaXZhdGUKICAgKiBAdHlwZSB7Tm9kZX0KICAgKi8KCiAgdGhpcy5hZl9taWRkbGVfID0gbnVsbDsKICAvKioKICAgKiBAcHJpdmF0ZQogICAqIEB0eXBlIHtOb2RlfQogICAqLwoKICB0aGlzLmFmX3RhaWxfID0gbnVsbDsKICB0aGlzLmJhc2luID0gbmV3IEJhc2luKCk7CiAgdGhpcy5lZGdlX2V2ZW50ID0gbmV3IEVkZ2VFdmVudCgpOwogIHRoaXMuaW5pdEVkZ2VzKHRoaXMucG9pbnRzXyk7Cn07Ci8qKgogKiBBZGQgYSBob2xlIHRvIHRoZSBjb25zdHJhaW50cwogKiBAZXhhbXBsZQogKiAgICAgIHZhciBzd2N0eCA9IG5ldyBwb2x5MnRyaS5Td2VlcENvbnRleHQoY29udG91cik7CiAqICAgICAgdmFyIGhvbGUgPSBbCiAqICAgICAgICAgIG5ldyBwb2x5MnRyaS5Qb2ludCgyMDAsIDIwMCksCiAqICAgICAgICAgIG5ldyBwb2x5MnRyaS5Qb2ludCgyMDAsIDI1MCksCiAqICAgICAgICAgIG5ldyBwb2x5MnRyaS5Qb2ludCgyNTAsIDI1MCkKICogICAgICBdOwogKiAgICAgIHN3Y3R4LmFkZEhvbGUoaG9sZSk7CiAqIEBleGFtcGxlCiAqICAgICAgdmFyIHN3Y3R4ID0gbmV3IHBvbHkydHJpLlN3ZWVwQ29udGV4dChjb250b3VyKTsKICogICAgICBzd2N0eC5hZGRIb2xlKFt7eDoyMDAsIHk6MjAwfSwge3g6MjAwLCB5OjI1MH0sIHt4OjI1MCwgeToyNTB9XSk7CiAqIEBwdWJsaWMKICogQHBhcmFtIHtBcnJheS48WFk+fSBwb2x5bGluZSAtIGFycmF5IG9mICJQb2ludCBsaWtlIiBvYmplY3RzIHdpdGgge3gseX0KICovCgoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5hZGRIb2xlID0gZnVuY3Rpb24gKHBvbHlsaW5lKSB7CiAgdGhpcy5pbml0RWRnZXMocG9seWxpbmUpOwogIHZhciBpLAogICAgICBsZW4gPSBwb2x5bGluZS5sZW5ndGg7CgogIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgdGhpcy5wb2ludHNfLnB1c2gocG9seWxpbmVbaV0pOwogIH0KCiAgcmV0dXJuIHRoaXM7IC8vIGZvciBjaGFpbmluZwp9OwovKioKICogRm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkKICogQGZ1bmN0aW9uCiAqIEBkZXByZWNhdGVkIHVzZSB7QGxpbmtjb2RlIFN3ZWVwQ29udGV4dCNhZGRIb2xlfSBpbnN0ZWFkCiAqLwoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUuQWRkSG9sZSA9IFN3ZWVwQ29udGV4dC5wcm90b3R5cGUuYWRkSG9sZTsKLyoqCiAqIEFkZCBzZXZlcmFsIGhvbGVzIHRvIHRoZSBjb25zdHJhaW50cwogKiBAZXhhbXBsZQogKiAgICAgIHZhciBzd2N0eCA9IG5ldyBwb2x5MnRyaS5Td2VlcENvbnRleHQoY29udG91cik7CiAqICAgICAgdmFyIGhvbGVzID0gWwogKiAgICAgICAgICBbIG5ldyBwb2x5MnRyaS5Qb2ludCgyMDAsIDIwMCksIG5ldyBwb2x5MnRyaS5Qb2ludCgyMDAsIDI1MCksIG5ldyBwb2x5MnRyaS5Qb2ludCgyNTAsIDI1MCkgXSwKICogICAgICAgICAgWyBuZXcgcG9seTJ0cmkuUG9pbnQoMzAwLCAzMDApLCBuZXcgcG9seTJ0cmkuUG9pbnQoMzAwLCAzNTApLCBuZXcgcG9seTJ0cmkuUG9pbnQoMzUwLCAzNTApIF0KICogICAgICBdOwogKiAgICAgIHN3Y3R4LmFkZEhvbGVzKGhvbGVzKTsKICogQGV4YW1wbGUKICogICAgICB2YXIgc3djdHggPSBuZXcgcG9seTJ0cmkuU3dlZXBDb250ZXh0KGNvbnRvdXIpOwogKiAgICAgIHZhciBob2xlcyA9IFsKICogICAgICAgICAgW3t4OjIwMCwgeToyMDB9LCB7eDoyMDAsIHk6MjUwfSwge3g6MjUwLCB5OjI1MH1dLAogKiAgICAgICAgICBbe3g6MzAwLCB5OjMwMH0sIHt4OjMwMCwgeTozNTB9LCB7eDozNTAsIHk6MzUwfV0KICogICAgICBdOwogKiAgICAgIHN3Y3R4LmFkZEhvbGVzKGhvbGVzKTsKICogQHB1YmxpYwogKiBAcGFyYW0ge0FycmF5LjxBcnJheS48WFk+Pn0gaG9sZXMgLSBhcnJheSBvZiBhcnJheSBvZiAiUG9pbnQgbGlrZSIgb2JqZWN0cyB3aXRoIHt4LHl9CiAqLwovLyBNZXRob2QgYWRkZWQgaW4gdGhlIEphdmFTY3JpcHQgdmVyc2lvbiAod2FzIG5vdCBwcmVzZW50IGluIHRoZSBjKysgdmVyc2lvbikKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUuYWRkSG9sZXMgPSBmdW5jdGlvbiAoaG9sZXMpIHsKICB2YXIgaSwKICAgICAgbGVuID0gaG9sZXMubGVuZ3RoOwoKICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgIHRoaXMuaW5pdEVkZ2VzKGhvbGVzW2ldKTsKICB9CgogIHRoaXMucG9pbnRzXyA9IHRoaXMucG9pbnRzXy5jb25jYXQuYXBwbHkodGhpcy5wb2ludHNfLCBob2xlcyk7CiAgcmV0dXJuIHRoaXM7IC8vIGZvciBjaGFpbmluZwp9OwovKioKICogQWRkIGEgU3RlaW5lciBwb2ludCB0byB0aGUgY29uc3RyYWludHMKICogQGV4YW1wbGUKICogICAgICB2YXIgc3djdHggPSBuZXcgcG9seTJ0cmkuU3dlZXBDb250ZXh0KGNvbnRvdXIpOwogKiAgICAgIHZhciBwb2ludCA9IG5ldyBwb2x5MnRyaS5Qb2ludCgxNTAsIDE1MCk7CiAqICAgICAgc3djdHguYWRkUG9pbnQocG9pbnQpOwogKiBAZXhhbXBsZQogKiAgICAgIHZhciBzd2N0eCA9IG5ldyBwb2x5MnRyaS5Td2VlcENvbnRleHQoY29udG91cik7CiAqICAgICAgc3djdHguYWRkUG9pbnQoe3g6MTUwLCB5OjE1MH0pOwogKiBAcHVibGljCiAqIEBwYXJhbSB7WFl9IHBvaW50IC0gYW55ICJQb2ludCBsaWtlIiBvYmplY3Qgd2l0aCB7eCx5fQogKi8KCgpTd2VlcENvbnRleHQucHJvdG90eXBlLmFkZFBvaW50ID0gZnVuY3Rpb24gKHBvaW50KSB7CiAgdGhpcy5wb2ludHNfLnB1c2gocG9pbnQpOwogIHJldHVybiB0aGlzOyAvLyBmb3IgY2hhaW5pbmcKfTsKLyoqCiAqIEZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5CiAqIEBmdW5jdGlvbgogKiBAZGVwcmVjYXRlZCB1c2Uge0BsaW5rY29kZSBTd2VlcENvbnRleHQjYWRkUG9pbnR9IGluc3RlYWQKICovCgoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5BZGRQb2ludCA9IFN3ZWVwQ29udGV4dC5wcm90b3R5cGUuYWRkUG9pbnQ7Ci8qKgogKiBBZGQgc2V2ZXJhbCBTdGVpbmVyIHBvaW50cyB0byB0aGUgY29uc3RyYWludHMKICogQGV4YW1wbGUKICogICAgICB2YXIgc3djdHggPSBuZXcgcG9seTJ0cmkuU3dlZXBDb250ZXh0KGNvbnRvdXIpOwogKiAgICAgIHZhciBwb2ludHMgPSBbCiAqICAgICAgICAgIG5ldyBwb2x5MnRyaS5Qb2ludCgxNTAsIDE1MCksCiAqICAgICAgICAgIG5ldyBwb2x5MnRyaS5Qb2ludCgyMDAsIDI1MCksCiAqICAgICAgICAgIG5ldyBwb2x5MnRyaS5Qb2ludCgyNTAsIDI1MCkKICogICAgICBdOwogKiAgICAgIHN3Y3R4LmFkZFBvaW50cyhwb2ludHMpOwogKiBAZXhhbXBsZQogKiAgICAgIHZhciBzd2N0eCA9IG5ldyBwb2x5MnRyaS5Td2VlcENvbnRleHQoY29udG91cik7CiAqICAgICAgc3djdHguYWRkUG9pbnRzKFt7eDoxNTAsIHk6MTUwfSwge3g6MjAwLCB5OjI1MH0sIHt4OjI1MCwgeToyNTB9XSk7CiAqIEBwdWJsaWMKICogQHBhcmFtIHtBcnJheS48WFk+fSBwb2ludHMgLSBhcnJheSBvZiAiUG9pbnQgbGlrZSIgb2JqZWN0IHdpdGgge3gseX0KICovCi8vIE1ldGhvZCBhZGRlZCBpbiB0aGUgSmF2YVNjcmlwdCB2ZXJzaW9uICh3YXMgbm90IHByZXNlbnQgaW4gdGhlIGMrKyB2ZXJzaW9uKQoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5hZGRQb2ludHMgPSBmdW5jdGlvbiAocG9pbnRzKSB7CiAgdGhpcy5wb2ludHNfID0gdGhpcy5wb2ludHNfLmNvbmNhdChwb2ludHMpOwogIHJldHVybiB0aGlzOyAvLyBmb3IgY2hhaW5pbmcKfTsKLyoqCiAqIFRyaWFuZ3VsYXRlIHRoZSBwb2x5Z29uIHdpdGggaG9sZXMgYW5kIFN0ZWluZXIgcG9pbnRzLgogKiBEbyB0aGlzIEFGVEVSIHlvdSd2ZSBhZGRlZCB0aGUgcG9seWxpbmUsIGhvbGVzLCBhbmQgU3RlaW5lciBwb2ludHMKICogQGV4YW1wbGUKICogICAgICB2YXIgc3djdHggPSBuZXcgcG9seTJ0cmkuU3dlZXBDb250ZXh0KGNvbnRvdXIpOwogKiAgICAgIHN3Y3R4LnRyaWFuZ3VsYXRlKCk7CiAqICAgICAgdmFyIHRyaWFuZ2xlcyA9IHN3Y3R4LmdldFRyaWFuZ2xlcygpOwogKiBAcHVibGljCiAqLwovLyBTaG9ydGN1dCBtZXRob2QgZm9yIHN3ZWVwLnRyaWFuZ3VsYXRlKFN3ZWVwQ29udGV4dCkuCi8vIE1ldGhvZCBhZGRlZCBpbiB0aGUgSmF2YVNjcmlwdCB2ZXJzaW9uICh3YXMgbm90IHByZXNlbnQgaW4gdGhlIGMrKyB2ZXJzaW9uKQoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUudHJpYW5ndWxhdGUgPSBmdW5jdGlvbiAoKSB7CiAgc3dlZXAudHJpYW5ndWxhdGUodGhpcyk7CiAgcmV0dXJuIHRoaXM7IC8vIGZvciBjaGFpbmluZwp9OwovKioKICogR2V0IHRoZSBib3VuZGluZyBib3ggb2YgdGhlIHByb3ZpZGVkIGNvbnN0cmFpbnRzIChjb250b3VyLCBob2xlcyBhbmQgCiAqIFN0ZWludGVyIHBvaW50cykuIFdhcm5pbmcgOiB0aGVzZSB2YWx1ZXMgYXJlIG5vdCBhdmFpbGFibGUgaWYgdGhlIHRyaWFuZ3VsYXRpb24gCiAqIGhhcyBub3QgYmVlbiBkb25lIHlldC4KICogQHB1YmxpYwogKiBAcmV0dXJucyB7e21pbjpQb2ludCxtYXg6UG9pbnR9fSBvYmplY3Qgd2l0aCAnbWluJyBhbmQgJ21heCcgUG9pbnQKICovCi8vIE1ldGhvZCBhZGRlZCBpbiB0aGUgSmF2YVNjcmlwdCB2ZXJzaW9uICh3YXMgbm90IHByZXNlbnQgaW4gdGhlIGMrKyB2ZXJzaW9uKQoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUuZ2V0Qm91bmRpbmdCb3ggPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHsKICAgIG1pbjogdGhpcy5wbWluXywKICAgIG1heDogdGhpcy5wbWF4XwogIH07Cn07Ci8qKgogKiBHZXQgcmVzdWx0IG9mIHRyaWFuZ3VsYXRpb24uCiAqIFRoZSBvdXRwdXQgdHJpYW5nbGVzIGhhdmUgdmVydGljZXMgd2hpY2ggYXJlIHJlZmVyZW5jZXMKICogdG8gdGhlIGluaXRpYWwgaW5wdXQgcG9pbnRzIChub3QgY29waWVzKTogYW55IGN1c3RvbSBmaWVsZHMgaW4gdGhlCiAqIGluaXRpYWwgcG9pbnRzIGNhbiBiZSByZXRyaWV2ZWQgaW4gdGhlIG91dHB1dCB0cmlhbmdsZXMuCiAqIEBleGFtcGxlCiAqICAgICAgdmFyIHN3Y3R4ID0gbmV3IHBvbHkydHJpLlN3ZWVwQ29udGV4dChjb250b3VyKTsKICogICAgICBzd2N0eC50cmlhbmd1bGF0ZSgpOwogKiAgICAgIHZhciB0cmlhbmdsZXMgPSBzd2N0eC5nZXRUcmlhbmdsZXMoKTsKICogQGV4YW1wbGUKICogICAgICB2YXIgY29udG91ciA9IFt7eDoxMDAsIHk6MTAwLCBpZDoxfSwge3g6MTAwLCB5OjMwMCwgaWQ6Mn0sIHt4OjMwMCwgeTozMDAsIGlkOjN9XTsKICogICAgICB2YXIgc3djdHggPSBuZXcgcG9seTJ0cmkuU3dlZXBDb250ZXh0KGNvbnRvdXIpOwogKiAgICAgIHN3Y3R4LnRyaWFuZ3VsYXRlKCk7CiAqICAgICAgdmFyIHRyaWFuZ2xlcyA9IHN3Y3R4LmdldFRyaWFuZ2xlcygpOwogKiAgICAgIHR5cGVvZiB0cmlhbmdsZXNbMF0uZ2V0UG9pbnQoMCkuaWQKICogICAgICAvLyDihpIgIm51bWJlciIKICogQHB1YmxpYwogKiBAcmV0dXJucyB7YXJyYXk8VHJpYW5nbGU+fSAgIGFycmF5IG9mIHRyaWFuZ2xlcwogKi8KCgpTd2VlcENvbnRleHQucHJvdG90eXBlLmdldFRyaWFuZ2xlcyA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy50cmlhbmdsZXNfOwp9OwovKioKICogRm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkKICogQGZ1bmN0aW9uCiAqIEBkZXByZWNhdGVkIHVzZSB7QGxpbmtjb2RlIFN3ZWVwQ29udGV4dCNnZXRUcmlhbmdsZXN9IGluc3RlYWQKICovCgoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5HZXRUcmlhbmdsZXMgPSBTd2VlcENvbnRleHQucHJvdG90eXBlLmdldFRyaWFuZ2xlczsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tU3dlZXBDb250ZXh0IChwcml2YXRlIEFQSSkKCi8qKiBAcHJpdmF0ZSAqLwoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5mcm9udCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy5mcm9udF87Cn07Ci8qKiBAcHJpdmF0ZSAqLwoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUucG9pbnRDb3VudCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy5wb2ludHNfLmxlbmd0aDsKfTsKLyoqIEBwcml2YXRlICovCgoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5oZWFkID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0aGlzLmhlYWRfOwp9OwovKiogQHByaXZhdGUgKi8KCgpTd2VlcENvbnRleHQucHJvdG90eXBlLnNldEhlYWQgPSBmdW5jdGlvbiAocDEpIHsKICB0aGlzLmhlYWRfID0gcDE7Cn07Ci8qKiBAcHJpdmF0ZSAqLwoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUudGFpbCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy50YWlsXzsKfTsKLyoqIEBwcml2YXRlICovCgoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5zZXRUYWlsID0gZnVuY3Rpb24gKHAxKSB7CiAgdGhpcy50YWlsXyA9IHAxOwp9OwovKiogQHByaXZhdGUgKi8KCgpTd2VlcENvbnRleHQucHJvdG90eXBlLmdldE1hcCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdGhpcy5tYXBfOwp9OwovKiogQHByaXZhdGUgKi8KCgpTd2VlcENvbnRleHQucHJvdG90eXBlLmluaXRUcmlhbmd1bGF0aW9uID0gZnVuY3Rpb24gKCkgewogIHZhciB4bWF4ID0gdGhpcy5wb2ludHNfWzBdLng7CiAgdmFyIHhtaW4gPSB0aGlzLnBvaW50c19bMF0ueDsKICB2YXIgeW1heCA9IHRoaXMucG9pbnRzX1swXS55OwogIHZhciB5bWluID0gdGhpcy5wb2ludHNfWzBdLnk7IC8vIENhbGN1bGF0ZSBib3VuZHMKCiAgdmFyIGksCiAgICAgIGxlbiA9IHRoaXMucG9pbnRzXy5sZW5ndGg7CgogIGZvciAoaSA9IDE7IGkgPCBsZW47IGkrKykgewogICAgdmFyIHAgPSB0aGlzLnBvaW50c19baV07CiAgICAvKiBqc2hpbnQgZXhwcjp0cnVlICovCgogICAgcC54ID4geG1heCAmJiAoeG1heCA9IHAueCk7CiAgICBwLnggPCB4bWluICYmICh4bWluID0gcC54KTsKICAgIHAueSA+IHltYXggJiYgKHltYXggPSBwLnkpOwogICAgcC55IDwgeW1pbiAmJiAoeW1pbiA9IHAueSk7CiAgfQoKICB0aGlzLnBtaW5fID0gbmV3IHBvaW50KHhtaW4sIHltaW4pOwogIHRoaXMucG1heF8gPSBuZXcgcG9pbnQoeG1heCwgeW1heCk7CiAgdmFyIGR4ID0ga0FscGhhICogKHhtYXggLSB4bWluKTsKICB2YXIgZHkgPSBrQWxwaGEgKiAoeW1heCAtIHltaW4pOwogIHRoaXMuaGVhZF8gPSBuZXcgcG9pbnQoeG1heCArIGR4LCB5bWluIC0gZHkpOwogIHRoaXMudGFpbF8gPSBuZXcgcG9pbnQoeG1pbiAtIGR4LCB5bWluIC0gZHkpOyAvLyBTb3J0IHBvaW50cyBhbG9uZyB5LWF4aXMKCiAgdGhpcy5wb2ludHNfLnNvcnQocG9pbnQuY29tcGFyZSk7Cn07Ci8qKiBAcHJpdmF0ZSAqLwoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUuaW5pdEVkZ2VzID0gZnVuY3Rpb24gKHBvbHlsaW5lKSB7CiAgdmFyIGksCiAgICAgIGxlbiA9IHBvbHlsaW5lLmxlbmd0aDsKCiAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7CiAgICB0aGlzLmVkZ2VfbGlzdC5wdXNoKG5ldyBFZGdlKHBvbHlsaW5lW2ldLCBwb2x5bGluZVsoaSArIDEpICUgbGVuXSkpOwogIH0KfTsKLyoqIEBwcml2YXRlICovCgoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5nZXRQb2ludCA9IGZ1bmN0aW9uIChpbmRleCkgewogIHJldHVybiB0aGlzLnBvaW50c19baW5kZXhdOwp9OwovKiogQHByaXZhdGUgKi8KCgpTd2VlcENvbnRleHQucHJvdG90eXBlLmFkZFRvTWFwID0gZnVuY3Rpb24gKHRyaWFuZ2xlKSB7CiAgdGhpcy5tYXBfLnB1c2godHJpYW5nbGUpOwp9OwovKiogQHByaXZhdGUgKi8KCgpTd2VlcENvbnRleHQucHJvdG90eXBlLmxvY2F0ZU5vZGUgPSBmdW5jdGlvbiAocG9pbnQpIHsKICByZXR1cm4gdGhpcy5mcm9udF8ubG9jYXRlTm9kZShwb2ludC54KTsKfTsKLyoqIEBwcml2YXRlICovCgoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5jcmVhdGVBZHZhbmNpbmdGcm9udCA9IGZ1bmN0aW9uICgpIHsKICB2YXIgaGVhZDsKICB2YXIgbWlkZGxlOwogIHZhciB0YWlsOyAvLyBJbml0aWFsIHRyaWFuZ2xlCgogIHZhciB0cmlhbmdsZSQxID0gbmV3IHRyaWFuZ2xlKHRoaXMucG9pbnRzX1swXSwgdGhpcy50YWlsXywgdGhpcy5oZWFkXyk7CiAgdGhpcy5tYXBfLnB1c2godHJpYW5nbGUkMSk7CiAgaGVhZCA9IG5ldyBOb2RlKHRyaWFuZ2xlJDEuZ2V0UG9pbnQoMSksIHRyaWFuZ2xlJDEpOwogIG1pZGRsZSA9IG5ldyBOb2RlKHRyaWFuZ2xlJDEuZ2V0UG9pbnQoMCksIHRyaWFuZ2xlJDEpOwogIHRhaWwgPSBuZXcgTm9kZSh0cmlhbmdsZSQxLmdldFBvaW50KDIpKTsKICB0aGlzLmZyb250XyA9IG5ldyBhZHZhbmNpbmdmcm9udChoZWFkLCB0YWlsKTsKICBoZWFkLm5leHQgPSBtaWRkbGU7CiAgbWlkZGxlLm5leHQgPSB0YWlsOwogIG1pZGRsZS5wcmV2ID0gaGVhZDsKICB0YWlsLnByZXYgPSBtaWRkbGU7Cn07Ci8qKiBAcHJpdmF0ZSAqLwoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUucmVtb3ZlTm9kZSA9IGZ1bmN0aW9uIChub2RlKSB7Ly8gZG8gbm90aGluZwoKICAvKiBqc2hpbnQgdW51c2VkOmZhbHNlICovCn07Ci8qKiBAcHJpdmF0ZSAqLwoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUubWFwVHJpYW5nbGVUb05vZGVzID0gZnVuY3Rpb24gKHQpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IDM7ICsraSkgewogICAgaWYgKCF0LmdldE5laWdoYm9yKGkpKSB7CiAgICAgIHZhciBuID0gdGhpcy5mcm9udF8ubG9jYXRlUG9pbnQodC5wb2ludENXKHQuZ2V0UG9pbnQoaSkpKTsKCiAgICAgIGlmIChuKSB7CiAgICAgICAgbi50cmlhbmdsZSA9IHQ7CiAgICAgIH0KICAgIH0KICB9Cn07Ci8qKiBAcHJpdmF0ZSAqLwoKClN3ZWVwQ29udGV4dC5wcm90b3R5cGUucmVtb3ZlRnJvbU1hcCA9IGZ1bmN0aW9uICh0cmlhbmdsZSkgewogIHZhciBpLAogICAgICBtYXAgPSB0aGlzLm1hcF8sCiAgICAgIGxlbiA9IG1hcC5sZW5ndGg7CgogIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgaWYgKG1hcFtpXSA9PT0gdHJpYW5nbGUpIHsKICAgICAgbWFwLnNwbGljZShpLCAxKTsKICAgICAgYnJlYWs7CiAgICB9CiAgfQp9OwovKioKICogRG8gYSBkZXB0aCBmaXJzdCB0cmF2ZXJzYWwgdG8gY29sbGVjdCB0cmlhbmdsZXMKICogQHByaXZhdGUKICogQHBhcmFtIHtUcmlhbmdsZX0gdHJpYW5nbGUgc3RhcnQKICovCgoKU3dlZXBDb250ZXh0LnByb3RvdHlwZS5tZXNoQ2xlYW4gPSBmdW5jdGlvbiAodHJpYW5nbGUpIHsKICAvLyBOZXcgaW1wbGVtZW50YXRpb24gYXZvaWRzIHJlY3Vyc2l2ZSBjYWxscyBhbmQgdXNlIGEgbG9vcCBpbnN0ZWFkLgogIC8vIENmLiBpc3N1ZXMgIyA1NywgNjUgYW5kIDY5LgogIHZhciB0cmlhbmdsZXMgPSBbdHJpYW5nbGVdLAogICAgICB0LAogICAgICBpOwogIC8qIGpzaGludCBib3NzOnRydWUgKi8KCiAgd2hpbGUgKHQgPSB0cmlhbmdsZXMucG9wKCkpIHsKICAgIGlmICghdC5pc0ludGVyaW9yKCkpIHsKICAgICAgdC5zZXRJbnRlcmlvcih0cnVlKTsKICAgICAgdGhpcy50cmlhbmdsZXNfLnB1c2godCk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgaWYgKCF0LmNvbnN0cmFpbmVkX2VkZ2VbaV0pIHsKICAgICAgICAgIHRyaWFuZ2xlcy5wdXNoKHQuZ2V0TmVpZ2hib3IoaSkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfTsgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUV4cG9ydHMKCgp2YXIgc3dlZXBjb250ZXh0ID0gU3dlZXBDb250ZXh0OwoKdmFyIHJlcXVpcmUkJDAgPSBnZXRDanNFeHBvcnRGcm9tTmFtZXNwYWNlKHZlcnNpb24kMik7Cgp2YXIgcG9seTJ0cmkgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7CiAgLyoqCiAgICogUHVibGljIEFQSSBmb3IgcG9seTJ0cmkuanMKICAgKiBAbW9kdWxlIHBvbHkydHJpCiAgICovCgogIC8qKgogICAqIElmIHlvdSBhcmUgbm90IHVzaW5nIGEgbW9kdWxlIHN5c3RlbSAoZS5nLiBDb21tb25KUywgUmVxdWlyZUpTKSwgeW91IGNhbiBhY2Nlc3MgdGhpcyBsaWJyYXJ5CiAgICogYXMgYSBnbG9iYWwgdmFyaWFibGUgPGNvZGU+cG9seTJ0cmk8L2NvZGU+IGkuZS4gPGNvZGU+d2luZG93LnBvbHkydHJpPC9jb2RlPiBpbiBhIGJyb3dzZXIuCiAgICogQG5hbWUgcG9seTJ0cmkKICAgKiBAZ2xvYmFsCiAgICogQHB1YmxpYwogICAqIEB0eXBlIHttb2R1bGU6cG9seTJ0cml9CiAgICovCgogIHZhciBwcmV2aW91c1BvbHkydHJpID0gY29tbW9uanNHbG9iYWwucG9seTJ0cmk7CiAgLyoqCiAgICogRm9yIEJyb3dzZXIgKyAmbHQ7c2NyaXB0Jmd0OyA6CiAgICogcmV2ZXJ0cyB0aGUge0BsaW5rY29kZSBwb2x5MnRyaX0gZ2xvYmFsIG9iamVjdCB0byBpdHMgcHJldmlvdXMgdmFsdWUsCiAgICogYW5kIHJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIGluc3RhbmNlIGNhbGxlZC4KICAgKgogICAqIEBleGFtcGxlCiAgICogICAgICAgICAgICAgIHZhciBwID0gcG9seTJ0cmkubm9Db25mbGljdCgpOwogICAqIEBwdWJsaWMKICAgKiBAcmV0dXJuIHttb2R1bGU6cG9seTJ0cml9IGluc3RhbmNlIGNhbGxlZAogICAqLwogIC8vICh0aGlzIGZlYXR1cmUgaXMgbm90IGF1dG9tYXRpY2FsbHkgcHJvdmlkZWQgYnkgYnJvd3NlcmlmeSkuCgogIGV4cG9ydHMubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHsKICAgIGNvbW1vbmpzR2xvYmFsLnBvbHkydHJpID0gcHJldmlvdXNQb2x5MnRyaTsKICAgIHJldHVybiBleHBvcnRzOwogIH07CiAgLyoqCiAgICogcG9seTJ0cmkgbGlicmFyeSB2ZXJzaW9uCiAgICogQHB1YmxpYwogICAqIEBjb25zdCB7c3RyaW5nfQogICAqLwoKCiAgZXhwb3J0cy5WRVJTSU9OID0gcmVxdWlyZSQkMC52ZXJzaW9uOwogIC8qKgogICAqIEV4cG9ydHMgdGhlIHtAbGlua2NvZGUgUG9pbnRFcnJvcn0gY2xhc3MuCiAgICogQHB1YmxpYwogICAqIEB0eXBlZGVmIHtQb2ludEVycm9yfSBtb2R1bGU6cG9seTJ0cmkuUG9pbnRFcnJvcgogICAqIEBmdW5jdGlvbgogICAqLwoKICBleHBvcnRzLlBvaW50RXJyb3IgPSBwb2ludGVycm9yOwogIC8qKgogICAqIEV4cG9ydHMgdGhlIHtAbGlua2NvZGUgUG9pbnR9IGNsYXNzLgogICAqIEBwdWJsaWMKICAgKiBAdHlwZWRlZiB7UG9pbnR9IG1vZHVsZTpwb2x5MnRyaS5Qb2ludAogICAqIEBmdW5jdGlvbgogICAqLwoKICBleHBvcnRzLlBvaW50ID0gcG9pbnQ7CiAgLyoqCiAgICogRXhwb3J0cyB0aGUge0BsaW5rY29kZSBUcmlhbmdsZX0gY2xhc3MuCiAgICogQHB1YmxpYwogICAqIEB0eXBlZGVmIHtUcmlhbmdsZX0gbW9kdWxlOnBvbHkydHJpLlRyaWFuZ2xlCiAgICogQGZ1bmN0aW9uCiAgICovCgogIGV4cG9ydHMuVHJpYW5nbGUgPSB0cmlhbmdsZTsKICAvKioKICAgKiBFeHBvcnRzIHRoZSB7QGxpbmtjb2RlIFN3ZWVwQ29udGV4dH0gY2xhc3MuCiAgICogQHB1YmxpYwogICAqIEB0eXBlZGVmIHtTd2VlcENvbnRleHR9IG1vZHVsZTpwb2x5MnRyaS5Td2VlcENvbnRleHQKICAgKiBAZnVuY3Rpb24KICAgKi8KCiAgZXhwb3J0cy5Td2VlcENvbnRleHQgPSBzd2VlcGNvbnRleHQ7IC8vIEJhY2t3YXJkIGNvbXBhdGliaWxpdHkKCiAgLyoqCiAgICogQGZ1bmN0aW9uCiAgICogQGRlcHJlY2F0ZWQgdXNlIHtAbGlua2NvZGUgU3dlZXBDb250ZXh0I3RyaWFuZ3VsYXRlfSBpbnN0ZWFkCiAgICovCgogIGV4cG9ydHMudHJpYW5ndWxhdGUgPSBzd2VlcC50cmlhbmd1bGF0ZTsKICAvKioKICAgKiBAZGVwcmVjYXRlZCB1c2Uge0BsaW5rY29kZSBTd2VlcENvbnRleHQjdHJpYW5ndWxhdGV9IGluc3RlYWQKICAgKiBAcHJvcGVydHkge2Z1bmN0aW9ufSBUcmlhbmd1bGF0ZSAtIHVzZSB7QGxpbmtjb2RlIFN3ZWVwQ29udGV4dCN0cmlhbmd1bGF0ZX0gaW5zdGVhZAogICAqLwoKICBleHBvcnRzLnN3ZWVwID0gewogICAgVHJpYW5ndWxhdGU6IHN3ZWVwLnRyaWFuZ3VsYXRlCiAgfTsKfSk7CnBvbHkydHJpLm5vQ29uZmxpY3Q7CnBvbHkydHJpLlZFUlNJT047CnBvbHkydHJpLlBvaW50RXJyb3I7CnZhciBwb2x5MnRyaV80ID0gcG9seTJ0cmkuUG9pbnQ7CnBvbHkydHJpLlRyaWFuZ2xlOwp2YXIgcG9seTJ0cmlfNiA9IHBvbHkydHJpLlN3ZWVwQ29udGV4dDsKcG9seTJ0cmkudHJpYW5ndWxhdGU7CnBvbHkydHJpLnN3ZWVwOwoKLyoqCiAqIEBhdXRob3Igeno4NSAvIGh0dHA6Ly93d3cubGFiNGdhbWVzLm5ldC96ejg1L2Jsb2cKICovCnZhciBTaGFwZVV0aWxzID0gewogIC8vIGNhbGN1bGF0ZSBhcmVhIG9mIHRoZSBjb250b3VyIHBvbHlnb24KICBhcmVhOiBmdW5jdGlvbiBhcmVhKGNvbnRvdXIpIHsKICAgIHZhciBuID0gY29udG91ci5sZW5ndGg7CiAgICB2YXIgYSA9IDAuMDsKCiAgICBmb3IgKHZhciBwID0gbiAtIDEsIHEgPSAwOyBxIDwgbjsgcCA9IHErKykgewogICAgICBhICs9IGNvbnRvdXJbcF0ueCAqIGNvbnRvdXJbcV0ueSAtIGNvbnRvdXJbcV0ueCAqIGNvbnRvdXJbcF0ueTsKICAgIH0KCiAgICByZXR1cm4gYSAqIDAuNTsKICB9LAogIGlzQ2xvY2tXaXNlOiBmdW5jdGlvbiBpc0Nsb2NrV2lzZShwdHMpIHsKICAgIHJldHVybiBTaGFwZVV0aWxzLmFyZWEocHRzKSA8IDA7CiAgfSwKICB0cmlhbmd1bGF0ZVNoYXBlOiBmdW5jdGlvbiB0cmlhbmd1bGF0ZVNoYXBlKGNvbnRvdXIsIGhvbGVzKSB7CiAgICB2YXIgdmVydGljZXMgPSBbXTsgLy8gZmxhdCBhcnJheSBvZiB2ZXJ0aWNlcyBsaWtlIFsgeDAseTAsIHgxLHkxLCB4Mix5MiwgLi4uIF0KCiAgICB2YXIgaG9sZUluZGljZXMgPSBbXTsgLy8gYXJyYXkgb2YgaG9sZSBpbmRpY2VzCgogICAgdmFyIGZhY2VzID0gW107IC8vIGZpbmFsIGFycmF5IG9mIHZlcnRleCBpbmRpY2VzIGxpa2UgWyBbIGEsYixkIF0sIFsgYixjLGQgXSBdCgogICAgcmVtb3ZlRHVwRW5kUHRzKGNvbnRvdXIpOwogICAgYWRkQ29udG91cih2ZXJ0aWNlcywgY29udG91cik7IC8vCgogICAgdmFyIGhvbGVJbmRleCA9IGNvbnRvdXIubGVuZ3RoOwogICAgaG9sZXMuZm9yRWFjaChyZW1vdmVEdXBFbmRQdHMpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaG9sZXMubGVuZ3RoOyBpKyspIHsKICAgICAgaG9sZUluZGljZXMucHVzaChob2xlSW5kZXgpOwogICAgICBob2xlSW5kZXggKz0gaG9sZXNbaV0ubGVuZ3RoOwogICAgICBhZGRDb250b3VyKHZlcnRpY2VzLCBob2xlc1tpXSk7CiAgICB9IC8vCgoKICAgIHZhciB0cmlhbmdsZXMgPSBlYXJjdXRfMSh2ZXJ0aWNlcywgaG9sZUluZGljZXMpOyAvLwoKICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCB0cmlhbmdsZXMubGVuZ3RoOyBfaSArPSAzKSB7CiAgICAgIGZhY2VzLnB1c2godHJpYW5nbGVzLnNsaWNlKF9pLCBfaSArIDMpKTsKICAgIH0KCiAgICByZXR1cm4gZmFjZXM7CiAgfSwKICAvLyB5dW55YW5nIHRvZG8KICB0cmlhbmd1bGF0ZVNoYXBlUG9seTJ0cmk6IGZ1bmN0aW9uIHRyaWFuZ3VsYXRlU2hhcGVQb2x5MnRyaShjb250b3VyLCBob2xlcykgewogICAgcmVtb3ZlRHVwRW5kUHRzKGNvbnRvdXIpOwogICAgaG9sZXMuZm9yRWFjaChyZW1vdmVEdXBFbmRQdHMpOwogICAgdmFyIHBvaW50TWFwID0ge307CiAgICB2YXIgY291bnQgPSAwOwogICAgdmFyIHBvaW50cyA9IG1ha2VQb2ludHMoY29udG91cik7CiAgICB2YXIgc3dlZXBDb250ZXh0ID0gbmV3IHBvbHkydHJpXzYocG9pbnRzKTsKCiAgICBmb3IgKHZhciBpID0gMCwgaWwgPSBob2xlcy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7CiAgICAgIHBvaW50cyA9IG1ha2VQb2ludHMoaG9sZXNbaV0pOwogICAgICBzd2VlcENvbnRleHQuYWRkSG9sZShwb2ludHMpOwogICAgICBwb2ludHMgPSBwb2ludHMuY29uY2F0KHBvaW50cyk7CiAgICB9CgogICAgdmFyIG9iamVjdCA9IHN3ZWVwQ29udGV4dC50cmlhbmd1bGF0ZSgpOwogICAgdmFyIHRyaWFuZ2xlcyA9IG9iamVjdC50cmlhbmdsZXNfOwogICAgdmFyIGE7CiAgICB2YXIgYjsKICAgIHZhciBjOwogICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgIGZvciAodmFyIF9pMiA9IDAsIF9pbCA9IHRyaWFuZ2xlcy5sZW5ndGg7IF9pMiA8IF9pbDsgX2kyKyspIHsKICAgICAgcG9pbnRzID0gdHJpYW5nbGVzW19pMl0ucG9pbnRzXzsKICAgICAgYSA9IHBvaW50TWFwW3BvaW50c1swXS54ICsgJywnICsgcG9pbnRzWzBdLnldOwogICAgICBiID0gcG9pbnRNYXBbcG9pbnRzWzFdLnggKyAnLCcgKyBwb2ludHNbMV0ueV07CiAgICAgIGMgPSBwb2ludE1hcFtwb2ludHNbMl0ueCArICcsJyArIHBvaW50c1syXS55XTsKICAgICAgcmVzdWx0LnB1c2goW2EsIGIsIGNdKTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwoKICAgIGZ1bmN0aW9uIG1ha2VQb2ludHMoYSkgewogICAgICB2YXIgaWwgPSBhLmxlbmd0aDsKICAgICAgdmFyIHBvaW50cyA9IFtdOwoKICAgICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgaWw7IF9pMysrKSB7CiAgICAgICAgcG9pbnRzLnB1c2gobmV3IHBvbHkydHJpXzQoYVtfaTNdLngsIGFbX2kzXS55KSk7CiAgICAgICAgcG9pbnRNYXBbYVtfaTNdLnggKyAnLCcgKyBhW19pM10ueV0gPSBjb3VudDsKICAgICAgICBjb3VudCsrOwogICAgICB9CgogICAgICByZXR1cm4gcG9pbnRzOwogICAgfQogIH0sCiAgdHJpYW5ndWxhdGVTaGFwZVRlc3N5OiBmdW5jdGlvbiB0cmlhbmd1bGF0ZVNoYXBlVGVzc3koY29udG91ciwgaG9sZXMsIHRlc3N5KSB7CiAgICByZW1vdmVEdXBFbmRQdHMoY29udG91cik7CiAgICBob2xlcy5mb3JFYWNoKHJlbW92ZUR1cEVuZFB0cyk7CiAgICB2YXIgdHJpYW5nbGVzID0gW107CiAgICB2YXIgcG9pbnRNYXAgPSB7fTsKICAgIHZhciBjb3VudCA9IDA7IC8vIGxpYnRlc3Mgd2lsbCB0YWtlIDNkIHZlcnRzIGFuZCBmbGF0dGVuIHRvIGEgcGxhbmUgZm9yIHRlc3NlbGF0aW9uCiAgICAvLyBzaW5jZSBvbmx5IGRvaW5nIDJkIHRlc3NlbGF0aW9uIGhlcmUsIHByb3ZpZGUgej0xIG5vcm1hbCB0byBza2lwCiAgICAvLyBpdGVyYXRpbmcgb3ZlciB2ZXJ0cyBvbmx5IHRvIGdldCB0aGUgc2FtZSBhbnN3ZXIuCiAgICAvLyBjb21tZW50IG91dCB0byB0ZXN0IG5vcm1hbC1nZW5lcmF0aW9uIGNvZGUKCiAgICB0ZXNzeS5nbHVUZXNzTm9ybWFsKDAsIDAsIDEpOwogICAgdGVzc3kuZ2x1VGVzc0JlZ2luUG9seWdvbih0cmlhbmdsZXMpOwogICAgdmFyIHBvaW50cyA9IG1ha2VQb2ludHMoY29udG91cik7CgogICAgZm9yICh2YXIgaSA9IDAsIGlsID0gaG9sZXMubGVuZ3RoOyBpIDwgaWw7IGkrKykgewogICAgICBwb2ludHMgPSBtYWtlUG9pbnRzKGhvbGVzW2ldKTsKICAgIH0KCiAgICB0ZXNzeS5nbHVUZXNzRW5kUG9seWdvbigpOwogICAgZGVidWcubG9nKCd0ZXNzeSB0ZXNzZWxhdGlvbicpOwogICAgdmFyIGE7CiAgICB2YXIgYjsKICAgIHZhciBjOwogICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgIGZvciAodmFyIF9pNCA9IDAsIF9pbDIgPSB0cmlhbmdsZXMubGVuZ3RoOyBfaTQgPCBfaWwyOyBfaTQgKz0gNikgewogICAgICBhID0gcG9pbnRNYXBbdHJpYW5nbGVzW19pNF0gKyAnLCcgKyB0cmlhbmdsZXNbX2k0ICsgMV1dOwogICAgICBiID0gcG9pbnRNYXBbdHJpYW5nbGVzW19pNCArIDJdICsgJywnICsgdHJpYW5nbGVzW19pNCArIDNdXTsKICAgICAgYyA9IHBvaW50TWFwW3RyaWFuZ2xlc1tfaTQgKyA0XSArICcsJyArIHRyaWFuZ2xlc1tfaTQgKyA1XV07CiAgICAgIHJlc3VsdC5wdXNoKFthLCBiLCBjXSk7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKCiAgICBmdW5jdGlvbiBtYWtlUG9pbnRzKGEpIHsKICAgICAgdmFyIGlsID0gYS5sZW5ndGg7CiAgICAgIHRlc3N5LmdsdVRlc3NCZWdpbkNvbnRvdXIoKTsKCiAgICAgIGZvciAodmFyIF9pNSA9IDA7IF9pNSA8IGlsOyBfaTUrKykgewogICAgICAgIHZhciBjb29yZGluYXRlcyA9IFthW19pNV0ueCwgYVtfaTVdLnksIDBdOwogICAgICAgIHRlc3N5LmdsdVRlc3NWZXJ0ZXgoY29vcmRpbmF0ZXMsIGNvb3JkaW5hdGVzKTsKICAgICAgICBwb2ludE1hcFthW19pNV0ueCArICcsJyArIGFbX2k1XS55XSA9IGNvdW50OwogICAgICAgIGNvdW50Kys7CiAgICAgIH0KCiAgICAgIHRlc3N5LmdsdVRlc3NFbmRDb250b3VyKCk7CiAgICAgIHJldHVybiBwb2ludHM7CiAgICB9CiAgfQp9OwoKZnVuY3Rpb24gcmVtb3ZlRHVwRW5kUHRzKHBvaW50cykgewogIHZhciBsID0gcG9pbnRzLmxlbmd0aDsKCiAgaWYgKGwgPiAyICYmIHBvaW50c1tsIC0gMV0uZXF1YWxzKHBvaW50c1swXSkpIHsKICAgIHBvaW50cy5wb3AoKTsKICB9Cn0KCmZ1bmN0aW9uIGFkZENvbnRvdXIodmVydGljZXMsIGNvbnRvdXIpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbnRvdXIubGVuZ3RoOyBpKyspIHsKICAgIHZlcnRpY2VzLnB1c2goY29udG91cltpXS54KTsKICAgIHZlcnRpY2VzLnB1c2goY29udG91cltpXS55KTsKICB9Cn0KCi8vIGNvbnN0IHBvbHkydHJpID0gJyc7CgpmdW5jdGlvbiBFeHRydWRlQnVmZmVyR2VvbWV0cnkoc2hhcGVzLCBvcHRpb25zKSB7CiAgQnVmZmVyR2VvbWV0cnkuY2FsbCh0aGlzKTsKICB0aGlzLnR5cGUgPSAnRXh0cnVkZUJ1ZmZlckdlb21ldHJ5JzsKICB0aGlzLnBhcmFtZXRlcnMgPSB7CiAgICBzaGFwZXM6IHNoYXBlcywKICAgIG9wdGlvbnM6IG9wdGlvbnMKICB9OyAvLyBleHRydWRlU2NhbGUgIGRpc2FibGVkLCB5dW55YW5nCgogIG9wdGlvbnMuZXh0cnVkZVNjYWxlID0gMTsKICBzaGFwZXMgPSBBcnJheS5pc0FycmF5KHNoYXBlcykgPyBzaGFwZXMgOiBbc2hhcGVzXTsKICB2YXIgc2NvcGUgPSB0aGlzOwogIHZhciB2ZXJ0aWNlc0FycmF5ID0gW107CiAgdmFyIHV2QXJyYXkgPSBbXTsKICB2YXIgY3VydmVTZWdtZW50c0FkYXB0aXZlID0gb3B0aW9ucy5jdXJ2ZVNlZ21lbnRzQWRhcHRpdmUgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuY3VydmVTZWdtZW50c0FkYXB0aXZlIDogMC4xOwogIHZhciBzaGFwZXNFeHRyYWN0ZWRQb2ludHMgPSBuZXcgQXJyYXkoc2hhcGVzLmxlbmd0aCk7CgogIGZvciAodmFyIGkgPSAwLCBsID0gc2hhcGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgdmFyIHNoYXBlID0gc2hhcGVzW2ldOwogICAgc2hhcGUuaXNEZWZvcm1hdGlvbk9OID0gb3B0aW9ucy5pc0RlZm9ybWF0aW9uT047CiAgICBzaGFwZXNFeHRyYWN0ZWRQb2ludHNbaV0gPSBzaGFwZS5leHRyYWN0UG9pbnRzQWRhcHRpdmVseShjdXJ2ZVNlZ21lbnRzQWRhcHRpdmUpOwogIH0KCiAgdmFyIHNoYXBlc19jZW50ZXIgPSBuZXcgVmVjdG9yMigwLCAwKTsKICB2YXIgYm91bmRpbmdib3hfZm9yX3NoYXBlcyA9IG5ldyBCb3gyKCk7CgogIGZvciAodmFyIF9pID0gMCwgX2wgPSBzaGFwZXMubGVuZ3RoOyBfaSA8IF9sOyBfaSsrKSB7CiAgICB2YXIgX3NoYXBlID0gc2hhcGVzW19pXTsKICAgIHZhciByZXQgPSBjYWxjdWxhdGVTaGFwZUNlbnRlcihfc2hhcGUsIHNoYXBlc0V4dHJhY3RlZFBvaW50c1tfaV0pOwogICAgdmFyIHNoYXBlX2NlbnRlcl9yZXQgPSByZXRbMF07CiAgICB2YXIgYm91bmRpbmdib3ggPSByZXRbMV07CiAgICBzaGFwZXNfY2VudGVyLnggPSBzaGFwZXNfY2VudGVyLnggKyBzaGFwZV9jZW50ZXJfcmV0Lng7CiAgICBzaGFwZXNfY2VudGVyLnkgPSBzaGFwZXNfY2VudGVyLnkgKyBzaGFwZV9jZW50ZXJfcmV0Lnk7CiAgICBib3VuZGluZ2JveF9mb3Jfc2hhcGVzLnVuaW9uKGJvdW5kaW5nYm94KTsKICB9IC8vIHVwZGF0ZSBleHRydWRlUGF0aAoKCiAgaWYgKG9wdGlvbnMuZXh0cnVkZVBhdGggIT0gdW5kZWZpbmVkKSB7CiAgICB2YXIgdmxlbiA9IG9wdGlvbnMuZXh0cnVkZVBhdGgucG9pbnRzLmxlbmd0aDsKCiAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCB2bGVuOyBfaTIrKykgewogICAgICB2YXIgdGVtcCA9IG9wdGlvbnMuZXh0cnVkZVBhdGgucG9pbnRzW19pMl07CgogICAgICBvcHRpb25zLmV4dHJ1ZGVQYXRoLnBvaW50c1tfaTJdLnNldCh0ZW1wLnggKyBzaGFwZXNfY2VudGVyLngsIHRlbXAueSArIHNoYXBlc19jZW50ZXIueSwgdGVtcC56KTsKICAgIH0KICB9CgogIHZhciBjaGFyVmVydGV4R3JvdXAgPSBbXTsKICB2YXIgY2hhckNvdW50ID0gMDsKCiAgZm9yICh2YXIgX2kzID0gMCwgX2wyID0gc2hhcGVzLmxlbmd0aDsgX2kzIDwgX2wyOyBfaTMrKykgewogICAgaWYgKG9wdGlvbnMuY2hhckZsYWdbY2hhckNvdW50XSA9PSBfaTMpIHsKICAgICAgY2hhckNvdW50ID0gY2hhckNvdW50ICsgMTsKICAgICAgY2hhclZlcnRleEdyb3VwLnB1c2godmVydGljZXNBcnJheS5sZW5ndGggLyAzKTsKICAgIH0KCiAgICB2YXIgX3NoYXBlMiA9IHNoYXBlc1tfaTNdOwogICAgYWRkU2hhcGUoX3NoYXBlMiwgc2hhcGVzX2NlbnRlciwgYm91bmRpbmdib3hfZm9yX3NoYXBlcywgc2hhcGVzRXh0cmFjdGVkUG9pbnRzW19pM10pOwogIH0KCiAgY2hhclZlcnRleEdyb3VwLnB1c2godmVydGljZXNBcnJheS5sZW5ndGggLyAzKTsKCiAgZm9yICh2YXIgX2k0ID0gMDsgX2k0IDwgdmVydGljZXNBcnJheS5sZW5ndGggLyAzOyBfaTQrKykgewogICAgZm9yICh2YXIgaiA9IDA7IGogPCBjaGFyVmVydGV4R3JvdXAubGVuZ3RoIC0gMTsgaisrKSB7CiAgICAgIGlmIChfaTQgPj0gY2hhclZlcnRleEdyb3VwW2pdICYmIF9pNCA8IGNoYXJWZXJ0ZXhHcm91cFtqICsgMV0pIHsKICAgICAgICB0aGlzLmNoYXJWZXJ0ZXhGbGFnQXJyYXkucHVzaChqKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0gLy8gYnVpbGQgZ2VvbWV0cnkKCgogIHRoaXMuYWRkQXR0cmlidXRlKCdwb3NpdGlvbicsIG5ldyBGbG9hdDMyQnVmZmVyQXR0cmlidXRlKHZlcnRpY2VzQXJyYXksIDMpKTsKICB0aGlzLmFkZEF0dHJpYnV0ZSgndXYnLCBuZXcgRmxvYXQzMkJ1ZmZlckF0dHJpYnV0ZSh1dkFycmF5LCAyKSk7CgogIGlmIChvcHRpb25zLnNoYWRpbmdTbW9vdGhBbmdsZSA9PSAwKSB7CiAgICB0aGlzLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7CiAgfSBlbHNlIHsKICAgIHRoaXMuY29tcHV0ZVZlcnRleE5vcm1hbHM0VGV4dGdlb21ldHJ5WXVueWFuZyhvcHRpb25zLnNoYWRpbmdTbW9vdGhBbmdsZSk7CiAgfQoKICB0aGlzLm1lcmdlU2FtZVZlcnRleCgpOwogIHRoaXMuY2VudGVyKCk7CiAgdGhpcy5wZXJDaGFyQ2FsY3VsYXRpb24oKTsKCiAgZnVuY3Rpb24gY2FsY3VsYXRlU2hhcGVDZW50ZXIoc2hhcGUsIHNoYXBlUG9pbnRzKSB7CiAgICB2YXIgdmVydGljZXMgPSBzaGFwZVBvaW50cy5zaGFwZTsKICAgIHZhciBib3VuZGluZ2JveCA9IG5ldyBCb3gyKCk7CiAgICBib3VuZGluZ2JveC5zZXRGcm9tUG9pbnRzKHZlcnRpY2VzKTsKICAgIHZhciB2bGVuID0gdmVydGljZXMubGVuZ3RoOwogICAgdmFyIHNoYXBlQ2VudGVyID0gbmV3IFZlY3RvcjIoKTsKICAgIHZhciB3ZWlnaHQgPSAxLjAgLyB2bGVuOyAvLyDorqHnrpdiYWNrIGZhY2luZyB2ZXJ0aWNlc+eahOS4reW/g+eCuQoKICAgIGZvciAodmFyIF9pNSA9IDA7IF9pNSA8IHZsZW47IF9pNSsrKSB7CiAgICAgIHNoYXBlQ2VudGVyLnggKz0gdmVydGljZXNbX2k1XS54ICogd2VpZ2h0OwogICAgICBzaGFwZUNlbnRlci55ICs9IHZlcnRpY2VzW19pNV0ueSAqIHdlaWdodDsKICAgIH0KCiAgICByZXR1cm4gW3NoYXBlQ2VudGVyLCBib3VuZGluZ2JveF07CiAgfSAvLyB5dW55YW5nCgoKICBmdW5jdGlvbiBsYXBsYWNpYW5TbW9vdGgodmVydGljZXMsIGl0ZXJhdGlvbl9udW1iKSB7CiAgICBpZiAoaXRlcmF0aW9uX251bWIgPT0gMCkgcmV0dXJuOwoKICAgIGZvciAodmFyIGl0ID0gMDsgaXQgPCBpdGVyYXRpb25fbnVtYjsgaXQrKykgewogICAgICAvLyBjb25zdCB2ZXJ0aWNlc19vbGQgPSBbXS5jb25jYXQodmVydGljZXMpOy8v5rex5ou36LSd5pWw57uECiAgICAgIHZhciB2ZXJ0aWNlc19vbGQgPSBbXTsKCiAgICAgIGZvciAodmFyIF9pNiA9IDA7IF9pNiA8IHZlcnRpY2VzLmxlbmd0aDsgX2k2KyspIHsKICAgICAgICB2YXIgdmVjMl90ZW1wID0gbmV3IFZlY3RvcjIoKTsKICAgICAgICB2ZWMyX3RlbXAuY29weSh2ZXJ0aWNlc1tfaTZdKTsKICAgICAgICB2ZXJ0aWNlc19vbGQucHVzaCh2ZWMyX3RlbXApOwogICAgICB9CgogICAgICBmb3IgKHZhciBfaTcgPSAwLCBpbCA9IHZlcnRpY2VzX29sZC5sZW5ndGgsIF9qID0gaWwgLSAxLCBrID0gX2k3ICsgMTsgX2k3IDwgaWw7IF9pNysrLCBfaisrLCBrKyspIHsKICAgICAgICBpZiAoX2ogPT09IGlsKSBfaiA9IDA7CiAgICAgICAgaWYgKGsgPT09IGlsKSBrID0gMDsKICAgICAgICB2ZXJ0aWNlc1tfaTddLnggPSAwLjUgKiAodmVydGljZXNfb2xkW19qXS54ICsgdmVydGljZXNfb2xkW2tdLngpOwogICAgICAgIHZlcnRpY2VzW19pN10ueSA9IDAuNSAqICh2ZXJ0aWNlc19vbGRbX2pdLnkgKyB2ZXJ0aWNlc19vbGRba10ueSk7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGFkZFNoYXBlKHNoYXBlLCBzaGFwZXNfY2VudGVyLCBib3VuZGluZ2JveF9mb3Jfc2hhcGVzLCBzaGFwZVBvaW50cykgewogICAgdmFyIHBsYWNlaG9sZGVyID0gW107CiAgICB2YXIgc3RlcHMgPSBvcHRpb25zLnN0ZXBzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnN0ZXBzIDogMTsKICAgIHZhciBkZXB0aCA9IG9wdGlvbnMuZGVwdGggIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuZGVwdGggOiAxMDA7CiAgICB2YXIgc2NhbGUgPSBvcHRpb25zLnNjYWxlICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnNjYWxlIDogMDsgLy8g5Z+65LqO6Iao6IOA5ZCR6YeP6L+b6KGM6Iao6IOA5ZKM57yp5bCPCgogICAgdmFyIHRyaWFuZ3VsYXRlTWV0aG9kID0gb3B0aW9ucy50cmlhbmd1bGF0ZU1ldGhvZCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy50cmlhbmd1bGF0ZU1ldGhvZCA6ICdlYXJjdXQnOwogICAgdmFyIGJldmVsRW5hYmxlZCA9IG9wdGlvbnMuYmV2ZWxFbmFibGVkICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmJldmVsRW5hYmxlZCA6IHRydWU7CiAgICB2YXIgYmV2ZWxUaGlja25lc3MgPSBvcHRpb25zLmJldmVsVGhpY2tuZXNzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmJldmVsVGhpY2tuZXNzIDogNjsKICAgIHZhciBiZXZlbFNpemUgPSBvcHRpb25zLmJldmVsU2l6ZSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5iZXZlbFNpemUgOiBiZXZlbFRoaWNrbmVzcyAtIDI7CiAgICB2YXIgYmV2ZWxTZWdtZW50cyA9IG9wdGlvbnMuYmV2ZWxTZWdtZW50cyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5iZXZlbFNlZ21lbnRzIDogMzsKICAgIHZhciBiZXZlbFR5cGUgPSBvcHRpb25zLmJldmVsVHlwZSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5iZXZlbFR5cGUgOiAncXVhZF9lbGxpcHNlJzsKICAgIHZhciBiZXZlbEJhY2tFbmFibGVkID0gZmFsc2U7IC8vIOiDjOmdouWAkuinkuS4jeWGjeaUr+aMgeS6hgoKICAgIHZhciBleHRydWRlUGF0aCA9IG9wdGlvbnMuZXh0cnVkZVBhdGg7CiAgICB2YXIgZXh0cnVkZVNjYWxlID0gb3B0aW9ucy5leHRydWRlU2NhbGU7CiAgICB2YXIgdXZnZW4gPSBvcHRpb25zLlVWR2VuZXJhdG9yICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLlVWR2VuZXJhdG9yIDogV29ybGRVVkdlbmVyYXRvcjsKICAgIHZhciBfb3B0aW9ucyRleHRydWRlT2Zmc2UgPSBvcHRpb25zLmV4dHJ1ZGVPZmZzZXRYLAogICAgICAgIGV4dHJ1ZGVPZmZzZXRYID0gX29wdGlvbnMkZXh0cnVkZU9mZnNlID09PSB2b2lkIDAgPyAwIDogX29wdGlvbnMkZXh0cnVkZU9mZnNlOwogICAgdmFyIF9vcHRpb25zJGV4dHJ1ZGVPZmZzZTIgPSBvcHRpb25zLmV4dHJ1ZGVPZmZzZXRZLAogICAgICAgIGV4dHJ1ZGVPZmZzZXRZID0gX29wdGlvbnMkZXh0cnVkZU9mZnNlMiA9PT0gdm9pZCAwID8gMCA6IF9vcHRpb25zJGV4dHJ1ZGVPZmZzZTI7CiAgICB2YXIgbGFwbGFjaWFuSXRlcmF0aW9uTnVtYiA9IG9wdGlvbnMubGFwbGFjaWFuSXRlcmF0aW9uTnVtYjsKICAgIHZhciB1dlNpZGVXYWxsTGVuZ3RoT2Zmc2V0ID0gMDsgLy8gZGVwcmVjYXRlZCBvcHRpb25zCgogICAgaWYgKG9wdGlvbnMuYW1vdW50ICE9PSB1bmRlZmluZWQpIHsKICAgICAgY29uc29sZS53YXJuKCdUSFJFRS5FeHRydWRlQnVmZmVyR2VvbWV0cnk6IGFtb3VudCBoYXMgYmVlbiByZW5hbWVkIHRvIGRlcHRoLicpOwogICAgICBvcHRpb25zLmFtb3VudCwgX3JlYWRPbmx5RXJyb3IoImRlcHRoIik7CiAgICB9IC8vIGNvbnN0IHNocmlua2VkU2hhcGUgPSBvcHRpb25zLnNocmlua2VkU2hhcGUhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5zaHJpbmtlZFNoYXBlIDogc2hhcGU7CiAgICAvLwoKCiAgICB2YXIgZXh0cnVkZVB0czsKICAgIHZhciBleHRydWRlQnlQYXRoID0gZmFsc2U7CiAgICB2YXIgYm91bmRpbmdib3ggPSBuZXcgQm94MigpOwoKICAgIGlmIChleHRydWRlUGF0aCkgewogICAgICBleHRydWRlUHRzID0gZXh0cnVkZVBhdGguZ2V0U3BhY2VkUG9pbnRzKHN0ZXBzKTsKICAgICAgZXh0cnVkZUJ5UGF0aCA9IHRydWU7CiAgICAgIF9yZWFkT25seUVycm9yKCJiZXZlbEVuYWJsZWQiKTsgLy8gYmV2ZWxzIG5vdCBzdXBwb3J0ZWQgZm9yIHBhdGggZXh0cnVzaW9uCiAgICAgIC8vIFNFVFVQIFROQiB2YXJpYWJsZXMKICAgICAgLy8gVE9ETzEgLSBoYXZlIGEgLmlzQ2xvc2VkIGluIHNwbGluZT8KCiAgICAgIGV4dHJ1ZGVQYXRoLmNvbXB1dGVGcmVuZXRGcmFtZXMoc3RlcHMsIGZhbHNlKTsKICAgIH0gLy8gU2FmZWd1YXJkcyBpZiBiZXZlbHMgYXJlIG5vdCBlbmFibGVkCgoKICAgIGlmICghYmV2ZWxFbmFibGVkKSB7CiAgICAgIGJldmVsU2VnbWVudHMgPSAwOwogICAgICBiZXZlbFRoaWNrbmVzcyA9IDA7CiAgICAgIGJldmVsU2l6ZSA9IDA7CiAgICB9IC8vIFZhcmlhYmxlcyBpbml0aWFsaXphdGlvbgoKCiAgICB2YXIgYWhvbGU7IC8vIGxvb3Bpbmcgb2YgaG9sZXMKCiAgICB2YXIgdmVydGljZXMgPSBzaGFwZVBvaW50cy5zaGFwZTsKICAgIHZhciBob2xlcyA9IHNoYXBlUG9pbnRzLmhvbGVzOyAvLyB0b2RvIHdpdGggc2hyaW5rCgogICAgdmFyIHJldmVyc2UgPSAhU2hhcGVVdGlscy5pc0Nsb2NrV2lzZSh2ZXJ0aWNlcyk7CgogICAgaWYgKHJldmVyc2UpIHsKICAgICAgdmVydGljZXMgPSB2ZXJ0aWNlcy5yZXZlcnNlKCk7IC8vIE1heWJlIHdlIHNob3VsZCBhbHNvIGNoZWNrIGlmIGhvbGVzIGFyZSBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLCBqdXN0IHRvIGJlIHNhZmUgLi4uCgogICAgICBmb3IgKHZhciBfaCA9IDAsIF9obCA9IGhvbGVzLmxlbmd0aDsgX2ggPCBfaGw7IF9oKyspIHsKICAgICAgICBhaG9sZSA9IGhvbGVzW19oXTsKCiAgICAgICAgaWYgKFNoYXBlVXRpbHMuaXNDbG9ja1dpc2UoYWhvbGUpKSB7CiAgICAgICAgICBob2xlc1tfaF0gPSBhaG9sZS5yZXZlcnNlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vIHl1bnlhbmcsIHRlc3QgbGFwbGFjaWFuU21vb3RoCgoKICAgIGxhcGxhY2lhblNtb290aCh2ZXJ0aWNlcywgbGFwbGFjaWFuSXRlcmF0aW9uTnVtYik7IC8vIGxhcGxhY2lhblNtb290aChzaHJpbmtlZFZlcnRpY2VzLCBzaHJpbmtPdXRsaW5lTGFwbGFjaWFuSXRlcmF0aW9uTnVtYik7CgogICAgZm9yICh2YXIgX2gyID0gMCwgX2hsMiA9IGhvbGVzLmxlbmd0aDsgX2gyIDwgX2hsMjsgX2gyKyspIHsKICAgICAgdmFyIF9haG9sZSA9IGhvbGVzW19oMl07CiAgICAgIGxhcGxhY2lhblNtb290aChfYWhvbGUsIGxhcGxhY2lhbkl0ZXJhdGlvbk51bWIpOwogICAgfQoKICAgIGJvdW5kaW5nYm94LmNvcHkoYm91bmRpbmdib3hfZm9yX3NoYXBlcyk7CiAgICB2YXIgZmFjZXM7CgogICAgaWYgKHRyaWFuZ3VsYXRlTWV0aG9kID09PSAnZWFyY3V0JykgewogICAgICBmYWNlcyA9IFNoYXBlVXRpbHMudHJpYW5ndWxhdGVTaGFwZSh2ZXJ0aWNlcywgaG9sZXMpOwogICAgfSBlbHNlIGlmICh0cmlhbmd1bGF0ZU1ldGhvZCA9PT0gJ3BvbHkydHJpJykgewogICAgICB0cnkgewogICAgICAgIGZhY2VzID0gU2hhcGVVdGlscy50cmlhbmd1bGF0ZVNoYXBlUG9seTJ0cmkodmVydGljZXMsIGhvbGVzKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgZmFjZXMgPSBTaGFwZVV0aWxzLnRyaWFuZ3VsYXRlU2hhcGUodmVydGljZXMsIGhvbGVzKTsKICAgICAgICBjb25zb2xlLmVycm9yKGVycik7CiAgICAgIH0KICAgIH0KICAgIC8qIFZlcnRpY2VzICovCgoKICAgIHZhciBjb250b3VyID0gdmVydGljZXM7IC8vIHZlcnRpY2VzIGhhcyBhbGwgcG9pbnRzIGJ1dCBjb250b3VyIGhhcyBvbmx5IHBvaW50cyBvZiBjaXJjdW1mZXJlbmNlCiAgICAvLyBjb25zdCBzaHJpbmtlZENvbnRvdXIgPSBzaHJpbmtlZFZlcnRpY2VzOyAvLyB2ZXJ0aWNlcyBoYXMgYWxsIHBvaW50cyBidXQgY29udG91ciBoYXMgb25seSBwb2ludHMgb2YgY2lyY3VtZmVyZW5jZQoKICAgIGZvciAodmFyIF9oMyA9IDAsIF9obDMgPSBob2xlcy5sZW5ndGg7IF9oMyA8IF9obDM7IF9oMysrKSB7CiAgICAgIHZhciBfYWhvbGUyID0gaG9sZXNbX2gzXTsKICAgICAgdmVydGljZXMgPSB2ZXJ0aWNlcy5jb25jYXQoX2Fob2xlMik7CiAgICB9CgogICAgZnVuY3Rpb24gc2NhbGVQdDIocHQsIHZlYywgc2l6ZSkgewogICAgICBpZiAoIXZlYykgY29uc29sZS5lcnJvcignVEhSRUUuRXh0cnVkZUdlb21ldHJ5OiB2ZWMgZG9lcyBub3QgZXhpc3QnKTsKICAgICAgcmV0dXJuIHZlYy5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLmFkZChwdCk7CiAgICB9CiAgICB2YXIgYnM7CiAgICB2YXIgejsKICAgIHZhciB2ZXJ0OwogICAgdmFyIHZsZW4gPSB2ZXJ0aWNlcy5sZW5ndGg7IC8vLCBmYWNlLCBmbGVuID0gZmFjZXMubGVuZ3RoCiAgICAvLyBGaW5kIGRpcmVjdGlvbnMgZm9yIHBvaW50IG1vdmVtZW50CgogICAgZnVuY3Rpb24gZ2V0QmV2ZWxWZWMoaW5QdCwgaW5QcmV2LCBpbk5leHQpIHsKICAgICAgdmFyIHZfdHJhbnNfeCwgdl90cmFuc195LCBzaHJpbmtfYnk7IC8vIHJlc3VsdGluZyB0cmFuc2xhdGlvbiB2ZWN0b3IgZm9yIGluUHQKICAgICAgLy8gZ29vZCByZWFkaW5nIGZvciBnZW9tZXRyeSBhbGdvcml0aG1zIChoZXJlOiBsaW5lLWxpbmUgaW50ZXJzZWN0aW9uKQogICAgICAvLyBodHRwOi8vZ2VvbWFsZ29yaXRobXMuY29tL2EwNS1faW50ZXJzZWN0LTEuaHRtbAoKICAgICAgdmFyIHZfcHJldl94ID0gaW5QdC54IC0gaW5QcmV2Lng7CiAgICAgIHZhciB2X3ByZXZfeSA9IGluUHQueSAtIGluUHJldi55OwogICAgICB2YXIgdl9uZXh0X3ggPSBpbk5leHQueCAtIGluUHQueDsKICAgICAgdmFyIHZfbmV4dF95ID0gaW5OZXh0LnkgLSBpblB0Lnk7CiAgICAgIHZhciB2X3ByZXZfbGVuc3EgPSB2X3ByZXZfeCAqIHZfcHJldl94ICsgdl9wcmV2X3kgKiB2X3ByZXZfeTsgLy8geXVueWFuZwoKICAgICAgaWYgKHZfcHJldl9sZW5zcSA8IE51bWJlci5FUFNJTE9OKSBjb25zb2xlLmVycm9yKCdpblB0IGFuZCBpblByZXYgYXJlIHRoZSBzYW1lIHBvaW50Jyk7CiAgICAgIHZhciB2X25leHRfbGVuc3EgPSB2X25leHRfeCAqIHZfbmV4dF94ICsgdl9uZXh0X3kgKiB2X25leHRfeTsKICAgICAgaWYgKHZfbmV4dF9sZW5zcSA8IE51bWJlci5FUFNJTE9OKSBjb25zb2xlLmVycm9yKCdpblB0IGFuZCBpbk5leHQgYXJlIHRoZSBzYW1lIHBvaW50Jyk7IC8vIGNoZWNrIGZvciBjb2xsaW5lYXIgZWRnZXMKCiAgICAgIHZhciBjb2xsaW5lYXIwID0gdl9wcmV2X3ggKiB2X25leHRfeSAtIHZfcHJldl95ICogdl9uZXh0X3g7IC8vIGNyb3NzIHRvIGdldCB0cmlhbmdsZSBhcmVhCiAgICAgIC8vIGxhcmdldCBlcHNsaW9uLCB5dW55YW5n77yM5Zyo56e75Yqo56uv5Y+v6IO95Lya5pyJ6Zeu6aKYCgogICAgICB2YXIgZXBzbGlvbiA9IDAuMDE7IC8vIDEwMDAqTnVtYmVyLkVQU0lMT047CiAgICAgIC8vIGRlYnVnLmxvZygnZXBzbGlvbiBpcyAnLCBlcHNsaW9uKTsKCiAgICAgIGlmIChNYXRoLmFicyhjb2xsaW5lYXIwKSA+IGVwc2xpb24pIHsKICAgICAgICAvLyBpZiAoIE1hdGguYWJzKCBjb2xsaW5lYXIwICkgPiBOdW1iZXIuRVBTSUxPTiApIHsKICAgICAgICAvLyBub3QgY29sbGluZWFyCiAgICAgICAgLy8gbGVuZ3RoIG9mIHZlY3RvcnMgZm9yIG5vcm1hbGl6aW5nCiAgICAgICAgdmFyIHZfcHJldl9sZW4gPSBNYXRoLnNxcnQodl9wcmV2X2xlbnNxKTsKICAgICAgICB2YXIgdl9uZXh0X2xlbiA9IE1hdGguc3FydCh2X25leHRfeCAqIHZfbmV4dF94ICsgdl9uZXh0X3kgKiB2X25leHRfeSk7IC8vIHNoaWZ0IGFkamFjZW50IHBvaW50cyBieSB1bml0IHZlY3RvcnMgdG8gdGhlIGxlZnQKCiAgICAgICAgdmFyIHB0UHJldlNoaWZ0X3ggPSBpblByZXYueCAtIHZfcHJldl95IC8gdl9wcmV2X2xlbjsKICAgICAgICB2YXIgcHRQcmV2U2hpZnRfeSA9IGluUHJldi55ICsgdl9wcmV2X3ggLyB2X3ByZXZfbGVuOwogICAgICAgIHZhciBwdE5leHRTaGlmdF94ID0gaW5OZXh0LnggLSB2X25leHRfeSAvIHZfbmV4dF9sZW47CiAgICAgICAgdmFyIHB0TmV4dFNoaWZ0X3kgPSBpbk5leHQueSArIHZfbmV4dF94IC8gdl9uZXh0X2xlbjsgLy8gc2NhbGluZyBmYWN0b3IgZm9yIHZfcHJldiB0byBpbnRlcnNlY3Rpb24gcG9pbnQKCiAgICAgICAgdmFyIHNmID0gKChwdE5leHRTaGlmdF94IC0gcHRQcmV2U2hpZnRfeCkgKiB2X25leHRfeSAtIChwdE5leHRTaGlmdF95IC0gcHRQcmV2U2hpZnRfeSkgKiB2X25leHRfeCkgLyAodl9wcmV2X3ggKiB2X25leHRfeSAtIHZfcHJldl95ICogdl9uZXh0X3gpOyAvLyB2ZWN0b3IgZnJvbSBpblB0IHRvIGludGVyc2VjdGlvbiBwb2ludAoKICAgICAgICB2X3RyYW5zX3ggPSBwdFByZXZTaGlmdF94ICsgdl9wcmV2X3ggKiBzZiAtIGluUHQueDsKICAgICAgICB2X3RyYW5zX3kgPSBwdFByZXZTaGlmdF95ICsgdl9wcmV2X3kgKiBzZiAtIGluUHQueTsgLy8gRG9uJ3Qgbm9ybWFsaXplISwgb3RoZXJ3aXNlIHNoYXJwIGNvcm5lcnMgYmVjb21lIHVnbHkKICAgICAgICAvLyAgYnV0IHByZXZlbnQgY3Jhenkgc3Bpa2VzCgogICAgICAgIHZhciB2X3RyYW5zX2xlbnNxID0gdl90cmFuc194ICogdl90cmFuc194ICsgdl90cmFuc195ICogdl90cmFuc195OwoKICAgICAgICBpZiAodl90cmFuc19sZW5zcSA8PSAyKSB7CiAgICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjIodl90cmFuc194LCB2X3RyYW5zX3kpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzaHJpbmtfYnkgPSBNYXRoLnNxcnQodl90cmFuc19sZW5zcSAvIDIpOwogICAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyKHZfdHJhbnNfeCAvIHNocmlua19ieSwgdl90cmFuc195IC8gc2hyaW5rX2J5KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gaGFuZGxlIGNvbGluZWFyLCB5dW55YW5nCiAgICAgICAgLy8gZGVidWcubG9nKCJjb2xpbmVhciIsIGluUHQsIGluUHJldiwgaW5OZXh0KTsKICAgICAgICAvLyByb3RhdGUgdl9wcmV2IDkwIGRlZ3JlZSB0byBnZXQgdmVjdG9yCiAgICAgICAgdmFyIF92X3ByZXZfbGVuID0gTWF0aC5zcXJ0KHZfcHJldl9sZW5zcSk7CgogICAgICAgIHZhciBfdl90cmFuc194ID0gLXZfcHJldl95IC8gX3ZfcHJldl9sZW47CgogICAgICAgIHZhciBfdl90cmFuc195ID0gdl9wcmV2X3ggLyBfdl9wcmV2X2xlbjsKCiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyKF92X3RyYW5zX3gsIF92X3RyYW5zX3kpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0TW92ZW1lbnQoY29udG91ciwgaG9sZXMsIGJldmVsU2l6ZSkgewogICAgICB2YXIgY29udG91ck1vdmVtZW50cyA9IFtdOwoKICAgICAgZm9yICh2YXIgX2k4ID0gMCwgX2lsID0gY29udG91ci5sZW5ndGgsIF9qMiA9IF9pbCAtIDEsIGsgPSBfaTggKyAxOyBfaTggPCBfaWw7IF9pOCsrLCBfajIrKywgaysrKSB7CiAgICAgICAgaWYgKF9qMiA9PT0gX2lsKSBfajIgPSAwOwogICAgICAgIGlmIChrID09PSBfaWwpIGsgPSAwOyAvLyAgKGopLS0tKGkpLS0tKGspCiAgICAgICAgLy8gZGVidWcubG9nKCdpLGosaycsIGksIGogLCBrKQogICAgICAgIC8vIGNvbnRvdXJNb3ZlbWVudHNbIGkgXSA9IGdldEJldmVsVmVjKCBjb250b3VyWyBpIF0sIGNvbnRvdXJbIGogXSwgY29udG91clsgayBdICk7Ly8ubXVsdGlwbHlTY2FsYXIoTWF0aC5hYnMoYmV2ZWxTaXplKSpzdGVwKTsKCiAgICAgICAgY29udG91ck1vdmVtZW50c1tfaThdID0gZ2V0QmV2ZWxWZWMoY29udG91cltfaThdLCBjb250b3VyW19qMl0sIGNvbnRvdXJba10pLm11bHRpcGx5U2NhbGFyKE1hdGguYWJzKGJldmVsU2l6ZSkpOwogICAgICB9IC8vIGF2ZXJhZ2Ugd2l0aCBuZWlnaGJvdXIKCiAgICAgIHZhciBob2xlc01vdmVtZW50cyA9IFtdOwogICAgICB2YXIgb25lSG9sZU1vdmVtZW50czsKICAgICAgdmFyIHZlcnRpY2VzTW92ZW1lbnRzID0gY29udG91ck1vdmVtZW50cy5jb25jYXQoKTsKCiAgICAgIGZvciAodmFyIF9oNCA9IDAsIF9obDQgPSBob2xlcy5sZW5ndGg7IF9oNCA8IF9obDQ7IF9oNCsrKSB7CiAgICAgICAgdmFyIF9haG9sZTMgPSBob2xlc1tfaDRdOwogICAgICAgIG9uZUhvbGVNb3ZlbWVudHMgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgX2kxMCA9IDAsIF9pbDMgPSBfYWhvbGUzLmxlbmd0aCwgX2o0ID0gX2lsMyAtIDEsIF9rMiA9IF9pMTAgKyAxOyBfaTEwIDwgX2lsMzsgX2kxMCsrLCBfajQrKywgX2syKyspIHsKICAgICAgICAgIGlmIChfajQgPT09IF9pbDMpIF9qNCA9IDA7CiAgICAgICAgICBpZiAoX2syID09PSBfaWwzKSBfazIgPSAwOyAvLyAgKGopLS0tKGkpLS0tKGspCiAgICAgICAgICAvLyBvbmVIb2xlTW92ZW1lbnRzWyBpIF0gPSBnZXRCZXZlbFZlYyggYWhvbGVbIGkgXSwgYWhvbGVbIGogXSwgYWhvbGVbIGsgXSApOwoKICAgICAgICAgIG9uZUhvbGVNb3ZlbWVudHNbX2kxMF0gPSBnZXRCZXZlbFZlYyhfYWhvbGUzW19pMTBdLCBfYWhvbGUzW19qNF0sIF9haG9sZTNbX2syXSkubXVsdGlwbHlTY2FsYXIoTWF0aC5hYnMoYmV2ZWxTaXplKSk7CiAgICAgICAgfSAvLyBhdmVyYWdlICB3aXRoIG5laWdoYm91ciwgeXVueWFuZwoKICAgICAgICBob2xlc01vdmVtZW50cy5wdXNoKG9uZUhvbGVNb3ZlbWVudHMpOwogICAgICAgIHZlcnRpY2VzTW92ZW1lbnRzID0gdmVydGljZXNNb3ZlbWVudHMuY29uY2F0KG9uZUhvbGVNb3ZlbWVudHMpOwogICAgICB9CgogICAgICB2YXIgQXJyYXlzID0gbmV3IEFycmF5KCk7CiAgICAgIEFycmF5cy5wdXNoKGNvbnRvdXJNb3ZlbWVudHMpOwogICAgICBBcnJheXMucHVzaChob2xlc01vdmVtZW50cyk7CiAgICAgIEFycmF5cy5wdXNoKHZlcnRpY2VzTW92ZW1lbnRzKTsKICAgICAgcmV0dXJuIEFycmF5czsKICAgIH0KCiAgICB2YXIgQXJyYXlzID0gZ2V0TW92ZW1lbnQoY29udG91ciwgaG9sZXMsIGJldmVsU2l6ZSAqIDAuMDYpOwogICAgdmFyIGNvbnRvdXJNb3ZlbWVudHMgPSBBcnJheXNbMF07CiAgICB2YXIgaG9sZXNNb3ZlbWVudHMgPSBBcnJheXNbMV07CiAgICB2YXIgQXJyYXlzNEV4dHJ1ZGVTY2FsZSA9IGdldE1vdmVtZW50KGNvbnRvdXIsIGhvbGVzLCAwLjUpOyAvLyB0b2RvIDog5omA5pyJ55qEZ2V0TW92ZW1lbnTosIPnlKgg5Y+v5Lul57uf5LiA5LiA5LiLCgogICAgdmFyIGNvbnRvdXJNb3ZlbWVudHM0RXh0cnVkZVNjYWxlID0gQXJyYXlzNEV4dHJ1ZGVTY2FsZVswXTsKICAgIHZhciBob2xlc01vdmVtZW50czRFeHRydWRlU2NhbGUgPSBBcnJheXM0RXh0cnVkZVNjYWxlWzFdOyAvLwogICAgLy8g5pS+5aSn6Iao6IOACiAgICAvLwoKICAgIGlmIChzY2FsZSA+IDApIHsKICAgICAgdmFyIEFycmF5czRTY2FsZSA9IGdldE1vdmVtZW50KGNvbnRvdXIsIGhvbGVzLCBzY2FsZSk7CiAgICAgIHZhciBjb250b3VyTW92ZW1lbnRzNFNjYWxlID0gQXJyYXlzNFNjYWxlWzBdOwogICAgICB2YXIgaG9sZXNNb3ZlbWVudHM0U2NhbGUgPSBBcnJheXM0U2NhbGVbMV07CgogICAgICBmb3IgKHZhciBfaTEyID0gMDsgX2kxMiA8IGNvbnRvdXIubGVuZ3RoOyBfaTEyKyspIHsKICAgICAgICBjb250b3VyW19pMTJdID0gc2NhbGVQdDIoY29udG91cltfaTEyXSwgY29udG91ck1vdmVtZW50czRTY2FsZVtfaTEyXSwgMSk7CiAgICAgIH0gLy8gZXhwYW5kIGhvbGVzCgoKICAgICAgZm9yICh2YXIgX2g1ID0gMDsgX2g1IDwgaG9sZXMubGVuZ3RoOyBfaDUrKykgewogICAgICAgIHZhciBfYWhvbGU0ID0gaG9sZXNbX2g1XTsKICAgICAgICB2YXIgb25lSG9sZU1vdmVtZW50cyA9IGhvbGVzTW92ZW1lbnRzNFNjYWxlW19oNV07CgogICAgICAgIGZvciAodmFyIF9pMTMgPSAwOyBfaTEzIDwgX2Fob2xlNC5sZW5ndGg7IF9pMTMrKykgewogICAgICAgICAgX2Fob2xlNFtfaTEzXSA9IHNjYWxlUHQyKF9haG9sZTRbX2kxM10sIG9uZUhvbGVNb3ZlbWVudHNbX2kxM10sIDEpOwogICAgICAgIH0KCiAgICAgICAgaG9sZXNbX2g1XSA9IF9haG9sZTQ7CiAgICAgIH0KICAgIH0gLy8g5YCS6KeS57G75Z6LCiAgICAvLyBNYXRoLnNpZ24oYmV2ZWxTaXplKT09IC0xIOiGqOiDgOWAkuinkgogICAgLy8gTWF0aC5zaWduKGJldmVsU2l6ZSk9PSAxIOaUtue8qeWAkuinkgogICAgLy8g5YeG5aSH5YCS6KeS55Sf5oiQ55qE6LW35aeL54K5LCB5dW55YW5nCgoKICAgIGlmIChiZXZlbEVuYWJsZWQpIHsKCiAgICAgIGZvciAodmFyIF9pMTQgPSAwOyBfaTE0IDwgY29udG91ci5sZW5ndGg7IF9pMTQrKykgewogICAgICAgIGlmIChNYXRoLnNpZ24oYmV2ZWxTaXplKSA9PSAtMSkgewogICAgICAgICAgLy8g6Iao6IOA5YCS6KeS77yM5aSW6L2u5buT5LiN5pS257ypCiAgICAgICAgICAvLyBjb250b3VyWyBpIF0gPSBzY2FsZVB0MiggY29udG91clsgaSBdLCBjb250b3VyTW92ZW1lbnRzWyBpIF0sIC1icyApOwogICAgICAgICAgY29udG91cltfaTE0XSA9IGNvbnRvdXJbX2kxNF07CiAgICAgICAgfSAvLy8gL+WGhee8qeWAkuinku+8jOaUtue8qQogICAgICAgIC8vIGNvbnRvdXJbIGkgXSA9IHNocmlua2VkQ29udG91cltpXS5jbG9uZSgpOwogICAgICAgIGVsc2UgewogICAgICAgICAgY29udG91cltfaTE0XSA9IGNvbnRvdXJbX2kxNF07CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBfaDYgPSAwOyBfaDYgPCBob2xlcy5sZW5ndGg7IF9oNisrKSB7CiAgICAgICAgdmFyIF9haG9sZTUgPSBob2xlc1tfaDZdOwogICAgICAgIGhvbGVzTW92ZW1lbnRzW19oNl07CgogICAgICAgIGZvciAodmFyIF9pMTUgPSAwOyBfaTE1IDwgX2Fob2xlNS5sZW5ndGg7IF9pMTUrKykgewogICAgICAgICAgaWYgKE1hdGguc2lnbihiZXZlbFNpemUpID09IC0xKSB7CiAgICAgICAgICAgIC8vIOiGqOiDgOWAkuinku+8jOWtlOS4jeiGqOiDgAogICAgICAgICAgICAvLyBhaG9sZVsgaSBdID0gc2NhbGVQdDIoIGFob2xlWyBpIF0sIG9uZUhvbGVNb3ZlbWVudHNbIGkgXSwgLWJzICk7CiAgICAgICAgICAgIF9haG9sZTVbX2kxNV0gPSBfYWhvbGU1W19pMTVdOwogICAgICAgICAgfSAvLyBhaG9sZVsgaSBdID0gc2hyaW5rZWRIb2xlc1sgaCBdW2ldLmNsb25lKCk7CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgX2Fob2xlNVtfaTE1XSA9IF9haG9sZTVbX2kxNV07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBob2xlc1tfaDZdID0gX2Fob2xlNTsKICAgICAgfSAvLyBBcnJheXMgPSBnZXRNb3ZlbWVudChjb250b3VyLCBob2xlcyk7CiAgICAgIC8vIGNvbnRvdXJNb3ZlbWVudHMgPSBBcnJheXNbMF07CiAgICAgIC8vIGhvbGVzTW92ZW1lbnRzID0gQXJyYXlzWzFdOwogICAgICAvLyB2ZXJ0aWNlc01vdmVtZW50cyA9IEFycmF5c1syXTsKCiAgICB9CiAgICB2YXIgZmxlbiA9IGZhY2VzLmxlbmd0aDsgLy8g5re75YqgIOato+mdouWAkuinkiDnmoTngrkKCiAgICBmb3IgKHZhciBfYiA9IDA7IF9iIDwgYmV2ZWxTZWdtZW50czsgX2IrKykgewogICAgICAvLwogICAgICAvLyDorqHnrpfov5nkuIDlsYLnmoTlgJLop5LnmoTmt7HluqZ65ZKMYnMKICAgICAgLy8KICAgICAgdmFyIF90ID0gX2IgLyBiZXZlbFNlZ21lbnRzOwoKICAgICAgaWYgKGJldmVsVHlwZSA9PSAncXVhZF9lbGxpcHNlJykgewogICAgICAgIF90ID0gX3QgKiBfdDsKICAgICAgICB6ID0gYmV2ZWxUaGlja25lc3MgKiBNYXRoLmNvcyhfdCAqIE1hdGguUEkgLyAyKTsKICAgICAgICBicyA9IE1hdGguc2luKF90ICogTWF0aC5QSSAvIDIpOwogICAgICB9IGVsc2UgaWYgKGJldmVsVHlwZSA9PSAnbGluZScpIHsKICAgICAgICB6ID0gYmV2ZWxUaGlja25lc3MgKiAoMSAtIF90KTsKICAgICAgICBicyA9IF90OwogICAgICB9IGVsc2UgaWYgKGJldmVsVHlwZSA9PSAnaGFsZl9lbGxpcHNlJykgewogICAgICAgIHogPSBiZXZlbFRoaWNrbmVzcyAqIE1hdGguY29zKF90ICogTWF0aC5QSSAtIE1hdGguUEkgLyAyKTsKICAgICAgICBicyA9IF90OwogICAgICB9IC8vCiAgICAgIC8vIOa3u+WKoOi/meS4gOWxgueahOWAkuinkumhtueCuQogICAgICAvLwogICAgICAvLyBjb250cmFjdCBzaGFwZQoKCiAgICAgIGZvciAodmFyIF9pMTYgPSAwLCBfaWw1ID0gY29udG91ci5sZW5ndGg7IF9pMTYgPCBfaWw1OyBfaTE2KyspIHsKICAgICAgICB2YXIgX3ZlcnQgPSBzY2FsZVB0Mihjb250b3VyW19pMTZdLCBjb250b3VyTW92ZW1lbnRzW19pMTZdLCBicyk7CgogICAgICAgIHBsYWNlaG9sZGVyLnB1c2goX3ZlcnQueCwgX3ZlcnQueSwgeik7CiAgICAgIH0gLy8gZXhwYW5kIGhvbGVzCgoKICAgICAgZm9yICh2YXIgX2g3ID0gMCwgX2hsNSA9IGhvbGVzLmxlbmd0aDsgX2g3IDwgX2hsNTsgX2g3KyspIHsKICAgICAgICB2YXIgX2Fob2xlNiA9IGhvbGVzW19oN107CiAgICAgICAgdmFyIF9vbmVIb2xlTW92ZW1lbnRzMiA9IGhvbGVzTW92ZW1lbnRzW19oN107CgogICAgICAgIGZvciAodmFyIF9pMTcgPSAwLCBfaWw2ID0gX2Fob2xlNi5sZW5ndGg7IF9pMTcgPCBfaWw2OyBfaTE3KyspIHsKICAgICAgICAgIHZlcnQgPSBzY2FsZVB0MihfYWhvbGU2W19pMTddLCBfb25lSG9sZU1vdmVtZW50czJbX2kxN10sIGJzKTsKICAgICAgICAgIHBsYWNlaG9sZGVyLnB1c2godmVydC54LCB2ZXJ0LnksIHopOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGJzID0gYmV2ZWxTaXplOyAvLyDkuIDlsYLkuIDlsYIg5b6Aeui9tOato+aWueWQkSDmt7vliqAg5q2j6Z2iIOWSjCDkvqfpnaLnmoTngrkKCiAgICBmb3IgKHZhciBzID0gMDsgcyA8PSBzdGVwczsgcysrKSB7CiAgICAgIHZhciBleHRydWRlWCA9IGV4dHJ1ZGVPZmZzZXRYOyAvLyBkZXB0aCAqIE1hdGguc2luKGV4dHJ1ZGVPZmZzZXRYLzE4MCAqIE1hdGguUEkpOwoKICAgICAgdmFyIGV4dHJ1ZGVZID0gZXh0cnVkZU9mZnNldFk7IC8vIGRlcHRoICogTWF0aC5zaW4oZXh0cnVkZU9mZnNldFkvMTgwICogTWF0aC5QSSk7CgogICAgICBpZiAoYmV2ZWxFbmFibGVkKSB7CiAgICAgICAgLy8geXVueWFuZyAncyBiZXZlbAogICAgICAgIC8vIGV4dHJ1ZGVTY2FsZUZhY3RvciA9IGV4dHJ1ZGVTY2FsZS8gc3RlcHMgKiBzOwogICAgICAgIC8vIOWkluWbtAogICAgICAgIGZvciAodmFyIF9pMTggPSAwOyBfaTE4IDwgY29udG91ci5sZW5ndGg7IF9pMTgrKykgewogICAgICAgICAgdmVydCA9IGNvbnRvdXJbX2kxOF0uY2xvbmUoKS5hZGQoY29udG91ck1vdmVtZW50c1tfaTE4XSkuYWRkKGNvbnRvdXJNb3ZlbWVudHM0RXh0cnVkZVNjYWxlW19pMThdLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoZXh0cnVkZVNjYWxlIC8gc3RlcHMgKiBzKSk7CiAgICAgICAgICBwbGFjZWhvbGRlci5wdXNoKHZlcnQueCArIGV4dHJ1ZGVYIC8gc3RlcHMgKiBzLCB2ZXJ0LnkgKyBleHRydWRlWSAvIHN0ZXBzICogcywgLWRlcHRoIC8gc3RlcHMgKiBzKTsKICAgICAgICB9IC8vIOWGhemDqOWtlAoKCiAgICAgICAgZm9yICh2YXIgX2g4ID0gMDsgX2g4IDwgaG9sZXMubGVuZ3RoOyBfaDgrKykgewogICAgICAgICAgdmFyIF9haG9sZTcgPSBob2xlc1tfaDhdOwogICAgICAgICAgdmFyIF9vbmVIb2xlTW92ZW1lbnRzMyA9IGhvbGVzTW92ZW1lbnRzW19oOF07CiAgICAgICAgICB2YXIgb25lSG9sZU1vdmVtZW50czRFeHRydWRlU2NhbGUgPSBob2xlc01vdmVtZW50czRFeHRydWRlU2NhbGVbX2g4XTsKCiAgICAgICAgICBmb3IgKHZhciBfaTE5ID0gMDsgX2kxOSA8IF9haG9sZTcubGVuZ3RoOyBfaTE5KyspIHsKICAgICAgICAgICAgdmVydCA9IF9haG9sZTdbX2kxOV0uY2xvbmUoKS5hZGQoX29uZUhvbGVNb3ZlbWVudHMzW19pMTldKS5hZGQob25lSG9sZU1vdmVtZW50czRFeHRydWRlU2NhbGVbX2kxOV0uY2xvbmUoKS5tdWx0aXBseVNjYWxhcihleHRydWRlU2NhbGUgLyBzdGVwcyAqIHMpKTsKICAgICAgICAgICAgcGxhY2Vob2xkZXIucHVzaCh2ZXJ0LnggKyBleHRydWRlWCAvIHN0ZXBzICogcywgdmVydC55ICsgZXh0cnVkZVkgLyBzdGVwcyAqIHMsIC1kZXB0aCAvIHN0ZXBzICogcyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIOayoeacieWAkuinkuaXtu+8jOato+mdouWSjOiDjOmdoueahOeCuQogICAgICBlbHNlIHsKICAgICAgICAvLyDlpJblm7QKICAgICAgICBmb3IgKHZhciBfaTIwID0gMDsgX2kyMCA8IGNvbnRvdXIubGVuZ3RoOyBfaTIwKyspIHsKICAgICAgICAgIHZlcnQgPSBjb250b3VyW19pMjBdLmNsb25lKCkuYWRkKGNvbnRvdXJNb3ZlbWVudHM0RXh0cnVkZVNjYWxlW19pMjBdLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoZXh0cnVkZVNjYWxlIC8gc3RlcHMgKiBzKSk7CiAgICAgICAgICBwbGFjZWhvbGRlci5wdXNoKHZlcnQueCArIGV4dHJ1ZGVYIC8gc3RlcHMgKiBzLCB2ZXJ0LnkgKyBleHRydWRlWSAvIHN0ZXBzICogcywgLWRlcHRoIC8gc3RlcHMgKiBzKTsKICAgICAgICB9IC8vIOWGhemDqOWtlAoKCiAgICAgICAgZm9yICh2YXIgX2g5ID0gMDsgX2g5IDwgaG9sZXMubGVuZ3RoOyBfaDkrKykgewogICAgICAgICAgdmFyIF9haG9sZTggPSBob2xlc1tfaDldOwogICAgICAgICAgdmFyIF9vbmVIb2xlTW92ZW1lbnRzNCA9IGhvbGVzTW92ZW1lbnRzNEV4dHJ1ZGVTY2FsZVtfaDldOwoKICAgICAgICAgIGZvciAodmFyIF9pMjEgPSAwOyBfaTIxIDwgX2Fob2xlOC5sZW5ndGg7IF9pMjErKykgewogICAgICAgICAgICB2ZXJ0ID0gX2Fob2xlOFtfaTIxXS5jbG9uZSgpLmFkZChfb25lSG9sZU1vdmVtZW50czRbX2kyMV0uY2xvbmUoKS5tdWx0aXBseVNjYWxhcihleHRydWRlU2NhbGUgLyBzdGVwcyAqIHMpKTsKICAgICAgICAgICAgcGxhY2Vob2xkZXIucHVzaCh2ZXJ0LnggKyBleHRydWRlWCAvIHN0ZXBzICogcywgdmVydC55ICsgZXh0cnVkZVkgLyBzdGVwcyAqIHMsIC1kZXB0aCAvIHN0ZXBzICogcyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vIOa3u+WKoOiDjOmdoueahOWAkuinkueCuQoKCiAgICBpZiAoYmV2ZWxFbmFibGVkICYmIGJldmVsQmFja0VuYWJsZWQpIHsKICAgICAgdmFyIF9leHRydWRlWCA9IGV4dHJ1ZGVPZmZzZXRYOyAvLyBkZXB0aCAqIE1hdGguc2luKGV4dHJ1ZGVPZmZzZXRYLzE4MCAqIE1hdGguUEkpOwoKICAgICAgdmFyIF9leHRydWRlWSA9IGV4dHJ1ZGVPZmZzZXRZOyAvLyBkZXB0aCAqIE1hdGguc2luKGV4dHJ1ZGVPZmZzZXRZLzE4MCAqIE1hdGguUEkpOwogICAgICAvLyBmb3IgKCBiID0gMTsgYiA8PSBiZXZlbFNlZ21lbnRzOyBiICsrICkgewoKICAgICAgZm9yICh2YXIgX2IyID0gYmV2ZWxTZWdtZW50cyAtIDE7IF9iMiA+PSAwOyBfYjItLSAvLyDku47lgJLop5LlpJblm7TlvoDlhoXplb8KICAgICAgKSB7CiAgICAgICAgdmFyIF90MiA9IF9iMiAvIGJldmVsU2VnbWVudHM7CgogICAgICAgIGlmIChiZXZlbFR5cGUgPT0gJ3F1YWRfZWxsaXBzZScpIHsKICAgICAgICAgIHogPSBiZXZlbFRoaWNrbmVzcyAqIE1hdGguY29zKF90MiAqIE1hdGguUEkgLyAyKTsKICAgICAgICAgIGJzID0gTWF0aC5zaW4oX3QyICogTWF0aC5QSSAvIDIpOwogICAgICAgIH0gZWxzZSBpZiAoYmV2ZWxUeXBlID09ICdsaW5lJykgewogICAgICAgICAgeiA9IGJldmVsVGhpY2tuZXNzICogKDEgLSBfdDIpOwogICAgICAgICAgYnMgPSBfdDI7CiAgICAgICAgfSBlbHNlIGlmIChiZXZlbFR5cGUgPT0gJ2hhbGZfZWxsaXBzZScpIHsKICAgICAgICAgIHogPSBiZXZlbFRoaWNrbmVzcyAqIE1hdGguY29zKF90MiAqIE1hdGguUEkgLSBNYXRoLlBJIC8gMik7CiAgICAgICAgICBicyA9IF90MjsKICAgICAgICB9IC8vIOi9ruW7k+W+gOWklumVvwoKCiAgICAgICAgZm9yICh2YXIgX2kyMiA9IDA7IF9pMjIgPCBjb250b3VyLmxlbmd0aDsgX2kyMisrKSB7CiAgICAgICAgICB2YXIgX3ZlcnQyID0gc2NhbGVQdDIoY29udG91cltfaTIyXSwgY29udG91ck1vdmVtZW50c1tfaTIyXSwgYnMpOwoKICAgICAgICAgIF92ZXJ0Mi5hZGQoY29udG91ck1vdmVtZW50czRFeHRydWRlU2NhbGVbX2kyMl0uY2xvbmUoKS5tdWx0aXBseVNjYWxhcihleHRydWRlU2NhbGUpKTsKCiAgICAgICAgICBwbGFjZWhvbGRlci5wdXNoKF92ZXJ0Mi54ICsgX2V4dHJ1ZGVYLCBfdmVydDIueSArIF9leHRydWRlWSwgLWRlcHRoIC0geik7CiAgICAgICAgfSAvLyDlhoXlrZTlvoDlpJbplb8KCgogICAgICAgIGZvciAodmFyIF9oMTAgPSAwOyBfaDEwIDwgaG9sZXMubGVuZ3RoOyBfaDEwKyspIHsKICAgICAgICAgIHZhciBfYWhvbGU5ID0gaG9sZXNbX2gxMF07CiAgICAgICAgICB2YXIgX29uZUhvbGVNb3ZlbWVudHM1ID0gaG9sZXNNb3ZlbWVudHNbX2gxMF07CiAgICAgICAgICB2YXIgX29uZUhvbGVNb3ZlbWVudHM0RXh0cnVkZVNjYWxlID0gaG9sZXNNb3ZlbWVudHM0RXh0cnVkZVNjYWxlW19oMTBdOwoKICAgICAgICAgIGZvciAodmFyIF9pMjMgPSAwLCBfaWw3ID0gX2Fob2xlOS5sZW5ndGg7IF9pMjMgPCBfaWw3OyBfaTIzKyspIHsKICAgICAgICAgICAgdmVydCA9IHNjYWxlUHQyKF9haG9sZTlbX2kyM10sIF9vbmVIb2xlTW92ZW1lbnRzNVtfaTIzXSwgYnMpOwogICAgICAgICAgICB2ZXJ0LmFkZChfb25lSG9sZU1vdmVtZW50czRFeHRydWRlU2NhbGVbX2kyM10uY2xvbmUoKS5tdWx0aXBseVNjYWxhcihleHRydWRlU2NhbGUpKTsKCiAgICAgICAgICAgIGlmICghZXh0cnVkZUJ5UGF0aCkgewogICAgICAgICAgICAgIHBsYWNlaG9sZGVyLnB1c2godmVydC54ICsgX2V4dHJ1ZGVYLCB2ZXJ0LnkgKyBfZXh0cnVkZVksIC1kZXB0aCAtIHopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHBsYWNlaG9sZGVyLnB1c2godmVydC54LCB2ZXJ0LnkgKyBleHRydWRlUHRzW3N0ZXBzIC0gMV0ueSwgZXh0cnVkZVB0c1tzdGVwcyAtIDFdLnggKyB6KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmIChiZXZlbEVuYWJsZWQgJiYgIWJldmVsQmFja0VuYWJsZWQpIHsKICAgICAgdmFyIF9leHRydWRlWDIgPSBleHRydWRlT2Zmc2V0WDsgLy8gZGVwdGggKiBNYXRoLnNpbihleHRydWRlT2Zmc2V0WC8xODAgKiBNYXRoLlBJKTsKCiAgICAgIHZhciBfZXh0cnVkZVkyID0gZXh0cnVkZU9mZnNldFk7IC8vIGRlcHRoICogTWF0aC5zaW4oZXh0cnVkZU9mZnNldFkvMTgwICogTWF0aC5QSSk7CgogICAgICB2YXIgX3MgPSBzdGVwczsgLy8g5aSW5Zu0CgogICAgICBmb3IgKHZhciBfaTI0ID0gMDsgX2kyNCA8IGNvbnRvdXIubGVuZ3RoOyBfaTI0KyspIHsKICAgICAgICB2YXIgX3ZlcnQzID0gY29udG91cltfaTI0XS5jbG9uZSgpLmFkZChjb250b3VyTW92ZW1lbnRzNEV4dHJ1ZGVTY2FsZVtfaTI0XS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKGV4dHJ1ZGVTY2FsZSAvIHN0ZXBzICogX3MpKTsKCiAgICAgICAgcGxhY2Vob2xkZXIucHVzaChfdmVydDMueCArIF9leHRydWRlWDIgLyBzdGVwcyAqIF9zLCBfdmVydDMueSArIF9leHRydWRlWTIgLyBzdGVwcyAqIF9zLCAtZGVwdGggLyBzdGVwcyAqIF9zKTsKICAgICAgfSAvLyDlhoXpg6jlrZQKCgogICAgICBmb3IgKHZhciBfaDExID0gMDsgX2gxMSA8IGhvbGVzLmxlbmd0aDsgX2gxMSsrKSB7CiAgICAgICAgdmFyIF9haG9sZTEwID0gaG9sZXNbX2gxMV07CiAgICAgICAgdmFyIF9vbmVIb2xlTW92ZW1lbnRzNiA9IGhvbGVzTW92ZW1lbnRzNEV4dHJ1ZGVTY2FsZVtfaDExXTsKCiAgICAgICAgZm9yICh2YXIgX2kyNSA9IDA7IF9pMjUgPCBfYWhvbGUxMC5sZW5ndGg7IF9pMjUrKykgewogICAgICAgICAgdmVydCA9IF9haG9sZTEwW19pMjVdLmNsb25lKCkuYWRkKF9vbmVIb2xlTW92ZW1lbnRzNltfaTI1XS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKGV4dHJ1ZGVTY2FsZSAvIHN0ZXBzICogX3MpKTsKICAgICAgICAgIHBsYWNlaG9sZGVyLnB1c2godmVydC54ICsgX2V4dHJ1ZGVYMiAvIHN0ZXBzICogX3MsIHZlcnQueSArIF9leHRydWRlWTIgLyBzdGVwcyAqIF9zLCAtZGVwdGggLyBzdGVwcyAqIF9zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qIEZhY2VzICovCiAgICAvLyBUb3AgYW5kIGJvdHRvbSBmYWNlcwoKCiAgICBidWlsZExpZEZhY2VzKCk7CiAgICBidWlsZEJldmVsRmFjZXMoKTsgLy8gU2lkZXMgZmFjZXMKCiAgICBidWlsZFNpZGVGYWNlcygpOyAvLy8gLy8gIEludGVybmFsIGZ1bmN0aW9ucwoKICAgIGZ1bmN0aW9uIGJ1aWxkTGlkRmFjZXMoKSB7CiAgICAgIHZhciBzdGFydCA9IHZlcnRpY2VzQXJyYXkubGVuZ3RoIC8gMzsKCiAgICAgIGlmIChiZXZlbEVuYWJsZWQpIHsKICAgICAgICB2YXIgbGF5ZXIgPSAwOyAvLyBzdGVwcyArIDEKCiAgICAgICAgdmFyIG9mZnNldCA9IHZsZW4gKiBsYXllcjsgLy8gQm90dG9tIGZhY2VzCgogICAgICAgIGZvciAodmFyIF9pMjYgPSAwOyBfaTI2IDwgZmxlbjsgX2kyNisrKSB7CiAgICAgICAgICB2YXIgX2ZhY2UgPSBmYWNlc1tfaTI2XTsKICAgICAgICAgIHRyaWFuZ2xlVG9Qb2ludChfZmFjZVswXSArIG9mZnNldCwgX2ZhY2VbMV0gKyBvZmZzZXQsIF9mYWNlWzJdICsgb2Zmc2V0KTsKICAgICAgICB9CgogICAgICAgIGxheWVyID0gc3RlcHMgKyBiZXZlbFNlZ21lbnRzICogMTsgLy8gMjsKCiAgICAgICAgb2Zmc2V0ID0gdmxlbiAqIGxheWVyOyAvLyBUb3AgZmFjZXMKCiAgICAgICAgZm9yICh2YXIgX2kyNyA9IDA7IF9pMjcgPCBmbGVuOyBfaTI3KyspIHsKICAgICAgICAgIHZhciBfZmFjZTIgPSBmYWNlc1tfaTI3XTsKICAgICAgICAgIHRyaWFuZ2xlVG9Qb2ludChfZmFjZTJbMl0gKyBvZmZzZXQsIF9mYWNlMlsxXSArIG9mZnNldCwgX2ZhY2UyWzBdICsgb2Zmc2V0KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gQm90dG9tIGZhY2VzCiAgICAgICAgZm9yICh2YXIgX2kyOCA9IDA7IF9pMjggPCBmbGVuOyBfaTI4KyspIHsKICAgICAgICAgIHZhciBfZmFjZTMgPSBmYWNlc1tfaTI4XTsKICAgICAgICAgIHRyaWFuZ2xlVG9Qb2ludChfZmFjZTNbMF0sIF9mYWNlM1sxXSwgX2ZhY2UzWzJdKTsKICAgICAgICB9IC8vIFRvcCBmYWNlcwoKCiAgICAgICAgZm9yICh2YXIgX2kyOSA9IDA7IF9pMjkgPCBmbGVuOyBfaTI5KyspIHsKICAgICAgICAgIHZhciBfZmFjZTQgPSBmYWNlc1tfaTI5XTsKICAgICAgICAgIHRyaWFuZ2xlVG9Qb2ludChfZmFjZTRbMl0gKyB2bGVuICogc3RlcHMsIF9mYWNlNFsxXSArIHZsZW4gKiBzdGVwcywgX2ZhY2U0WzBdICsgdmxlbiAqIHN0ZXBzKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHNjb3BlLmFkZEdyb3VwKHN0YXJ0LCB2ZXJ0aWNlc0FycmF5Lmxlbmd0aCAvIDMgLSBzdGFydCwgMCk7CiAgICB9CgogICAgZnVuY3Rpb24gYnVpbGRCZXZlbEZhY2VzKCkgewogICAgICBpZiAoYmV2ZWxTZWdtZW50cyA9PSAwIHx8ICFiZXZlbEVuYWJsZWQpIHJldHVybiAwOwogICAgICB2YXIgc3RhcnQgPSB2ZXJ0aWNlc0FycmF5Lmxlbmd0aCAvIDM7CiAgICAgIHZhciBsYXllcm9mZnNldCA9IDA7CiAgICAgIGJldmVsd2FsbHMoY29udG91ciwgbGF5ZXJvZmZzZXQpOwogICAgICBsYXllcm9mZnNldCArPSBjb250b3VyLmxlbmd0aDsKCiAgICAgIGZvciAodmFyIF9oMTIgPSAwLCBfaGw2ID0gaG9sZXMubGVuZ3RoOyBfaDEyIDwgX2hsNjsgX2gxMisrKSB7CiAgICAgICAgYWhvbGUgPSBob2xlc1tfaDEyXTsKICAgICAgICBiZXZlbHdhbGxzKGFob2xlLCBsYXllcm9mZnNldCk7IC8vLCB0cnVlCgogICAgICAgIGxheWVyb2Zmc2V0ICs9IGFob2xlLmxlbmd0aDsKICAgICAgfQoKICAgICAgc2NvcGUuYWRkR3JvdXAoc3RhcnQsIHZlcnRpY2VzQXJyYXkubGVuZ3RoIC8gMyAtIHN0YXJ0LCAxKTsKICAgIH0KCiAgICBmdW5jdGlvbiBiZXZlbHdhbGxzKGNvbnRvdXIsIGxheWVyb2Zmc2V0KSB7CiAgICAgIHZhciBjb250b3VyX2xlbmd0aCA9IFtdOwogICAgICB2YXIgY2xvc2VkQ29udG91ciA9IFtdOwoKICAgICAgZm9yICh2YXIgX2kzMCA9IDA7IF9pMzAgPCBjb250b3VyLmxlbmd0aDsgX2kzMCsrKSB7CiAgICAgICAgY2xvc2VkQ29udG91ci5wdXNoKGNvbnRvdXJbX2kzMF0pOwogICAgICB9CgogICAgICBjbG9zZWRDb250b3VyLnB1c2goY29udG91clswXSk7CiAgICAgIGNvbnRvdXJfbGVuZ3RoWzBdID0gMDsKCiAgICAgIGZvciAodmFyIHggPSAxOyB4IDwgY2xvc2VkQ29udG91ci5sZW5ndGg7IHgrKykgewogICAgICAgIHZhciBfdGVtcCA9IGNvbnRvdXJfbGVuZ3RoW3ggLSAxXSArIGNsb3NlZENvbnRvdXJbeF0uY2xvbmUoKS5zdWIoY2xvc2VkQ29udG91clt4IC0gMV0pLmxlbmd0aCgpOwoKICAgICAgICBjb250b3VyX2xlbmd0aFt4XSA9IF90ZW1wOwogICAgICB9CgogICAgICB2YXIgc2wgPSBiZXZlbFNlZ21lbnRzOyAvLyBjYWxjdWxhdGUgc2lkZSB3YWxsIGRlcHRoIGxlbmd0aAoKICAgICAgdmFyIHNpZGVXYWxsTGVuZ3RoID0gW107CiAgICAgIHNpZGVXYWxsTGVuZ3RoWzBdID0gMDsKICAgICAgdmFyIGogPSAxOwoKICAgICAgZm9yICh2YXIgX3MyID0gMDsgX3MyIDwgc2w7IF9zMisrKSB7CiAgICAgICAgdmFyIHNsZW4xID0gdmxlbiAqIF9zMjsKICAgICAgICB2YXIgc2xlbjIgPSB2bGVuICogKF9zMiArIDEpOwogICAgICAgIHZhciBhID0gbGF5ZXJvZmZzZXQgKyBqICsgc2xlbjE7CiAgICAgICAgdmFyIGQgPSBsYXllcm9mZnNldCArIGogKyBzbGVuMjsKICAgICAgICB2YXIgdmEgPSBuZXcgVmVjdG9yMyhwbGFjZWhvbGRlclthICogMyArIDBdLCBwbGFjZWhvbGRlclthICogMyArIDFdLCBwbGFjZWhvbGRlclthICogMyArIDJdKTsKICAgICAgICB2YXIgdmQgPSBuZXcgVmVjdG9yMyhwbGFjZWhvbGRlcltkICogMyArIDBdLCBwbGFjZWhvbGRlcltkICogMyArIDFdLCBwbGFjZWhvbGRlcltkICogMyArIDJdKTsKCiAgICAgICAgdmFyIF90ZW1wMiA9IHZkLnN1Yih2YSkubGVuZ3RoKCk7CgogICAgICAgIHNpZGVXYWxsTGVuZ3RoLnB1c2goc2lkZVdhbGxMZW5ndGhbc2lkZVdhbGxMZW5ndGgubGVuZ3RoIC0gMV0gKyBfdGVtcDIpOwogICAgICB9IC8vIGNvbnNvbGUubG9nKHNpZGVXYWxsTGVuZ3RoKTsKCgogICAgICB1dlNpZGVXYWxsTGVuZ3RoT2Zmc2V0ID0gc2lkZVdhbGxMZW5ndGhbc2lkZVdhbGxMZW5ndGgubGVuZ3RoIC0gMV07CiAgICAgIHZhciBpID0gY29udG91ci5sZW5ndGg7CgogICAgICB3aGlsZSAoLS1pID49IDApIHsKICAgICAgICB2YXIgX2o2ID0gaTsKCiAgICAgICAgdmFyIF9rNCA9IGkgLSAxOwoKICAgICAgICBpZiAoX2s0IDwgMCkgX2s0ID0gY29udG91ci5sZW5ndGggLSAxOwoKICAgICAgICBmb3IgKHZhciBfczMgPSAwOyBfczMgPCBzbDsgX3MzKyspIHsKICAgICAgICAgIHZhciBfc2xlbiA9IHZsZW4gKiBfczM7CgogICAgICAgICAgdmFyIF9zbGVuMiA9IHZsZW4gKiAoX3MzICsgMSk7CgogICAgICAgICAgdmFyIF9hID0gbGF5ZXJvZmZzZXQgKyBfajYgKyBfc2xlbjsKCiAgICAgICAgICB2YXIgX2IzID0gbGF5ZXJvZmZzZXQgKyBfazQgKyBfc2xlbjsKCiAgICAgICAgICB2YXIgYyA9IGxheWVyb2Zmc2V0ICsgX2s0ICsgX3NsZW4yOwoKICAgICAgICAgIHZhciBfZCA9IGxheWVyb2Zmc2V0ICsgX2o2ICsgX3NsZW4yOwoKICAgICAgICAgIHF1YWRUb1BvaW50KGNvbnRvdXJfbGVuZ3RoLCBzaWRlV2FsbExlbmd0aCwgaSwgX3MzLCBfYjMsIF9hLCBfZCwgYyk7CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vIENyZWF0ZSBmYWNlcyBmb3IgdGhlIHotc2lkZXMgb2YgdGhlIHNoYXBlCgoKICAgIGZ1bmN0aW9uIGJ1aWxkU2lkZUZhY2VzKCkgewogICAgICB2YXIgc3RhcnQgPSB2ZXJ0aWNlc0FycmF5Lmxlbmd0aCAvIDM7CiAgICAgIHZhciBsYXllcm9mZnNldCA9IHZsZW4gKiBiZXZlbFNlZ21lbnRzOwogICAgICBzaWRld2FsbHMoY29udG91ciwgbGF5ZXJvZmZzZXQpOwogICAgICBsYXllcm9mZnNldCArPSBjb250b3VyLmxlbmd0aDsKCiAgICAgIGZvciAodmFyIF9oMTMgPSAwLCBfaGw3ID0gaG9sZXMubGVuZ3RoOyBfaDEzIDwgX2hsNzsgX2gxMysrKSB7CiAgICAgICAgYWhvbGUgPSBob2xlc1tfaDEzXTsKICAgICAgICBzaWRld2FsbHMoYWhvbGUsIGxheWVyb2Zmc2V0KTsKICAgICAgICBsYXllcm9mZnNldCArPSBhaG9sZS5sZW5ndGg7CiAgICAgIH0KCiAgICAgIHNjb3BlLmFkZEdyb3VwKHN0YXJ0LCB2ZXJ0aWNlc0FycmF5Lmxlbmd0aCAvIDMgLSBzdGFydCwgMSk7CiAgICB9CgogICAgZnVuY3Rpb24gc2lkZXdhbGxzKGNvbnRvdXIsIGxheWVyb2Zmc2V0KSB7CiAgICAgIHZhciBjb250b3VyX2xlbmd0aCA9IFtdOwogICAgICB2YXIgY2xvc2VkQ29udG91ciA9IFtdOwoKICAgICAgZm9yICh2YXIgX2kzMSA9IDA7IF9pMzEgPCBjb250b3VyLmxlbmd0aDsgX2kzMSsrKSB7CiAgICAgICAgY2xvc2VkQ29udG91ci5wdXNoKGNvbnRvdXJbX2kzMV0pOwogICAgICB9CgogICAgICBjbG9zZWRDb250b3VyLnB1c2goY29udG91clswXSk7CiAgICAgIGNvbnRvdXJfbGVuZ3RoWzBdID0gMDsKCiAgICAgIGZvciAodmFyIHggPSAxOyB4IDwgY2xvc2VkQ29udG91ci5sZW5ndGg7IHgrKykgewogICAgICAgIHZhciBfdGVtcDMgPSBjb250b3VyX2xlbmd0aFt4IC0gMV0gKyBjbG9zZWRDb250b3VyW3hdLmNsb25lKCkuc3ViKGNsb3NlZENvbnRvdXJbeCAtIDFdKS5sZW5ndGgoKTsKCiAgICAgICAgY29udG91cl9sZW5ndGhbeF0gPSBfdGVtcDM7CiAgICAgIH0KCiAgICAgIHZhciBzbCA9IHN0ZXBzOyAvLyBjYWxjdWxhdGUgc2lkZSB3YWxsIGRlcHRoIGxlbmd0aAoKICAgICAgdmFyIHNpZGVXYWxsTGVuZ3RoID0gW107CiAgICAgIHNpZGVXYWxsTGVuZ3RoWzBdID0gdXZTaWRlV2FsbExlbmd0aE9mZnNldDsgLy8gMDsKCiAgICAgIHZhciBqID0gMTsKCiAgICAgIGZvciAodmFyIF9zNCA9IDA7IF9zNCA8IHNsOyBfczQrKykgewogICAgICAgIHZhciBzbGVuMSA9IHZsZW4gKiBfczQ7CiAgICAgICAgdmFyIHNsZW4yID0gdmxlbiAqIChfczQgKyAxKTsKICAgICAgICB2YXIgYSA9IGxheWVyb2Zmc2V0ICsgaiArIHNsZW4xOwogICAgICAgIHZhciBkID0gbGF5ZXJvZmZzZXQgKyBqICsgc2xlbjI7CiAgICAgICAgdmFyIHZhID0gbmV3IFZlY3RvcjMocGxhY2Vob2xkZXJbYSAqIDMgKyAwXSwgcGxhY2Vob2xkZXJbYSAqIDMgKyAxXSwgcGxhY2Vob2xkZXJbYSAqIDMgKyAyXSk7CiAgICAgICAgdmFyIHZkID0gbmV3IFZlY3RvcjMocGxhY2Vob2xkZXJbZCAqIDMgKyAwXSwgcGxhY2Vob2xkZXJbZCAqIDMgKyAxXSwgcGxhY2Vob2xkZXJbZCAqIDMgKyAyXSk7CgogICAgICAgIHZhciBfdGVtcDQgPSB2ZC5zdWIodmEpLmxlbmd0aCgpOwoKICAgICAgICBzaWRlV2FsbExlbmd0aC5wdXNoKHNpZGVXYWxsTGVuZ3RoW3NpZGVXYWxsTGVuZ3RoLmxlbmd0aCAtIDFdICsgX3RlbXA0KTsKICAgICAgfQoKICAgICAgdmFyIGkgPSBjb250b3VyLmxlbmd0aDsKCiAgICAgIHdoaWxlICgtLWkgPj0gMCkgewogICAgICAgIHZhciBfajcgPSBpOwoKICAgICAgICB2YXIgX2s1ID0gaSAtIDE7CgogICAgICAgIGlmIChfazUgPCAwKSBfazUgPSBjb250b3VyLmxlbmd0aCAtIDE7CgogICAgICAgIGZvciAodmFyIF9zNSA9IDA7IF9zNSA8IHNsOyBfczUrKykgewogICAgICAgICAgdmFyIF9zbGVuMyA9IHZsZW4gKiBfczU7CgogICAgICAgICAgdmFyIF9zbGVuNCA9IHZsZW4gKiAoX3M1ICsgMSk7CgogICAgICAgICAgdmFyIF9hMiA9IGxheWVyb2Zmc2V0ICsgX2o3ICsgX3NsZW4zOwoKICAgICAgICAgIHZhciBfYjQgPSBsYXllcm9mZnNldCArIF9rNSArIF9zbGVuMzsKCiAgICAgICAgICB2YXIgYyA9IGxheWVyb2Zmc2V0ICsgX2s1ICsgX3NsZW40OwoKICAgICAgICAgIHZhciBfZDIgPSBsYXllcm9mZnNldCArIF9qNyArIF9zbGVuNDsKCiAgICAgICAgICBxdWFkVG9Qb2ludChjb250b3VyX2xlbmd0aCwgc2lkZVdhbGxMZW5ndGgsIGksIF9zNSwgX2I0LCBfYTIsIF9kMiwgYyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdHJpYW5nbGVUb1BvaW50KGEsIGIsIGMpIHsKICAgICAgYWRkVmVydGV4KGEpOwogICAgICBhZGRWZXJ0ZXgoYik7CiAgICAgIGFkZFZlcnRleChjKTsKICAgICAgdmFyIG5leHRJbmRleCA9IHZlcnRpY2VzQXJyYXkubGVuZ3RoIC8gMzsKICAgICAgdmFyIHV2cyA9IHV2Z2VuLmdlbmVyYXRlVG9wVVYoc2NvcGUsIHZlcnRpY2VzQXJyYXksIGJvdW5kaW5nYm94LCBuZXh0SW5kZXggLSAzLCBuZXh0SW5kZXggLSAyLCBuZXh0SW5kZXggLSAxKTsKICAgICAgYWRkVVYodXZzWzBdKTsKICAgICAgYWRkVVYodXZzWzFdKTsKICAgICAgYWRkVVYodXZzWzJdKTsKICAgIH0KCiAgICBmdW5jdGlvbiBxdWFkVG9Qb2ludChjb250b3VyX2xlbmd0aCwgc2lkZVdhbGxMZW5ndGgsIHV2U3RhcnRJbmRleCwgdXZTdGFydEluZGV4RGVwdGhEaXJlY3Rpb24sIGEsIGIsIGMsIGQpIHsKICAgICAgYWRkVmVydGV4KGEpOwogICAgICBhZGRWZXJ0ZXgoYik7CiAgICAgIGFkZFZlcnRleChkKTsKICAgICAgYWRkVmVydGV4KGIpOwogICAgICBhZGRWZXJ0ZXgoYyk7CiAgICAgIGFkZFZlcnRleChkKTsKICAgICAgdmFyIG5leHRJbmRleCA9IHZlcnRpY2VzQXJyYXkubGVuZ3RoIC8gMzsKICAgICAgdmFyIHV2cyA9IHV2Z2VuLmdlbmVyYXRlU2lkZVdhbGxVVkV4dGVuZChzY29wZSwgdmVydGljZXNBcnJheSwgYm91bmRpbmdib3gsIGRlcHRoLCBjb250b3VyX2xlbmd0aCwgc2lkZVdhbGxMZW5ndGgsIHV2U3RhcnRJbmRleCwgdXZTdGFydEluZGV4RGVwdGhEaXJlY3Rpb24sIG5leHRJbmRleCAtIDYsIG5leHRJbmRleCAtIDMsIG5leHRJbmRleCAtIDIsIG5leHRJbmRleCAtIDEpOwogICAgICBhZGRVVih1dnNbMF0pOwogICAgICBhZGRVVih1dnNbMV0pOwogICAgICBhZGRVVih1dnNbM10pOwogICAgICBhZGRVVih1dnNbMV0pOwogICAgICBhZGRVVih1dnNbMl0pOwogICAgICBhZGRVVih1dnNbM10pOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZFZlcnRleChpbmRleCkgewogICAgICB2ZXJ0aWNlc0FycmF5LnB1c2gocGxhY2Vob2xkZXJbaW5kZXggKiAzICsgMF0sIHBsYWNlaG9sZGVyW2luZGV4ICogMyArIDFdLCBwbGFjZWhvbGRlcltpbmRleCAqIDMgKyAyXSk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkVVYodmVjdG9yMikgewogICAgICB1dkFycmF5LnB1c2godmVjdG9yMi54KTsKICAgICAgdXZBcnJheS5wdXNoKHZlY3RvcjIueSk7CiAgICB9CiAgfQp9CgpFeHRydWRlQnVmZmVyR2VvbWV0cnkucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShCdWZmZXJHZW9tZXRyeS5wcm90b3R5cGUpOwpFeHRydWRlQnVmZmVyR2VvbWV0cnkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRXh0cnVkZUJ1ZmZlckdlb21ldHJ5OwoKRXh0cnVkZUJ1ZmZlckdlb21ldHJ5LnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoKSB7CiAgdmFyIGRhdGEgPSBCdWZmZXJHZW9tZXRyeS5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7CiAgdmFyIHNoYXBlcyA9IHRoaXMucGFyYW1ldGVycy5zaGFwZXM7CiAgdmFyIG9wdGlvbnMgPSB0aGlzLnBhcmFtZXRlcnMub3B0aW9uczsKICByZXR1cm4gdG9KU09OKHNoYXBlcywgb3B0aW9ucywgZGF0YSk7Cn07CgpmdW5jdGlvbiByb3RhdGVDb29yZDQ1ZGVncmVlKHgsIHksIG5ld194LCBuZXdfeSkgewogIG5ld194ID0gTWF0aC5TUVJUMiAqIHggLSBNYXRoLlNRUlQyICogeTsKICBuZXdfeSA9IE1hdGguU1FSVDIgKiB4ICsgTWF0aC5TUVJUMiAqIHk7CiAgcmV0dXJuIFtuZXdfeCwgbmV3X3ldOwp9IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tcmRvb2IvdGhyZWUuanMvaXNzdWVzLzE4MjQKCgp2YXIgV29ybGRVVkdlbmVyYXRvciA9IHsKICBnZW5lcmF0ZVRvcFVWOiBmdW5jdGlvbiBnZW5lcmF0ZVRvcFVWKGdlb21ldHJ5LCB2ZXJ0aWNlcywgYm91bmRpbmdib3gsIGluZGV4QSwgaW5kZXhCLCBpbmRleEMpIHsKICAgIHZhciBhX3ggPSB2ZXJ0aWNlc1tpbmRleEEgKiAzXTsKICAgIHZhciBhX3kgPSB2ZXJ0aWNlc1tpbmRleEEgKiAzICsgMV07CiAgICB2YXIgYl94ID0gdmVydGljZXNbaW5kZXhCICogM107CiAgICB2YXIgYl95ID0gdmVydGljZXNbaW5kZXhCICogMyArIDFdOwogICAgdmFyIGNfeCA9IHZlcnRpY2VzW2luZGV4QyAqIDNdOwogICAgdmFyIGNfeSA9IHZlcnRpY2VzW2luZGV4QyAqIDMgKyAxXTsKICAgIHZhciBiYiA9IGJvdW5kaW5nYm94OyAvLyBleHRydWRlZFNoYXBlLmJvdW5kaW5nQm94KCk7CgogICAgdmFyIGJieSA9IGJiLm1heC55IC0gYmIubWluLnk7CiAgICB2YXIgYW10ID0gYmJ5OwogICAgcmV0dXJuIFtuZXcgVmVjdG9yMigoYV94IC0gYmIubWluLngpIC8gYW10LCAxIC0gKGFfeSAtIGJiLm1pbi55KSAvIGFtdCksIG5ldyBWZWN0b3IyKChiX3ggLSBiYi5taW4ueCkgLyBhbXQsIDEgLSAoYl95IC0gYmIubWluLnkpIC8gYW10KSwgbmV3IFZlY3RvcjIoKGNfeCAtIGJiLm1pbi54KSAvIGFtdCwgMSAtIChjX3kgLSBiYi5taW4ueSkgLyBhbXQpXTsKICB9LAogIGdlbmVyYXRlQm90dG9tVVY6IGZ1bmN0aW9uIGdlbmVyYXRlQm90dG9tVVYoZ2VvbWV0cnksIHZlcnRpY2VzLCBib3VuZGluZ2JveCwgaW5kZXhBLCBpbmRleEIsIGluZGV4QykgewogICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVUb3BVVihnZW9tZXRyeSwgYm91bmRpbmdib3gsIGluZGV4QSwgaW5kZXhCLCBpbmRleEMpOwogIH0sCiAgLy8geXVueWFuZwogIGdlbmVyYXRlU2lkZVdhbGxVVjogZnVuY3Rpb24gZ2VuZXJhdGVTaWRlV2FsbFVWKGdlb21ldHJ5LCB2ZXJ0aWNlcywgYm91bmRpbmdib3gsIGV4dHJ1ZGVoZWlnaHQsIGluZGV4QSwgaW5kZXhCLCBpbmRleEMsIGluZGV4RCkgewogICAgdmFyIGF4ID0gdmVydGljZXNbaW5kZXhBICogM107CiAgICB2YXIgYXkgPSB2ZXJ0aWNlc1tpbmRleEEgKiAzICsgMV07CiAgICB2YXIgYXogPSB2ZXJ0aWNlc1tpbmRleEEgKiAzICsgMl07CiAgICB2YXIgYnggPSB2ZXJ0aWNlc1tpbmRleEIgKiAzXTsKICAgIHZhciBieSA9IHZlcnRpY2VzW2luZGV4QiAqIDMgKyAxXTsKICAgIHZhciBieiA9IHZlcnRpY2VzW2luZGV4QiAqIDMgKyAyXTsKICAgIHZhciBjeCA9IHZlcnRpY2VzW2luZGV4QyAqIDNdOwogICAgdmFyIGN5ID0gdmVydGljZXNbaW5kZXhDICogMyArIDFdOwogICAgdmFyIGN6ID0gdmVydGljZXNbaW5kZXhDICogMyArIDJdOwogICAgdmFyIGR4ID0gdmVydGljZXNbaW5kZXhEICogM107CiAgICB2YXIgZHkgPSB2ZXJ0aWNlc1tpbmRleEQgKiAzICsgMV07CiAgICB2YXIgZHogPSB2ZXJ0aWNlc1tpbmRleEQgKiAzICsgMl07CiAgICB2YXIgLy8gYW10ID0gZXh0cnVkZWhlaWdodCwvL3RoaXMuZXh0cnVkZWRPcHRpb25zLmFtb3VudCwKICAgIGJiID0gYm91bmRpbmdib3g7CiAgICAvLyBleHRydWRlZFNoYXBlLmdldEJvdW5kaW5nQm94KCksCiAgICBiYi5tYXgueCAtIGJiLm1pbi54OwogICAgdmFyIGJieSA9IGJiLm1heC55IC0gYmIubWluLnk7CiAgICBiYi5tYXgueiAtIGJiLm1pbi56OwogICAgdmFyIGFtdCA9IGJieTsgLy8gY29uc3QgYWJfYW5nbGUgPSBNYXRoLmFicyhheSAtIGJ5KSAvICBNYXRoLnNxcnQoKGF4LWJ4KSooYXgtYngpICsgKGF5LWJ5KSooYXktYnkpKTsKICAgIC8vIGNvbnN0IGFiX2FuZ2xlID0gKGF5IC0gYnkpIC8gIE1hdGguc3FydCgoYXgtYngpKihheC1ieCkgKyAoYXktYnkpKihheS1ieSkpOwoKICAgIHZhciBiYSA9IG5ldyBWZWN0b3IzKGJ4IC0gYXgsIGJ5IC0gYXksIDApOwogICAgdmFyIHhBeGlzID0gbmV3IFZlY3RvcjMoMSwgMCwgMCk7CiAgICB2YXIgYWJBbmdsZSA9IGJhLmFuZ2xlVG8oeEF4aXMpICogMTgwIC8gTWF0aC5QSTsKICAgIGlmIChhYkFuZ2xlIDwgMCB8fCBhYkFuZ2xlID4gMTgwKSBjb25zb2xlLmVycm9yKCdhYkFuZ2xlPDAgfHwgYWJBbmdsZT4xODAnLCBhYkFuZ2xlKTsKICAgIHZhciBhbmdsZUNvbnN0ID0gMzA7IC8vIGlmKE1hdGguYWJzKGF5IC0gYnkpL2JieCA8IDAuMDEpCgogICAgaWYgKGFiQW5nbGUgPCBhbmdsZUNvbnN0IHx8IGFiQW5nbGUgPiAxODAgLSBhbmdsZUNvbnN0KSB7CiAgICAgIHJldHVybiBbbmV3IFZlY3RvcjIoYXggLyBhbXQsIGF6IC8gYW10KSwgbmV3IFZlY3RvcjIoYnggLyBhbXQsIGJ6IC8gYW10KSwgbmV3IFZlY3RvcjIoY3ggLyBhbXQsIGN6IC8gYW10KSwgbmV3IFZlY3RvcjIoZHggLyBhbXQsIGR6IC8gYW10KV07CiAgICB9IGVsc2UgaWYgKGFiQW5nbGUgPiA5MCAtIGFuZ2xlQ29uc3QgJiYgYWJBbmdsZSA8IDkwICsgYW5nbGVDb25zdCkgewogICAgICByZXR1cm4gW25ldyBWZWN0b3IyKGF5IC8gYW10LCBheiAvIGFtdCksIG5ldyBWZWN0b3IyKGJ5IC8gYW10LCBieiAvIGFtdCksIG5ldyBWZWN0b3IyKGN5IC8gYW10LCBjeiAvIGFtdCksIG5ldyBWZWN0b3IyKGR5IC8gYW10LCBkeiAvIGFtdCldOwogICAgfSBlbHNlIHsKICAgICAgdmFyIF9yb3RhdGVDb29yZDQ1ZGVncmVlID0gcm90YXRlQ29vcmQ0NWRlZ3JlZShheCwgYXkpLAogICAgICAgICAgX3JvdGF0ZUNvb3JkNDVkZWdyZWUyID0gX3NsaWNlZFRvQXJyYXkoX3JvdGF0ZUNvb3JkNDVkZWdyZWUsIDIpLAogICAgICAgICAgbmV3X2F4ID0gX3JvdGF0ZUNvb3JkNDVkZWdyZWUyWzBdLAogICAgICAgICAgbmV3X2F5ID0gX3JvdGF0ZUNvb3JkNDVkZWdyZWUyWzFdOwoKICAgICAgdmFyIF9yb3RhdGVDb29yZDQ1ZGVncmVlMyA9IHJvdGF0ZUNvb3JkNDVkZWdyZWUoYngsIGJ5KSwKICAgICAgICAgIF9yb3RhdGVDb29yZDQ1ZGVncmVlNCA9IF9zbGljZWRUb0FycmF5KF9yb3RhdGVDb29yZDQ1ZGVncmVlMywgMiksCiAgICAgICAgICBuZXdfYnggPSBfcm90YXRlQ29vcmQ0NWRlZ3JlZTRbMF0sCiAgICAgICAgICBuZXdfYnkgPSBfcm90YXRlQ29vcmQ0NWRlZ3JlZTRbMV07CgogICAgICB2YXIgX2JhID0gbmV3IFZlY3RvcjMobmV3X2J4IC0gbmV3X2F4LCBuZXdfYnkgLSBuZXdfYXksIDApOwoKICAgICAgdmFyIG5ld0FiQW5nbGUgPSBfYmEuYW5nbGVUbyh4QXhpcykgKiAxODAgLyBNYXRoLlBJOwogICAgICB2YXIgbmV3X2FtdCA9IGFtdCAvIDEuNDE0MjE7CiAgICAgIHZhciBuZXdBbmdsZUNvbnN0ID0gNDUgLSBhbmdsZUNvbnN0OwoKICAgICAgaWYgKG5ld0FiQW5nbGUgPCBuZXdBbmdsZUNvbnN0IHx8IG5ld0FiQW5nbGUgPiAxODAgLSBuZXdBbmdsZUNvbnN0KSB7CiAgICAgICAgcmV0dXJuIFtuZXcgVmVjdG9yMihheCAvIG5ld19hbXQsIGF6IC8gYW10KSwgbmV3IFZlY3RvcjIoYnggLyBuZXdfYW10LCBieiAvIGFtdCksIG5ldyBWZWN0b3IyKGN4IC8gbmV3X2FtdCwgY3ogLyBhbXQpLCBuZXcgVmVjdG9yMihkeCAvIG5ld19hbXQsIGR6IC8gYW10KV07CiAgICAgIH0KCiAgICAgIHsKICAgICAgICByZXR1cm4gW25ldyBWZWN0b3IyKGF5IC8gbmV3X2FtdCwgYXogLyBhbXQpLCBuZXcgVmVjdG9yMihieSAvIG5ld19hbXQsIGJ6IC8gYW10KSwgbmV3IFZlY3RvcjIoY3kgLyBuZXdfYW10LCBjeiAvIGFtdCksIG5ldyBWZWN0b3IyKGR5IC8gbmV3X2FtdCwgZHogLyBhbXQpXTsKICAgICAgfQogICAgfQogIH0sCiAgLy8geXVueWFuZwogIGdlbmVyYXRlU2lkZVdhbGxVVkV4dGVuZDogZnVuY3Rpb24gZ2VuZXJhdGVTaWRlV2FsbFVWRXh0ZW5kKGdlb21ldHJ5LCB2ZXJ0aWNlcywgYm91bmRpbmdib3gsIGV4dHJ1ZGVoZWlnaHQsIGNvbnRvdXJfbGVuZ3RoLCBzaWRlV2FsbExlbmd0aCwgdXZTdGFydEluZGV4LCB1dlN0YXJ0SW5kZXhEZXB0aERpcmVjdGlvbiwgaW5kZXhBLCBpbmRleEIsIGluZGV4QywgaW5kZXhEKSB7CiAgICB2YXIgYmIgPSBib3VuZGluZ2JveDsKICAgIHZhciBiYnkgPSBiYi5tYXgueSAtIGJiLm1pbi55OwogICAgdmFyIGFtdCA9IGJieTsKCiAgICBpZiAodXZTdGFydEluZGV4IC0gMSA8IDApIHsKICAgICAgdXZTdGFydEluZGV4ID0gY29udG91cl9sZW5ndGgubGVuZ3RoIC0gMTsKICAgIH0KCiAgICB2YXIgdXYwVSA9IGNvbnRvdXJfbGVuZ3RoW3V2U3RhcnRJbmRleCAtIDFdIC8gYW10OyAvLy8gY29udG91cl9sZW5ndGhbY29udG91cl9sZW5ndGgubGVuZ3RoLTFdOwoKICAgIHZhciB1djFVID0gY29udG91cl9sZW5ndGhbdXZTdGFydEluZGV4XSAvIGFtdDsgLy8gLyBjb250b3VyX2xlbmd0aFtjb250b3VyX2xlbmd0aC5sZW5ndGgtMV07CgogICAgcmV0dXJuIFtuZXcgVmVjdG9yMih1djBVLCBzaWRlV2FsbExlbmd0aFt1dlN0YXJ0SW5kZXhEZXB0aERpcmVjdGlvbl0gLyBhbXQpLCBuZXcgVmVjdG9yMih1djFVLCBzaWRlV2FsbExlbmd0aFt1dlN0YXJ0SW5kZXhEZXB0aERpcmVjdGlvbl0gLyBhbXQpLCBuZXcgVmVjdG9yMih1djFVLCBzaWRlV2FsbExlbmd0aFt1dlN0YXJ0SW5kZXhEZXB0aERpcmVjdGlvbiArIDFdIC8gYW10KSwgbmV3IFZlY3RvcjIodXYwVSwgc2lkZVdhbGxMZW5ndGhbdXZTdGFydEluZGV4RGVwdGhEaXJlY3Rpb24gKyAxXSAvIGFtdCldOwogIH0KfTsKCmZ1bmN0aW9uIHRvSlNPTihzaGFwZXMsIG9wdGlvbnMsIGRhdGEpIHsKICBkYXRhLnNoYXBlcyA9IFtdOwoKICBpZiAoQXJyYXkuaXNBcnJheShzaGFwZXMpKSB7CiAgICBmb3IgKHZhciBpID0gMCwgbCA9IHNoYXBlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmFyIHNoYXBlID0gc2hhcGVzW2ldOwogICAgICBkYXRhLnNoYXBlcy5wdXNoKHNoYXBlLnV1aWQpOwogICAgfQogIH0gZWxzZSB7CiAgICBkYXRhLnNoYXBlcy5wdXNoKHNoYXBlcy51dWlkKTsKICB9CgogIGlmIChvcHRpb25zLmV4dHJ1ZGVQYXRoICE9PSB1bmRlZmluZWQpIGRhdGEub3B0aW9ucy5leHRydWRlUGF0aCA9IG9wdGlvbnMuZXh0cnVkZVBhdGgudG9KU09OKCk7CiAgcmV0dXJuIGRhdGE7Cn0KCnZhciBnZXRQcm90b3R5cGVPZiA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgewogICAgbW9kdWxlLmV4cG9ydHMgPSBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsKICAgICAgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsKICAgIH0sIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7CiAgICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOwogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfZ2V0UHJvdG90eXBlT2YsIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp2YXIgX2dldFByb3RvdHlwZU9mID0gdW53cmFwRXhwb3J0cyhnZXRQcm90b3R5cGVPZik7Cgp2YXIgc3VwZXJQcm9wQmFzZSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICBmdW5jdGlvbiBfc3VwZXJQcm9wQmFzZShvYmplY3QsIHByb3BlcnR5KSB7CiAgICB3aGlsZSAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KSkgewogICAgICBvYmplY3QgPSBnZXRQcm90b3R5cGVPZihvYmplY3QpOwogICAgICBpZiAob2JqZWN0ID09PSBudWxsKSBicmVhazsKICAgIH0KCiAgICByZXR1cm4gb2JqZWN0OwogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfc3VwZXJQcm9wQmFzZSwgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKfSk7CnVud3JhcEV4cG9ydHMoc3VwZXJQcm9wQmFzZSk7Cgp2YXIgZ2V0ID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkgewogIGZ1bmN0aW9uIF9nZXQoKSB7CiAgICBpZiAodHlwZW9mIFJlZmxlY3QgIT09ICJ1bmRlZmluZWQiICYmIFJlZmxlY3QuZ2V0KSB7CiAgICAgIG1vZHVsZS5leHBvcnRzID0gX2dldCA9IFJlZmxlY3QuZ2V0LmJpbmQoKSwgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKICAgIH0gZWxzZSB7CiAgICAgIG1vZHVsZS5leHBvcnRzID0gX2dldCA9IGZ1bmN0aW9uIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsKICAgICAgICB2YXIgYmFzZSA9IHN1cGVyUHJvcEJhc2UodGFyZ2V0LCBwcm9wZXJ0eSk7CiAgICAgICAgaWYgKCFiYXNlKSByZXR1cm47CiAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGJhc2UsIHByb3BlcnR5KTsKCiAgICAgICAgaWYgKGRlc2MuZ2V0KSB7CiAgICAgICAgICByZXR1cm4gZGVzYy5nZXQuY2FsbChhcmd1bWVudHMubGVuZ3RoIDwgMyA/IHRhcmdldCA6IHJlY2VpdmVyKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBkZXNjLnZhbHVlOwogICAgICB9LCBtb2R1bGUuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZSwgbW9kdWxlLmV4cG9ydHNbImRlZmF1bHQiXSA9IG1vZHVsZS5leHBvcnRzOwogICAgfQoKICAgIHJldHVybiBfZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IF9nZXQsIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp2YXIgX2dldCA9IHVud3JhcEV4cG9ydHMoZ2V0KTsKCnZhciBzZXRQcm90b3R5cGVPZiA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgewogICAgbW9kdWxlLmV4cG9ydHMgPSBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsKICAgICAgby5fX3Byb3RvX18gPSBwOwogICAgICByZXR1cm4gbzsKICAgIH0sIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7CiAgICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOwogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfc2V0UHJvdG90eXBlT2YsIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp1bndyYXBFeHBvcnRzKHNldFByb3RvdHlwZU9mKTsKCnZhciBpbmhlcml0cyA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICBmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICAgIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7CiAgICB9CgogICAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgICB9CiAgICB9KTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdWJDbGFzcywgInByb3RvdHlwZSIsIHsKICAgICAgd3JpdGFibGU6IGZhbHNlCiAgICB9KTsKICAgIGlmIChzdXBlckNsYXNzKSBzZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IF9pbmhlcml0cywgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKfSk7CnZhciBfaW5oZXJpdHMgPSB1bndyYXBFeHBvcnRzKGluaGVyaXRzKTsKCnZhciBhc3NlcnRUaGlzSW5pdGlhbGl6ZWQgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7CiAgZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7CiAgICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7CiAgICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7CiAgICB9CgogICAgcmV0dXJuIHNlbGY7CiAgfQoKICBtb2R1bGUuZXhwb3J0cyA9IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQsIG1vZHVsZS5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlLCBtb2R1bGUuZXhwb3J0c1siZGVmYXVsdCJdID0gbW9kdWxlLmV4cG9ydHM7Cn0pOwp1bndyYXBFeHBvcnRzKGFzc2VydFRoaXNJbml0aWFsaXplZCk7Cgp2YXIgcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHsKICB2YXIgX3R5cGVvZiA9IF90eXBlb2ZfMVsiZGVmYXVsdCJdOwoKICBmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7CiAgICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7CiAgICAgIHJldHVybiBjYWxsOwogICAgfSBlbHNlIGlmIChjYWxsICE9PSB2b2lkIDApIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWQiKTsKICAgIH0KCiAgICByZXR1cm4gYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOwogIH0KCiAgbW9kdWxlLmV4cG9ydHMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiwgbW9kdWxlLmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWUsIG1vZHVsZS5leHBvcnRzWyJkZWZhdWx0Il0gPSBtb2R1bGUuZXhwb3J0czsKfSk7CnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiA9IHVud3JhcEV4cG9ydHMocG9zc2libGVDb25zdHJ1Y3RvclJldHVybik7Cgp2YXIgQ3VydmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEN1cnZlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEN1cnZlKTsKCiAgICB0aGlzLnR5cGUgPSAnQ3VydmUnOwogICAgdGhpcy5hcmNMZW5ndGhEaXZpc2lvbnMgPSAyMDA7CiAgICB0aGlzLnJlY3VyRGVwdGggPSAwOwogIH0gLy8gR2V0IHBvaW50IGF0IHJlbGF0aXZlIHBvc2l0aW9uIGluIGN1cnZlIGFjY29yZGluZyB0byBhcmMgbGVuZ3RoCiAgLy8gLSB1IFswIC4uIDFdCgoKICBfY3JlYXRlQ2xhc3MoQ3VydmUsIFt7CiAgICBrZXk6ICJnZXRQb2ludEF0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQb2ludEF0KHUpIHsKICAgICAgdmFyIHQgPSB0aGlzLmdldFV0b1RtYXBwaW5nKHUpOwogICAgICByZXR1cm4gdGhpcy5nZXRQb2ludCh0KTsKICAgIH0gLy8gR2V0IHNlcXVlbmNlIG9mIHBvaW50cyB1c2luZyBnZXRQb2ludCggdCApCgogIH0sIHsKICAgIGtleTogImdldFBvaW50cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UG9pbnRzKGRpdmlzaW9ucykgewogICAgICBpZiAoZGl2aXNpb25zID09PSB1bmRlZmluZWQpIGRpdmlzaW9ucyA9IDU7CiAgICAgIHZhciBwb2ludHMgPSBbXTsKCiAgICAgIGZvciAodmFyIGQgPSAwOyBkIDw9IGRpdmlzaW9uczsgZCsrKSB7CiAgICAgICAgcG9pbnRzLnB1c2godGhpcy5nZXRQb2ludChkIC8gZGl2aXNpb25zKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb2ludHM7CiAgICB9IC8vIHl1bnlhbmcKCiAgfSwgewogICAga2V5OiAiZ2V0UG9pbnRzQnlTdGVwc2l6ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UG9pbnRzQnlTdGVwc2l6ZShzdGVwU2l6ZSkgewogICAgICBpZiAoc3RlcFNpemUgPT09IHVuZGVmaW5lZCkgc3RlcFNpemUgPSA1OwogICAgICB2YXIgbGVuZ3RoID0gdGhpcy5nZXRMZW5ndGgoKTsKICAgICAgdmFyIGRpdmlzaW9uczsKCiAgICAgIGlmIChzdGVwU2l6ZSA+IGxlbmd0aCkgewogICAgICAgIGRpdmlzaW9ucyA9IDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGl2aXNpb25zID0gTWF0aC5yb3VuZChsZW5ndGggLyBzdGVwU2l6ZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmdldFBvaW50cyhkaXZpc2lvbnMpOwogICAgfSAvLyBzaWduZWQgYXJlYSBvZiBhIHRyaWFuZ2xlCgogIH0sIHsKICAgIGtleTogInRyaWFuZ2xlQXJlYSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdHJpYW5nbGVBcmVhKHAsIHEsIHIpIHsKICAgICAgcmV0dXJuIE1hdGguYWJzKChxLnggLSBwLngpICogKHIueSAtIHAueSkgLSAocS55IC0gcC55KSAqIChyLnggLSBwLngpKTsKICAgIH0gLy8gUiBpcyBwb2ludCBiZXR3ZWVuIFAgYW5kIFEKCiAgfSwgewogICAga2V5OiAiY2hlY2tGbGF0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja0ZsYXQocG9pbnRQLCBwb2ludFEsIHBvaW50UiwgdG9sZXJhbmNlKSB7CiAgICAgIHJldHVybiB0aGlzLnRyaWFuZ2xlQXJlYShwb2ludFAsIHBvaW50USwgcG9pbnRSKSA8IHRvbGVyYW5jZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzYW1wbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNhbXBsZSh0UCwgdFEsIHRvbGVyYW5jZSwgc2FtcGxlUG9pbnRzKSB7CiAgICAgIGlmICh0aGlzLnJlY3VyRGVwdGggPiAxMDApIHsKICAgICAgICAvLyBkZWJ1Zy5sb2coInJlY3VyRGVwdGggPiAxMDAiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMucmVjdXJEZXB0aCsrOwogICAgICB2YXIgcG9pbnRQID0gdGhpcy5nZXRQb2ludEF0KHRQKTsKICAgICAgdmFyIHBvaW50USA9IHRoaXMuZ2V0UG9pbnRBdCh0USk7CiAgICAgIHZhciB0ID0gMC40NTsgLy8gKyAwLjEgKiAoTWF0aC5yYW5kb20oKSoyLTEpOyAvL01hdGgucmFuZG9tKCktLT4oMCwxKQoKICAgICAgdmFyIHRSID0gdFAgKyAodFEgLSB0UCkgKiB0OwogICAgICB2YXIgcG9pbnRSID0gdGhpcy5nZXRQb2ludEF0KHRSKTsKCiAgICAgIGlmICh0aGlzLmNoZWNrRmxhdChwb2ludFAsIHBvaW50USwgcG9pbnRSLCB0b2xlcmFuY2UpKSB7CiAgICAgICAgLy8gc2FtcGxlUG9pbnRzLmFkZChwb2ludFApOwogICAgICAgIHNhbXBsZVBvaW50cy5hZGQocG9pbnRRKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNhbXBsZSh0UCwgdFIsIHRvbGVyYW5jZSwgc2FtcGxlUG9pbnRzKTsKICAgICAgICB0aGlzLnNhbXBsZSh0UiwgdFEsIHRvbGVyYW5jZSwgc2FtcGxlUG9pbnRzKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImdldFBvaW50c0FkYXB0aXZlbHk0Q3VydmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBvaW50c0FkYXB0aXZlbHk0Q3VydmUoKSB7CiAgICAgIHZhciB0b2xlcmFuY2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDAuMDE7CiAgICAgIHRoaXMucmVjdXJEZXB0aCA9IDA7CiAgICAgIHZhciBzYW1wbGVQb2ludHMgPSBuZXcgU2V0KCk7CiAgICAgIHZhciB0UCA9IDA7CiAgICAgIHZhciB0USA9IDE7CiAgICAgIHNhbXBsZVBvaW50cy5hZGQodGhpcy5nZXRQb2ludEF0KDApKTsKICAgICAgdGhpcy5zYW1wbGUodFAsIHRRLCB0b2xlcmFuY2UsIHNhbXBsZVBvaW50cyk7CiAgICAgIHJldHVybiBBcnJheS5mcm9tKHNhbXBsZVBvaW50cyk7CiAgICB9IC8vIEdldCBzZXF1ZW5jZSBvZiBwb2ludHMgdXNpbmcgZ2V0UG9pbnRBdCggdSApCgogIH0sIHsKICAgIGtleTogImdldFNwYWNlZFBvaW50cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3BhY2VkUG9pbnRzKGRpdmlzaW9ucykgewogICAgICBpZiAoZGl2aXNpb25zID09PSB1bmRlZmluZWQpIGRpdmlzaW9ucyA9IDU7CiAgICAgIHZhciBwb2ludHMgPSBbXTsKCiAgICAgIGZvciAodmFyIGQgPSAwOyBkIDw9IGRpdmlzaW9uczsgZCsrKSB7CiAgICAgICAgcG9pbnRzLnB1c2godGhpcy5nZXRQb2ludEF0KGQgLyBkaXZpc2lvbnMpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvaW50czsKICAgIH0gLy8gR2V0IHRvdGFsIGN1cnZlIGFyYyBsZW5ndGgKCiAgfSwgewogICAga2V5OiAiZ2V0TGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMZW5ndGgoKSB7CiAgICAgIHZhciBsZW5ndGhzID0gdGhpcy5nZXRMZW5ndGhzKCk7CiAgICAgIHJldHVybiBsZW5ndGhzW2xlbmd0aHMubGVuZ3RoIC0gMV07CiAgICB9IC8vIEdldCBsaXN0IG9mIGN1bXVsYXRpdmUgc2VnbWVudCBsZW5ndGhzCgogIH0sIHsKICAgIGtleTogImdldExlbmd0aHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExlbmd0aHMoZGl2aXNpb25zKSB7CiAgICAgIGlmIChkaXZpc2lvbnMgPT09IHVuZGVmaW5lZCkgZGl2aXNpb25zID0gdGhpcy5hcmNMZW5ndGhEaXZpc2lvbnM7CgogICAgICBpZiAodGhpcy5jYWNoZUFyY0xlbmd0aHMgJiYgdGhpcy5jYWNoZUFyY0xlbmd0aHMubGVuZ3RoID09PSBkaXZpc2lvbnMgKyAxICYmICF0aGlzLm5lZWRzVXBkYXRlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGVBcmNMZW5ndGhzOwogICAgICB9CgogICAgICB0aGlzLm5lZWRzVXBkYXRlID0gZmFsc2U7CiAgICAgIHZhciBjYWNoZSA9IFtdOwogICAgICB2YXIgY3VycmVudDsKICAgICAgdmFyIGxhc3QgPSB0aGlzLmdldFBvaW50KDApOwogICAgICB2YXIgcDsKICAgICAgdmFyIHN1bSA9IDA7CiAgICAgIGNhY2hlLnB1c2goMCk7CgogICAgICBmb3IgKHAgPSAxOyBwIDw9IGRpdmlzaW9uczsgcCsrKSB7CiAgICAgICAgY3VycmVudCA9IHRoaXMuZ2V0UG9pbnQocCAvIGRpdmlzaW9ucyk7CiAgICAgICAgc3VtICs9IGN1cnJlbnQuZGlzdGFuY2VUbyhsYXN0KTsKICAgICAgICBjYWNoZS5wdXNoKHN1bSk7CiAgICAgICAgbGFzdCA9IGN1cnJlbnQ7CiAgICAgIH0KCiAgICAgIHRoaXMuY2FjaGVBcmNMZW5ndGhzID0gY2FjaGU7CiAgICAgIHJldHVybiBjYWNoZTsgLy8geyBzdW1zOiBjYWNoZSwgc3VtOiBzdW0gfTsgU3VtIGlzIGluIHRoZSBsYXN0IGVsZW1lbnQuCiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlQXJjTGVuZ3RocyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXJjTGVuZ3RocygpIHsKICAgICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMuZ2V0TGVuZ3RocygpOwogICAgfSAvLyBHaXZlbiB1ICggMCAuLiAxICksIGdldCBhIHQgdG8gZmluZCBwLiBUaGlzIGdpdmVzIHlvdSBwb2ludHMgd2hpY2ggYXJlIGVxdWlkaXN0YW50CgogIH0sIHsKICAgIGtleTogImdldFV0b1RtYXBwaW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRVdG9UbWFwcGluZyh1LCBkaXN0YW5jZSkgewogICAgICB2YXIgYXJjTGVuZ3RocyA9IHRoaXMuZ2V0TGVuZ3RocygpOwogICAgICB2YXIgaSA9IDA7CiAgICAgIHZhciBpbCA9IGFyY0xlbmd0aHMubGVuZ3RoOwogICAgICB2YXIgdGFyZ2V0QXJjTGVuZ3RoOyAvLyBUaGUgdGFyZ2V0ZWQgdSBkaXN0YW5jZSB2YWx1ZSB0byBnZXQKCiAgICAgIGlmIChkaXN0YW5jZSkgewogICAgICAgIHRhcmdldEFyY0xlbmd0aCA9IGRpc3RhbmNlOwogICAgICB9IGVsc2UgewogICAgICAgIHRhcmdldEFyY0xlbmd0aCA9IHUgKiBhcmNMZW5ndGhzW2lsIC0gMV07CiAgICAgIH0gLy8gYmluYXJ5IHNlYXJjaCBmb3IgdGhlIGluZGV4IHdpdGggbGFyZ2VzdCB2YWx1ZSBzbWFsbGVyIHRoYW4gdGFyZ2V0IHUgZGlzdGFuY2UKCgogICAgICB2YXIgbG93ID0gMDsKICAgICAgdmFyIGhpZ2ggPSBpbCAtIDE7CiAgICAgIHZhciBjb21wYXJpc29uOwoKICAgICAgd2hpbGUgKGxvdyA8PSBoaWdoKSB7CiAgICAgICAgaSA9IE1hdGguZmxvb3IobG93ICsgKGhpZ2ggLSBsb3cpIC8gMik7IC8vIGxlc3MgbGlrZWx5IHRvIG92ZXJmbG93LCB0aG91Z2ggcHJvYmFibHkgbm90IGlzc3VlIGhlcmUsIEpTIGRvZXNuJ3QgcmVhbGx5IGhhdmUgaW50ZWdlcnMsIGFsbCBudW1iZXJzIGFyZSBmbG9hdHMKCiAgICAgICAgY29tcGFyaXNvbiA9IGFyY0xlbmd0aHNbaV0gLSB0YXJnZXRBcmNMZW5ndGg7CgogICAgICAgIGlmIChjb21wYXJpc29uIDwgMCkgewogICAgICAgICAgbG93ID0gaSArIDE7CiAgICAgICAgfSBlbHNlIGlmIChjb21wYXJpc29uID4gMCkgewogICAgICAgICAgaGlnaCA9IGkgLSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoaWdoID0gaTsKICAgICAgICAgIGJyZWFrOyAvLyBET05FCiAgICAgICAgfQogICAgICB9CgogICAgICBpID0gaGlnaDsKCiAgICAgIGlmIChhcmNMZW5ndGhzW2ldID09PSB0YXJnZXRBcmNMZW5ndGgpIHsKICAgICAgICByZXR1cm4gaSAvIChpbCAtIDEpOwogICAgICB9IC8vIHdlIGNvdWxkIGdldCBmaW5lciBncmFpbiBhdCBsZW5ndGhzLCBvciB1c2Ugc2ltcGxlIGludGVycG9sYXRpb24gYmV0d2VlbiB0d28gcG9pbnRzCgoKICAgICAgdmFyIGxlbmd0aEJlZm9yZSA9IGFyY0xlbmd0aHNbaV07CiAgICAgIHZhciBsZW5ndGhBZnRlciA9IGFyY0xlbmd0aHNbaSArIDFdOwogICAgICB2YXIgc2VnbWVudExlbmd0aCA9IGxlbmd0aEFmdGVyIC0gbGVuZ3RoQmVmb3JlOyAvLyBkZXRlcm1pbmUgd2hlcmUgd2UgYXJlIGJldHdlZW4gdGhlICdiZWZvcmUnIGFuZCAnYWZ0ZXInIHBvaW50cwoKICAgICAgdmFyIHNlZ21lbnRGcmFjdGlvbiA9ICh0YXJnZXRBcmNMZW5ndGggLSBsZW5ndGhCZWZvcmUpIC8gc2VnbWVudExlbmd0aDsgLy8gYWRkIHRoYXQgZnJhY3Rpb25hbCBhbW91bnQgdG8gdAoKICAgICAgdmFyIHQgPSAoaSArIHNlZ21lbnRGcmFjdGlvbikgLyAoaWwgLSAxKTsKICAgICAgcmV0dXJuIHQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Tm9ybWFsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROb3JtYWwodCkgewogICAgICB2YXIgX3RoaXMkZ2V0VGFuZ2VudCA9IHRoaXMuZ2V0VGFuZ2VudCh0KSwKICAgICAgICAgIHggPSBfdGhpcyRnZXRUYW5nZW50LngsCiAgICAgICAgICB5ID0gX3RoaXMkZ2V0VGFuZ2VudC55OyAvLyDnm7Tnur/pgIbml7bpkojml4vovawgOTAg5bqmCgoKICAgICAgdmFyIG5vcm1hbCA9IG5ldyBWZWN0b3IyKHksIC14KTsKICAgICAgcmV0dXJuIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgIH0gLy8gUmV0dXJucyBhIHVuaXQgdmVjdG9yIHRhbmdlbnQgYXQgdAogICAgLy8gSW4gY2FzZSBhbnkgc3ViIGN1cnZlIGRvZXMgbm90IGltcGxlbWVudCBpdHMgdGFuZ2VudCBkZXJpdmF0aW9uLAogICAgLy8gMiBwb2ludHMgYSBzbWFsbCBkZWx0YSBhcGFydCB3aWxsIGJlIHVzZWQgdG8gZmluZCBpdHMgZ3JhZGllbnQKICAgIC8vIHdoaWNoIHNlZW1zIHRvIGdpdmUgYSByZWFzb25hYmxlIGFwcHJveGltYXRpb24KCiAgfSwgewogICAga2V5OiAiZ2V0VGFuZ2VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VGFuZ2VudCh0KSB7CiAgICAgIHZhciBkZWx0YSA9IDAuMDAwMTsKICAgICAgdmFyIHQxID0gdCAtIGRlbHRhOwogICAgICB2YXIgdDIgPSB0ICsgZGVsdGE7IC8vIENhcHBpbmcgaW4gY2FzZSBvZiBkYW5nZXIKCiAgICAgIGlmICh0MSA8IDApIHQxID0gMDsKICAgICAgaWYgKHQyID4gMSkgdDIgPSAxOwogICAgICB2YXIgcHQxID0gdGhpcy5nZXRQb2ludCh0MSk7CiAgICAgIHZhciBwdDIgPSB0aGlzLmdldFBvaW50KHQyKTsKICAgICAgdmFyIHZlYyA9IHB0Mi5jbG9uZSgpLnN1YihwdDEpOwogICAgICByZXR1cm4gdmVjLm5vcm1hbGl6ZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFRhbmdlbnRBdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VGFuZ2VudEF0KHUpIHsKICAgICAgdmFyIHQgPSB0aGlzLmdldFV0b1RtYXBwaW5nKHUpOwogICAgICByZXR1cm4gdGhpcy5nZXRUYW5nZW50KHQpOwogICAgfQogIH0sIHsKICAgIGtleTogImNvbXB1dGVGcmVuZXRGcmFtZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXB1dGVGcmVuZXRGcmFtZXMoc2VnbWVudHMsIGNsb3NlZCkgewogICAgICAvLyBzZWUgaHR0cDovL3d3dy5jcy5pbmRpYW5hLmVkdS9wdWIvdGVjaHJlcG9ydHMvVFI0MjUucGRmCiAgICAgIHZhciBub3JtYWwgPSBuZXcgVmVjdG9yMygpOwogICAgICB2YXIgdGFuZ2VudHMgPSBbXTsKICAgICAgdmFyIG5vcm1hbHMgPSBbXTsKICAgICAgdmFyIGJpbm9ybWFscyA9IFtdOwogICAgICB2YXIgdmVjID0gbmV3IFZlY3RvcjMoKTsKICAgICAgdmFyIG1hdCA9IG5ldyBNYXRyaXg0KCk7CiAgICAgIHZhciBpLCB1LCB0aGV0YTsgLy8gY29tcHV0ZSB0aGUgdGFuZ2VudCB2ZWN0b3JzIGZvciBlYWNoIHNlZ21lbnQgb24gdGhlIGN1cnZlCgogICAgICBmb3IgKGkgPSAwOyBpIDw9IHNlZ21lbnRzOyBpKyspIHsKICAgICAgICB1ID0gaSAvIHNlZ21lbnRzOwogICAgICAgIHRhbmdlbnRzW2ldID0gdGhpcy5nZXRUYW5nZW50QXQodSk7CiAgICAgICAgdGFuZ2VudHNbaV0ubm9ybWFsaXplKCk7CiAgICAgIH0gLy8gc2VsZWN0IGFuIGluaXRpYWwgbm9ybWFsIHZlY3RvciBwZXJwZW5kaWN1bGFyIHRvIHRoZSBmaXJzdCB0YW5nZW50IHZlY3RvciwKICAgICAgLy8gYW5kIGluIHRoZSBkaXJlY3Rpb24gb2YgdGhlIG1pbmltdW0gdGFuZ2VudCB4eXogY29tcG9uZW50CgoKICAgICAgbm9ybWFsc1swXSA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIGJpbm9ybWFsc1swXSA9IG5ldyBWZWN0b3IzKCk7CiAgICAgIHZhciBtaW4gPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICB2YXIgdHggPSBNYXRoLmFicyh0YW5nZW50c1swXS54KTsKICAgICAgdmFyIHR5ID0gTWF0aC5hYnModGFuZ2VudHNbMF0ueSk7CiAgICAgIHZhciB0eiA9IE1hdGguYWJzKHRhbmdlbnRzWzBdLnopOwoKICAgICAgaWYgKHR4IDw9IG1pbikgewogICAgICAgIG1pbiA9IHR4OwogICAgICAgIG5vcm1hbC5zZXQoMSwgMCwgMCk7CiAgICAgIH0KCiAgICAgIGlmICh0eSA8PSBtaW4pIHsKICAgICAgICBtaW4gPSB0eTsKICAgICAgICBub3JtYWwuc2V0KDAsIDEsIDApOwogICAgICB9CgogICAgICBpZiAodHogPD0gbWluKSB7CiAgICAgICAgbm9ybWFsLnNldCgwLCAwLCAxKTsKICAgICAgfQoKICAgICAgdmVjLmNyb3NzVmVjdG9ycyh0YW5nZW50c1swXSwgbm9ybWFsKS5ub3JtYWxpemUoKTsKICAgICAgbm9ybWFsc1swXS5jcm9zc1ZlY3RvcnModGFuZ2VudHNbMF0sIHZlYyk7CiAgICAgIGJpbm9ybWFsc1swXS5jcm9zc1ZlY3RvcnModGFuZ2VudHNbMF0sIG5vcm1hbHNbMF0pOyAvLyBjb21wdXRlIHRoZSBzbG93bHktdmFyeWluZyBub3JtYWwgYW5kIGJpbm9ybWFsIHZlY3RvcnMgZm9yIGVhY2ggc2VnbWVudCBvbiB0aGUgY3VydmUKCiAgICAgIGZvciAoaSA9IDE7IGkgPD0gc2VnbWVudHM7IGkrKykgewogICAgICAgIG5vcm1hbHNbaV0gPSBub3JtYWxzW2kgLSAxXS5jbG9uZSgpOwogICAgICAgIGJpbm9ybWFsc1tpXSA9IGJpbm9ybWFsc1tpIC0gMV0uY2xvbmUoKTsKICAgICAgICB2ZWMuY3Jvc3NWZWN0b3JzKHRhbmdlbnRzW2kgLSAxXSwgdGFuZ2VudHNbaV0pOwoKICAgICAgICBpZiAodmVjLmxlbmd0aCgpID4gTnVtYmVyLkVQU0lMT04pIHsKICAgICAgICAgIHZlYy5ub3JtYWxpemUoKTsKICAgICAgICAgIHRoZXRhID0gTWF0aC5hY29zKF9NYXRoLmNsYW1wKHRhbmdlbnRzW2kgLSAxXS5kb3QodGFuZ2VudHNbaV0pLCAtMSwgMSkpOyAvLyBjbGFtcCBmb3IgZmxvYXRpbmcgcHQgZXJyb3JzCgogICAgICAgICAgbm9ybWFsc1tpXS5hcHBseU1hdHJpeDQobWF0Lm1ha2VSb3RhdGlvbkF4aXModmVjLCB0aGV0YSkpOwogICAgICAgIH0KCiAgICAgICAgYmlub3JtYWxzW2ldLmNyb3NzVmVjdG9ycyh0YW5nZW50c1tpXSwgbm9ybWFsc1tpXSk7CiAgICAgIH0gLy8gaWYgdGhlIGN1cnZlIGlzIGNsb3NlZCwgcG9zdHByb2Nlc3MgdGhlIHZlY3RvcnMgc28gdGhlIGZpcnN0IGFuZCBsYXN0IG5vcm1hbCB2ZWN0b3JzIGFyZSB0aGUgc2FtZQoKCiAgICAgIGlmIChjbG9zZWQgPT09IHRydWUpIHsKICAgICAgICB0aGV0YSA9IE1hdGguYWNvcyhfTWF0aC5jbGFtcChub3JtYWxzWzBdLmRvdChub3JtYWxzW3NlZ21lbnRzXSksIC0xLCAxKSk7CiAgICAgICAgdGhldGEgLz0gc2VnbWVudHM7CgogICAgICAgIGlmICh0YW5nZW50c1swXS5kb3QodmVjLmNyb3NzVmVjdG9ycyhub3JtYWxzWzBdLCBub3JtYWxzW3NlZ21lbnRzXSkpID4gMCkgewogICAgICAgICAgdGhldGEgPSAtdGhldGE7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGkgPSAxOyBpIDw9IHNlZ21lbnRzOyBpKyspIHsKICAgICAgICAgIC8vIHR3aXN0IGEgbGl0dGxlLi4uCiAgICAgICAgICBub3JtYWxzW2ldLmFwcGx5TWF0cml4NChtYXQubWFrZVJvdGF0aW9uQXhpcyh0YW5nZW50c1tpXSwgdGhldGEgKiBpKSk7CiAgICAgICAgICBiaW5vcm1hbHNbaV0uY3Jvc3NWZWN0b3JzKHRhbmdlbnRzW2ldLCBub3JtYWxzW2ldKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgdGFuZ2VudHM6IHRhbmdlbnRzLAogICAgICAgIG5vcm1hbHM6IG5vcm1hbHMsCiAgICAgICAgYmlub3JtYWxzOiBiaW5vcm1hbHMKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7CiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb3B5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb3B5KHNvdXJjZSkgewogICAgICB0aGlzLmFyY0xlbmd0aERpdmlzaW9ucyA9IHNvdXJjZS5hcmNMZW5ndGhEaXZpc2lvbnM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEN1cnZlOwp9KCk7CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIkNyhEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCQ3KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KCmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QkNygpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KCnZhciBMaW5lQ3VydmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9DdXJ2ZSkgewogIF9pbmhlcml0cyhMaW5lQ3VydmUsIF9DdXJ2ZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIkNyhMaW5lQ3VydmUpOwoKICBmdW5jdGlvbiBMaW5lQ3VydmUodjEsIHYyKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmVDdXJ2ZSk7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKTsKICAgIF90aGlzLnR5cGUgPSAnTGluZUN1cnZlJzsKICAgIF90aGlzLnYxID0gdjEgfHwgbmV3IFZlY3RvcjIoKTsKICAgIF90aGlzLnYyID0gdjIgfHwgbmV3IFZlY3RvcjIoKTsKICAgIF90aGlzLmlzTGluZUN1cnZlID0gdHJ1ZTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhMaW5lQ3VydmUsIFt7CiAgICBrZXk6ICJnZXRQb2xlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQb2xlKG1pbiwgbWF4KSB7CiAgICAgIHZhciB2MSA9IHRoaXMudjEsCiAgICAgICAgICB2MiA9IHRoaXMudjI7CiAgICAgIG1pbi54ID0gTWF0aC5taW4obWluLngsIHYxLngsIHYyLngpOwogICAgICBtaW4ueSA9IE1hdGgubWluKG1pbi55LCB2MS55LCB2Mi55KTsKICAgICAgbWF4LnggPSBNYXRoLm1heChtYXgueCwgdjEueCwgdjIueCk7CiAgICAgIG1heC55ID0gTWF0aC5tYXgobWF4LnksIHYxLnksIHYyLnkpOwogICAgfQogIH0sIHsKICAgIGtleTogInBvaW50QXBwbHlGdW5jIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwb2ludEFwcGx5RnVuYyhmdW5jKSB7CiAgICAgIGZ1bmModGhpcy52MSk7CiAgICAgIGZ1bmModGhpcy52Mik7CiAgICB9CiAgfSwgewogICAga2V5OiAic3BsaXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0KF9yZWYpIHsKICAgICAgdmFyIHggPSBfcmVmLngsCiAgICAgICAgICB5ID0gX3JlZi55OwogICAgICB2YXIgdjEgPSB0aGlzLnYxLAogICAgICAgICAgdjIgPSB0aGlzLnYyOwogICAgICB2YXIgc3BsaXRCeVggPSB4ICE9PSB1bmRlZmluZWQgJiYgKHYxLnggLSB4KSAqICh2Mi54IC0geCkgPCAwOwogICAgICB2YXIgc3BsaXRCeVkgPSB5ICE9PSB1bmRlZmluZWQgJiYgKHYxLnkgLSB5KSAqICh2Mi55IC0geSkgPCAwOwoKICAgICAgaWYgKHNwbGl0QnlYKSB7CiAgICAgICAgeSA9IHYxLnkgKyAodjIueSAtIHYxLnkpIC8gKHYyLnggLSB2MS54KSAqICh4IC0gdjEueCk7CiAgICAgIH0KCiAgICAgIGlmIChzcGxpdEJ5WSkgewogICAgICAgIHggPSB2MS54ICsgKHYyLnggLSB2MS54KSAvICh2Mi55IC0gdjEueSkgKiAoeSAtIHYxLnkpOwogICAgICB9CgogICAgICBpZiAoc3BsaXRCeVggfHwgc3BsaXRCeVkpIHsKICAgICAgICB2YXIgbGluZUN1cnZlMSA9IG5ldyBMaW5lQ3VydmUodjEsIG5ldyBWZWN0b3IyKHgsIHkpKTsKICAgICAgICB2YXIgbGluZUN1cnZlMiA9IG5ldyBMaW5lQ3VydmUobmV3IFZlY3RvcjIoeCwgeSksIHYyKTsKICAgICAgICByZXR1cm4gW2xpbmVDdXJ2ZTEsIGxpbmVDdXJ2ZTJdOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBbdGhpc107CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRMZW5ndGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExlbmd0aCgpIHsKICAgICAgdmFyIHYxID0gdGhpcy52MSwKICAgICAgICAgIHYyID0gdGhpcy52MjsKICAgICAgcmV0dXJuIE1hdGguaHlwb3QodjEueCAtIHYyLngsIHYxLnkgLSB2Mi55KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQb2ludCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UG9pbnQodCkgewogICAgICB2YXIgcG9pbnQgPSBuZXcgVmVjdG9yMigpOwoKICAgICAgaWYgKHQgPT09IDEpIHsKICAgICAgICBwb2ludC5jb3B5KHRoaXMudjIpOwogICAgICB9IGVsc2UgewogICAgICAgIHBvaW50LmNvcHkodGhpcy52Mikuc3ViKHRoaXMudjEpOwogICAgICAgIHBvaW50Lm11bHRpcGx5U2NhbGFyKHQpLmFkZCh0aGlzLnYxKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvaW50OwogICAgfQogIH0sIHsKICAgIGtleTogImdldE5vcm1hbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Tm9ybWFsKCkgewogICAgICB2YXIgeCA9IHRoaXMudjIueCAtIHRoaXMudjEueDsKICAgICAgdmFyIHkgPSB0aGlzLnYyLnkgLSB0aGlzLnYxLnk7IC8vIOebtOe6v+mAhuaXtumSiOaXi+i9rCA5MCDluqYKCiAgICAgIHZhciBub3JtYWwgPSBuZXcgVmVjdG9yMih5LCAteCk7CiAgICAgIHJldHVybiBub3JtYWwubm9ybWFsaXplKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VGFuZ2VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VGFuZ2VudCgpIHsKICAgICAgdmFyIHRhbmdlbnQgPSB0aGlzLnYyLmNsb25lKCkuc3ViKHRoaXMudjEpOwogICAgICByZXR1cm4gdGFuZ2VudC5ub3JtYWxpemUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb3B5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb3B5KHNvdXJjZSkgewogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihMaW5lQ3VydmUucHJvdG90eXBlKSwgImNvcHkiLCB0aGlzKS5jYWxsKHRoaXMsIHNvdXJjZSk7CgogICAgICB0aGlzLnYxLmNvcHkoc291cmNlLnYxKTsKICAgICAgdGhpcy52Mi5jb3B5KHNvdXJjZS52Mik7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIExpbmVDdXJ2ZTsKfShDdXJ2ZSk7CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIkNihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCQ2KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KCmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QkNigpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KLyoqCiAqIEBhdXRob3Igeno4NSAvIGh0dHA6Ly93d3cubGFiNGdhbWVzLm5ldC96ejg1L2Jsb2cKICoKICoqLwoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAqICAgIEN1cnZlZCBQYXRoIC0gYSBjdXJ2ZSBwYXRoIGlzIHNpbXBseSBhIGFycmF5IG9mIGNvbm5lY3RlZAogKiAgY3VydmVzLCBidXQgcmV0YWlucyB0aGUgYXBpIG9mIGEgY3VydmUKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKdmFyIEN1cnZlUGF0aCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0N1cnZlKSB7CiAgX2luaGVyaXRzKEN1cnZlUGF0aCwgX0N1cnZlKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlciQ2KEN1cnZlUGF0aCk7CgogIGZ1bmN0aW9uIEN1cnZlUGF0aCgpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ3VydmVQYXRoKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpOwogICAgX3RoaXMudHlwZSA9ICdDdXJ2ZVBhdGgnOwogICAgX3RoaXMuY3VydmVzID0gW107CiAgICBfdGhpcy5hdXRvQ2xvc2UgPSBmYWxzZTsgLy8gQXV0b21hdGljYWxseSBjbG9zZXMgdGhlIHBhdGgKCiAgICBfdGhpcy5pc0RlZm9ybWF0aW9uT04gPSBmYWxzZTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhDdXJ2ZVBhdGgsIFt7CiAgICBrZXk6ICJhZGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZChjdXJ2ZSkgewogICAgICB0aGlzLmN1cnZlcy5wdXNoKGN1cnZlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9zZVBhdGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlUGF0aCgpIHsKICAgICAgLy8gQWRkIGEgbGluZSBjdXJ2ZSBpZiBzdGFydCBhbmQgZW5kIG9mIGxpbmVzIGFyZSBub3QgY29ubmVjdGVkCiAgICAgIHZhciBzdGFydFBvaW50ID0gdGhpcy5jdXJ2ZXNbMF0uZ2V0UG9pbnQoMCk7CiAgICAgIHZhciBlbmRQb2ludCA9IHRoaXMuY3VydmVzW3RoaXMuY3VydmVzLmxlbmd0aCAtIDFdLmdldFBvaW50KDEpOwoKICAgICAgaWYgKCFzdGFydFBvaW50LmVxdWFscyhlbmRQb2ludCkpIHsKICAgICAgICB0aGlzLmN1cnZlcy5wdXNoKG5ldyBMaW5lQ3VydmUoZW5kUG9pbnQsIHN0YXJ0UG9pbnQpKTsKICAgICAgfQogICAgfSAvLyBUbyBnZXQgYWNjdXJhdGUgcG9pbnQgd2l0aCByZWZlcmVuY2UgdG8KICAgIC8vIGVudGlyZSBwYXRoIGRpc3RhbmNlIGF0IHRpbWUgdCwKICAgIC8vIGZvbGxvd2luZyBoYXMgdG8gYmUgZG9uZToKICAgIC8vIDEuIExlbmd0aCBvZiBlYWNoIHN1YiBwYXRoIGhhdmUgdG8gYmUga25vd24KICAgIC8vIDIuIExvY2F0ZSBhbmQgaWRlbnRpZnkgdHlwZSBvZiBjdXJ2ZQogICAgLy8gMy4gR2V0IHQgZm9yIHRoZSBjdXJ2ZQogICAgLy8gNC4gUmV0dXJuIGN1cnZlLmdldFBvaW50QXQodCcpCgogIH0sIHsKICAgIGtleTogImdldFBvaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQb2ludCh0KSB7CiAgICAgIHZhciBkID0gdCAqIHRoaXMuZ2V0TGVuZ3RoKCk7CiAgICAgIHZhciBjdXJ2ZUxlbmd0aHMgPSB0aGlzLmdldEN1cnZlTGVuZ3RocygpOwogICAgICB2YXIgaSA9IDA7IC8vIFRvIHRoaW5rIGFib3V0IGJvdW5kYXJpZXMgcG9pbnRzLgoKICAgICAgd2hpbGUgKGkgPCBjdXJ2ZUxlbmd0aHMubGVuZ3RoKSB7CiAgICAgICAgaWYgKGN1cnZlTGVuZ3Roc1tpXSA+PSBkKSB7CiAgICAgICAgICB2YXIgZGlmZiA9IGN1cnZlTGVuZ3Roc1tpXSAtIGQ7CiAgICAgICAgICB2YXIgY3VydmUgPSB0aGlzLmN1cnZlc1tpXTsKICAgICAgICAgIHZhciBzZWdtZW50TGVuZ3RoID0gY3VydmUuZ2V0TGVuZ3RoKCk7CiAgICAgICAgICB2YXIgdSA9IHNlZ21lbnRMZW5ndGggPT09IDAgPyAwIDogMSAtIGRpZmYgLyBzZWdtZW50TGVuZ3RoOwogICAgICAgICAgcmV0dXJuIGN1cnZlLmdldFBvaW50QXQodSk7CiAgICAgICAgfQoKICAgICAgICBpKys7CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOyAvLyBsb29wIHdoZXJlIHN1bSAhPSAwLCBzdW0gPiBkICwgc3VtKzEgPGQKICAgIH0gLy8gV2UgY2Fubm90IHVzZSB0aGUgZGVmYXVsdCBUSFJFRS5DdXJ2ZSBnZXRQb2ludCgpIHdpdGggZ2V0TGVuZ3RoKCkgYmVjYXVzZSBpbgogICAgLy8gVEhSRUUuQ3VydmUsIGdldExlbmd0aCgpIGRlcGVuZHMgb24gZ2V0UG9pbnQoKSBidXQgaW4gVEhSRUUuQ3VydmVQYXRoCiAgICAvLyBnZXRQb2ludCgpIGRlcGVuZHMgb24gZ2V0TGVuZ3RoCgogIH0sIHsKICAgIGtleTogImdldExlbmd0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGVuZ3RoKCkgewogICAgICB2YXIgbGVucyA9IHRoaXMuZ2V0Q3VydmVMZW5ndGhzKCk7CiAgICAgIHJldHVybiBsZW5zW2xlbnMubGVuZ3RoIC0gMV07CiAgICB9IC8vIGNhY2hlTGVuZ3RocyBtdXN0IGJlIHJlY2FsY3VsYXRlZC4KCiAgfSwgewogICAga2V5OiAidXBkYXRlQXJjTGVuZ3RocyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXJjTGVuZ3RocygpIHsKICAgICAgdGhpcy5uZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMuY2FjaGVMZW5ndGhzID0gbnVsbDsKICAgICAgdGhpcy5nZXRDdXJ2ZUxlbmd0aHMoKTsKICAgIH0gLy8gQ29tcHV0ZSBsZW5ndGhzIGFuZCBjYWNoZSB0aGVtCiAgICAvLyBXZSBjYW5ub3Qgb3ZlcndyaXRlIGdldExlbmd0aHMoKSBiZWNhdXNlIFV0b1QgbWFwcGluZyB1c2VzIGl0LgoKICB9LCB7CiAgICBrZXk6ICJnZXRDdXJ2ZUxlbmd0aHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEN1cnZlTGVuZ3RocygpIHsKICAgICAgLy8gV2UgdXNlIGNhY2hlIHZhbHVlcyBpZiBjdXJ2ZXMgYW5kIGNhY2hlIGFycmF5IGFyZSBzYW1lIGxlbmd0aAogICAgICBpZiAodGhpcy5jYWNoZUxlbmd0aHMgJiYgdGhpcy5jYWNoZUxlbmd0aHMubGVuZ3RoID09PSB0aGlzLmN1cnZlcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gdGhpcy5jYWNoZUxlbmd0aHM7CiAgICAgIH0gLy8gR2V0IGxlbmd0aCBvZiBzdWItY3VydmUKICAgICAgLy8gUHVzaCBzdW1zIGludG8gY2FjaGVkIGFycmF5CgoKICAgICAgdmFyIGxlbmd0aHMgPSBbXTsKICAgICAgdmFyIHN1bXMgPSAwOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmN1cnZlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBzdW1zICs9IHRoaXMuY3VydmVzW2ldLmdldExlbmd0aCgpOwogICAgICAgIGxlbmd0aHMucHVzaChzdW1zKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWNoZUxlbmd0aHMgPSBsZW5ndGhzOwogICAgICByZXR1cm4gbGVuZ3RoczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTcGFjZWRQb2ludHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNwYWNlZFBvaW50cyhkaXZpc2lvbnMpIHsKICAgICAgaWYgKGRpdmlzaW9ucyA9PT0gdW5kZWZpbmVkKSBkaXZpc2lvbnMgPSA0MDsKICAgICAgdmFyIHBvaW50cyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gZGl2aXNpb25zOyBpKyspIHsKICAgICAgICBwb2ludHMucHVzaCh0aGlzLmdldFBvaW50KGkgLyBkaXZpc2lvbnMpKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuYXV0b0Nsb3NlKSB7CiAgICAgICAgcG9pbnRzLnB1c2gocG9pbnRzWzBdKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvaW50czsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQb2ludHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBvaW50cyhkaXZpc2lvbnMpIHsKICAgICAgZGl2aXNpb25zID0gZGl2aXNpb25zIHx8IDEyOwogICAgICB2YXIgcG9pbnRzID0gW107CiAgICAgIHZhciBsYXN0OwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmN1cnZlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBjdXJ2ZSA9IHRoaXMuY3VydmVzW2ldOwogICAgICAgIHZhciByZXNvbHV0aW9uID0gY3VydmUgJiYgY3VydmUuaXNFbGxpcHNlQ3VydmUgPyBkaXZpc2lvbnMgKiAyIDogY3VydmUgJiYgKGN1cnZlLmlzTGluZUN1cnZlIHx8IGN1cnZlLmlzTGluZUN1cnZlMykgPyAxIDogY3VydmUgJiYgY3VydmUuaXNTcGxpbmVDdXJ2ZSA/IGRpdmlzaW9ucyAqIGN1cnZlLnBvaW50cy5sZW5ndGggOiBkaXZpc2lvbnM7IC8vIHl1bnlhbmcgLy/lvoXop6PlhrPvvIznm7Tnur/lpJrkuKrph4fmoLfngrnvvIzkvJrlr7zoh7Tohqjog4DlgJLop5LnmoRnZXR2ZWN0b3IoKeiuoeeul+WcqOafkOS6m+WcsOaWueWHuueOsGJ1ZwoKICAgICAgICBpZiAoY3VydmUgJiYgY3VydmUuaXNMaW5lQ3VydmUpIHsKICAgICAgICAgIHJlc29sdXRpb24gPSBkaXZpc2lvbnM7CiAgICAgICAgfQoKICAgICAgICB2YXIgcHRzID0gY3VydmUuZ2V0UG9pbnRzKHJlc29sdXRpb24pOyAvLyBsZXQgcHRzID0gY3VydmUuZ2V0UG9pbnRzQnlTdGVwc2l6ZSggcmVzb2x1dGlvbiApOwoKICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHB0cy5sZW5ndGg7IGorKykgewogICAgICAgICAgdmFyIHBvaW50ID0gcHRzW2pdOwogICAgICAgICAgaWYgKGxhc3QgJiYgbGFzdC5lcXVhbHMocG9pbnQpKSBjb250aW51ZTsgLy8gZW5zdXJlcyBubyBjb25zZWN1dGl2ZSBwb2ludHMgYXJlIGR1cGxpY2F0ZXMKCiAgICAgICAgICBwb2ludHMucHVzaChwb2ludCk7CiAgICAgICAgICBsYXN0ID0gcG9pbnQ7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5hdXRvQ2xvc2UgJiYgcG9pbnRzLmxlbmd0aCA+IDEgJiYgIXBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0uZXF1YWxzKHBvaW50c1swXSkpIHsKICAgICAgICBwb2ludHMucHVzaChwb2ludHNbMF0pOwogICAgICB9CgogICAgICByZXR1cm4gcG9pbnRzOwogICAgfSAvLyB5dW55YW5nCgogIH0sIHsKICAgIGtleTogImdldFBvaW50c0J5U3RlcFNpemUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBvaW50c0J5U3RlcFNpemUoc3RlcFNpemUpIHsKICAgICAgc3RlcFNpemUgPSBzdGVwU2l6ZSB8fCAxOwogICAgICB2YXIgcG9pbnRzID0gW107CiAgICAgIHZhciBsYXN0OwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGN1cnZlcyA9IHRoaXMuY3VydmVzOyBpIDwgY3VydmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGN1cnZlID0gY3VydmVzW2ldOwogICAgICAgIHZhciBjdXJ2ZUxlbmd0aCA9IGN1cnZlLmdldExlbmd0aCgyMCk7CiAgICAgICAgdmFyIHJlc29sdXRpb24gPSBwYXJzZUludChNYXRoLm1heCgxLCBjdXJ2ZUxlbmd0aCAvIHN0ZXBTaXplKSk7IC8vIOacgOWwkeS4pOS4qumHh+agt+eCuQoKICAgICAgICBkZWJ1Zy5sb2coJ3Jlc29sdXRpb24nLCByZXNvbHV0aW9uKTsKICAgICAgICB2YXIgcHRzID0gY3VydmUuZ2V0UG9pbnRzKHJlc29sdXRpb24pOwoKICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHB0cy5sZW5ndGg7IGorKykgewogICAgICAgICAgdmFyIHBvaW50ID0gcHRzW2pdOwogICAgICAgICAgaWYgKGxhc3QgJiYgbGFzdC5lcXVhbHMocG9pbnQpKSBjb250aW51ZTsgLy8gZW5zdXJlcyBubyBjb25zZWN1dGl2ZSBwb2ludHMgYXJlIGR1cGxpY2F0ZXMKCiAgICAgICAgICBwb2ludHMucHVzaChwb2ludCk7CiAgICAgICAgICBsYXN0ID0gcG9pbnQ7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5hdXRvQ2xvc2UgJiYgcG9pbnRzLmxlbmd0aCA+IDEgJiYgIXBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0uZXF1YWxzKHBvaW50c1swXSkpIHsKICAgICAgICBwb2ludHMucHVzaChwb2ludHNbMF0pOwogICAgICB9CgogICAgICByZXR1cm4gcG9pbnRzOwogICAgfSAvLyB5dW55YW5nCgogIH0sIHsKICAgIGtleTogImdldFBvaW50c0FkYXB0aXZlbHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBvaW50c0FkYXB0aXZlbHkodG9sZXJhbmNlKSB7CiAgICAgIHRvbGVyYW5jZSA9IHRvbGVyYW5jZSB8fCAwLjAxOwogICAgICB2YXIgcG9pbnRzID0gW107CiAgICAgIHZhciBsYXN0OwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGN1cnZlcyA9IHRoaXMuY3VydmVzOyBpIDwgY3VydmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGN1cnZlID0gY3VydmVzW2ldOwogICAgICAgIHZhciBwdHMgPSB2b2lkIDA7CgogICAgICAgIGlmIChjdXJ2ZS5pc0xpbmVDdXJ2ZSAmJiB0aGlzLmlzRGVmb3JtYXRpb25PTikgewogICAgICAgICAgLy8g5Y+Y5b2i5pe25YaN6ICD6JmRCiAgICAgICAgICB2YXIgY3VydmVMZW5ndGggPSBjdXJ2ZS5nZXRMZW5ndGgoMjApOwogICAgICAgICAgdmFyIHN0ZXBTaXplID0gTWF0aC5tYXgoMSwgdG9sZXJhbmNlICogMS41KTsgLy8gbGV0IHN0ZXBTaXplID0gMTA7Ly9NYXRoLm1heCgxLCB0b2xlcmFuY2UqMTAwKTsKCiAgICAgICAgICB2YXIgcmVzb2x1dGlvbiA9IHBhcnNlSW50KE1hdGgubWF4KDEsIGN1cnZlTGVuZ3RoIC8gc3RlcFNpemUpKTsgLy8g5pyA5bCR5Lik5Liq6YeH5qC354K5CiAgICAgICAgICAvLyBkZWJ1Zy5sb2coInJlc29sdXRpb24iLCByZXNvbHV0aW9uKTsKCiAgICAgICAgICByZXNvbHV0aW9uID0gTWF0aC5taW4oMjAsIHJlc29sdXRpb24pOyAvLyDmnIDlpJoyMOS4qumHh+agt+eCuQoKICAgICAgICAgIHB0cyA9IGN1cnZlLmdldFBvaW50cyhyZXNvbHV0aW9uKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcHRzID0gY3VydmUuZ2V0UG9pbnRzQWRhcHRpdmVseTRDdXJ2ZSh0b2xlcmFuY2UpOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwdHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIHZhciBwb2ludCA9IHB0c1tqXTsKICAgICAgICAgIGlmIChsYXN0ICYmIGxhc3QuZXF1YWxzKHBvaW50KSkgY29udGludWU7IC8vIGVuc3VyZXMgbm8gY29uc2VjdXRpdmUgcG9pbnRzIGFyZSBkdXBsaWNhdGVzCgogICAgICAgICAgcG9pbnRzLnB1c2gocG9pbnQpOwogICAgICAgICAgbGFzdCA9IHBvaW50OwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuYXV0b0Nsb3NlICYmIHBvaW50cy5sZW5ndGggPiAxICYmICFwb2ludHNbcG9pbnRzLmxlbmd0aCAtIDFdLmVxdWFscyhwb2ludHNbMF0pKSB7CiAgICAgICAgcG9pbnRzLnB1c2gocG9pbnRzWzBdKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvaW50czsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb3B5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb3B5KHNvdXJjZSkgewogICAgICBPYmplY3QuYXNzaWduKHRoaXMsIHNvdXJjZSk7CiAgICAgIHRoaXMuY3VydmVzID0gW107CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHNvdXJjZS5jdXJ2ZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgdmFyIGN1cnZlID0gc291cmNlLmN1cnZlc1tpXTsKICAgICAgICB0aGlzLmN1cnZlcy5wdXNoKGN1cnZlLmNsb25lKCkpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9XSk7CgogIHJldHVybiBDdXJ2ZVBhdGg7Cn0oQ3VydmUpOwoKZnVuY3Rpb24gX2NyZWF0ZVN1cGVyJDUoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QkNSgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0JDUoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9CnZhciBFbGxpcHNlQ3VydmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9DdXJ2ZSkgewogIF9pbmhlcml0cyhFbGxpcHNlQ3VydmUsIF9DdXJ2ZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIkNShFbGxpcHNlQ3VydmUpOwoKICBmdW5jdGlvbiBFbGxpcHNlQ3VydmUoYVgsIGFZLCB4UmFkaXVzLCB5UmFkaXVzLCBzdGFydEFuZ2xlLCBlbmRBbmdsZSwgY2xvY2t3aXNlLCByb3RhdGlvbikgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFbGxpcHNlQ3VydmUpOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcyk7CiAgICBfdGhpcy50eXBlID0gJ0VsbGlwc2VDdXJ2ZSc7CiAgICBfdGhpcy5hWCA9IGFYIHx8IDA7CiAgICBfdGhpcy5hWSA9IGFZIHx8IDA7CiAgICBfdGhpcy54UmFkaXVzID0geFJhZGl1cyB8fCAxOwogICAgX3RoaXMueVJhZGl1cyA9IHlSYWRpdXMgfHwgMTsKICAgIF90aGlzLnN0YXJ0QW5nbGUgPSBzdGFydEFuZ2xlIHx8IDA7CiAgICBfdGhpcy5lbmRBbmdsZSA9IGVuZEFuZ2xlIHx8IDIgKiBNYXRoLlBJOwogICAgX3RoaXMuY2xvY2t3aXNlID0gY2xvY2t3aXNlIHx8IGZhbHNlOwogICAgX3RoaXMucm90YXRpb24gPSByb3RhdGlvbiB8fCAwOwogICAgX3RoaXMuaXNFbGxpcHNlQ3VydmUgPSB0cnVlOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEVsbGlwc2VDdXJ2ZSwgW3sKICAgIGtleTogImdldFBvaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQb2ludCh0KSB7CiAgICAgIHZhciB0d29QaSA9IE1hdGguUEkgKiAyOwogICAgICB2YXIgYVggPSB0aGlzLmFYLAogICAgICAgICAgYVkgPSB0aGlzLmFZLAogICAgICAgICAgcm90YXRpb24gPSB0aGlzLnJvdGF0aW9uLAogICAgICAgICAgeFJhZGl1cyA9IHRoaXMueFJhZGl1cywKICAgICAgICAgIHlSYWRpdXMgPSB0aGlzLnlSYWRpdXMsCiAgICAgICAgICBzdGFydEFuZ2xlID0gdGhpcy5zdGFydEFuZ2xlLAogICAgICAgICAgZW5kQW5nbGUgPSB0aGlzLmVuZEFuZ2xlOwogICAgICB2YXIgYW5nbGUgPSBzdGFydEFuZ2xlICsgdCAqIChlbmRBbmdsZSAtIHN0YXJ0QW5nbGUpOwogICAgICBhbmdsZSAlPSB0d29QaTsKCiAgICAgIGlmIChhbmdsZSA8IDApIHsKICAgICAgICBhbmdsZSArPSB0d29QaTsKICAgICAgfQoKICAgICAgdmFyIHggPSBhWCArIHhSYWRpdXMgKiBNYXRoLmNvcyhhbmdsZSk7CiAgICAgIHZhciB5ID0gYVkgKyB5UmFkaXVzICogTWF0aC5zaW4oYW5nbGUpOwoKICAgICAgaWYgKHJvdGF0aW9uKSB7CiAgICAgICAgdmFyIGNvcyA9IE1hdGguY29zKHRoaXMucm90YXRpb24pOwogICAgICAgIHZhciBzaW4gPSBNYXRoLnNpbih0aGlzLnJvdGF0aW9uKTsKICAgICAgICB2YXIgdHggPSB4IC0gYVg7CiAgICAgICAgdmFyIHR5ID0geSAtIGFZOyAvLyBSb3RhdGUgdGhlIHBvaW50IGFib3V0IHRoZSBjZW50ZXIgb2YgdGhlIGVsbGlwc2UuCgogICAgICAgIHggPSB0eCAqIGNvcyAtIHR5ICogc2luICsgYVg7CiAgICAgICAgeSA9IHR4ICogc2luICsgdHkgKiBjb3MgKyBhWTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyKHgsIHkpOwogICAgfQogIH0sIHsKICAgIGtleTogImNvcHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvcHkoc291cmNlKSB7CiAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKEVsbGlwc2VDdXJ2ZS5wcm90b3R5cGUpLCAiY29weSIsIHRoaXMpLmNhbGwodGhpcywgc291cmNlKTsKCiAgICAgIHRoaXMuYVggPSBzb3VyY2UuYVg7CiAgICAgIHRoaXMuYVkgPSBzb3VyY2UuYVk7CiAgICAgIHRoaXMueFJhZGl1cyA9IHNvdXJjZS54UmFkaXVzOwogICAgICB0aGlzLnlSYWRpdXMgPSBzb3VyY2UueVJhZGl1czsKICAgICAgdGhpcy5zdGFydEFuZ2xlID0gc291cmNlLmFTdGFydEFuZ2xlOwogICAgICB0aGlzLmVuZEFuZ2xlID0gc291cmNlLmFFbmRBbmdsZTsKICAgICAgdGhpcy5jbG9ja3dpc2UgPSBzb3VyY2UuYUNsb2Nrd2lzZTsKICAgICAgdGhpcy5yb3RhdGlvbiA9IHNvdXJjZS5hUm90YXRpb247CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEVsbGlwc2VDdXJ2ZTsKfShDdXJ2ZSk7CgovKioKICogQGF1dGhvciB6ejg1IC8gaHR0cDovL3d3dy5sYWI0Z2FtZXMubmV0L3p6ODUvYmxvZwogKgogKiBCZXppZXIgQ3VydmVzIGZvcm11bGFzIG9idGFpbmVkIGZyb20KICogaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Cw6l6aWVyX2N1cnZlCiAqLwpmdW5jdGlvbiBDYXRtdWxsUm9tKHQsIHAwLCBwMSwgcDIsIHAzKSB7CiAgdmFyIHYwID0gKHAyIC0gcDApICogMC41OwogIHZhciB2MSA9IChwMyAtIHAxKSAqIDAuNTsKICB2YXIgdDIgPSB0ICogdDsKICB2YXIgdDMgPSB0ICogdDI7CiAgcmV0dXJuICgyICogcDEgLSAyICogcDIgKyB2MCArIHYxKSAqIHQzICsgKC0zICogcDEgKyAzICogcDIgLSAyICogdjAgLSB2MSkgKiB0MiArIHYwICogdCArIHAxOwp9IC8vCgoKZnVuY3Rpb24gUXVhZHJhdGljQmV6aWVyUDAodCwgcCkgewogIHZhciBrID0gMSAtIHQ7CiAgcmV0dXJuIGsgKiBrICogcDsKfQoKZnVuY3Rpb24gUXVhZHJhdGljQmV6aWVyUDEodCwgcCkgewogIHJldHVybiAyICogKDEgLSB0KSAqIHQgKiBwOwp9CgpmdW5jdGlvbiBRdWFkcmF0aWNCZXppZXJQMih0LCBwKSB7CiAgcmV0dXJuIHQgKiB0ICogcDsKfQoKZnVuY3Rpb24gUXVhZHJhdGljQmV6aWVyKHQsIHAwLCBwMSwgcDIpIHsKICByZXR1cm4gUXVhZHJhdGljQmV6aWVyUDAodCwgcDApICsgUXVhZHJhdGljQmV6aWVyUDEodCwgcDEpICsgUXVhZHJhdGljQmV6aWVyUDIodCwgcDIpOwp9IC8vCgoKZnVuY3Rpb24gQ3ViaWNCZXppZXJQMCh0LCBwKSB7CiAgdmFyIGsgPSAxIC0gdDsKICByZXR1cm4gayAqIGsgKiBrICogcDsKfQoKZnVuY3Rpb24gQ3ViaWNCZXppZXJQMSh0LCBwKSB7CiAgdmFyIGsgPSAxIC0gdDsKICByZXR1cm4gMyAqIGsgKiBrICogdCAqIHA7Cn0KCmZ1bmN0aW9uIEN1YmljQmV6aWVyUDIodCwgcCkgewogIHJldHVybiAzICogKDEgLSB0KSAqIHQgKiB0ICogcDsKfQoKZnVuY3Rpb24gQ3ViaWNCZXppZXJQMyh0LCBwKSB7CiAgcmV0dXJuIHQgKiB0ICogdCAqIHA7Cn0KCmZ1bmN0aW9uIEN1YmljQmV6aWVyKHQsIHAwLCBwMSwgcDIsIHAzKSB7CiAgcmV0dXJuIEN1YmljQmV6aWVyUDAodCwgcDApICsgQ3ViaWNCZXppZXJQMSh0LCBwMSkgKyBDdWJpY0JlemllclAyKHQsIHAyKSArIEN1YmljQmV6aWVyUDModCwgcDMpOwp9CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIkNChEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCQ0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KCmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QkNCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KdmFyIFNwbGluZUN1cnZlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ3VydmUpIHsKICBfaW5oZXJpdHMoU3BsaW5lQ3VydmUsIF9DdXJ2ZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIkNChTcGxpbmVDdXJ2ZSk7CgogIGZ1bmN0aW9uIFNwbGluZUN1cnZlKHBvaW50cykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTcGxpbmVDdXJ2ZSk7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKTsKICAgIF90aGlzLnR5cGUgPSAnU3BsaW5lQ3VydmUnOwogICAgX3RoaXMucG9pbnRzID0gcG9pbnRzIHx8IFtdOwogICAgX3RoaXMuaXNTcGxpbmVDdXJ2ZSA9IHRydWU7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU3BsaW5lQ3VydmUsIFt7CiAgICBrZXk6ICJnZXRQb2ludCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UG9pbnQodCkgewogICAgICB2YXIgcG9pbnQgPSBuZXcgVmVjdG9yMigpOwogICAgICB2YXIgcG9pbnRzID0gdGhpcy5wb2ludHM7CiAgICAgIHZhciBwID0gKHBvaW50cy5sZW5ndGggLSAxKSAqIHQ7CiAgICAgIHZhciBpbnRQb2ludCA9IE1hdGguZmxvb3IocCk7CiAgICAgIHZhciB3ZWlnaHQgPSBwIC0gaW50UG9pbnQ7CiAgICAgIHZhciBwMCA9IHBvaW50c1tpbnRQb2ludCA9PT0gMCA/IGludFBvaW50IDogaW50UG9pbnQgLSAxXTsKICAgICAgdmFyIHAxID0gcG9pbnRzW2ludFBvaW50XTsKICAgICAgdmFyIHAyID0gcG9pbnRzW2ludFBvaW50ID4gcG9pbnRzLmxlbmd0aCAtIDIgPyBwb2ludHMubGVuZ3RoIC0gMSA6IGludFBvaW50ICsgMV07CiAgICAgIHZhciBwMyA9IHBvaW50c1tpbnRQb2ludCA+IHBvaW50cy5sZW5ndGggLSAzID8gcG9pbnRzLmxlbmd0aCAtIDEgOiBpbnRQb2ludCArIDJdOwogICAgICBwb2ludC5zZXQoQ2F0bXVsbFJvbSh3ZWlnaHQsIHAwLngsIHAxLngsIHAyLngsIHAzLngpLCBDYXRtdWxsUm9tKHdlaWdodCwgcDAueSwgcDEueSwgcDIueSwgcDMueSkpOwogICAgICByZXR1cm4gcG9pbnQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29weSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29weShzb3VyY2UpIHsKICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoU3BsaW5lQ3VydmUucHJvdG90eXBlKSwgImNvcHkiLCB0aGlzKS5jYWxsKHRoaXMsIHNvdXJjZSk7CgogICAgICB0aGlzLnBvaW50cyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBzb3VyY2UucG9pbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZhciBwb2ludCA9IHNvdXJjZS5wb2ludHNbaV07CiAgICAgICAgdGhpcy5wb2ludHMucHVzaChwb2ludC5jbG9uZSgpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU3BsaW5lQ3VydmU7Cn0oQ3VydmUpOwoKZnVuY3Rpb24gX2NyZWF0ZVN1cGVyJDMoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QkMygpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0JDMoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9CnZhciBDdWJpY0JlemllckN1cnZlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ3VydmUpIHsKICBfaW5oZXJpdHMoQ3ViaWNCZXppZXJDdXJ2ZSwgX0N1cnZlKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlciQzKEN1YmljQmV6aWVyQ3VydmUpOwoKICBmdW5jdGlvbiBDdWJpY0JlemllckN1cnZlKHYwLCB2MSwgdjIsIHYzKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEN1YmljQmV6aWVyQ3VydmUpOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcyk7CiAgICBfdGhpcy50eXBlID0gJ0N1YmljQmV6aWVyQ3VydmUnOwogICAgX3RoaXMudjAgPSB2MCB8fCBuZXcgVmVjdG9yMigpOwogICAgX3RoaXMudjEgPSB2MSB8fCBuZXcgVmVjdG9yMigpOwogICAgX3RoaXMudjIgPSB2MiB8fCBuZXcgVmVjdG9yMigpOwogICAgX3RoaXMudjMgPSB2MyB8fCBuZXcgVmVjdG9yMigpOwogICAgX3RoaXMuaXNDdWJpY0JlemllckN1cnZlID0gdHJ1ZTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhDdWJpY0JlemllckN1cnZlLCBbewogICAga2V5OiAiZ2V0UG9sZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UG9sZShtaW4sIG1heCkgewogICAgICB2YXIgdjAgPSB0aGlzLnYwLAogICAgICAgICAgdjEgPSB0aGlzLnYxLAogICAgICAgICAgdjIgPSB0aGlzLnYyLAogICAgICAgICAgdjMgPSB0aGlzLnYzOwogICAgICBtaW4ueCA9IE1hdGgubWluKG1pbi54LCB2MC54LCB2MS54LCB2Mi54LCB2My54KTsKICAgICAgbWluLnkgPSBNYXRoLm1pbihtaW4ueSwgdjAueSwgdjEueSwgdjIueSwgdjMueSk7CiAgICAgIG1heC54ID0gTWF0aC5tYXgobWF4LngsIHYwLngsIHYxLngsIHYyLngsIHYzLngpOwogICAgICBtYXgueSA9IE1hdGgubWF4KG1heC55LCB2MC55LCB2MS55LCB2Mi55LCB2My55KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQb2ludCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UG9pbnQodCwgb3B0aW9uYWxUYXJnZXQpIHsKICAgICAgdmFyIHBvaW50ID0gb3B0aW9uYWxUYXJnZXQgfHwgbmV3IFZlY3RvcjIoKTsKICAgICAgdmFyIHYwID0gdGhpcy52MCwKICAgICAgICAgIHYxID0gdGhpcy52MSwKICAgICAgICAgIHYyID0gdGhpcy52MiwKICAgICAgICAgIHYzID0gdGhpcy52MzsKICAgICAgcG9pbnQuc2V0KEN1YmljQmV6aWVyKHQsIHYwLngsIHYxLngsIHYyLngsIHYzLngpLCBDdWJpY0Jlemllcih0LCB2MC55LCB2MS55LCB2Mi55LCB2My55KSk7CiAgICAgIHJldHVybiBwb2ludDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwb2ludEFwcGx5RnVuYyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcG9pbnRBcHBseUZ1bmMoZnVuYykgewogICAgICBmdW5jKHRoaXMudjApOwogICAgICBmdW5jKHRoaXMudjEpOwogICAgICBmdW5jKHRoaXMudjIpOwogICAgICBmdW5jKHRoaXMudjMpOwogICAgfQogIH0sIHsKICAgIGtleTogImNvcHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvcHkoc291cmNlKSB7CiAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKEN1YmljQmV6aWVyQ3VydmUucHJvdG90eXBlKSwgImNvcHkiLCB0aGlzKS5jYWxsKHRoaXMsIHNvdXJjZSk7CgogICAgICB0aGlzLnYwLmNvcHkoc291cmNlLnYwKTsKICAgICAgdGhpcy52MS5jb3B5KHNvdXJjZS52MSk7CiAgICAgIHRoaXMudjIuY29weShzb3VyY2UudjIpOwogICAgICB0aGlzLnYzLmNvcHkoc291cmNlLnYzKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9IC8vIDPpmLbotJ3loZ7lsJTliIblibLov5Dnrpfmr5TovoPlpKfvvIzmmoLml7blj6rmlK/mjIHlnYfliIYKCiAgfSwgewogICAga2V5OiAic3BsaXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGl0KF9yZWYpIHsKICAgICAgdmFyIHggPSBfcmVmLngsCiAgICAgICAgICB5ID0gX3JlZi55OwogICAgICB2YXIgdjAgPSB0aGlzLnYwLAogICAgICAgICAgdjEgPSB0aGlzLnYxLAogICAgICAgICAgdjIgPSB0aGlzLnYyLAogICAgICAgICAgdjMgPSB0aGlzLnYzOwogICAgICB2YXIgbWluID0gbmV3IFZlY3RvcjIoSW5maW5pdHksIEluZmluaXR5KTsKICAgICAgdmFyIG1heCA9IG5ldyBWZWN0b3IyKC1JbmZpbml0eSwgLUluZmluaXR5KTsKICAgICAgdGhpcy5nZXRQb2xlKG1pbiwgbWF4KTsKICAgICAgdmFyIHNwbGl0QnlYID0geCAhPT0gdW5kZWZpbmVkICYmIChtaW4ueCAtIHgpICogKG1heC54IC0geCkgPCAwOwogICAgICB2YXIgc3BsaXRCeVkgPSB5ICE9PSB1bmRlZmluZWQgJiYgKG1pbi55IC0geSkgKiAobWF4LnkgLSB5KSA8IDA7CgogICAgICBpZiAoc3BsaXRCeVggfHwgc3BsaXRCeVkpIHsKICAgICAgICB4ID0gMC41ICogdjAueCArIDAuNSAqIHYxLng7CiAgICAgICAgeSA9IDAuNSAqIHYwLnkgKyAwLjUgKiB2MS55OwogICAgICAgIHZhciBwb2ludDEgPSBuZXcgVmVjdG9yMih4LCB5KTsKICAgICAgICB4ID0gMC4yNSAqIHYwLnggKyAwLjUgKiB2MS54ICsgMC4yNSAqIHYyLng7CiAgICAgICAgeSA9IDAuMjUgKiB2MC55ICsgMC41ICogdjEueSArIDAuMjUgKiB2Mi55OwogICAgICAgIHZhciBwb2ludDIgPSBuZXcgVmVjdG9yMih4LCB5KTsKICAgICAgICB4ID0gMC4xMjUgKiB2MC54ICsgMC4zNzUgKiB2MS54ICsgMC4zNzUgKiB2Mi54ICsgMC4xMjUgKiB2My54OwogICAgICAgIHkgPSAwLjEyNSAqIHYwLnkgKyAwLjM3NSAqIHYxLnkgKyAwLjM3NSAqIHYyLnkgKyAwLjEyNSAqIHYzLnk7CiAgICAgICAgdmFyIHBvaW50MyA9IG5ldyBWZWN0b3IyKHgsIHkpOwogICAgICAgIHggPSAwLjI1ICogdjEueCArIDAuNSAqIHYyLnggKyAwLjI1ICogdjMueDsKICAgICAgICB5ID0gMC4yNSAqIHYxLnkgKyAwLjUgKiB2Mi55ICsgMC4yNSAqIHYzLnk7CiAgICAgICAgdmFyIHBvaW50NCA9IG5ldyBWZWN0b3IyKHgsIHkpOwogICAgICAgIHggPSAwLjUgKiB2Mi54ICsgMC41ICogdjMueDsKICAgICAgICB5ID0gMC41ICogdjIueSArIDAuNSAqIHYzLnk7CiAgICAgICAgdmFyIHBvaW50NSA9IG5ldyBWZWN0b3IyKHgsIHkpOwogICAgICAgIHZhciBjdXJ2ZTEgPSBuZXcgQ3ViaWNCZXppZXJDdXJ2ZSh2MCwgcG9pbnQxLCBwb2ludDIsIHBvaW50Myk7CiAgICAgICAgdmFyIGN1cnZlMiA9IG5ldyBDdWJpY0JlemllckN1cnZlKHBvaW50My5jbG9uZSgpLCBwb2ludDQsIHBvaW50NSwgdjMpOwogICAgICAgIHJldHVybiBbY3VydmUxLCBjdXJ2ZTJdOwogICAgICB9CgogICAgICByZXR1cm4gW3RoaXNdOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEN1YmljQmV6aWVyQ3VydmU7Cn0oQ3VydmUpOwoKZnVuY3Rpb24gX2NyZWF0ZVN1cGVyJDIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QkMigpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0JDIoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9Cgp2YXIgUXVhZHJhdGljQmV6aWVyQ3VydmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9DdXJ2ZSkgewogIF9pbmhlcml0cyhRdWFkcmF0aWNCZXppZXJDdXJ2ZSwgX0N1cnZlKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlciQyKFF1YWRyYXRpY0JlemllckN1cnZlKTsKCiAgZnVuY3Rpb24gUXVhZHJhdGljQmV6aWVyQ3VydmUodjAsIHYxLCB2MikgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBRdWFkcmF0aWNCZXppZXJDdXJ2ZSk7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKTsKICAgIF90aGlzLnR5cGUgPSAnUXVhZHJhdGljQmV6aWVyQ3VydmUnOwogICAgX3RoaXMudjAgPSB2MCB8fCBuZXcgVmVjdG9yMigpOwogICAgX3RoaXMudjEgPSB2MSB8fCBuZXcgVmVjdG9yMigpOwogICAgX3RoaXMudjIgPSB2MiB8fCBuZXcgVmVjdG9yMigpOwogICAgX3RoaXMuaXNRdWFkcmF0aWNCZXppZXJDdXJ2ZSA9IHRydWU7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoUXVhZHJhdGljQmV6aWVyQ3VydmUsIFt7CiAgICBrZXk6ICJnZXRQb2xlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQb2xlKG1pbiwgbWF4KSB7CiAgICAgIHZhciB2MCA9IHRoaXMudjAsCiAgICAgICAgICB2MSA9IHRoaXMudjEsCiAgICAgICAgICB2MiA9IHRoaXMudjI7CiAgICAgIHZhciB4MSA9IDAuNSAqICh2MC54ICsgdjEueCk7CiAgICAgIHZhciB5MSA9IDAuNSAqICh2MC55ICsgdjEueSk7CiAgICAgIHZhciB4MiA9IDAuNSAqICh2MC54ICsgdjIueCk7CiAgICAgIHZhciB5MiA9IDAuNSAqICh2MC55ICsgdjIueSk7CiAgICAgIG1pbi54ID0gTWF0aC5taW4obWluLngsIHYwLngsIHYyLngsIHgxLCB4Mik7CiAgICAgIG1pbi55ID0gTWF0aC5taW4obWluLnksIHYwLnksIHYyLnksIHkxLCB5Mik7CiAgICAgIG1heC54ID0gTWF0aC5tYXgobWF4LngsIHYwLngsIHYyLngsIHgxLCB4Mik7CiAgICAgIG1heC55ID0gTWF0aC5tYXgobWF4LnksIHYwLnksIHYyLnksIHkxLCB5Mik7CiAgICB9CiAgfSwgewogICAga2V5OiAicG9pbnRBcHBseUZ1bmMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBvaW50QXBwbHlGdW5jKGZ1bmMpIHsKICAgICAgZnVuYyh0aGlzLnYwKTsKICAgICAgZnVuYyh0aGlzLnYxKTsKICAgICAgZnVuYyh0aGlzLnYyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzcGxpdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaXQoX3JlZikgewogICAgICB2YXIgeCA9IF9yZWYueCwKICAgICAgICAgIHkgPSBfcmVmLnk7CiAgICAgIHZhciB2MCA9IHRoaXMudjAsCiAgICAgICAgICB2MSA9IHRoaXMudjEsCiAgICAgICAgICB2MiA9IHRoaXMudjI7CiAgICAgIHZhciBzcGxpdEJ5WCA9IHggIT09IHVuZGVmaW5lZCAmJiBNYXRoLmFicyhNYXRoLnNpZ24odjAueCAtIHgpICsgTWF0aC5zaWduKHYxLnggLSB4KSArIE1hdGguc2lnbih2Mi54IC0geCkpID09PSAxOwogICAgICB2YXIgc3BsaXRCeVkgPSB5ICE9PSB1bmRlZmluZWQgJiYgTWF0aC5hYnMoTWF0aC5zaWduKHYwLnkgLSB4KSArIE1hdGguc2lnbih2MS55IC0geCkgKyBNYXRoLnNpZ24odjIueSAtIHgpKSA9PT0gMTsKICAgICAgdmFyIGEsIGIsIGMsIGQ7CgogICAgICBpZiAoc3BsaXRCeVgpIHsKICAgICAgICBhID0gdjAueCAtIDIgKiB2MS54ICsgdjIueDsKICAgICAgICBiID0gMiAqICgtdjAueCArIHYxLngpOwogICAgICAgIGMgPSB2MC54IC0geDsKICAgICAgfQoKICAgICAgaWYgKHNwbGl0QnlZKSB7CiAgICAgICAgYSA9IHYwLnkgLSAyICogdjEueSArIHYyLnk7CiAgICAgICAgYiA9IDIgKiAoLXYwLnkgKyB2MS55KTsKICAgICAgICBjID0gdjAueSAtIHk7CiAgICAgIH0KCiAgICAgIGlmIChzcGxpdEJ5WCB8fCBzcGxpdEJ5WSkgewogICAgICAgIGQgPSBiICogYiAtIDQgKiBhICogYzsKCiAgICAgICAgaWYgKGQgPiAwKSB7CiAgICAgICAgICB2YXIgZSA9IE1hdGguc3FydChkKTsKICAgICAgICAgIHZhciB0MSA9ICgtYiArIGUpIC8gMiAvIGE7CiAgICAgICAgICB2YXIgdDIgPSAoLWIgLSBlKSAvIDIgLyBhOwogICAgICAgICAgdmFyIHQgPSBbdDEsIHQyXS5maW5kKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICAgIHJldHVybiB4ID4gMCAmJiB4IDwgMTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmICh0KSB7CiAgICAgICAgICAgIHZhciBwb2ludDEgPSBuZXcgVmVjdG9yMigpLmxlcnBWZWN0b3JzKHYwLCB2MSwgdCk7CiAgICAgICAgICAgIHZhciBwb2ludDMgPSBuZXcgVmVjdG9yMigpLmxlcnBWZWN0b3JzKHYxLCB2MiwgdCk7CiAgICAgICAgICAgIHZhciBwb2ludDIgPSBuZXcgVmVjdG9yMigpLmxlcnBWZWN0b3JzKHBvaW50MSwgcG9pbnQzLCB0KTsKICAgICAgICAgICAgdmFyIGN1cnZlMSA9IG5ldyBRdWFkcmF0aWNCZXppZXJDdXJ2ZSh2MCwgcG9pbnQxLCBwb2ludDIpOwogICAgICAgICAgICB2YXIgY3VydmUyID0gbmV3IFF1YWRyYXRpY0JlemllckN1cnZlKHBvaW50Mi5jbG9uZSgpLCBwb2ludDMsIHYyKTsKICAgICAgICAgICAgcmV0dXJuIFtjdXJ2ZTEsIGN1cnZlMl07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gW3RoaXNdOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFBvaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQb2ludCh0KSB7CiAgICAgIHZhciBwb2ludCA9IG5ldyBWZWN0b3IyKCk7CiAgICAgIHZhciB2MCA9IHRoaXMudjAsCiAgICAgICAgICB2MSA9IHRoaXMudjEsCiAgICAgICAgICB2MiA9IHRoaXMudjI7CiAgICAgIHBvaW50LnNldChRdWFkcmF0aWNCZXppZXIodCwgdjAueCwgdjEueCwgdjIueCksIFF1YWRyYXRpY0Jlemllcih0LCB2MC55LCB2MS55LCB2Mi55KSk7CiAgICAgIHJldHVybiBwb2ludDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb3B5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb3B5KHNvdXJjZSkgewogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihRdWFkcmF0aWNCZXppZXJDdXJ2ZS5wcm90b3R5cGUpLCAiY29weSIsIHRoaXMpLmNhbGwodGhpcywgc291cmNlKTsKCiAgICAgIHRoaXMudjAuY29weShzb3VyY2UudjApOwogICAgICB0aGlzLnYxLmNvcHkoc291cmNlLnYxKTsKICAgICAgdGhpcy52Mi5jb3B5KHNvdXJjZS52Mik7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFF1YWRyYXRpY0JlemllckN1cnZlOwp9KEN1cnZlKTsKCmZ1bmN0aW9uIF9jcmVhdGVTdXBlciQxKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0JDEoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCQxKCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQovKioKICogQGF1dGhvciB6ejg1IC8gaHR0cDovL3d3dy5sYWI0Z2FtZXMubmV0L3p6ODUvYmxvZwogKiBDcmVhdGVzIGZyZWUgZm9ybSAyZCBwYXRoIHVzaW5nIHNlcmllcyBvZiBwb2ludHMsIGxpbmVzIG9yIGN1cnZlcy4KICoqLwoKdmFyIFBhdGggPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9DdXJ2ZVBhdGgpIHsKICBfaW5oZXJpdHMoUGF0aCwgX0N1cnZlUGF0aCk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIkMShQYXRoKTsKCiAgZnVuY3Rpb24gUGF0aChwb2ludHMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGF0aCk7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwb2ludHMpOwogICAgX3RoaXMudHlwZSA9ICdQYXRoJzsKICAgIF90aGlzLmN1cnJlbnRQb2ludCA9IG5ldyBWZWN0b3IyKCk7CgogICAgaWYgKHBvaW50cykgewogICAgICBfdGhpcy5zZXRGcm9tUG9pbnRzKHBvaW50cyk7CiAgICB9CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFBhdGgsIFt7CiAgICBrZXk6ICJzZXRGcm9tUG9pbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGcm9tUG9pbnRzKHBvaW50cykgewogICAgICB0aGlzLm1vdmVUbyhwb2ludHNbMF0ueCwgcG9pbnRzWzBdLnkpOwoKICAgICAgZm9yICh2YXIgaSA9IDEsIGwgPSBwb2ludHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5saW5lVG8ocG9pbnRzW2ldLngsIHBvaW50c1tpXS55KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIm1vdmVUbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZVRvKHgsIHkpIHsKICAgICAgdGhpcy5jdXJyZW50UG9pbnQuc2V0KHgsIHkpOyAvLyBUT0RPIGNvbnNpZGVyIHJlZmVyZW5jaW5nIHZlY3RvcnMgaW5zdGVhZCBvZiBjb3B5aW5nPwogICAgfQogIH0sIHsKICAgIGtleTogImxpbmVUbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbGluZVRvKHgsIHkpIHsKICAgICAgdmFyIGN1cnZlID0gbmV3IExpbmVDdXJ2ZSh0aGlzLmN1cnJlbnRQb2ludC5jbG9uZSgpLCBuZXcgVmVjdG9yMih4LCB5KSk7CiAgICAgIHRoaXMuY3VydmVzLnB1c2goY3VydmUpOwogICAgICB0aGlzLmN1cnJlbnRQb2ludC5zZXQoeCwgeSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicXVhZHJhdGljQ3VydmVUbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcXVhZHJhdGljQ3VydmVUbyhhQ1B4LCBhQ1B5LCBhWCwgYVkpIHsKICAgICAgdmFyIGN1cnZlID0gbmV3IFF1YWRyYXRpY0JlemllckN1cnZlKHRoaXMuY3VycmVudFBvaW50LmNsb25lKCksIG5ldyBWZWN0b3IyKGFDUHgsIGFDUHkpLCBuZXcgVmVjdG9yMihhWCwgYVkpKTsKICAgICAgdGhpcy5jdXJ2ZXMucHVzaChjdXJ2ZSk7CiAgICAgIHRoaXMuY3VycmVudFBvaW50LnNldChhWCwgYVkpOwogICAgfQogIH0sIHsKICAgIGtleTogImJlemllckN1cnZlVG8iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJlemllckN1cnZlVG8oYUNQMXgsIGFDUDF5LCBhQ1AyeCwgYUNQMnksIGFYLCBhWSkgewogICAgICB2YXIgY3VydmUgPSBuZXcgQ3ViaWNCZXppZXJDdXJ2ZSh0aGlzLmN1cnJlbnRQb2ludC5jbG9uZSgpLCBuZXcgVmVjdG9yMihhQ1AxeCwgYUNQMXkpLCBuZXcgVmVjdG9yMihhQ1AyeCwgYUNQMnkpLCBuZXcgVmVjdG9yMihhWCwgYVkpKTsKICAgICAgdGhpcy5jdXJ2ZXMucHVzaChjdXJ2ZSk7CiAgICAgIHRoaXMuY3VycmVudFBvaW50LnNldChhWCwgYVkpOwogICAgfQogIH0sIHsKICAgIGtleTogInNwbGluZVRocnUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGluZVRocnUocHRzCiAgICAvKiBBcnJheSBvZiBWZWN0b3IgKi8KICAgICkgewogICAgICB2YXIgbnB0cyA9IFt0aGlzLmN1cnJlbnRQb2ludC5jbG9uZSgpXS5jb25jYXQocHRzKTsKICAgICAgdmFyIGN1cnZlID0gbmV3IFNwbGluZUN1cnZlKG5wdHMpOwogICAgICB0aGlzLmN1cnZlcy5wdXNoKGN1cnZlKTsKICAgICAgdGhpcy5jdXJyZW50UG9pbnQuY29weShwdHNbcHRzLmxlbmd0aCAtIDFdKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhcmMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFyYyhhWCwgYVksIGFSYWRpdXMsIGFTdGFydEFuZ2xlLCBhRW5kQW5nbGUsIGFDbG9ja3dpc2UpIHsKICAgICAgdmFyIHgwID0gdGhpcy5jdXJyZW50UG9pbnQueDsKICAgICAgdmFyIHkwID0gdGhpcy5jdXJyZW50UG9pbnQueTsKICAgICAgdGhpcy5hYnNhcmMoYVggKyB4MCwgYVkgKyB5MCwgYVJhZGl1cywgYVN0YXJ0QW5nbGUsIGFFbmRBbmdsZSwgYUNsb2Nrd2lzZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWJzYXJjIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhYnNhcmMoYVgsIGFZLCBhUmFkaXVzLCBhU3RhcnRBbmdsZSwgYUVuZEFuZ2xlLCBhQ2xvY2t3aXNlKSB7CiAgICAgIHRoaXMuYWJzZWxsaXBzZShhWCwgYVksIGFSYWRpdXMsIGFSYWRpdXMsIGFTdGFydEFuZ2xlLCBhRW5kQW5nbGUsIGFDbG9ja3dpc2UpOwogICAgfQogIH0sIHsKICAgIGtleTogImVsbGlwc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVsbGlwc2UoYVgsIGFZLCB4UmFkaXVzLCB5UmFkaXVzLCBhU3RhcnRBbmdsZSwgYUVuZEFuZ2xlLCBhQ2xvY2t3aXNlLCBhUm90YXRpb24pIHsKICAgICAgdmFyIHgwID0gdGhpcy5jdXJyZW50UG9pbnQueDsKICAgICAgdmFyIHkwID0gdGhpcy5jdXJyZW50UG9pbnQueTsKICAgICAgdGhpcy5hYnNlbGxpcHNlKGFYICsgeDAsIGFZICsgeTAsIHhSYWRpdXMsIHlSYWRpdXMsIGFTdGFydEFuZ2xlLCBhRW5kQW5nbGUsIGFDbG9ja3dpc2UsIGFSb3RhdGlvbik7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWJzZWxsaXBzZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWJzZWxsaXBzZShhWCwgYVksIHhSYWRpdXMsIHlSYWRpdXMsIGFTdGFydEFuZ2xlLCBhRW5kQW5nbGUsIGFDbG9ja3dpc2UsIGFSb3RhdGlvbikgewogICAgICB2YXIgY3VydmUgPSBuZXcgRWxsaXBzZUN1cnZlKGFYLCBhWSwgeFJhZGl1cywgeVJhZGl1cywgYVN0YXJ0QW5nbGUsIGFFbmRBbmdsZSwgYUNsb2Nrd2lzZSwgYVJvdGF0aW9uKTsKCiAgICAgIGlmICh0aGlzLmN1cnZlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgLy8gaWYgYSBwcmV2aW91cyBjdXJ2ZSBpcyBwcmVzZW50LCBhdHRlbXB0IHRvIGpvaW4KICAgICAgICB2YXIgZmlyc3RQb2ludCA9IGN1cnZlLmdldFBvaW50KDApOwoKICAgICAgICBpZiAoIWZpcnN0UG9pbnQuZXF1YWxzKHRoaXMuY3VycmVudFBvaW50KSkgewogICAgICAgICAgdGhpcy5saW5lVG8oZmlyc3RQb2ludC54LCBmaXJzdFBvaW50LnkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5jdXJ2ZXMucHVzaChjdXJ2ZSk7CiAgICAgIHZhciBsYXN0UG9pbnQgPSBjdXJ2ZS5nZXRQb2ludCgxKTsKICAgICAgdGhpcy5jdXJyZW50UG9pbnQuY29weShsYXN0UG9pbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogImNvcHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvcHkoc291cmNlKSB7CiAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKFBhdGgucHJvdG90eXBlKSwgImNvcHkiLCB0aGlzKS5jYWxsKHRoaXMsIHNvdXJjZSk7CgogICAgICB0aGlzLmN1cnJlbnRQb2ludC5jb3B5KHNvdXJjZS5jdXJyZW50UG9pbnQpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9XSk7CgogIHJldHVybiBQYXRoOwp9KEN1cnZlUGF0aCk7CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KLyoqCiAqIEBhdXRob3Igeno4NSAvIGh0dHA6Ly93d3cubGFiNGdhbWVzLm5ldC96ejg1L2Jsb2cKICogRGVmaW5lcyBhIDJkIHNoYXBlIHBsYW5lIHVzaW5nIHBhdGhzLgogKiovCi8vIFNURVAgMSBDcmVhdGUgYSBwYXRoLgovLyBTVEVQIDIgVHVybiBwYXRoIGludG8gc2hhcGUuCi8vIFNURVAgMyBFeHRydWRlR2VvbWV0cnkgdGFrZXMgaW4gU2hhcGUvU2hhcGVzCi8vIFNURVAgM2EgLSBFeHRyYWN0IHBvaW50cyBmcm9tIGVhY2ggc2hhcGUsIHR1cm4gdG8gdmVydGljZXMKLy8gU1RFUCAzYiAtIFRyaWFuZ3VsYXRlIGVhY2ggc2hhcGUsIGFkZCBmYWNlcy4KCnZhciBTaGFwZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1BhdGgpIHsKICBfaW5oZXJpdHMoU2hhcGUsIF9QYXRoKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihTaGFwZSk7CgogIGZ1bmN0aW9uIFNoYXBlKHBvaW50cykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTaGFwZSk7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwb2ludHMpOwogICAgX3RoaXMudXVpZCA9IF9NYXRoLmdlbmVyYXRlVVVJRCgpOwogICAgX3RoaXMudHlwZSA9ICdTaGFwZSc7CiAgICBfdGhpcy5ob2xlcyA9IFtdOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFNoYXBlLCBbewogICAga2V5OiAiZ2V0UG9pbnRzSG9sZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBvaW50c0hvbGVzKGRpdmlzaW9ucykgewogICAgICB2YXIgaG9sZXNQdHMgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy5ob2xlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBob2xlc1B0c1tpXSA9IHRoaXMuaG9sZXNbaV0uZ2V0UG9pbnRzKGRpdmlzaW9ucyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBob2xlc1B0czsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQb2ludHNIb2xlc0J5U3RlcFNpemUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBvaW50c0hvbGVzQnlTdGVwU2l6ZShzdGVwU2l6ZSkgewogICAgICB2YXIgaG9sZXNQdHMgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy5ob2xlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBob2xlc1B0c1tpXSA9IHRoaXMuaG9sZXNbaV0uZ2V0UG9pbnRzQnlTdGVwU2l6ZShzdGVwU2l6ZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBob2xlc1B0czsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQb2ludHNIb2xlc0FkYXB0aXZlbHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBvaW50c0hvbGVzQWRhcHRpdmVseSh0b2xlcmFuY2UpIHsKICAgICAgdmFyIGhvbGVzUHRzID0gW107CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHRoaXMuaG9sZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgaG9sZXNQdHNbaV0gPSB0aGlzLmhvbGVzW2ldLmdldFBvaW50c0FkYXB0aXZlbHkodG9sZXJhbmNlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhvbGVzUHRzOwogICAgfSAvLyBnZXQgcG9pbnRzIG9mIHNoYXBlIGFuZCBob2xlcyAoa2V5cG9pbnRzIGJhc2VkIG9uIHNlZ21lbnRzIHBhcmFtZXRlcikKCiAgfSwgewogICAga2V5OiAiZXh0cmFjdFBvaW50cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZXh0cmFjdFBvaW50cyhkaXZpc2lvbnMpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzaGFwZTogdGhpcy5nZXRQb2ludHMoZGl2aXNpb25zKSwKICAgICAgICBob2xlczogdGhpcy5nZXRQb2ludHNIb2xlcyhkaXZpc2lvbnMpCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiZXh0cmFjdFBvaW50c0J5U3RlcFNpemUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV4dHJhY3RQb2ludHNCeVN0ZXBTaXplKHN0ZXBTaXplKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgc2hhcGU6IHRoaXMuZ2V0UG9pbnRzQnlTdGVwU2l6ZShzdGVwU2l6ZSksCiAgICAgICAgaG9sZXM6IHRoaXMuZ2V0UG9pbnRzSG9sZXNCeVN0ZXBTaXplKHN0ZXBTaXplKQogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogImV4dHJhY3RQb2ludHNBZGFwdGl2ZWx5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBleHRyYWN0UG9pbnRzQWRhcHRpdmVseSh0b2xlcmFuY2UpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzaGFwZTogdGhpcy5nZXRQb2ludHNBZGFwdGl2ZWx5KHRvbGVyYW5jZSksCiAgICAgICAgaG9sZXM6IHRoaXMuZ2V0UG9pbnRzSG9sZXNBZGFwdGl2ZWx5KHRvbGVyYW5jZSkKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb3B5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb3B5KHNvdXJjZSkgewogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihTaGFwZS5wcm90b3R5cGUpLCAiY29weSIsIHRoaXMpLmNhbGwodGhpcywgc291cmNlKTsKCiAgICAgIHRoaXMuaG9sZXMgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gc291cmNlLmhvbGVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZhciBob2xlID0gc291cmNlLmhvbGVzW2ldOwogICAgICAgIHRoaXMuaG9sZXMucHVzaChob2xlLmNsb25lKCkpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9XSk7CgogIHJldHVybiBTaGFwZTsKfShQYXRoKTsKCnZhciBTaGFwZVBhdGggPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFNoYXBlUGF0aCgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTaGFwZVBhdGgpOwoKICAgIHRoaXMudHlwZSA9ICdTaGFwZVBhdGgnOwogICAgdGhpcy5zdWJQYXRocyA9IFtdOwogICAgdGhpcy5jdXJyZW50UGF0aCA9IG51bGw7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU2hhcGVQYXRoLCBbewogICAga2V5OiAibW92ZVRvIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlVG8oeCwgeSkgewogICAgICB0aGlzLmN1cnJlbnRQYXRoID0gbmV3IFBhdGgoKTsKICAgICAgdGhpcy5zdWJQYXRocy5wdXNoKHRoaXMuY3VycmVudFBhdGgpOwogICAgICB0aGlzLmN1cnJlbnRQYXRoLm1vdmVUbyh4LCB5KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsaW5lVG8iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxpbmVUbyh4LCB5KSB7CiAgICAgIHRoaXMuY3VycmVudFBhdGgubGluZVRvKHgsIHkpOwogICAgfQogIH0sIHsKICAgIGtleTogInF1YWRyYXRpY0N1cnZlVG8iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHF1YWRyYXRpY0N1cnZlVG8oYUNQeCwgYUNQeSwgYVgsIGFZKSB7CiAgICAgIHRoaXMuY3VycmVudFBhdGgucXVhZHJhdGljQ3VydmVUbyhhQ1B4LCBhQ1B5LCBhWCwgYVkpOwogICAgfQogIH0sIHsKICAgIGtleTogImJlemllckN1cnZlVG8iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJlemllckN1cnZlVG8oYUNQMXgsIGFDUDF5LCBhQ1AyeCwgYUNQMnksIGFYLCBhWSkgewogICAgICB0aGlzLmN1cnJlbnRQYXRoLmJlemllckN1cnZlVG8oYUNQMXgsIGFDUDF5LCBhQ1AyeCwgYUNQMnksIGFYLCBhWSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic3BsaW5lVGhydSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaW5lVGhydShwdHMpIHsKICAgICAgdGhpcy5jdXJyZW50UGF0aC5zcGxpbmVUaHJ1KHB0cyk7CiAgICB9CiAgfSwgewogICAga2V5OiAidG9TaGFwZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvU2hhcGVzKGlzQ0NXLCBub0hvbGVzKSB7CiAgICAgIGZ1bmN0aW9uIHRvU2hhcGVzTm9Ib2xlcyhpblN1YnBhdGhzKSB7CiAgICAgICAgdmFyIHNoYXBlcyA9IFtdOwoKICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGluU3VicGF0aHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICB2YXIgX3RtcFBhdGggPSBpblN1YnBhdGhzW2ldOwoKICAgICAgICAgIHZhciBfdG1wU2hhcGUgPSBuZXcgU2hhcGUoKTsKCiAgICAgICAgICBfdG1wU2hhcGUuY3VydmVzID0gX3RtcFBhdGguY3VydmVzOwogICAgICAgICAgc2hhcGVzLnB1c2goX3RtcFNoYXBlKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzaGFwZXM7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGlzUG9pbnRJbnNpZGVQb2x5Z29uKGluUHQsIGluUG9seWdvbikgewogICAgICAgIHZhciBwb2x5TGVuID0gaW5Qb2x5Z29uLmxlbmd0aDsgLy8gaW5QdCBvbiBwb2x5Z29uIGNvbnRvdXIgPT4gaW1tZWRpYXRlIHN1Y2Nlc3MgICAgb3IKICAgICAgICAvLyB0b2dnbGluZyBvZiBpbnNpZGUvb3V0c2lkZSBhdCBldmVyeSBzaW5nbGUhIGludGVyc2VjdGlvbiBwb2ludCBvZiBhbiBlZGdlCiAgICAgICAgLy8gIHdpdGggdGhlIGhvcml6b250YWwgbGluZSB0aHJvdWdoIGluUHQsIGxlZnQgb2YgaW5QdAogICAgICAgIC8vICBub3QgY291bnRpbmcgbG93ZXJZIGVuZHBvaW50cyBvZiBlZGdlcyBhbmQgd2hvbGUgZWRnZXMgb24gdGhhdCBsaW5lCgogICAgICAgIHZhciBpbnNpZGUgPSBmYWxzZTsKCiAgICAgICAgZm9yICh2YXIgaSA9IHBvbHlMZW4gLSAxLCBxID0gMDsgcSA8IHBvbHlMZW47IGkgPSBxKyspIHsKICAgICAgICAgIHZhciBlZGdlTG93UHQgPSBpblBvbHlnb25baV07CiAgICAgICAgICB2YXIgZWRnZUhpZ2hQdCA9IGluUG9seWdvbltxXTsKICAgICAgICAgIHZhciBlZGdlRHggPSBlZGdlSGlnaFB0LnggLSBlZGdlTG93UHQueDsKICAgICAgICAgIHZhciBlZGdlRHkgPSBlZGdlSGlnaFB0LnkgLSBlZGdlTG93UHQueTsKCiAgICAgICAgICBpZiAoTWF0aC5hYnMoZWRnZUR5KSA+IE51bWJlci5FUFNJTE9OKSB7CiAgICAgICAgICAgIC8vIG5vdCBwYXJhbGxlbAogICAgICAgICAgICBpZiAoZWRnZUR5IDwgMCkgewogICAgICAgICAgICAgIGVkZ2VMb3dQdCA9IGluUG9seWdvbltxXTsKICAgICAgICAgICAgICBlZGdlRHggPSAtZWRnZUR4OwogICAgICAgICAgICAgIGVkZ2VIaWdoUHQgPSBpblBvbHlnb25baV07CiAgICAgICAgICAgICAgZWRnZUR5ID0gLWVkZ2VEeTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGluUHQueSA8IGVkZ2VMb3dQdC55IHx8IGluUHQueSA+IGVkZ2VIaWdoUHQueSkgY29udGludWU7CgogICAgICAgICAgICBpZiAoaW5QdC55ID09PSBlZGdlTG93UHQueSkgewogICAgICAgICAgICAgIGlmIChpblB0LnggPT09IGVkZ2VMb3dQdC54KSByZXR1cm4gdHJ1ZTsgLy8gaW5QdCBpcyBvbiBjb250b3VyID8KICAgICAgICAgICAgICAvLyBjb250aW51ZTsgICAgICAgICAgICAgICAgLy8gbm8gaW50ZXJzZWN0aW9uIG9yIGVkZ2VMb3dQdCA9PiBkb2Vzbid0IGNvdW50ICEhIQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhciBwZXJwRWRnZSA9IGVkZ2VEeSAqIChpblB0LnggLSBlZGdlTG93UHQueCkgLSBlZGdlRHggKiAoaW5QdC55IC0gZWRnZUxvd1B0LnkpOwogICAgICAgICAgICAgIGlmIChwZXJwRWRnZSA9PT0gMCkgcmV0dXJuIHRydWU7IC8vIGluUHQgaXMgb24gY29udG91ciA/CgogICAgICAgICAgICAgIGlmIChwZXJwRWRnZSA8IDApIGNvbnRpbnVlOwogICAgICAgICAgICAgIGluc2lkZSA9ICFpbnNpZGU7IC8vIHRydWUgaW50ZXJzZWN0aW9uIGxlZnQgb2YgaW5QdAogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBwYXJhbGxlbCBvciBjb2xsaW5lYXIKICAgICAgICAgICAgaWYgKGluUHQueSAhPT0gZWRnZUxvd1B0LnkpIGNvbnRpbnVlOyAvLyBwYXJhbGxlbAogICAgICAgICAgICAvLyBlZGdlIGxpZXMgb24gdGhlIHNhbWUgaG9yaXpvbnRhbCBsaW5lIGFzIGluUHQKCiAgICAgICAgICAgIGlmIChlZGdlSGlnaFB0LnggPD0gaW5QdC54ICYmIGluUHQueCA8PSBlZGdlTG93UHQueCB8fCBlZGdlTG93UHQueCA8PSBpblB0LnggJiYgaW5QdC54IDw9IGVkZ2VIaWdoUHQueCkgcmV0dXJuIHRydWU7IC8vIGluUHQ6IFBvaW50IG9uIGNvbnRvdXIgIQogICAgICAgICAgICAvLyBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBpbnNpZGU7CiAgICAgIH0KCiAgICAgIHZhciBpc0Nsb2NrV2lzZSA9IFNoYXBlVXRpbHMuaXNDbG9ja1dpc2U7CiAgICAgIHZhciBzdWJQYXRocyA9IHRoaXMuc3ViUGF0aHM7CiAgICAgIGlmIChzdWJQYXRocy5sZW5ndGggPT09IDApIHJldHVybiBbXTsKICAgICAgaWYgKG5vSG9sZXMgPT09IHRydWUpIHJldHVybiB0b1NoYXBlc05vSG9sZXMoc3ViUGF0aHMpOwogICAgICB2YXIgc29saWQsIHRtcFBhdGgsIHRtcFNoYXBlOwogICAgICB2YXIgc2hhcGVzID0gW107CgogICAgICBpZiAoc3ViUGF0aHMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgdG1wUGF0aCA9IHN1YlBhdGhzWzBdOwogICAgICAgIHRtcFNoYXBlID0gbmV3IFNoYXBlKCk7CiAgICAgICAgdG1wU2hhcGUuY3VydmVzID0gdG1wUGF0aC5jdXJ2ZXM7CiAgICAgICAgc2hhcGVzLnB1c2godG1wU2hhcGUpOwogICAgICAgIHJldHVybiBzaGFwZXM7CiAgICAgIH0KCiAgICAgIHZhciBob2xlc0ZpcnN0ID0gIWlzQ2xvY2tXaXNlKHN1YlBhdGhzWzBdLmdldFBvaW50cygpKTsKICAgICAgaG9sZXNGaXJzdCA9IGlzQ0NXID8gIWhvbGVzRmlyc3QgOiBob2xlc0ZpcnN0OyAvLyBkZWJ1Zy5sb2coJ0hvbGVzIGZpcnN0JywgaG9sZXNGaXJzdCk7CgogICAgICB2YXIgYmV0dGVyU2hhcGVIb2xlcyA9IFtdOwogICAgICB2YXIgbmV3U2hhcGVzID0gW107CiAgICAgIHZhciBuZXdTaGFwZUhvbGVzID0gW107CiAgICAgIHZhciBtYWluSWR4ID0gMDsKICAgICAgdmFyIHRtcFBvaW50czsKICAgICAgbmV3U2hhcGVzW21haW5JZHhdID0gdW5kZWZpbmVkOwogICAgICBuZXdTaGFwZUhvbGVzW21haW5JZHhdID0gW107CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHN1YlBhdGhzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHRtcFBhdGggPSBzdWJQYXRoc1tpXTsKICAgICAgICB0bXBQb2ludHMgPSB0bXBQYXRoLmdldFBvaW50cygpOwogICAgICAgIHNvbGlkID0gaXNDbG9ja1dpc2UodG1wUG9pbnRzKTsKICAgICAgICBzb2xpZCA9IGlzQ0NXID8gIXNvbGlkIDogc29saWQ7CgogICAgICAgIGlmIChzb2xpZCkgewogICAgICAgICAgaWYgKCFob2xlc0ZpcnN0ICYmIG5ld1NoYXBlc1ttYWluSWR4XSkgbWFpbklkeCsrOwogICAgICAgICAgbmV3U2hhcGVzW21haW5JZHhdID0gewogICAgICAgICAgICBzOiBuZXcgU2hhcGUoKSwKICAgICAgICAgICAgcDogdG1wUG9pbnRzCiAgICAgICAgICB9OwogICAgICAgICAgbmV3U2hhcGVzW21haW5JZHhdLnMuY3VydmVzID0gdG1wUGF0aC5jdXJ2ZXM7CiAgICAgICAgICBpZiAoaG9sZXNGaXJzdCkgbWFpbklkeCsrOwogICAgICAgICAgbmV3U2hhcGVIb2xlc1ttYWluSWR4XSA9IFtdOyAvLyBkZWJ1Zy5sb2coJ2N3JywgaSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5ld1NoYXBlSG9sZXNbbWFpbklkeF0ucHVzaCh7CiAgICAgICAgICAgIGg6IHRtcFBhdGgsCiAgICAgICAgICAgIHA6IHRtcFBvaW50c1swXQogICAgICAgICAgfSk7IC8vIGRlYnVnLmxvZygnY2N3JywgaSk7CiAgICAgICAgfQogICAgICB9IC8vIG9ubHkgSG9sZXM/IC0+IHByb2JhYmx5IGFsbCBTaGFwZXMgd2l0aCB3cm9uZyBvcmllbnRhdGlvbgoKCiAgICAgIGlmICghbmV3U2hhcGVzWzBdKSByZXR1cm4gdG9TaGFwZXNOb0hvbGVzKHN1YlBhdGhzKTsKCiAgICAgIGlmIChuZXdTaGFwZXMubGVuZ3RoID4gMSkgewogICAgICAgIHZhciBhbWJpZ3VvdXMgPSBmYWxzZTsKICAgICAgICB2YXIgdG9DaGFuZ2UgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgc0lkeCA9IDAsIHNMZW4gPSBuZXdTaGFwZXMubGVuZ3RoOyBzSWR4IDwgc0xlbjsgc0lkeCsrKSB7CiAgICAgICAgICBiZXR0ZXJTaGFwZUhvbGVzW3NJZHhdID0gW107CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBfc0lkeCA9IDAsIF9zTGVuID0gbmV3U2hhcGVzLmxlbmd0aDsgX3NJZHggPCBfc0xlbjsgX3NJZHgrKykgewogICAgICAgICAgdmFyIHNobyA9IG5ld1NoYXBlSG9sZXNbX3NJZHhdOwoKICAgICAgICAgIGZvciAodmFyIGhJZHggPSAwOyBoSWR4IDwgc2hvLmxlbmd0aDsgaElkeCsrKSB7CiAgICAgICAgICAgIHZhciBobyA9IHNob1toSWR4XTsKICAgICAgICAgICAgdmFyIGhvbGVVbmFzc2lnbmVkID0gdHJ1ZTsKCiAgICAgICAgICAgIGZvciAodmFyIHMySWR4ID0gMDsgczJJZHggPCBuZXdTaGFwZXMubGVuZ3RoOyBzMklkeCsrKSB7CiAgICAgICAgICAgICAgaWYgKCFpc1BvaW50SW5zaWRlUG9seWdvbihoby5wLCBuZXdTaGFwZXNbczJJZHhdLnApKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChfc0lkeCAhPT0gczJJZHgpIHRvQ2hhbmdlLnB1c2goewogICAgICAgICAgICAgICAgZnJvbXM6IF9zSWR4LAogICAgICAgICAgICAgICAgdG9zOiBzMklkeCwKICAgICAgICAgICAgICAgIGhvbGU6IGhJZHgKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgaWYgKGhvbGVVbmFzc2lnbmVkKSB7CiAgICAgICAgICAgICAgICBob2xlVW5hc3NpZ25lZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgYmV0dGVyU2hhcGVIb2xlc1tzMklkeF0ucHVzaChobyk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFtYmlndW91cyA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIWhvbGVVbmFzc2lnbmVkKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJldHRlclNoYXBlSG9sZXNbX3NJZHhdLnB1c2goaG8pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHRvQ2hhbmdlLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGlmICghYW1iaWd1b3VzKSBuZXdTaGFwZUhvbGVzID0gYmV0dGVyU2hhcGVIb2xlczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciB0bXBIb2xlczsKCiAgICAgIGZvciAodmFyIF9pID0gMCwgaWwgPSBuZXdTaGFwZXMubGVuZ3RoOyBfaSA8IGlsOyBfaSsrKSB7CiAgICAgICAgdG1wU2hhcGUgPSBuZXdTaGFwZXNbX2ldLnM7CgogICAgICAgIGlmIChnZXRTaGFwZVNpemUodG1wU2hhcGUpID4gMSkgewogICAgICAgICAgc2hhcGVzLnB1c2godG1wU2hhcGUpOwogICAgICAgIH0KCiAgICAgICAgdG1wSG9sZXMgPSBuZXdTaGFwZUhvbGVzW19pXTsKCiAgICAgICAgZm9yICh2YXIgaiA9IDAsIGpsID0gdG1wSG9sZXMubGVuZ3RoOyBqIDwgamw7IGorKykgewogICAgICAgICAgdG1wU2hhcGUuaG9sZXMucHVzaCh0bXBIb2xlc1tqXS5oKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBzaGFwZXM7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU2hhcGVQYXRoOwp9KCk7CgpmdW5jdGlvbiBnZXRTaGFwZVNpemUoc2hhcGUpIHsKICB2YXIgbWluID0gewogICAgeDogSW5maW5pdHksCiAgICB5OiBJbmZpbml0eQogIH07CiAgdmFyIG1heCA9IHsKICAgIHg6IC1JbmZpbml0eSwKICAgIHk6IC1JbmZpbml0eQogIH07CiAgc2hhcGUuY3VydmVzLmZvckVhY2goZnVuY3Rpb24gKGN1cnZlKSB7CiAgICBjdXJ2ZS5nZXRQb2xlKG1pbiwgbWF4KTsKICB9KTsKICByZXR1cm4gTWF0aC5oeXBvdChtaW4ueCAtIG1heC54LCBtaW4ueSAtIG1heC55KTsKfQoKdmFyIEZvbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEZvbnQoZGF0YSkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZvbnQpOwoKICAgIHRoaXMudHlwZSA9ICdGb250JzsKICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB0aGlzLmlzRm9udCA9IHRydWU7CiAgfQoKICBfY3JlYXRlQ2xhc3MoRm9udCwgbnVsbCwgW3sKICAgIGtleTogImdlbmVyYXRlU2hhcGVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZVNoYXBlcyhnbHlwaHMpIHsKICAgICAgdmFyIHNpemUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IDEwMDsKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIG9mZnNldFNjYWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CiAgICAgIHZhciBzaGFwZXMgPSBbXTsKICAgICAgdmFyIHBhdGhEYXRhID0gY3JlYXRlUGF0aHMoZ2x5cGhzLCBzaXplLCBkYXRhLCBvZmZzZXRTY2FsZSk7CiAgICAgIHZhciBwYXRocyA9IHBhdGhEYXRhLnBhdGhzOwogICAgICB2YXIgY2hhckZsYWcgPSBbXTsKICAgICAgdmFyIGNvdW50ID0gMDsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgdGVtcFNoYXBlcyA9IHBhdGhzW2ldLnRvU2hhcGVzKCk7CiAgICAgICAgc2hhcGVzLnB1c2guYXBwbHkoc2hhcGVzLCBfdG9Db25zdW1hYmxlQXJyYXkodGVtcFNoYXBlcykpOwogICAgICAgIGNoYXJGbGFnLnB1c2goY291bnQpOwogICAgICAgIGNvdW50ICs9IHRlbXBTaGFwZXMubGVuZ3RoOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0RGF0YSA9IHsKICAgICAgICBzaGFwZXM6IHNoYXBlcwogICAgICB9OwogICAgICByZXN1bHREYXRhLnBhcmEgPSBPYmplY3QuYXNzaWduKHt9LCBwYXRoRGF0YS5wYXJhLCB7CiAgICAgICAgY2hhckZsYWc6IGNoYXJGbGFnCiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0RGF0YTsKICAgIH0KICB9XSk7CgogIHJldHVybiBGb250Owp9KCk7CgpmdW5jdGlvbiBjcmVhdGVQYXRocyhnbHlwaHMpIHsKICB2YXIgc2l6ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogMTAwOwogIHZhciBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgdmFyIG9mZnNldFNjYWxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CiAgdmFyIGxldHRlclNwYWNpbmcgPSBkYXRhLmxldHRlclNwYWNpbmcsCiAgICAgIGxpbmVIZWlnaHQgPSBkYXRhLmxpbmVIZWlnaHQsCiAgICAgIGxpbmVIZWlnaHREYXRhID0gZGF0YS5saW5lSGVpZ2h0RGF0YSwKICAgICAgdGV4dEFsaWduID0gZGF0YS50ZXh0QWxpZ247CiAgdmFyIF9saW5lSGVpZ2h0RGF0YSRlbVNpeiA9IGxpbmVIZWlnaHREYXRhLmVtU2l6ZSwKICAgICAgZW1TaXplID0gX2xpbmVIZWlnaHREYXRhJGVtU2l6ID09PSB2b2lkIDAgPyAxMDI0IDogX2xpbmVIZWlnaHREYXRhJGVtU2l6OwogIHZhciBzY2FsZSA9IHNpemUgLyBlbVNpemU7CiAgdmFyIHJlYWxMaW5lSGVpZ2h0ID0gc2l6ZSAqIGxpbmVIZWlnaHQ7CiAgdmFyIHNoYXBlUGF0aHMgPSBbXTsKICB2YXIgY2hhclBvc0RhdGFzID0gW107CiAgdmFyIGxpbmVzV2lkdGggPSBbMF07CiAgdmFyIGogPSAwOwogIHZhciBvZmZzZXRYID0gMDsKICB2YXIgb2Zmc2V0WSA9IDA7CiAgdmFyIGsgPSAtMTsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBnbHlwaHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBnbHlwaCA9IGdseXBoc1tpXTsKCiAgICBpZiAoZ2x5cGgubmFtZSA9PT0gJ1xuJykgewogICAgICBsaW5lc1dpZHRoWysral0gPSAwOwogICAgICBrID0gLTE7CiAgICB9IGVsc2UgewogICAgICBvZmZzZXRYID0gZ2x5cGguaGEgKiBzY2FsZSAqIG9mZnNldFNjYWxlICsgbGV0dGVyU3BhY2luZzsKICAgICAgbGluZXNXaWR0aFtqXSArPSBvZmZzZXRYOwoKICAgICAgaWYgKGdseXBoLm5hbWUgJiYgZ2x5cGgubmFtZSAhPT0gJyAnKSB7CiAgICAgICAgY2hhclBvc0RhdGFzLnB1c2goewogICAgICAgICAgcm93TnVtOiBqLAogICAgICAgICAgY29sdW1uTnVtOiArK2sKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KCiAgdmFyIG1heExpbmVXaWR0aCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIGxpbmVzV2lkdGgpOwogIG9mZnNldFggPSAwOwogIGogPSAwOwoKICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgZ2x5cGhzLmxlbmd0aDsgX2krKykgewogICAgdmFyIF9nbHlwaCA9IGdseXBoc1tfaV07CgogICAgaWYgKF9nbHlwaC5uYW1lID09PSAnXG4nKSB7CiAgICAgIG9mZnNldFkgLT0gcmVhbExpbmVIZWlnaHQ7CgogICAgICBzd2l0Y2ggKHRleHRBbGlnbikgewogICAgICAgIGNhc2UgJ2NlbnRlcic6CiAgICAgICAgICBvZmZzZXRYIC09IChsaW5lc1dpZHRoW2pdICsgbGluZXNXaWR0aFsrK2pdKSAvIDI7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAncmlnaHQnOgogICAgICAgICAgb2Zmc2V0WCAtPSBsaW5lc1dpZHRoWysral07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIG9mZnNldFggPSAwOwogICAgICB9CiAgICB9IGVsc2UgaWYgKF9nbHlwaC5uYW1lID09PSAnICcgfHwgIV9nbHlwaC5uYW1lKSB7CiAgICAgIG9mZnNldFggKz0gX2dseXBoLmhhICogc2NhbGUgKyBsZXR0ZXJTcGFjaW5nOwogICAgfSBlbHNlIHsKICAgICAgdmFyIHJldCA9IGNyZWF0ZVBhdGgoX2dseXBoLCBzY2FsZSwgb2Zmc2V0WCwgb2Zmc2V0WSwgb2Zmc2V0U2NhbGUpOwogICAgICBvZmZzZXRYICs9IHJldC5vZmZzZXRYICsgbGV0dGVyU3BhY2luZzsKICAgICAgc2hhcGVQYXRocy5wdXNoKHJldC5wYXRoKTsKICAgIH0KICB9IC8vIGNvbnN0IGZmZEZvclBhdGhzID0gbmV3IEZGREZvclBhdGhzKCk7CiAgLy8gZmZkRm9yUGF0aHMuRkZERm9yUGF0aHMoc2hhcGVQYXRocywgNTAsIDAsICdyaG9tYm9pZCcpOwogIC8vIGNvbnZlcnRQYXRocyhwYXRocyk7CiAgLy8gZmZkRm9yUGF0aHMuRkZERm9yUGF0aHMoW3tzdWJQYXRoczpwYXRoc1sxXS5zdWJQYXRoc31dLCAxMDAsIDAsICdyaG9tYm9pZCcpOwogIC8vIGNvbnN0IGJlbmRGb3JQYXRocyA9IG5ldyBCZW5kRm9yUGF0aHMoKTsKICAvLyBiZW5kRm9yUGF0aHMuYmVuZGluZ0ZvclBhdGhzKHBhdGhzLCAndmVydGljYWwnLCAwKTsKICAvLyBjb25zdCB2ZXJiYXRpbVRyYW5zID0gbmV3IFZlcmJhdGltRm9yUGF0aHMoKTsKICAvLyB2ZXJiYXRpbVRyYW5zLnZlcmJhdGltVHJhbnNmb3JtYXRpb24ocGF0aHMsIDUwLCAncmFuZG9tU2l6ZScsIDEwLCAxMCk7CgoKICB2YXIgcmVzdWx0RGF0YSA9IHsKICAgIHBhdGhzOiBzaGFwZVBhdGhzCiAgfTsKICByZXN1bHREYXRhLnBhcmEgPSB7CiAgICBiYXNlTGluZUhlaWdodDogc2l6ZSwKICAgIGNoYXJQb3NEYXRhczogY2hhclBvc0RhdGFzLAogICAgcmVhbExpbmVIZWlnaHQ6IHJlYWxMaW5lSGVpZ2h0LAogICAgbWF4TGluZVdpZHRoOiBtYXhMaW5lV2lkdGgKICB9OyAvLyB2ZXJiYXRpbVRyYW5zLnZlcmJhdGltVHJhbnNmb3JtYXRpb24ocGF0aHMsIDUwLCAncmFuZG9tU2l6ZScsIDEwLCAxMCwgcmVzdWx0RGF0YS5wYXJhKTsKCiAgcmV0dXJuIHJlc3VsdERhdGE7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVBhdGgoZ2x5cGgsIHNjYWxlLCBvZmZzZXRYLCBvZmZzZXRZLCBvZmZzZXRTY2FsZSkgewogIGlmICghZ2x5cGgpIHJldHVybjsKICB2YXIgc2hhcGVQYXRoID0gbmV3IFNoYXBlUGF0aCgpOwogIHZhciB4LCB5LCBjcHgsIGNweSwgY3B4MSwgY3B5MSwgY3B4MiwgY3B5MjsKCiAgaWYgKGdseXBoLm8pIHsKICAgIHZhciBvdXRsaW5lID0gZ2x5cGguX2NhY2hlZE91dGxpbmUgfHwgKGdseXBoLl9jYWNoZWRPdXRsaW5lID0gZ2x5cGguby5zcGxpdCgnICcpKTsgLy8gbGV0IG91dGxpbmUgPSBvdXRsaW5lT3JpLnNsaWNlKDApOwoKICAgIHZhciBzdGFydFggPSAwOwogICAgdmFyIHN0YXJ0WSA9IDA7CgogICAgZm9yICh2YXIgaSA9IDAsIGwgPSBvdXRsaW5lLmxlbmd0aDsgaSA8IGw7KSB7CiAgICAgIHZhciBhY3Rpb24gPSBvdXRsaW5lW2krK107CgogICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAgIGNhc2UgJ20nOgogICAgICAgICAgLy8gbW92ZVRvCiAgICAgICAgICB4ID0gb3V0bGluZVtpKytdICogc2NhbGUgKyBvZmZzZXRYOwogICAgICAgICAgeSA9IG91dGxpbmVbaSsrXSAqIHNjYWxlICsgb2Zmc2V0WTsKICAgICAgICAgIHNoYXBlUGF0aC5tb3ZlVG8oeCwgeSk7CiAgICAgICAgICBzdGFydFggPSB4OwogICAgICAgICAgc3RhcnRZID0geTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdsJzoKICAgICAgICAgIC8vIGxpbmVUbwogICAgICAgICAgeCA9IG91dGxpbmVbaSsrXSAqIHNjYWxlICsgb2Zmc2V0WDsKICAgICAgICAgIHkgPSBvdXRsaW5lW2krK10gKiBzY2FsZSArIG9mZnNldFk7CiAgICAgICAgICBzaGFwZVBhdGgubGluZVRvKHgsIHkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3EnOgogICAgICAgICAgLy8gcXVhZHJhdGljQ3VydmVUbwogICAgICAgICAgY3B4ID0gb3V0bGluZVtpKytdICogc2NhbGUgKyBvZmZzZXRYOwogICAgICAgICAgY3B5ID0gb3V0bGluZVtpKytdICogc2NhbGUgKyBvZmZzZXRZOwogICAgICAgICAgY3B4MSA9IG91dGxpbmVbaSsrXSAqIHNjYWxlICsgb2Zmc2V0WDsKICAgICAgICAgIGNweTEgPSBvdXRsaW5lW2krK10gKiBzY2FsZSArIG9mZnNldFk7CiAgICAgICAgICBzaGFwZVBhdGgucXVhZHJhdGljQ3VydmVUbyhjcHgxLCBjcHkxLCBjcHgsIGNweSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnYic6CiAgICAgICAgICAvLyBiZXppZXJDdXJ2ZVRvCiAgICAgICAgICBjcHggPSBvdXRsaW5lW2krK10gKiBzY2FsZSArIG9mZnNldFg7CiAgICAgICAgICBjcHkgPSBvdXRsaW5lW2krK10gKiBzY2FsZSArIG9mZnNldFk7CiAgICAgICAgICBjcHgxID0gb3V0bGluZVtpKytdICogc2NhbGUgKyBvZmZzZXRYOwogICAgICAgICAgY3B5MSA9IG91dGxpbmVbaSsrXSAqIHNjYWxlICsgb2Zmc2V0WTsKICAgICAgICAgIGNweDIgPSBvdXRsaW5lW2krK10gKiBzY2FsZSArIG9mZnNldFg7CiAgICAgICAgICBjcHkyID0gb3V0bGluZVtpKytdICogc2NhbGUgKyBvZmZzZXRZOwogICAgICAgICAgc2hhcGVQYXRoLmJlemllckN1cnZlVG8oY3B4MSwgY3B5MSwgY3B4MiwgY3B5MiwgY3B4LCBjcHkpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3onOgogICAgICAgICAgLy8gbGluZVRvCiAgICAgICAgICB4ID0gc3RhcnRYOwogICAgICAgICAgeSA9IHN0YXJ0WTsKICAgICAgICAgIHNoYXBlUGF0aC5saW5lVG8oeCwgeSk7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIHsKICAgIG9mZnNldFg6IGdseXBoLmhhICogc2NhbGUgKiBvZmZzZXRTY2FsZSwKICAgIG9mZnNldFk6IGdseXBoLmhhICogc2NhbGUgKiBvZmZzZXRTY2FsZSwKICAgIHBhdGg6IHNoYXBlUGF0aAogIH07Cn0KCm9ubWVzc2FnZSA9IGZ1bmN0aW9uIG9ubWVzc2FnZShlKSB7CiAgdmFyIF9lJGRhdGEgPSBlLmRhdGEsCiAgICAgIGRhdGEgPSBfZSRkYXRhLmRhdGEsCiAgICAgIGdseXBocyA9IF9lJGRhdGEuZ2x5cGhzLAogICAgICBvcHRpb25zID0gX2UkZGF0YS5vcHRpb25zOwogIHZhciBzaXplID0gb3B0aW9ucy5zaXplLAogICAgICBvZmZzZXRTY2FsZSA9IG9wdGlvbnMub2Zmc2V0U2NhbGU7CgogIHZhciBfRm9udCRnZW5lcmF0ZVNoYXBlcyA9IEZvbnQuZ2VuZXJhdGVTaGFwZXMoZ2x5cGhzLCBzaXplLCBkYXRhLCBvZmZzZXRTY2FsZSksCiAgICAgIHNoYXBlcyA9IF9Gb250JGdlbmVyYXRlU2hhcGVzLnNoYXBlcywKICAgICAgcGFyYSA9IF9Gb250JGdlbmVyYXRlU2hhcGVzLnBhcmE7CgogIE9iamVjdC5hc3NpZ24ob3B0aW9ucywgcGFyYSk7CiAgdmFyIGJ1ZmZlckdlb21ldHJ5ID0gbmV3IEV4dHJ1ZGVCdWZmZXJHZW9tZXRyeShzaGFwZXMsIG9wdGlvbnMpOwogIHBvc3RNZXNzYWdlKGJ1ZmZlckdlb21ldHJ5KTsKfTsKCg==','bind','getOwnPropertyDescriptor','this\x20hasn\x27t\x20been\x20initialised\x20-\x20super()\x20hasn\x27t\x20been\x20called','Derived\x20constructors\x20may\x20only\x20return\x20object\x20or\x20undefined','Curve','arcLengthDivisions','recurDepth','getPointAt','getUtoTmapping','getPoints','getPointsByStepsize','getLength','triangleArea','checkFlat','sample','getPointsAdaptively4Curve','getLengths','cacheArcLengths','updateArcLengths','getTangent','getTangentAt','MAX_VALUE','construct','sham','valueOf','isLineCurve','getPole','curves','autoClose','getCurveLengths','cacheLengths','isEllipseCurve','isSplineCurve','getPointsByStepSize','resolution','getPointsAdaptively','EllipseCurve','xRadius','yRadius','startAngle','endAngle','clockwise','rotation','aStartAngle','aEndAngle','aClockwise','SplineCurve','CubicBezierCurve','isCubicBezierCurve','pointApplyFunc','QuadraticBezierCurve','find','currentPoint','moveTo','lineTo','quadraticCurveTo','bezierCurveTo','arc','absarc','ellipse','absellipse','Shape','getPointsHoles','getPointsHolesByStepSize','getPointsHolesAdaptively','extractPointsByStepSize','extractPointsAdaptively','ShapePath','currentPath','splineThru','toShapes','subPaths','paths','para','letterSpacing','lineHeight','offsetX','path','_cachedOutline','font','isFont','THREE.TextBufferGeometry:\x20font\x20parameter\x20is\x20not\x20an\x20instance\x20of\x20THREE.Font.','glyphs','lineHeightData','textAlign','TextBufferGeometry','mark','worker','onerror','postMessage','offsetScale','abrupt','stop','values','supportedGlyphs','unicode','fromCharCode','commands','advanceWidth','x_min','x_max','xMax','familyName','ascender','descender','tables','post','underlinePosition','underlineThickness','xMin','yMax','original_font_information','fontSubfamily','bold','cssFontWeight','cssFontStyle','error:\x20reverseCommands:\x20not\x20specify\x20reverseTagList,\x20return\x20original\x20commands','hole','polyId','child','path_id','runPattern','bendType','bend_intersity','RUN','meshGeometryBoundingBoxMaxx','startNum','endNum','isCircleCurve','getNormal','LineCurve3','isLineCurve3','QuadraticBezierCurve3','PloygonCurve','num','lineCurves','currentLine','getCurrentLine','pointK','SQRT1_2','currentCurve','RectangularCurve','ratio','breakLine','boundingBoxOfAFont','getExtremumOfSubPaths','centreOfAFont','caculateCrossPoint','makeTheJointSmooth','isFromLine','lineToQuadraticBezier','LineCurve','getWhetherParallel','charPosDatas','intensitys','isHorizontal','baseWidth','baseHeight','bend','tan','baseTransform','transform','_factorial','_combination','_bernsteinBasis','_linearBasis','_basisFunction','bernstein','linear','_calculateSTUfromX','_initP','XWidth','ZWidth','_getP','_addP','STUs','_calculateXfromSTU','pattern','basisType','baseLineHeight','maxLineWidth','_initSTUs','_changeP','YWidth','_calculateDeformedGeometry','factorialForFFD','combineForFFD','caculateForBezierFFD','caculateForFFD','linearBasis','maxFontSize','horizontal-tb','bevel','upperRoof','lowerRoof','angledProjection','foldedCorner','flagCurve','archCurve','creatFFDControlPoints','adjustControlPoints','concaveCurve','upperArchCurve','lowerArchCurve','bulbCurve','trapezoid','lowerTrapezoid','lateralStretching','getBoundingBoxOfPaths','intensity','runPattern0','runPattern1','runPattern2','runPattern3','runPattern4','runPattern5','runPattern8','fround','PerCharCalculation','minX','bboxPerLine','rowNum','randNum','getRandom','runPattern9','intensity1','patchwork','columnNum','translateVec','step','arch2','centerPos','wave','stepFarAndNear','centerX','centerY','archFarAndNear','boxCenter','horizontalRotate','horizontalCurvedRotate','getPerCharAndCurveFunc','funcPerChar','funcPerCurve','arbitraryOffsetRotate','fontSize','polygon','rectangular','isFollowTangent','pentagon','heart','calculateNewCenter','resetPointPos','calculateNewCenterWithoutRotate','curve','centerDiviation','newCenterPos','resetPointPosWithoutRotate','arrayBuffer','textGeometry\x20options\x20is','catch','info','Error\x20occurred\x20when\x20parsing\x20font','initPosArray','skew','topTrapezoid','verticalStretching','字体挤出缩放','getAttribute','bufferGeometry\x20vertex\x20count','undefined','prototype','call','exports','default','value','done','apply','__esModule','@babel/helpers\x20-\x20typeof','function','symbol','iterator','constructor','@@iterator','asyncIterator','toStringTag','@@toStringTag','defineProperty','create','_invoke','completed','throw','arg','delegate','method','sent','_sent','dispatchException','return','normal','type','wrap','getPrototypeOf','forEach','__await','resolve','then','The\x20iterator\x20does\x20not\x20provide\x20a\x20\x27throw\x27\x20method','resultName','nextLoc','next','iterator\x20result\x20is\x20not\x20an\x20object','catchLoc','finallyLoc','afterLoc','push','completion','root','reset','length','displayName','isGeneratorFunction','GeneratorFunction','setPrototypeOf','__proto__','AsyncIterator','async','[object\x20Generator]','keys','pop','prev','tryEntries','charAt','slice','tryLoc','end','break','continue','complete','object','regeneratorRuntime\x20=\x20r','assign','_listeners','indexOf','Cannot\x20call\x20a\x20class\x20as\x20a\x20function','enumerable','configurable','writable','key','toString','random','toUpperCase','max','min','floor','RAD2DEG','pow','ceil','log','LN2','elements','isMatrix4','identity','set','copyPosition','extractBasis','setFromMatrixColumn','makeBasis','extractRotation','makeRotationFromQuaternion','compose','lookAt','lengthSq','crossVectors','abs','normalize','warn','THREE.Matrix4:\x20.multiply()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.multiplyMatrices(\x20a,\x20b\x20)\x20instead.','multiplyMatrices','premultiply','multiplyScalar','getX','getY','getZ','setXYZ','transpose','setPosition','THREE.Matrix4:\x20.getInverse()\x20can\x27t\x20invert\x20matrix,\x20determinant\x20is\x200','scale','getMaxScaleOnAxis','makeTranslation','makeRotationX','cos','sin','makeRotationZ','makeRotationAxis','makeScale','decompose','determinant','copy','setFromRotationMatrix','makePerspective','equals','toArray','isQuaternion','slerpFlat','EPSILON','sqrt','atan2','onChangeCallback','clone','setFromEuler','isEuler','THREE.Quaternion:\x20.setFromEuler()\x20now\x20expects\x20an\x20Euler\x20rotation\x20rather\x20than\x20a\x20Vector3\x20and\x20order.','YXZ','ZXY','ZYX','YZX','setFromUnitVectors','angleTo','acos','clamp','slerp','inverse','conjugate','dot','multiply','THREE.Quaternion:\x20.multiply()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.multiplyQuaternions(\x20a,\x20b\x20)\x20instead.','multiplyQuaternions','fromArray','onChange','isVector3','setScalar','setComponent','index\x20is\x20out\x20of\x20range:\x20','getComponent','THREE.Vector3:\x20.add()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.addVectors(\x20a,\x20b\x20)\x20instead.','addVectors','addScalar','addScaledVector','sub','subScalar','subVectors','multiplyVectors','applyEuler','error','THREE.Vector3:\x20.applyEuler()\x20now\x20expects\x20an\x20Euler\x20rotation\x20rather\x20than\x20a\x20Vector3\x20and\x20order.','applyQuaternion','applyAxisAngle','setFromAxisAngle','project','matrixWorldInverse','applyMatrix4','projectionMatrix','unproject','getInverse','matrixWorld','transformDirection','divide','clampScalar','clampLength','round','roundToZero','negate','manhattanLength','setLength','add','THREE.Vector3:\x20.cross()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.crossVectors(\x20a,\x20b\x20)\x20instead.','projectOnVector','reflect','distanceToSquared','manhattanDistanceTo','setFromSphericalCoords','theta','setFromCylindrical','setFromCylindricalCoords','radius','setFromMatrixScale','fromBufferAttribute','THREE.Vector3:\x20offset\x20has\x20been\x20removed\x20from\x20.fromBufferAttribute().','vertexNormals','isArray','materialIndex','isMatrix3','count','THREE.Matrix3:\x20.getInverse()\x20no\x20longer\x20takes\x20a\x20Matrix4\x20argument.','getNormalMatrix','rotate','translate','isBox3','setFromArray','setFromPoints','makeEmpty','expandByPoint','setFromObject','expandByObject','isEmpty','getCenter','THREE.Box3:\x20.getCenter()\x20target\x20is\x20now\x20required','getSize','expandByVector','expandByScalar','geometry','isGeometry','vertices','isBufferGeometry','attributes','position','updateMatrixWorld','traverse','containsBox','THREE.Box3:\x20.getParameter()\x20target\x20is\x20now\x20required','intersectsBox','clampPoint','THREE.Box3:\x20.clampPoint()\x20target\x20is\x20now\x20required','distanceToPoint','getBoundingSphere','THREE.Box3:\x20.getBoundingSphere()\x20target\x20is\x20now\x20required','center','union','empty','intersectsSphere','intersectsPlane','THREE.Sphere:\x20.clampPoint()\x20target\x20is\x20now\x20required','THREE.Sphere:\x20.getBoundingBox()\x20target\x20is\x20now\x20required','isVector2','setY','THREE.Vector2:\x20.add()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.addVectors(\x20a,\x20b\x20)\x20instead.','divideScalar','applyMatrix3','cross','hypot','distanceTo','lerp','lerpVectors','THREE.Vector2:\x20offset\x20has\x20been\x20removed\x20from\x20.fromBufferAttribute().','rotateAround','defineProperties','_order','DefaultOrder','XYZ','asin','XZY','THREE.Euler:\x20.setFromRotationMatrix()\x20given\x20unsupported\x20order:\x20','mask','uuid','generateUUID','name','parent','setFromQuaternion','matrix','matrixAutoUpdate','DefaultMatrixAutoUpdate','visible','receiveShadow','userData','DefaultUp','quaternion','translateOnAxis','updateWorldMatrix','isCamera','remove','dispatchEvent','added','children','THREE.Object3D.add:\x20object\x20not\x20an\x20instance\x20of\x20THREE.Object3D.','removed','splice','getObjectByProperty','THREE.Object3D:\x20.getWorldPosition()\x20target\x20is\x20now\x20required','THREE.Object3D:\x20.getWorldQuaternion()\x20target\x20is\x20now\x20required','traverseVisible','traverseAncestors','matrixWorldNeedsUpdate','updateMatrix','metadata','Object','Object3D.toJSON','frustumCulled','renderOrder','stringify','layers','isMesh','isLine','isPoints','geometries','parameters','shapes','material','materials','toJSON','textures','images','castShadow','from','string','Map','Arguments','test','Invalid\x20attempt\x20to\x20spread\x20non-iterable\x20instance.\x0aIn\x20order\x20to\x20be\x20iterable,\x20non-array\x20objects\x20must\x20have\x20a\x20[Symbol.iterator]()\x20method.','Invalid\x20attempt\x20to\x20destructure\x20non-iterable\x20instance.\x0aIn\x20order\x20to\x20be\x20iterable,\x20non-array\x20objects\x20must\x20have\x20a\x20[Symbol.iterator]()\x20method.','val\x20is\x20not\x20a\x20non-empty\x20string\x20or\x20a\x20valid\x20number.\x20val=','year','yrs','week','days','hours','hrs','minute','mins','seconds','second','sec','milliseconds','millisecond','day','\x20ms','coerce','enable','destroy','names','skips','formatters','charCodeAt','colors','selectColor','enabled','diff','curr','unshift','replace','formatArgs','useColors','namespaces','init','namespace','save','split','concat','map','join','substring','stack','message','Instance\x20method\x20`debug.destroy()`\x20is\x20deprecated\x20and\x20no\x20longer\x20does\x20anything.\x20It\x20will\x20be\x20removed\x20in\x20the\x20next\x20major\x20version\x20of\x20`debug`.','load','storage','#0000CC','#0000FF','#0066CC','#0066FF','#0099FF','#00CC00','#00CC33','#00CC66','#00CC99','#00CCCC','#00CCFF','#3300CC','#3300FF','#3333CC','#3333FF','#3366CC','#3366FF','#3399CC','#33CC00','#33CC66','#33CC99','#33CCCC','#33CCFF','#6600CC','#6600FF','#6633CC','#6633FF','#66CC00','#66CC33','#9900FF','#9933CC','#9933FF','#99CC33','#CC0000','#CC0033','#CC0099','#CC00CC','#CC3300','#CC3366','#CC3399','#CC6600','#CC6633','#CC9900','#CC9933','#CCCC33','#FF0000','#FF0099','#FF00FF','#FF3300','#FF3333','#FF3366','#FF3399','#FF33CC','#FF33FF','#FF6600','#FF6633','#FF9900','#FFCC33','process','renderer','userAgent','toLowerCase','match','documentElement','style','WebkitAppearance','console','firebug','exception','%c\x20','humanize','color','color:\x20inherit','debug','getItem','env','DEBUG','[UnexpectedJSONParseError]:\x20','three-font-parser','0.4.2','size','weight','height','half_ellipse','tri_method','entries','reduce','_fire','_createDebug','_store','timer\x20','\x20already\x20exists','get','\x20not\x20exists','Geometry','faces','faceVertexUvs','morphTargets','morphNormals','skinIndices','elementsNeedUpdate','verticesNeedUpdate','uvsNeedUpdate','normalsNeedUpdate','lineDistancesNeedUpdate','groupsNeedUpdate','boundingBox','computeBoundingBox','boundingSphere','computeBoundingSphere','index','array','uv2','applyMatrix','computeFaceNormals','__originalFaceNormal','__originalVertexNormals','faceNormals','THREE.Geometry.merge():\x20geometry\x20not\x20an\x20instance\x20of\x20THREE.Geometry.','THREE.Geometry.mergeMesh():\x20mesh\x20not\x20an\x20instance\x20of\x20THREE.Mesh.','_id','sort','Geometry.toJSON','data','normals','uvs','skinWeights','lineDistances','dispose','\x22\x20is\x20read-only','THREE.Vector4:\x20.add()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.addVectors(\x20a,\x20b\x20)\x20instead.','THREE.Vector4:\x20.sub()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.subVectors(\x20a,\x20b\x20)\x20instead.','THREE.Vector4:\x20offset\x20has\x20been\x20removed\x20from\x20.fromBufferAttribute().','getW','updateRange','version','needsUpdate','THREE.BufferAttribute:\x20array\x20should\x20be\x20a\x20Typed\x20Array.','itemSize','dynamic','THREE.BufferAttribute.copyVector3sArray():\x20vector\x20is\x20undefined','THREE.BufferAttribute.copyVector4sArray():\x20vector\x20is\x20undefined','onUploadCallback','uvs2','start','groups','THREE.DirectGeometry:\x20Faceless\x20geometries\x20are\x20not\x20supported.','THREE.DirectGeometry.fromGeometry():\x20Undefined\x20vertexUv\x20','THREE.DirectGeometry.fromGeometry():\x20Undefined\x20vertexUv2\x20','BufferGeometry','morphAttributes','drawRange','charVertexFlagArray','charCenterArray','charCenterArrayT','charVertexCountArray','charBBoxArray','isBufferAttribute','isInterleavedBufferAttribute','addAttribute','THREE.BufferGeometry.addAttribute:\x20Use\x20.setIndex()\x20for\x20index\x20attribute.','setIndex','applyToBufferAttribute','copyVector3sArray','copyArray','fromGeometry','fromDirectGeometry','__directGeometry','setFromBufferAttribute','THREE.BufferGeometry.computeBoundingBox:\x20Computed\x20min/max\x20have\x20NaN\x20values.\x20The\x20\x22position\x22\x20attribute\x20is\x20likely\x20to\x20have\x20NaN\x20values.','normalizeNormals','material_id\x20===\x20-1','time','mergeSameVertex','copyVector2sArray','setIndexYunyang','after\x20merge\x20the\x20vertex\x20number\x20is\x20:\x20','timeEnd','THREE.BufferGeometry.merge():\x20Overwriting\x20original\x20geometry,\x20starting\x20at\x20offset=0.\x20','Use\x20BufferGeometryUtils.mergeBufferGeometries()\x20for\x20lossless\x20merge.','THREE.BufferGeometry.toNonIndexed():\x20Geometry\x20is\x20already\x20non-indexed.','parse','addGroup','setFromCenterAndSize','THREE.Box2:\x20.getCenter()\x20target\x20is\x20now\x20required','THREE.Box2:\x20.getSize()\x20target\x20is\x20now\x20required','containsPoint','THREE.Box2:\x20.getParameter()\x20target\x20is\x20now\x20required','THREE.Box2:\x20.clampPoint()\x20target\x20is\x20now\x20required','intersect','steiner','nextZ','prevZ','deviation','1.5.0','freeze','[object\x20Object]','PointError','points','toStringBase','set_zero','mul','number','compare','cmp','interior_','delaunay_edge','points_','getPoint','getNeighbor','neighbors_','markNeighborPointers','markNeighbor','containsPoints','clearNeighbors','pointCCW','neighborCW','neighborCCW','getConstrainedEdgeCW','constrained_edge','getDelaunayEdgeCCW','setDelaunayEdgeCW','setDelaunayEdgeCCW','neighborAcross','oppositePoint','pointCW','legalize','poly2tri\x20Invalid\x20Triangle.legalize()\x20call','poly2tri\x20Invalid\x20Triangle.index()\x20call','edgeIndex','markConstrainedEdgeByPoints','Assert\x20Failed','point','triangle','head_','tail_','search_node_','head','setHead','tail','setTail','search','setSearch','findSearchNode','poly2tri\x20Invalid\x20AdvancingFront.locatePoint()\x20call','Node','CCW','Orientation','orient2d','inScanArea','isAngleObtuse','initTriangulation','createAdvancingFront','pointCount','front','meshClean','COLLINEAR','poly2tri\x20EdgeEvent:\x20Collinear\x20not\x20supported!','addToMap','mapTriangleToNodes','unordered\x20y','getConstrainedEdgeCCW','getDelaunayEdgeCW','setConstrainedEdgeCCW','setConstrainedEdgeCW','basin','left_node','bottom_node','right_node','width','left_highest','edge_event','right','getConstrainedEdgeAcross','poly2tri\x20Intersecting\x20Constraints','clearDelaunayEdges','poly2tri\x20[Unsupported]\x20nextFlipPoint:\x20opposing\x20point\x20on\x20constrained\x20edge!','FLIP\x20failed\x20due\x20to\x20missing\x20triangle','poly2tri\x20Invalid\x20Edge\x20constructor:\x20repeated\x20points!','_p2t_edge_list','clear','triangles_','map_','cloneArrays','pmin_','front_','af_middle_','af_tail_','initEdges','addHole','AddHole','addHoles','addPoint','addPoints','triangulate','getBoundingBox','pmax_','getTriangles','GetTriangles'];(function(_0x1a026c,_0x2492de){var _0x2d8f05=function(_0x4b81bb){while(--_0x4b81bb){_0x1a026c['push'](_0x1a026c['shift']());}};_0x2d8f05(++_0x2492de);}(_0x509b,0x14d));var _0x22c1=function(_0x590beb,_0x310f27){_0x590beb=_0x590beb-0x0;var _0xd1621f=_0x509b[_0x590beb];return _0xd1621f;};import{parse as _0x30de3a}from'opentype.js';import{LRUMap}from'lru_map';import{cloneDeep}from'lodash';var commonjsGlobal=typeof globalThis!==_0x22c1('0x0')?globalThis:typeof window!==_0x22c1('0x0')?window:typeof global!=='undefined'?global:typeof self!==_0x22c1('0x0')?self:{};function unwrapExports(x){return x&&x['__esModule']&&Object[_0x22c1('0x1')]['hasOwnProperty'][_0x22c1('0x2')](x,'default')?x['default']:x;}function createCommonjsModule(fn,module){return module={'exports':{}},fn(module,module[_0x22c1('0x3')]),module[_0x22c1('0x3')];}function getCjsExportFromNamespace(n){return n&&n[_0x22c1('0x4')]||n;}var asyncToGenerator=createCommonjsModule(function(module){function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info[_0x22c1('0x5')];}catch(_0x592bf4){reject(_0x592bf4);return;}if(info[_0x22c1('0x6')]){resolve(value);}else{Promise['resolve'](value)['then'](_next,_throw);}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn[_0x22c1('0x7')](self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,'next',value);}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,'throw',err);}_next(undefined);});};}module[_0x22c1('0x3')]=_asyncToGenerator,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});var _asyncToGenerator=unwrapExports(asyncToGenerator);var _typeof_1=createCommonjsModule(function(module){function _typeof(obj){_0x22c1('0x9');return(module[_0x22c1('0x3')]=_typeof=_0x22c1('0xa')==typeof Symbol&&_0x22c1('0xb')==typeof Symbol[_0x22c1('0xc')]?function(obj){return typeof obj;}:function(obj){return obj&&_0x22c1('0xa')==typeof Symbol&&obj[_0x22c1('0xd')]===Symbol&&obj!==Symbol[_0x22c1('0x1')]?_0x22c1('0xb'):typeof obj;},module[_0x22c1('0x3')]['__esModule']=!![],module[_0x22c1('0x3')]['default']=module[_0x22c1('0x3')]),_typeof(obj);}module['exports']=_typeof,module['exports'][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});var _typeof=unwrapExports(_typeof_1);var regeneratorRuntime$1=createCommonjsModule(function(module){var _typeof=_typeof_1[_0x22c1('0x4')];function _regeneratorRuntime(){module[_0x22c1('0x3')]=_regeneratorRuntime=function _regeneratorRuntime(){return exports;},module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module[_0x22c1('0x3')];var exports={},Op=Object[_0x22c1('0x1')],hasOwn=Op['hasOwnProperty'],$Symbol=_0x22c1('0xa')==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol[_0x22c1('0xc')]||_0x22c1('0xe'),asyncIteratorSymbol=$Symbol[_0x22c1('0xf')]||'@@asyncIterator',toStringTagSymbol=$Symbol[_0x22c1('0x10')]||_0x22c1('0x11');function define(obj,key,value){return Object[_0x22c1('0x12')](obj,key,{'value':value,'enumerable':!0x0,'configurable':!0x0,'writable':!0x0}),obj[key];}try{define({},'');}catch(_0x33320c){define=function define(obj,key,value){return obj[key]=value;};}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn['prototype']instanceof Generator?outerFn:Generator,generator=Object[_0x22c1('0x13')](protoGenerator[_0x22c1('0x1')]),context=new Context(tryLocsList||[]);return generator[_0x22c1('0x14')]=function(innerFn,self,context){var state='suspendedStart';return function(method,arg){if('executing'===state)throw new Error('Generator\x20is\x20already\x20running');if(_0x22c1('0x15')===state){if(_0x22c1('0x16')===method)throw arg;return doneResult();}for(context['method']=method,context[_0x22c1('0x17')]=arg;;){var delegate=context[_0x22c1('0x18')];if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}if('next'===context[_0x22c1('0x19')])context[_0x22c1('0x1a')]=context[_0x22c1('0x1b')]=context[_0x22c1('0x17')];else if(_0x22c1('0x16')===context[_0x22c1('0x19')]){if('suspendedStart'===state)throw state=_0x22c1('0x15'),context[_0x22c1('0x17')];context[_0x22c1('0x1c')](context[_0x22c1('0x17')]);}else _0x22c1('0x1d')===context[_0x22c1('0x19')]&&context['abrupt'](_0x22c1('0x1d'),context[_0x22c1('0x17')]);state='executing';var record=tryCatch(innerFn,self,context);if(_0x22c1('0x1e')===record[_0x22c1('0x1f')]){if(state=context['done']?_0x22c1('0x15'):'suspendedYield',record[_0x22c1('0x17')]===ContinueSentinel)continue;return{'value':record[_0x22c1('0x17')],'done':context[_0x22c1('0x6')]};}_0x22c1('0x16')===record[_0x22c1('0x1f')]&&(state=_0x22c1('0x15'),context[_0x22c1('0x19')]=_0x22c1('0x16'),context['arg']=record[_0x22c1('0x17')]);}};}(innerFn,self,context),generator;}function tryCatch(fn,obj,arg){try{return{'type':'normal','arg':fn[_0x22c1('0x2')](obj,arg)};}catch(_0xd57eab){return{'type':_0x22c1('0x16'),'arg':_0xd57eab};}}exports[_0x22c1('0x20')]=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this;});var getProto=Object[_0x22c1('0x21')],NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn['call'](NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype['prototype']=Generator['prototype']=Object[_0x22c1('0x13')](IteratorPrototype);function defineIteratorMethods(prototype){['next',_0x22c1('0x16'),_0x22c1('0x1d')][_0x22c1('0x22')](function(method){define(prototype,method,function(arg){return this[_0x22c1('0x14')](method,arg);});});}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if('throw'!==record[_0x22c1('0x1f')]){var result=record[_0x22c1('0x17')],value=result[_0x22c1('0x5')];return value&&'object'==_typeof(value)&&hasOwn['call'](value,_0x22c1('0x23'))?PromiseImpl[_0x22c1('0x24')](value[_0x22c1('0x23')])[_0x22c1('0x25')](function(value){invoke('next',value,resolve,reject);},function(err){invoke(_0x22c1('0x16'),err,resolve,reject);}):PromiseImpl[_0x22c1('0x24')](value)[_0x22c1('0x25')](function(unwrapped){result['value']=unwrapped,resolve(result);},function(error){return invoke(_0x22c1('0x16'),error,resolve,reject);});}reject(record[_0x22c1('0x17')]);}var previousPromise;this[_0x22c1('0x14')]=function(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject);});}return previousPromise=previousPromise?previousPromise[_0x22c1('0x25')](callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();};}function maybeInvokeDelegate(delegate,context){var method=delegate[_0x22c1('0xc')][context[_0x22c1('0x19')]];if(undefined===method){if(context['delegate']=null,_0x22c1('0x16')===context[_0x22c1('0x19')]){if(delegate['iterator'][_0x22c1('0x1d')]&&(context[_0x22c1('0x19')]='return',context['arg']=undefined,maybeInvokeDelegate(delegate,context),_0x22c1('0x16')===context[_0x22c1('0x19')]))return ContinueSentinel;context[_0x22c1('0x19')]='throw',context['arg']=new TypeError(_0x22c1('0x26'));}return ContinueSentinel;}var record=tryCatch(method,delegate[_0x22c1('0xc')],context[_0x22c1('0x17')]);if(_0x22c1('0x16')===record[_0x22c1('0x1f')])return context['method']=_0x22c1('0x16'),context[_0x22c1('0x17')]=record[_0x22c1('0x17')],context[_0x22c1('0x18')]=null,ContinueSentinel;var info=record[_0x22c1('0x17')];return info?info[_0x22c1('0x6')]?(context[delegate[_0x22c1('0x27')]]=info['value'],context['next']=delegate[_0x22c1('0x28')],'return'!==context[_0x22c1('0x19')]&&(context['method']=_0x22c1('0x29'),context[_0x22c1('0x17')]=undefined),context['delegate']=null,ContinueSentinel):info:(context[_0x22c1('0x19')]='throw',context[_0x22c1('0x17')]=new TypeError(_0x22c1('0x2a')),context['delegate']=null,ContinueSentinel);}function pushTryEntry(locs){var entry={'tryLoc':locs[0x0]};0x1 in locs&&(entry[_0x22c1('0x2b')]=locs[0x1]),0x2 in locs&&(entry[_0x22c1('0x2c')]=locs[0x2],entry[_0x22c1('0x2d')]=locs[0x3]),this['tryEntries'][_0x22c1('0x2e')](entry);}function resetTryEntry(entry){var record=entry[_0x22c1('0x2f')]||{};record[_0x22c1('0x1f')]='normal',delete record['arg'],entry['completion']=record;}function Context(tryLocsList){this['tryEntries']=[{'tryLoc':_0x22c1('0x30')}],tryLocsList['forEach'](pushTryEntry,this),this[_0x22c1('0x31')](!0x0);}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod[_0x22c1('0x2')](iterable);if(_0x22c1('0xa')==typeof iterable['next'])return iterable;if(!isNaN(iterable[_0x22c1('0x32')])){var i=-0x1,next=function next(){for(;++i<iterable[_0x22c1('0x32')];){if(hasOwn[_0x22c1('0x2')](iterable,i))return next[_0x22c1('0x5')]=iterable[i],next[_0x22c1('0x6')]=!0x1,next;}return next[_0x22c1('0x5')]=undefined,next['done']=!0x0,next;};return next[_0x22c1('0x29')]=next;}}return{'next':doneResult};}function doneResult(){return{'value':undefined,'done':!0x0};}return GeneratorFunction[_0x22c1('0x1')]=GeneratorFunctionPrototype,define(Gp,_0x22c1('0xd'),GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,'constructor',GeneratorFunction),GeneratorFunction[_0x22c1('0x33')]=define(GeneratorFunctionPrototype,toStringTagSymbol,'GeneratorFunction'),exports[_0x22c1('0x34')]=function(genFun){var ctor=_0x22c1('0xa')==typeof genFun&&genFun[_0x22c1('0xd')];return!!ctor&&(ctor===GeneratorFunction||_0x22c1('0x35')===(ctor[_0x22c1('0x33')]||ctor['name']));},exports['mark']=function(genFun){return Object[_0x22c1('0x36')]?Object[_0x22c1('0x36')](genFun,GeneratorFunctionPrototype):(genFun[_0x22c1('0x37')]=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,_0x22c1('0x35'))),genFun[_0x22c1('0x1')]=Object[_0x22c1('0x13')](Gp),genFun;},exports['awrap']=function(arg){return{'__await':arg};},defineIteratorMethods(AsyncIterator[_0x22c1('0x1')]),define(AsyncIterator['prototype'],asyncIteratorSymbol,function(){return this;}),exports[_0x22c1('0x38')]=AsyncIterator,exports[_0x22c1('0x39')]=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0x0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports[_0x22c1('0x34')](outerFn)?iter:iter[_0x22c1('0x29')]()['then'](function(result){return result[_0x22c1('0x6')]?result[_0x22c1('0x5')]:iter[_0x22c1('0x29')]();});},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,'Generator'),define(Gp,iteratorSymbol,function(){return this;}),define(Gp,'toString',function(){return _0x22c1('0x3a');}),exports[_0x22c1('0x3b')]=function(object){var keys=[];for(var key in object){keys['push'](key);}return keys['reverse'](),function next(){for(;keys['length'];){var key=keys[_0x22c1('0x3c')]();if(key in object)return next['value']=key,next[_0x22c1('0x6')]=!0x1,next;}return next[_0x22c1('0x6')]=!0x0,next;};},exports['values']=values,Context[_0x22c1('0x1')]={'constructor':Context,'reset':function reset(skipTempReset){if(this[_0x22c1('0x3d')]=0x0,this[_0x22c1('0x29')]=0x0,this[_0x22c1('0x1a')]=this[_0x22c1('0x1b')]=undefined,this['done']=!0x1,this[_0x22c1('0x18')]=null,this['method']=_0x22c1('0x29'),this[_0x22c1('0x17')]=undefined,this[_0x22c1('0x3e')]['forEach'](resetTryEntry),!skipTempReset)for(var name in this){'t'===name[_0x22c1('0x3f')](0x0)&&hasOwn[_0x22c1('0x2')](this,name)&&!isNaN(+name[_0x22c1('0x40')](0x1))&&(this[name]=undefined);}},'stop':function stop(){this['done']=!0x0;var rootRecord=this[_0x22c1('0x3e')][0x0][_0x22c1('0x2f')];if(_0x22c1('0x16')===rootRecord[_0x22c1('0x1f')])throw rootRecord['arg'];return this['rval'];},'dispatchException':function dispatchException(exception){if(this[_0x22c1('0x6')])throw exception;var context=this;function handle(loc,caught){return record[_0x22c1('0x1f')]='throw',record[_0x22c1('0x17')]=exception,context[_0x22c1('0x29')]=loc,caught&&(context[_0x22c1('0x19')]=_0x22c1('0x29'),context[_0x22c1('0x17')]=undefined),!!caught;}for(var i=this[_0x22c1('0x3e')][_0x22c1('0x32')]-0x1;i>=0x0;--i){var entry=this[_0x22c1('0x3e')][i],record=entry[_0x22c1('0x2f')];if('root'===entry[_0x22c1('0x41')])return handle(_0x22c1('0x42'));if(entry[_0x22c1('0x41')]<=this[_0x22c1('0x3d')]){var hasCatch=hasOwn[_0x22c1('0x2')](entry,_0x22c1('0x2b')),hasFinally=hasOwn[_0x22c1('0x2')](entry,_0x22c1('0x2c'));if(hasCatch&&hasFinally){if(this[_0x22c1('0x3d')]<entry['catchLoc'])return handle(entry['catchLoc'],!0x0);if(this[_0x22c1('0x3d')]<entry['finallyLoc'])return handle(entry['finallyLoc']);}else if(hasCatch){if(this[_0x22c1('0x3d')]<entry[_0x22c1('0x2b')])return handle(entry[_0x22c1('0x2b')],!0x0);}else{if(!hasFinally)throw new Error('try\x20statement\x20without\x20catch\x20or\x20finally');if(this['prev']<entry['finallyLoc'])return handle(entry[_0x22c1('0x2c')]);}}}},'abrupt':function abrupt(type,arg){for(var i=this[_0x22c1('0x3e')]['length']-0x1;i>=0x0;--i){var entry=this[_0x22c1('0x3e')][i];if(entry[_0x22c1('0x41')]<=this[_0x22c1('0x3d')]&&hasOwn[_0x22c1('0x2')](entry,_0x22c1('0x2c'))&&this[_0x22c1('0x3d')]<entry[_0x22c1('0x2c')]){var finallyEntry=entry;break;}}finallyEntry&&(_0x22c1('0x43')===type||_0x22c1('0x44')===type)&&finallyEntry[_0x22c1('0x41')]<=arg&&arg<=finallyEntry['finallyLoc']&&(finallyEntry=null);var record=finallyEntry?finallyEntry['completion']:{};return record[_0x22c1('0x1f')]=type,record['arg']=arg,finallyEntry?(this['method']=_0x22c1('0x29'),this[_0x22c1('0x29')]=finallyEntry[_0x22c1('0x2c')],ContinueSentinel):this[_0x22c1('0x45')](record);},'complete':function complete(record,afterLoc){if(_0x22c1('0x16')===record['type'])throw record[_0x22c1('0x17')];return _0x22c1('0x43')===record[_0x22c1('0x1f')]||_0x22c1('0x44')===record['type']?this[_0x22c1('0x29')]=record[_0x22c1('0x17')]:_0x22c1('0x1d')===record[_0x22c1('0x1f')]?(this['rval']=this['arg']=record[_0x22c1('0x17')],this[_0x22c1('0x19')]=_0x22c1('0x1d'),this[_0x22c1('0x29')]=_0x22c1('0x42')):_0x22c1('0x1e')===record[_0x22c1('0x1f')]&&afterLoc&&(this[_0x22c1('0x29')]=afterLoc),ContinueSentinel;},'finish':function finish(finallyLoc){for(var i=this[_0x22c1('0x3e')]['length']-0x1;i>=0x0;--i){var entry=this['tryEntries'][i];if(entry['finallyLoc']===finallyLoc)return this[_0x22c1('0x45')](entry['completion'],entry[_0x22c1('0x2d')]),resetTryEntry(entry),ContinueSentinel;}},'catch':function _catch(tryLoc){for(var i=this[_0x22c1('0x3e')][_0x22c1('0x32')]-0x1;i>=0x0;--i){var entry=this[_0x22c1('0x3e')][i];if(entry['tryLoc']===tryLoc){var record=entry[_0x22c1('0x2f')];if(_0x22c1('0x16')===record[_0x22c1('0x1f')]){var thrown=record[_0x22c1('0x17')];resetTryEntry(entry);}return thrown;}}throw new Error('illegal\x20catch\x20attempt');},'delegateYield':function delegateYield(iterable,resultName,nextLoc){return this['delegate']={'iterator':values(iterable),'resultName':resultName,'nextLoc':nextLoc},_0x22c1('0x29')===this[_0x22c1('0x19')]&&(this[_0x22c1('0x17')]=undefined),ContinueSentinel;}},exports;}module['exports']=_regeneratorRuntime,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')]['default']=module['exports'];});unwrapExports(regeneratorRuntime$1);var runtime=regeneratorRuntime$1();var regenerator=runtime;try{regeneratorRuntime=runtime;}catch(_0x2cb24f){if((typeof globalThis===_0x22c1('0x0')?_0x22c1('0x0'):_typeof(globalThis))===_0x22c1('0x46')){globalThis['regeneratorRuntime']=runtime;}else{Function('r',_0x22c1('0x47'))(runtime);}}function EventDispatcher(){}Object[_0x22c1('0x48')](EventDispatcher[_0x22c1('0x1')],{'addEventListener':function addEventListener(type,listener){if(this[_0x22c1('0x49')]===undefined)this['_listeners']={};var listeners=this[_0x22c1('0x49')];if(listeners[type]===undefined){listeners[type]=[];}if(listeners[type][_0x22c1('0x4a')](listener)===-0x1){listeners[type][_0x22c1('0x2e')](listener);}},'hasEventListener':function hasEventListener(type,listener){if(this[_0x22c1('0x49')]===undefined)return![];var listeners=this[_0x22c1('0x49')];return listeners[type]!==undefined&&listeners[type][_0x22c1('0x4a')](listener)!==-0x1;},'removeEventListener':function removeEventListener(type,listener){if(this[_0x22c1('0x49')]===undefined)return;var listeners=this[_0x22c1('0x49')];var listenerArray=listeners[type];if(listenerArray!==undefined){var index=listenerArray[_0x22c1('0x4a')](listener);if(index!==-0x1){listenerArray['splice'](index,0x1);}}},'dispatchEvent':function dispatchEvent(event){if(this[_0x22c1('0x49')]===undefined)return;var listeners=this[_0x22c1('0x49')];var listenerArray=listeners[event[_0x22c1('0x1f')]];if(listenerArray!==undefined){event['target']=this;var array=listenerArray[_0x22c1('0x40')](0x0);for(var i=0x0,l=array[_0x22c1('0x32')];i<l;i++){array[i][_0x22c1('0x2')](this,event);}}}});var classCallCheck=createCommonjsModule(function(module){function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(_0x22c1('0x4b'));}}module[_0x22c1('0x3')]=_classCallCheck,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module[_0x22c1('0x3')];});var _classCallCheck=unwrapExports(classCallCheck);var createClass=createCommonjsModule(function(module){function _defineProperties(target,props){for(var i=0x0;i<props[_0x22c1('0x32')];i++){var descriptor=props[i];descriptor[_0x22c1('0x4c')]=descriptor[_0x22c1('0x4c')]||![];descriptor[_0x22c1('0x4d')]=!![];if(_0x22c1('0x5')in descriptor)descriptor[_0x22c1('0x4e')]=!![];Object[_0x22c1('0x12')](target,descriptor[_0x22c1('0x4f')],descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor[_0x22c1('0x1')],protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object['defineProperty'](Constructor,_0x22c1('0x1'),{'writable':![]});return Constructor;}module['exports']=_createClass,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module[_0x22c1('0x3')];});var _createClass=unwrapExports(createClass);var _Math={'DEG2RAD':Math['PI']/0xb4,'RAD2DEG':0xb4/Math['PI'],'generateUUID':function(){var lut=[];for(var i=0x0;i<0x100;i++){lut[i]=(i<0x10?'0':'')+i[_0x22c1('0x50')](0x10);}return function generateUUID(){var d0=Math['random']()*0xffffffff|0x0;var d1=Math['random']()*0xffffffff|0x0;var d2=Math[_0x22c1('0x51')]()*0xffffffff|0x0;var d3=Math['random']()*0xffffffff|0x0;var uuid=lut[d0&0xff]+lut[d0>>0x8&0xff]+lut[d0>>0x10&0xff]+lut[d0>>0x18&0xff]+'-'+lut[d1&0xff]+lut[d1>>0x8&0xff]+'-'+lut[d1>>0x10&0xf|0x40]+lut[d1>>0x18&0xff]+'-'+lut[d2&0x3f|0x80]+lut[d2>>0x8&0xff]+'-'+lut[d2>>0x10&0xff]+lut[d2>>0x18&0xff]+lut[d3&0xff]+lut[d3>>0x8&0xff]+lut[d3>>0x10&0xff]+lut[d3>>0x18&0xff];return uuid[_0x22c1('0x52')]();};}(),'clamp':function clamp(value,min,max){return Math[_0x22c1('0x53')](min,Math[_0x22c1('0x54')](max,value));},'euclideanModulo':function euclideanModulo(n,m){return(n%m+m)%m;},'mapLinear':function mapLinear(x,a1,a2,b1,b2){return b1+(x-a1)*(b2-b1)/(a2-a1);},'lerp':function lerp(x,y,t){return(0x1-t)*x+t*y;},'smoothstep':function smoothstep(x,min,max){if(x<=min)return 0x0;if(x>=max)return 0x1;x=(x-min)/(max-min);return x*x*(0x3-0x2*x);},'smootherstep':function smootherstep(x,min,max){if(x<=min)return 0x0;if(x>=max)return 0x1;x=(x-min)/(max-min);return x*x*x*(x*(x*0x6-0xf)+0xa);},'randInt':function randInt(low,high){return low+Math[_0x22c1('0x55')](Math['random']()*(high-low+0x1));},'randFloat':function randFloat(low,high){return low+Math[_0x22c1('0x51')]()*(high-low);},'randFloatSpread':function randFloatSpread(range){return range*(0.5-Math[_0x22c1('0x51')]());},'degToRad':function degToRad(degrees){return degrees*_Math['DEG2RAD'];},'radToDeg':function radToDeg(radians){return radians*_Math[_0x22c1('0x56')];},'isPowerOfTwo':function isPowerOfTwo(value){return(value&value-0x1)===0x0&&value!==0x0;},'ceilPowerOfTwo':function ceilPowerOfTwo(value){return Math[_0x22c1('0x57')](0x2,Math[_0x22c1('0x58')](Math[_0x22c1('0x59')](value)/Math[_0x22c1('0x5a')]));},'floorPowerOfTwo':function floorPowerOfTwo(value){return Math[_0x22c1('0x57')](0x2,Math['floor'](Math[_0x22c1('0x59')](value)/Math[_0x22c1('0x5a')]));}};var Matrix4=function(){function Matrix4(){_classCallCheck(this,Matrix4);this[_0x22c1('0x5b')]=[0x1,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x0,0x1];this[_0x22c1('0x5c')]=!![];}_createClass(Matrix4,[{'key':'set','value':function set(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44){var te=this[_0x22c1('0x5b')];te[0x0]=n11;te[0x4]=n12;te[0x8]=n13;te[0xc]=n14;te[0x1]=n21;te[0x5]=n22;te[0x9]=n23;te[0xd]=n24;te[0x2]=n31;te[0x6]=n32;te[0xa]=n33;te[0xe]=n34;te[0x3]=n41;te[0x7]=n42;te[0xb]=n43;te[0xf]=n44;return this;}},{'key':_0x22c1('0x5d'),'value':function identity(){this[_0x22c1('0x5e')](0x1,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x0,0x1);return this;}},{'key':'clone','value':function clone(){return new Matrix4()['fromArray'](this[_0x22c1('0x5b')]);}},{'key':'copy','value':function copy(m){var te=this['elements'];var me=m[_0x22c1('0x5b')];te[0x0]=me[0x0];te[0x1]=me[0x1];te[0x2]=me[0x2];te[0x3]=me[0x3];te[0x4]=me[0x4];te[0x5]=me[0x5];te[0x6]=me[0x6];te[0x7]=me[0x7];te[0x8]=me[0x8];te[0x9]=me[0x9];te[0xa]=me[0xa];te[0xb]=me[0xb];te[0xc]=me[0xc];te[0xd]=me[0xd];te[0xe]=me[0xe];te[0xf]=me[0xf];return this;}},{'key':_0x22c1('0x5f'),'value':function copyPosition(m){var te=this[_0x22c1('0x5b')];var me=m[_0x22c1('0x5b')];te[0xc]=me[0xc];te[0xd]=me[0xd];te[0xe]=me[0xe];return this;}},{'key':_0x22c1('0x60'),'value':function extractBasis(xAxis,yAxis,zAxis){xAxis['setFromMatrixColumn'](this,0x0);yAxis[_0x22c1('0x61')](this,0x1);zAxis[_0x22c1('0x61')](this,0x2);return this;}},{'key':_0x22c1('0x62'),'value':function makeBasis(xAxis,yAxis,zAxis){this['set'](xAxis['x'],yAxis['x'],zAxis['x'],0x0,xAxis['y'],yAxis['y'],zAxis['y'],0x0,xAxis['z'],yAxis['z'],zAxis['z'],0x0,0x0,0x0,0x0,0x1);return this;}},{'key':_0x22c1('0x63'),'value':function extractRotation(m){var v1=new Vector3();var te=this['elements'];var me=m[_0x22c1('0x5b')];var scaleX=0x1/v1[_0x22c1('0x61')](m,0x0)[_0x22c1('0x32')]();var scaleY=0x1/v1['setFromMatrixColumn'](m,0x1)[_0x22c1('0x32')]();var scaleZ=0x1/v1[_0x22c1('0x61')](m,0x2)[_0x22c1('0x32')]();te[0x0]=me[0x0]*scaleX;te[0x1]=me[0x1]*scaleX;te[0x2]=me[0x2]*scaleX;te[0x3]=0x0;te[0x4]=me[0x4]*scaleY;te[0x5]=me[0x5]*scaleY;te[0x6]=me[0x6]*scaleY;te[0x7]=0x0;te[0x8]=me[0x8]*scaleZ;te[0x9]=me[0x9]*scaleZ;te[0xa]=me[0xa]*scaleZ;te[0xb]=0x0;te[0xc]=0x0;te[0xd]=0x0;te[0xe]=0x0;te[0xf]=0x1;return this;}},{'key':_0x22c1('0x64'),'value':function makeRotationFromQuaternion(q){var zero=new Vector3(0x0,0x0,0x0);var one=new Vector3(0x1,0x1,0x1);return this[_0x22c1('0x65')](zero,q,one);}},{'key':_0x22c1('0x66'),'value':function lookAt(eye,target,up){var x=new Vector3();var y=new Vector3();var z=new Vector3();var te=this[_0x22c1('0x5b')];z['subVectors'](eye,target);if(z[_0x22c1('0x67')]()===0x0){z['z']=0x1;}z['normalize']();x[_0x22c1('0x68')](up,z);if(x['lengthSq']()===0x0){if(Math[_0x22c1('0x69')](up['z'])===0x1){z['x']+=0.0001;}else{z['z']+=0.0001;}z['normalize']();x['crossVectors'](up,z);}x[_0x22c1('0x6a')]();y[_0x22c1('0x68')](z,x);te[0x0]=x['x'];te[0x4]=y['x'];te[0x8]=z['x'];te[0x1]=x['y'];te[0x5]=y['y'];te[0x9]=z['y'];te[0x2]=x['z'];te[0x6]=y['z'];te[0xa]=z['z'];return this;}},{'key':'multiply','value':function multiply(m,n){if(n!==undefined){console[_0x22c1('0x6b')](_0x22c1('0x6c'));return this[_0x22c1('0x6d')](m,n);}return this[_0x22c1('0x6d')](this,m);}},{'key':_0x22c1('0x6e'),'value':function premultiply(m){return this['multiplyMatrices'](m,this);}},{'key':_0x22c1('0x6d'),'value':function multiplyMatrices(a,b){var ae=a['elements'];var be=b[_0x22c1('0x5b')];var te=this[_0x22c1('0x5b')];var a11=ae[0x0];var a12=ae[0x4];var a13=ae[0x8];var a14=ae[0xc];var a21=ae[0x1];var a22=ae[0x5];var a23=ae[0x9];var a24=ae[0xd];var a31=ae[0x2];var a32=ae[0x6];var a33=ae[0xa];var a34=ae[0xe];var a41=ae[0x3];var a42=ae[0x7];var a43=ae[0xb];var a44=ae[0xf];var b11=be[0x0];var b12=be[0x4];var b13=be[0x8];var b14=be[0xc];var b21=be[0x1];var b22=be[0x5];var b23=be[0x9];var b24=be[0xd];var b31=be[0x2];var b32=be[0x6];var b33=be[0xa];var b34=be[0xe];var b41=be[0x3];var b42=be[0x7];var b43=be[0xb];var b44=be[0xf];te[0x0]=a11*b11+a12*b21+a13*b31+a14*b41;te[0x4]=a11*b12+a12*b22+a13*b32+a14*b42;te[0x8]=a11*b13+a12*b23+a13*b33+a14*b43;te[0xc]=a11*b14+a12*b24+a13*b34+a14*b44;te[0x1]=a21*b11+a22*b21+a23*b31+a24*b41;te[0x5]=a21*b12+a22*b22+a23*b32+a24*b42;te[0x9]=a21*b13+a22*b23+a23*b33+a24*b43;te[0xd]=a21*b14+a22*b24+a23*b34+a24*b44;te[0x2]=a31*b11+a32*b21+a33*b31+a34*b41;te[0x6]=a31*b12+a32*b22+a33*b32+a34*b42;te[0xa]=a31*b13+a32*b23+a33*b33+a34*b43;te[0xe]=a31*b14+a32*b24+a33*b34+a34*b44;te[0x3]=a41*b11+a42*b21+a43*b31+a44*b41;te[0x7]=a41*b12+a42*b22+a43*b32+a44*b42;te[0xb]=a41*b13+a42*b23+a43*b33+a44*b43;te[0xf]=a41*b14+a42*b24+a43*b34+a44*b44;return this;}},{'key':_0x22c1('0x6f'),'value':function multiplyScalar(s){var te=this[_0x22c1('0x5b')];te[0x0]*=s;te[0x4]*=s;te[0x8]*=s;te[0xc]*=s;te[0x1]*=s;te[0x5]*=s;te[0x9]*=s;te[0xd]*=s;te[0x2]*=s;te[0x6]*=s;te[0xa]*=s;te[0xe]*=s;te[0x3]*=s;te[0x7]*=s;te[0xb]*=s;te[0xf]*=s;return this;}},{'key':'applyToBufferAttribute','value':function applyToBufferAttribute(attribute){var v1=new Vector3();for(var i=0x0,l=attribute['count'];i<l;i++){v1['x']=attribute[_0x22c1('0x70')](i);v1['y']=attribute[_0x22c1('0x71')](i);v1['z']=attribute[_0x22c1('0x72')](i);v1['applyMatrix4'](this);attribute[_0x22c1('0x73')](i,v1['x'],v1['y'],v1['z']);}return attribute;}},{'key':'determinant','value':function determinant(){var te=this['elements'];var n11=te[0x0];var n12=te[0x4];var n13=te[0x8];var n14=te[0xc];var n21=te[0x1];var n22=te[0x5];var n23=te[0x9];var n24=te[0xd];var n31=te[0x2];var n32=te[0x6];var n33=te[0xa];var n34=te[0xe];var n41=te[0x3];var n42=te[0x7];var n43=te[0xb];var n44=te[0xf];return n41*(+n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34)+n42*(+n11*n23*n34-n11*n24*n33+n14*n21*n33-n13*n21*n34+n13*n24*n31-n14*n23*n31)+n43*(+n11*n24*n32-n11*n22*n34-n14*n21*n32+n12*n21*n34+n14*n22*n31-n12*n24*n31)+n44*(-n13*n22*n31-n11*n23*n32+n11*n22*n33+n13*n21*n32-n12*n21*n33+n12*n23*n31);}},{'key':_0x22c1('0x74'),'value':function transpose(){var te=this[_0x22c1('0x5b')];var tmp;tmp=te[0x1];te[0x1]=te[0x4];te[0x4]=tmp;tmp=te[0x2];te[0x2]=te[0x8];te[0x8]=tmp;tmp=te[0x6];te[0x6]=te[0x9];te[0x9]=tmp;tmp=te[0x3];te[0x3]=te[0xc];te[0xc]=tmp;tmp=te[0x7];te[0x7]=te[0xd];te[0xd]=tmp;tmp=te[0xb];te[0xb]=te[0xe];te[0xe]=tmp;return this;}},{'key':_0x22c1('0x75'),'value':function setPosition(v){var te=this[_0x22c1('0x5b')];te[0xc]=v['x'];te[0xd]=v['y'];te[0xe]=v['z'];return this;}},{'key':'getInverse','value':function getInverse(m,throwOnDegenerate){var te=this[_0x22c1('0x5b')];var me=m[_0x22c1('0x5b')];var n11=me[0x0];var n21=me[0x1];var n31=me[0x2];var n41=me[0x3];var n12=me[0x4];var n22=me[0x5];var n32=me[0x6];var n42=me[0x7];var n13=me[0x8];var n23=me[0x9];var n33=me[0xa];var n43=me[0xb];var n14=me[0xc];var n24=me[0xd];var n34=me[0xe];var n44=me[0xf];var t11=n23*n34*n42-n24*n33*n42+n24*n32*n43-n22*n34*n43-n23*n32*n44+n22*n33*n44;var t12=n14*n33*n42-n13*n34*n42-n14*n32*n43+n12*n34*n43+n13*n32*n44-n12*n33*n44;var t13=n13*n24*n42-n14*n23*n42+n14*n22*n43-n12*n24*n43-n13*n22*n44+n12*n23*n44;var t14=n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34;var det=n11*t11+n21*t12+n31*t13+n41*t14;if(det===0x0){var msg=_0x22c1('0x76');if(throwOnDegenerate===!![]){throw new Error(msg);}else{console[_0x22c1('0x6b')](msg);}return this['identity']();}var detInv=0x1/det;te[0x0]=t11*detInv;te[0x1]=(n24*n33*n41-n23*n34*n41-n24*n31*n43+n21*n34*n43+n23*n31*n44-n21*n33*n44)*detInv;te[0x2]=(n22*n34*n41-n24*n32*n41+n24*n31*n42-n21*n34*n42-n22*n31*n44+n21*n32*n44)*detInv;te[0x3]=(n23*n32*n41-n22*n33*n41-n23*n31*n42+n21*n33*n42+n22*n31*n43-n21*n32*n43)*detInv;te[0x4]=t12*detInv;te[0x5]=(n13*n34*n41-n14*n33*n41+n14*n31*n43-n11*n34*n43-n13*n31*n44+n11*n33*n44)*detInv;te[0x6]=(n14*n32*n41-n12*n34*n41-n14*n31*n42+n11*n34*n42+n12*n31*n44-n11*n32*n44)*detInv;te[0x7]=(n12*n33*n41-n13*n32*n41+n13*n31*n42-n11*n33*n42-n12*n31*n43+n11*n32*n43)*detInv;te[0x8]=t13*detInv;te[0x9]=(n14*n23*n41-n13*n24*n41-n14*n21*n43+n11*n24*n43+n13*n21*n44-n11*n23*n44)*detInv;te[0xa]=(n12*n24*n41-n14*n22*n41+n14*n21*n42-n11*n24*n42-n12*n21*n44+n11*n22*n44)*detInv;te[0xb]=(n13*n22*n41-n12*n23*n41-n13*n21*n42+n11*n23*n42+n12*n21*n43-n11*n22*n43)*detInv;te[0xc]=t14*detInv;te[0xd]=(n13*n24*n31-n14*n23*n31+n14*n21*n33-n11*n24*n33-n13*n21*n34+n11*n23*n34)*detInv;te[0xe]=(n14*n22*n31-n12*n24*n31-n14*n21*n32+n11*n24*n32+n12*n21*n34-n11*n22*n34)*detInv;te[0xf]=(n12*n23*n31-n13*n22*n31+n13*n21*n32-n11*n23*n32-n12*n21*n33+n11*n22*n33)*detInv;return this;}},{'key':_0x22c1('0x77'),'value':function scale(v){var te=this['elements'];var x=v['x'];var y=v['y'];var z=v['z'];te[0x0]*=x;te[0x4]*=y;te[0x8]*=z;te[0x1]*=x;te[0x5]*=y;te[0x9]*=z;te[0x2]*=x;te[0x6]*=y;te[0xa]*=z;te[0x3]*=x;te[0x7]*=y;te[0xb]*=z;return this;}},{'key':_0x22c1('0x78'),'value':function getMaxScaleOnAxis(){var te=this[_0x22c1('0x5b')];var scaleXSq=te[0x0]*te[0x0]+te[0x1]*te[0x1]+te[0x2]*te[0x2];var scaleYSq=te[0x4]*te[0x4]+te[0x5]*te[0x5]+te[0x6]*te[0x6];var scaleZSq=te[0x8]*te[0x8]+te[0x9]*te[0x9]+te[0xa]*te[0xa];return Math['sqrt'](Math[_0x22c1('0x53')](scaleXSq,scaleYSq,scaleZSq));}},{'key':_0x22c1('0x79'),'value':function makeTranslation(x,y,z){this['set'](0x1,0x0,0x0,x,0x0,0x1,0x0,y,0x0,0x0,0x1,z,0x0,0x0,0x0,0x1);return this;}},{'key':_0x22c1('0x7a'),'value':function makeRotationX(theta){var c=Math[_0x22c1('0x7b')](theta);var s=Math[_0x22c1('0x7c')](theta);this[_0x22c1('0x5e')](0x1,0x0,0x0,0x0,0x0,c,-s,0x0,0x0,s,c,0x0,0x0,0x0,0x0,0x1);return this;}},{'key':'makeRotationY','value':function makeRotationY(theta){var c=Math[_0x22c1('0x7b')](theta);var s=Math[_0x22c1('0x7c')](theta);this[_0x22c1('0x5e')](c,0x0,s,0x0,0x0,0x1,0x0,0x0,-s,0x0,c,0x0,0x0,0x0,0x0,0x1);return this;}},{'key':_0x22c1('0x7d'),'value':function makeRotationZ(theta){var c=Math['cos'](theta);var s=Math[_0x22c1('0x7c')](theta);this[_0x22c1('0x5e')](c,-s,0x0,0x0,s,c,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x0,0x1);return this;}},{'key':_0x22c1('0x7e'),'value':function makeRotationAxis(axis,angle){var c=Math['cos'](angle);var s=Math[_0x22c1('0x7c')](angle);var t=0x1-c;var x=axis['x'];var y=axis['y'];var z=axis['z'];var tx=t*x;var ty=t*y;this[_0x22c1('0x5e')](tx*x+c,tx*y-s*z,tx*z+s*y,0x0,tx*y+s*z,ty*y+c,ty*z-s*x,0x0,tx*z-s*y,ty*z+s*x,t*z*z+c,0x0,0x0,0x0,0x0,0x1);return this;}},{'key':_0x22c1('0x7f'),'value':function makeScale(x,y,z){this[_0x22c1('0x5e')](x,0x0,0x0,0x0,0x0,y,0x0,0x0,0x0,0x0,z,0x0,0x0,0x0,0x0,0x1);return this;}},{'key':'makeShear','value':function makeShear(x,y,z){this['set'](0x1,y,z,0x0,x,0x1,z,0x0,x,y,0x1,0x0,0x0,0x0,0x0,0x1);return this;}},{'key':_0x22c1('0x65'),'value':function compose(position,quaternion,scale){var te=this[_0x22c1('0x5b')];var x=quaternion['_x'];var y=quaternion['_y'];var z=quaternion['_z'];var w=quaternion['_w'];var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var xy=x*y2;var xz=x*z2;var yy=y*y2;var yz=y*z2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;var sx=scale['x'];var sy=scale['y'];var sz=scale['z'];te[0x0]=(0x1-(yy+zz))*sx;te[0x1]=(xy+wz)*sx;te[0x2]=(xz-wy)*sx;te[0x3]=0x0;te[0x4]=(xy-wz)*sy;te[0x5]=(0x1-(xx+zz))*sy;te[0x6]=(yz+wx)*sy;te[0x7]=0x0;te[0x8]=(xz+wy)*sz;te[0x9]=(yz-wx)*sz;te[0xa]=(0x1-(xx+yy))*sz;te[0xb]=0x0;te[0xc]=position['x'];te[0xd]=position['y'];te[0xe]=position['z'];te[0xf]=0x1;return this;}},{'key':_0x22c1('0x80'),'value':function decompose(position,quaternion,scale){var vector=new Vector3();var matrix=new Matrix4();var te=this['elements'];var sx=vector[_0x22c1('0x5e')](te[0x0],te[0x1],te[0x2])[_0x22c1('0x32')]();var sy=vector[_0x22c1('0x5e')](te[0x4],te[0x5],te[0x6])[_0x22c1('0x32')]();var sz=vector[_0x22c1('0x5e')](te[0x8],te[0x9],te[0xa])[_0x22c1('0x32')]();var det=this[_0x22c1('0x81')]();if(det<0x0)sx=-sx;position['x']=te[0xc];position['y']=te[0xd];position['z']=te[0xe];matrix[_0x22c1('0x82')](this);var invSX=0x1/sx;var invSY=0x1/sy;var invSZ=0x1/sz;matrix[_0x22c1('0x5b')][0x0]*=invSX;matrix['elements'][0x1]*=invSX;matrix[_0x22c1('0x5b')][0x2]*=invSX;matrix['elements'][0x4]*=invSY;matrix[_0x22c1('0x5b')][0x5]*=invSY;matrix[_0x22c1('0x5b')][0x6]*=invSY;matrix[_0x22c1('0x5b')][0x8]*=invSZ;matrix[_0x22c1('0x5b')][0x9]*=invSZ;matrix[_0x22c1('0x5b')][0xa]*=invSZ;quaternion[_0x22c1('0x83')](matrix);scale['x']=sx;scale['y']=sy;scale['z']=sz;return this;}},{'key':_0x22c1('0x84'),'value':function makePerspective(left,right,top,bottom,near,far){if(far===undefined){console[_0x22c1('0x6b')]('THREE.Matrix4:\x20.makePerspective()\x20has\x20been\x20redefined\x20and\x20has\x20a\x20new\x20signature.\x20Please\x20check\x20the\x20docs.');}var te=this['elements'];var x=0x2*near/(right-left);var y=0x2*near/(top-bottom);var a=(right+left)/(right-left);var b=(top+bottom)/(top-bottom);var c=-(far+near)/(far-near);var d=-0x2*far*near/(far-near);te[0x0]=x;te[0x4]=0x0;te[0x8]=a;te[0xc]=0x0;te[0x1]=0x0;te[0x5]=y;te[0x9]=b;te[0xd]=0x0;te[0x2]=0x0;te[0x6]=0x0;te[0xa]=c;te[0xe]=d;te[0x3]=0x0;te[0x7]=0x0;te[0xb]=-0x1;te[0xf]=0x0;return this;}},{'key':'makeOrthographic','value':function makeOrthographic(left,right,top,bottom,near,far){var te=this[_0x22c1('0x5b')];var w=0x1/(right-left);var h=0x1/(top-bottom);var p=0x1/(far-near);var x=(right+left)*w;var y=(top+bottom)*h;var z=(far+near)*p;te[0x0]=0x2*w;te[0x4]=0x0;te[0x8]=0x0;te[0xc]=-x;te[0x1]=0x0;te[0x5]=0x2*h;te[0x9]=0x0;te[0xd]=-y;te[0x2]=0x0;te[0x6]=0x0;te[0xa]=-0x2*p;te[0xe]=-z;te[0x3]=0x0;te[0x7]=0x0;te[0xb]=0x0;te[0xf]=0x1;return this;}},{'key':_0x22c1('0x85'),'value':function equals(matrix){var te=this[_0x22c1('0x5b')];var me=matrix[_0x22c1('0x5b')];for(var i=0x0;i<0x10;i++){if(te[i]!==me[i])return![];}return!![];}},{'key':'fromArray','value':function fromArray(array,offset){if(offset===undefined)offset=0x0;for(var i=0x0;i<0x10;i++){this[_0x22c1('0x5b')][i]=array[i+offset];}return this;}},{'key':_0x22c1('0x86'),'value':function toArray(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0x0;var te=this[_0x22c1('0x5b')];array[offset]=te[0x0];array[offset+0x1]=te[0x1];array[offset+0x2]=te[0x2];array[offset+0x3]=te[0x3];array[offset+0x4]=te[0x4];array[offset+0x5]=te[0x5];array[offset+0x6]=te[0x6];array[offset+0x7]=te[0x7];array[offset+0x8]=te[0x8];array[offset+0x9]=te[0x9];array[offset+0xa]=te[0xa];array[offset+0xb]=te[0xb];array[offset+0xc]=te[0xc];array[offset+0xd]=te[0xd];array[offset+0xe]=te[0xe];array[offset+0xf]=te[0xf];return array;}}]);return Matrix4;}();var Quaternion=function(){function Quaternion(x,y,z,w){_classCallCheck(this,Quaternion);this['_x']=x||0x0;this['_y']=y||0x0;this['_z']=z||0x0;this['_w']=w!==undefined?w:0x1;this[_0x22c1('0x87')]=!![];}_createClass(Quaternion,[{'key':_0x22c1('0x88'),'value':function slerpFlat(dst,dstOffset,src0,srcOffset0,src1,srcOffset1,t){var x0=src0[srcOffset0+0x0];var y0=src0[srcOffset0+0x1];var z0=src0[srcOffset0+0x2];var w0=src0[srcOffset0+0x3];var x1=src1[srcOffset1+0x0];var y1=src1[srcOffset1+0x1];var z1=src1[srcOffset1+0x2];var w1=src1[srcOffset1+0x3];if(w0!==w1||x0!==x1||y0!==y1||z0!==z1){var s=0x1-t;var cos=x0*x1+y0*y1+z0*z1+w0*w1;var dir=cos>=0x0?0x1:-0x1;var sqrSin=0x1-cos*cos;if(sqrSin>Number[_0x22c1('0x89')]){var sin=Math[_0x22c1('0x8a')](sqrSin);var len=Math[_0x22c1('0x8b')](sin,cos*dir);s=Math[_0x22c1('0x7c')](s*len)/sin;t=Math[_0x22c1('0x7c')](t*len)/sin;}var tDir=t*dir;x0=x0*s+x1*tDir;y0=y0*s+y1*tDir;z0=z0*s+z1*tDir;w0=w0*s+w1*tDir;if(s===0x1-t){var f=0x1/Math[_0x22c1('0x8a')](x0*x0+y0*y0+z0*z0+w0*w0);x0*=f;y0*=f;z0*=f;w0*=f;}}dst[dstOffset]=x0;dst[dstOffset+0x1]=y0;dst[dstOffset+0x2]=z0;dst[dstOffset+0x3]=w0;}},{'key':'set','value':function set(x,y,z,w){this['_x']=x;this['_y']=y;this['_z']=z;this['_w']=w;this[_0x22c1('0x8c')]();return this;}},{'key':_0x22c1('0x8d'),'value':function clone(){return new this[(_0x22c1('0xd'))](this['_x'],this['_y'],this['_z'],this['_w']);}},{'key':_0x22c1('0x82'),'value':function copy(quaternion){this['_x']=quaternion['x'];this['_y']=quaternion['y'];this['_z']=quaternion['z'];this['_w']=quaternion['w'];this[_0x22c1('0x8c')]();return this;}},{'key':_0x22c1('0x8e'),'value':function setFromEuler(euler,update){if(!(euler&&euler[_0x22c1('0x8f')])){throw new Error(_0x22c1('0x90'));}var x=euler['_x'];var y=euler['_y'];var z=euler['_z'];var order=euler['order'];var cos=Math[_0x22c1('0x7b')];var sin=Math['sin'];var c1=cos(x/0x2);var c2=cos(y/0x2);var c3=cos(z/0x2);var s1=sin(x/0x2);var s2=sin(y/0x2);var s3=sin(z/0x2);if(order==='XYZ'){this['_x']=s1*c2*c3+c1*s2*s3;this['_y']=c1*s2*c3-s1*c2*s3;this['_z']=c1*c2*s3+s1*s2*c3;this['_w']=c1*c2*c3-s1*s2*s3;}else if(order===_0x22c1('0x91')){this['_x']=s1*c2*c3+c1*s2*s3;this['_y']=c1*s2*c3-s1*c2*s3;this['_z']=c1*c2*s3-s1*s2*c3;this['_w']=c1*c2*c3+s1*s2*s3;}else if(order===_0x22c1('0x92')){this['_x']=s1*c2*c3-c1*s2*s3;this['_y']=c1*s2*c3+s1*c2*s3;this['_z']=c1*c2*s3+s1*s2*c3;this['_w']=c1*c2*c3-s1*s2*s3;}else if(order===_0x22c1('0x93')){this['_x']=s1*c2*c3-c1*s2*s3;this['_y']=c1*s2*c3+s1*c2*s3;this['_z']=c1*c2*s3-s1*s2*c3;this['_w']=c1*c2*c3+s1*s2*s3;}else if(order===_0x22c1('0x94')){this['_x']=s1*c2*c3+c1*s2*s3;this['_y']=c1*s2*c3+s1*c2*s3;this['_z']=c1*c2*s3-s1*s2*c3;this['_w']=c1*c2*c3-s1*s2*s3;}else if(order==='XZY'){this['_x']=s1*c2*c3-c1*s2*s3;this['_y']=c1*s2*c3-s1*c2*s3;this['_z']=c1*c2*s3+s1*s2*c3;this['_w']=c1*c2*c3+s1*s2*s3;}if(update!==![])this[_0x22c1('0x8c')]();return this;}},{'key':'setFromAxisAngle','value':function setFromAxisAngle(axis,angle){var halfAngle=angle/0x2;var s=Math[_0x22c1('0x7c')](halfAngle);this['_x']=axis['x']*s;this['_y']=axis['y']*s;this['_z']=axis['z']*s;this['_w']=Math[_0x22c1('0x7b')](halfAngle);this[_0x22c1('0x8c')]();return this;}},{'key':'setFromRotationMatrix','value':function setFromRotationMatrix(m){var te=m['elements'];var m11=te[0x0];var m12=te[0x4];var m13=te[0x8];var m21=te[0x1];var m22=te[0x5];var m23=te[0x9];var m31=te[0x2];var m32=te[0x6];var m33=te[0xa];var trace=m11+m22+m33;var s;if(trace>0x0){s=0.5/Math[_0x22c1('0x8a')](trace+0x1);this['_w']=0.25/s;this['_x']=(m32-m23)*s;this['_y']=(m13-m31)*s;this['_z']=(m21-m12)*s;}else if(m11>m22&&m11>m33){s=0x2*Math[_0x22c1('0x8a')](0x1+m11-m22-m33);this['_w']=(m32-m23)/s;this['_x']=0.25*s;this['_y']=(m12+m21)/s;this['_z']=(m13+m31)/s;}else if(m22>m33){s=0x2*Math[_0x22c1('0x8a')](0x1+m22-m11-m33);this['_w']=(m13-m31)/s;this['_x']=(m12+m21)/s;this['_y']=0.25*s;this['_z']=(m23+m32)/s;}else{s=0x2*Math[_0x22c1('0x8a')](0x1+m33-m11-m22);this['_w']=(m21-m12)/s;this['_x']=(m13+m31)/s;this['_y']=(m23+m32)/s;this['_z']=0.25*s;}this[_0x22c1('0x8c')]();return this;}},{'key':_0x22c1('0x95'),'value':function setFromUnitVectors(vFrom,vTo){var v1=new Vector3();var r;var EPS=0.000001;if(v1===undefined)v1=new Vector3();r=vFrom['dot'](vTo)+0x1;if(r<EPS){r=0x0;if(Math[_0x22c1('0x69')](vFrom['x'])>Math[_0x22c1('0x69')](vFrom['z'])){v1[_0x22c1('0x5e')](-vFrom['y'],vFrom['x'],0x0);}else{v1['set'](0x0,-vFrom['z'],vFrom['y']);}}else{v1[_0x22c1('0x68')](vFrom,vTo);}this['_x']=v1['x'];this['_y']=v1['y'];this['_z']=v1['z'];this['_w']=r;return this['normalize']();}},{'key':_0x22c1('0x96'),'value':function angleTo(q){return 0x2*Math[_0x22c1('0x97')](Math[_0x22c1('0x69')](_Math[_0x22c1('0x98')](this['dot'](q),-0x1,0x1)));}},{'key':'rotateTowards','value':function rotateTowards(q,step){var angle=this['angleTo'](q);if(angle===0x0)return this;var t=Math[_0x22c1('0x54')](0x1,step/angle);this[_0x22c1('0x99')](q,t);return this;}},{'key':_0x22c1('0x9a'),'value':function inverse(){return this[_0x22c1('0x9b')]();}},{'key':'conjugate','value':function conjugate(){this['_x']*=-0x1;this['_y']*=-0x1;this['_z']*=-0x1;this['onChangeCallback']();return this;}},{'key':_0x22c1('0x9c'),'value':function dot(v){return this['_x']*v['_x']+this['_y']*v['_y']+this['_z']*v['_z']+this['_w']*v['_w'];}},{'key':_0x22c1('0x67'),'value':function lengthSq(){return this['_x']*this['_x']+this['_y']*this['_y']+this['_z']*this['_z']+this['_w']*this['_w'];}},{'key':'length','value':function length(){return Math[_0x22c1('0x8a')](this['_x']*this['_x']+this['_y']*this['_y']+this['_z']*this['_z']+this['_w']*this['_w']);}},{'key':_0x22c1('0x6a'),'value':function normalize(){var l=this[_0x22c1('0x32')]();if(l===0x0){this['_x']=0x0;this['_y']=0x0;this['_z']=0x0;this['_w']=0x1;}else{l=0x1/l;this['_x']=this['_x']*l;this['_y']=this['_y']*l;this['_z']=this['_z']*l;this['_w']=this['_w']*l;}this[_0x22c1('0x8c')]();return this;}},{'key':_0x22c1('0x9d'),'value':function multiply(q,p){if(p!==undefined){console[_0x22c1('0x6b')](_0x22c1('0x9e'));return this['multiplyQuaternions'](q,p);}return this[_0x22c1('0x9f')](this,q);}},{'key':_0x22c1('0x6e'),'value':function premultiply(q){return this['multiplyQuaternions'](q,this);}},{'key':_0x22c1('0x9f'),'value':function multiplyQuaternions(a,b){var qax=a['_x'];var qay=a['_y'];var qaz=a['_z'];var qaw=a['_w'];var qbx=b['_x'];var qby=b['_y'];var qbz=b['_z'];var qbw=b['_w'];this['_x']=qax*qbw+qaw*qbx+qay*qbz-qaz*qby;this['_y']=qay*qbw+qaw*qby+qaz*qbx-qax*qbz;this['_z']=qaz*qbw+qaw*qbz+qax*qby-qay*qbx;this['_w']=qaw*qbw-qax*qbx-qay*qby-qaz*qbz;this[_0x22c1('0x8c')]();return this;}},{'key':_0x22c1('0x99'),'value':function slerp(qb,t){if(t===0x0)return this;if(t===0x1)return this[_0x22c1('0x82')](qb);var x=this['_x'];var y=this['_y'];var z=this['_z'];var w=this['_w'];var cosHalfTheta=w*qb['_w']+x*qb['_x']+y*qb['_y']+z*qb['_z'];if(cosHalfTheta<0x0){this['_w']=-qb['_w'];this['_x']=-qb['_x'];this['_y']=-qb['_y'];this['_z']=-qb['_z'];cosHalfTheta=-cosHalfTheta;}else{this[_0x22c1('0x82')](qb);}if(cosHalfTheta>=0x1){this['_w']=w;this['_x']=x;this['_y']=y;this['_z']=z;return this;}var sqrSinHalfTheta=0x1-cosHalfTheta*cosHalfTheta;if(sqrSinHalfTheta<=Number['EPSILON']){var s=0x1-t;this['_w']=s*w+t*this['_w'];this['_x']=s*x+t*this['_x'];this['_y']=s*y+t*this['_y'];this['_z']=s*z+t*this['_z'];return this[_0x22c1('0x6a')]();}var sinHalfTheta=Math[_0x22c1('0x8a')](sqrSinHalfTheta);var halfTheta=Math['atan2'](sinHalfTheta,cosHalfTheta);var ratioA=Math[_0x22c1('0x7c')]((0x1-t)*halfTheta)/sinHalfTheta;var ratioB=Math[_0x22c1('0x7c')](t*halfTheta)/sinHalfTheta;this['_w']=w*ratioA+this['_w']*ratioB;this['_x']=x*ratioA+this['_x']*ratioB;this['_y']=y*ratioA+this['_y']*ratioB;this['_z']=z*ratioA+this['_z']*ratioB;this[_0x22c1('0x8c')]();return this;}},{'key':_0x22c1('0x85'),'value':function equals(quaternion){return quaternion['_x']===this['_x']&&quaternion['_y']===this['_y']&&quaternion['_z']===this['_z']&&quaternion['_w']===this['_w'];}},{'key':_0x22c1('0xa0'),'value':function fromArray(array,offset){if(offset===undefined)offset=0x0;this['_x']=array[offset];this['_y']=array[offset+0x1];this['_z']=array[offset+0x2];this['_w']=array[offset+0x3];this[_0x22c1('0x8c')]();return this;}},{'key':_0x22c1('0x86'),'value':function toArray(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0x0;array[offset]=this['_x'];array[offset+0x1]=this['_y'];array[offset+0x2]=this['_z'];array[offset+0x3]=this['_w'];return array;}},{'key':_0x22c1('0xa1'),'value':function onChange(callback){this[_0x22c1('0x8c')]=callback;return this;}},{'key':_0x22c1('0x8c'),'value':function onChangeCallback(){}}]);return Quaternion;}();Object['defineProperties'](Quaternion[_0x22c1('0x1')],{'x':{'get':function get(){return this['_x'];},'set':function set(value){this['_x']=value;this[_0x22c1('0x8c')]();}},'y':{'get':function get(){return this['_y'];},'set':function set(value){this['_y']=value;this[_0x22c1('0x8c')]();}},'z':{'get':function get(){return this['_z'];},'set':function set(value){this['_z']=value;this[_0x22c1('0x8c')]();}},'w':{'get':function get(){return this['_w'];},'set':function set(value){this['_w']=value;this['onChangeCallback']();}}});var Vector3=function(){function Vector3(x,y,z){_classCallCheck(this,Vector3);this['x']=x||0x0;this['y']=y||0x0;this['z']=z||0x0;this[_0x22c1('0xa2')]=!![];}_createClass(Vector3,[{'key':'set','value':function set(x,y,z){this['x']=x;this['y']=y;this['z']=z;return this;}},{'key':_0x22c1('0xa3'),'value':function setScalar(scalar){this['x']=scalar;this['y']=scalar;this['z']=scalar;return this;}},{'key':'setX','value':function setX(x){this['x']=x;return this;}},{'key':'setY','value':function setY(y){this['y']=y;return this;}},{'key':'setZ','value':function setZ(z){this['z']=z;return this;}},{'key':_0x22c1('0xa4'),'value':function setComponent(index,value){switch(index){case 0x0:this['x']=value;break;case 0x1:this['y']=value;break;case 0x2:this['z']=value;break;default:throw new Error(_0x22c1('0xa5')+index);}return this;}},{'key':_0x22c1('0xa6'),'value':function getComponent(index){switch(index){case 0x0:return this['x'];case 0x1:return this['y'];case 0x2:return this['z'];default:throw new Error(_0x22c1('0xa5')+index);}}},{'key':_0x22c1('0x8d'),'value':function clone(){return new this['constructor'](this['x'],this['y'],this['z']);}},{'key':_0x22c1('0x82'),'value':function copy(v){this['x']=v['x'];this['y']=v['y'];this['z']=v['z'];return this;}},{'key':'add','value':function add(v,w){if(w!==undefined){console['warn'](_0x22c1('0xa7'));return this[_0x22c1('0xa8')](v,w);}this['x']+=v['x'];this['y']+=v['y'];this['z']+=v['z'];return this;}},{'key':_0x22c1('0xa9'),'value':function addScalar(s){this['x']+=s;this['y']+=s;this['z']+=s;return this;}},{'key':_0x22c1('0xa8'),'value':function addVectors(a,b){this['x']=a['x']+b['x'];this['y']=a['y']+b['y'];this['z']=a['z']+b['z'];return this;}},{'key':_0x22c1('0xaa'),'value':function addScaledVector(v,s){this['x']+=v['x']*s;this['y']+=v['y']*s;this['z']+=v['z']*s;return this;}},{'key':_0x22c1('0xab'),'value':function sub(v,w){if(w!==undefined){console['warn']('THREE.Vector3:\x20.sub()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.subVectors(\x20a,\x20b\x20)\x20instead.');return this['subVectors'](v,w);}this['x']-=v['x'];this['y']-=v['y'];this['z']-=v['z'];return this;}},{'key':_0x22c1('0xac'),'value':function subScalar(s){this['x']-=s;this['y']-=s;this['z']-=s;return this;}},{'key':_0x22c1('0xad'),'value':function subVectors(a,b){this['x']=a['x']-b['x'];this['y']=a['y']-b['y'];this['z']=a['z']-b['z'];return this;}},{'key':_0x22c1('0x9d'),'value':function multiply(v,w){if(w!==undefined){console['warn']('THREE.Vector3:\x20.multiply()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.multiplyVectors(\x20a,\x20b\x20)\x20instead.');return this[_0x22c1('0xae')](v,w);}this['x']*=v['x'];this['y']*=v['y'];this['z']*=v['z'];return this;}},{'key':'multiplyScalar','value':function multiplyScalar(scalar){this['x']*=scalar;this['y']*=scalar;this['z']*=scalar;return this;}},{'key':_0x22c1('0xae'),'value':function multiplyVectors(a,b){this['x']=a['x']*b['x'];this['y']=a['y']*b['y'];this['z']=a['z']*b['z'];return this;}},{'key':_0x22c1('0xaf'),'value':function applyEuler(euler){if(!(euler&&euler[_0x22c1('0x8f')])){console[_0x22c1('0xb0')](_0x22c1('0xb1'));}var quaternion=new Quaternion();return this[_0x22c1('0xb2')](quaternion['setFromEuler'](euler));}},{'key':_0x22c1('0xb3'),'value':function applyAxisAngle(axis,angle){var quaternion=new Quaternion();return this[_0x22c1('0xb2')](quaternion[_0x22c1('0xb4')](axis,angle));}},{'key':'applyMatrix3','value':function applyMatrix3(m){var x=this['x'];var y=this['y'];var z=this['z'];var e=m[_0x22c1('0x5b')];this['x']=e[0x0]*x+e[0x3]*y+e[0x6]*z;this['y']=e[0x1]*x+e[0x4]*y+e[0x7]*z;this['z']=e[0x2]*x+e[0x5]*y+e[0x8]*z;return this;}},{'key':'applyMatrix4','value':function applyMatrix4(m){var x=this['x'];var y=this['y'];var z=this['z'];var e=m[_0x22c1('0x5b')];var w=0x1/(e[0x3]*x+e[0x7]*y+e[0xb]*z+e[0xf]);this['x']=(e[0x0]*x+e[0x4]*y+e[0x8]*z+e[0xc])*w;this['y']=(e[0x1]*x+e[0x5]*y+e[0x9]*z+e[0xd])*w;this['z']=(e[0x2]*x+e[0x6]*y+e[0xa]*z+e[0xe])*w;return this;}},{'key':_0x22c1('0xb2'),'value':function applyQuaternion(q){var x=this['x'];var y=this['y'];var z=this['z'];var qx=q['x'];var qy=q['y'];var qz=q['z'];var qw=q['w'];var ix=qw*x+qy*z-qz*y;var iy=qw*y+qz*x-qx*z;var iz=qw*z+qx*y-qy*x;var iw=-qx*x-qy*y-qz*z;this['x']=ix*qw+iw*-qx+iy*-qz-iz*-qy;this['y']=iy*qw+iw*-qy+iz*-qx-ix*-qz;this['z']=iz*qw+iw*-qz+ix*-qy-iy*-qx;return this;}},{'key':_0x22c1('0xb5'),'value':function project(camera){return this['applyMatrix4'](camera[_0x22c1('0xb6')])[_0x22c1('0xb7')](camera[_0x22c1('0xb8')]);}},{'key':_0x22c1('0xb9'),'value':function unproject(camera){var matrix=new Matrix4();return this[_0x22c1('0xb7')](matrix[_0x22c1('0xba')](camera[_0x22c1('0xb8')]))[_0x22c1('0xb7')](camera[_0x22c1('0xbb')]);}},{'key':_0x22c1('0xbc'),'value':function transformDirection(m){var x=this['x'];var y=this['y'];var z=this['z'];var e=m[_0x22c1('0x5b')];this['x']=e[0x0]*x+e[0x4]*y+e[0x8]*z;this['y']=e[0x1]*x+e[0x5]*y+e[0x9]*z;this['z']=e[0x2]*x+e[0x6]*y+e[0xa]*z;return this[_0x22c1('0x6a')]();}},{'key':_0x22c1('0xbd'),'value':function divide(v){this['x']/=v['x'];this['y']/=v['y'];this['z']/=v['z'];return this;}},{'key':'divideScalar','value':function divideScalar(scalar){return this[_0x22c1('0x6f')](0x1/scalar);}},{'key':_0x22c1('0x54'),'value':function min(v){this['x']=Math[_0x22c1('0x54')](this['x'],v['x']);this['y']=Math[_0x22c1('0x54')](this['y'],v['y']);this['z']=Math[_0x22c1('0x54')](this['z'],v['z']);return this;}},{'key':_0x22c1('0x53'),'value':function max(v){this['x']=Math[_0x22c1('0x53')](this['x'],v['x']);this['y']=Math[_0x22c1('0x53')](this['y'],v['y']);this['z']=Math['max'](this['z'],v['z']);return this;}},{'key':_0x22c1('0x98'),'value':function clamp(min,max){this['x']=Math['max'](min['x'],Math[_0x22c1('0x54')](max['x'],this['x']));this['y']=Math['max'](min['y'],Math[_0x22c1('0x54')](max['y'],this['y']));this['z']=Math[_0x22c1('0x53')](min['z'],Math[_0x22c1('0x54')](max['z'],this['z']));return this;}},{'key':_0x22c1('0xbe'),'value':function clampScalar(minVal,maxVal){var min=new Vector3();var max=new Vector3();min[_0x22c1('0x5e')](minVal,minVal,minVal);max[_0x22c1('0x5e')](maxVal,maxVal,maxVal);return this[_0x22c1('0x98')](min,max);}},{'key':_0x22c1('0xbf'),'value':function clampLength(min,max){var length=this[_0x22c1('0x32')]();return this['divideScalar'](length||0x1)['multiplyScalar'](Math[_0x22c1('0x53')](min,Math['min'](max,length)));}},{'key':_0x22c1('0x55'),'value':function floor(){this['x']=Math['floor'](this['x']);this['y']=Math[_0x22c1('0x55')](this['y']);this['z']=Math[_0x22c1('0x55')](this['z']);return this;}},{'key':'ceil','value':function ceil(){this['x']=Math[_0x22c1('0x58')](this['x']);this['y']=Math['ceil'](this['y']);this['z']=Math[_0x22c1('0x58')](this['z']);return this;}},{'key':'round','value':function round(){this['x']=Math[_0x22c1('0xc0')](this['x']);this['y']=Math[_0x22c1('0xc0')](this['y']);this['z']=Math['round'](this['z']);return this;}},{'key':_0x22c1('0xc1'),'value':function roundToZero(){this['x']=this['x']<0x0?Math[_0x22c1('0x58')](this['x']):Math[_0x22c1('0x55')](this['x']);this['y']=this['y']<0x0?Math[_0x22c1('0x58')](this['y']):Math[_0x22c1('0x55')](this['y']);this['z']=this['z']<0x0?Math[_0x22c1('0x58')](this['z']):Math[_0x22c1('0x55')](this['z']);return this;}},{'key':_0x22c1('0xc2'),'value':function negate(){this['x']=-this['x'];this['y']=-this['y'];this['z']=-this['z'];return this;}},{'key':_0x22c1('0x9c'),'value':function dot(v){return this['x']*v['x']+this['y']*v['y']+this['z']*v['z'];}},{'key':'lengthSq','value':function lengthSq(){return this['x']*this['x']+this['y']*this['y']+this['z']*this['z'];}},{'key':_0x22c1('0x32'),'value':function length(){return Math[_0x22c1('0x8a')](this['x']*this['x']+this['y']*this['y']+this['z']*this['z']);}},{'key':_0x22c1('0xc3'),'value':function manhattanLength(){return Math[_0x22c1('0x69')](this['x'])+Math[_0x22c1('0x69')](this['y'])+Math[_0x22c1('0x69')](this['z']);}},{'key':'normalize','value':function normalize(){return this['divideScalar'](this[_0x22c1('0x32')]()||0x1);}},{'key':_0x22c1('0xc4'),'value':function setLength(length){return this[_0x22c1('0x6a')]()[_0x22c1('0x6f')](length);}},{'key':'lerp','value':function lerp(v,alpha){this['x']+=(v['x']-this['x'])*alpha;this['y']+=(v['y']-this['y'])*alpha;this['z']+=(v['z']-this['z'])*alpha;return this;}},{'key':'lerpVectors','value':function lerpVectors(v1,v2,alpha){return this[_0x22c1('0xad')](v2,v1)[_0x22c1('0x6f')](alpha)[_0x22c1('0xc5')](v1);}},{'key':'cross','value':function cross(v,w){if(w!==undefined){console[_0x22c1('0x6b')](_0x22c1('0xc6'));return this[_0x22c1('0x68')](v,w);}return this[_0x22c1('0x68')](this,v);}},{'key':_0x22c1('0x68'),'value':function crossVectors(a,b){var ax=a['x'];var ay=a['y'];var az=a['z'];var bx=b['x'];var by=b['y'];var bz=b['z'];this['x']=ay*bz-az*by;this['y']=az*bx-ax*bz;this['z']=ax*by-ay*bx;return this;}},{'key':_0x22c1('0xc7'),'value':function projectOnVector(vector){var scalar=vector['dot'](this)/vector[_0x22c1('0x67')]();return this[_0x22c1('0x82')](vector)[_0x22c1('0x6f')](scalar);}},{'key':'projectOnPlane','value':function projectOnPlane(planeNormal){var v1=new Vector3();v1[_0x22c1('0x82')](this)[_0x22c1('0xc7')](planeNormal);return this[_0x22c1('0xab')](v1);}},{'key':_0x22c1('0xc8'),'value':function reflect(normal){var v1=new Vector3();return this[_0x22c1('0xab')](v1[_0x22c1('0x82')](normal)[_0x22c1('0x6f')](0x2*this[_0x22c1('0x9c')](normal)));}},{'key':_0x22c1('0x96'),'value':function angleTo(v){var theta=this['dot'](v)/Math[_0x22c1('0x8a')](this[_0x22c1('0x67')]()*v[_0x22c1('0x67')]());return Math[_0x22c1('0x97')](_Math[_0x22c1('0x98')](theta,-0x1,0x1));}},{'key':'distanceTo','value':function distanceTo(v){return Math['sqrt'](this[_0x22c1('0xc9')](v));}},{'key':'distanceToSquared','value':function distanceToSquared(v){var dx=this['x']-v['x'];var dy=this['y']-v['y'];var dz=this['z']-v['z'];return dx*dx+dy*dy+dz*dz;}},{'key':_0x22c1('0xca'),'value':function manhattanDistanceTo(v){return Math[_0x22c1('0x69')](this['x']-v['x'])+Math[_0x22c1('0x69')](this['y']-v['y'])+Math['abs'](this['z']-v['z']);}},{'key':'setFromSpherical','value':function setFromSpherical(s){return this[_0x22c1('0xcb')](s['radius'],s['phi'],s[_0x22c1('0xcc')]);}},{'key':_0x22c1('0xcb'),'value':function setFromSphericalCoords(radius,phi,theta){var sinPhiRadius=Math[_0x22c1('0x7c')](phi)*radius;this['x']=sinPhiRadius*Math['sin'](theta);this['y']=Math['cos'](phi)*radius;this['z']=sinPhiRadius*Math['cos'](theta);return this;}},{'key':_0x22c1('0xcd'),'value':function setFromCylindrical(c){return this[_0x22c1('0xce')](c[_0x22c1('0xcf')],c['theta'],c['y']);}},{'key':_0x22c1('0xce'),'value':function setFromCylindricalCoords(radius,theta,y){this['x']=radius*Math[_0x22c1('0x7c')](theta);this['y']=y;this['z']=radius*Math['cos'](theta);return this;}},{'key':'setFromMatrixPosition','value':function setFromMatrixPosition(m){var e=m[_0x22c1('0x5b')];this['x']=e[0xc];this['y']=e[0xd];this['z']=e[0xe];return this;}},{'key':_0x22c1('0xd0'),'value':function setFromMatrixScale(m){var sx=this[_0x22c1('0x61')](m,0x0)['length']();var sy=this[_0x22c1('0x61')](m,0x1)[_0x22c1('0x32')]();var sz=this[_0x22c1('0x61')](m,0x2)['length']();this['x']=sx;this['y']=sy;this['z']=sz;return this;}},{'key':_0x22c1('0x61'),'value':function setFromMatrixColumn(m,index){return this[_0x22c1('0xa0')](m[_0x22c1('0x5b')],index*0x4);}},{'key':_0x22c1('0x85'),'value':function equals(v){return v['x']===this['x']&&v['y']===this['y']&&v['z']===this['z'];}},{'key':_0x22c1('0xa0'),'value':function fromArray(array,offset){if(offset===undefined)offset=0x0;this['x']=array[offset];this['y']=array[offset+0x1];this['z']=array[offset+0x2];return this;}},{'key':'toArray','value':function toArray(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0x0;array[offset]=this['x'];array[offset+0x1]=this['y'];array[offset+0x2]=this['z'];return array;}},{'key':_0x22c1('0xd1'),'value':function fromBufferAttribute(attribute,index,offset){if(offset!==undefined){console['warn'](_0x22c1('0xd2'));}this['x']=attribute[_0x22c1('0x70')](index);this['y']=attribute[_0x22c1('0x71')](index);this['z']=attribute['getZ'](index);return this;}}]);return Vector3;}();function Face3(a,b,c,normal,materialIndex){this['a']=a;this['b']=b;this['c']=c;this[_0x22c1('0x1e')]=normal&&normal[_0x22c1('0xa2')]?normal:new Vector3();this[_0x22c1('0xd3')]=Array[_0x22c1('0xd4')](normal)?normal:[];this[_0x22c1('0xd5')]=materialIndex!==undefined?materialIndex:0x0;}Object[_0x22c1('0x48')](Face3[_0x22c1('0x1')],{'clone':function clone(){return new this[(_0x22c1('0xd'))]()['copy'](this);},'copy':function copy(source){this['a']=source['a'];this['b']=source['b'];this['c']=source['c'];this[_0x22c1('0x1e')]['copy'](source[_0x22c1('0x1e')]);this[_0x22c1('0xd5')]=source[_0x22c1('0xd5')];for(var i=0x0,il=source['vertexNormals'][_0x22c1('0x32')];i<il;i++){this[_0x22c1('0xd3')][i]=source[_0x22c1('0xd3')][i][_0x22c1('0x8d')]();}return this;}});var Matrix3=function(){function Matrix3(){_classCallCheck(this,Matrix3);this['elements']=[0x1,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1];this[_0x22c1('0xd6')]=!![];}_createClass(Matrix3,[{'key':'set','value':function set(n11,n12,n13,n21,n22,n23,n31,n32,n33){var te=this['elements'];te[0x0]=n11;te[0x1]=n21;te[0x2]=n31;te[0x3]=n12;te[0x4]=n22;te[0x5]=n32;te[0x6]=n13;te[0x7]=n23;te[0x8]=n33;return this;}},{'key':'identity','value':function identity(){this[_0x22c1('0x5e')](0x1,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1);return this;}},{'key':_0x22c1('0x8d'),'value':function clone(){return new this[(_0x22c1('0xd'))]()[_0x22c1('0xa0')](this[_0x22c1('0x5b')]);}},{'key':'copy','value':function copy(m){var te=this[_0x22c1('0x5b')];var me=m[_0x22c1('0x5b')];te[0x0]=me[0x0];te[0x1]=me[0x1];te[0x2]=me[0x2];te[0x3]=me[0x3];te[0x4]=me[0x4];te[0x5]=me[0x5];te[0x6]=me[0x6];te[0x7]=me[0x7];te[0x8]=me[0x8];return this;}},{'key':'setFromMatrix4','value':function setFromMatrix4(m){var me=m[_0x22c1('0x5b')];this['set'](me[0x0],me[0x4],me[0x8],me[0x1],me[0x5],me[0x9],me[0x2],me[0x6],me[0xa]);return this;}},{'key':'applyToBufferAttribute','value':function applyToBufferAttribute(attribute){var v1=new Vector3();for(var i=0x0,l=attribute[_0x22c1('0xd7')];i<l;i++){v1['x']=attribute[_0x22c1('0x70')](i);v1['y']=attribute[_0x22c1('0x71')](i);v1['z']=attribute['getZ'](i);v1['applyMatrix3'](this);attribute[_0x22c1('0x73')](i,v1['x'],v1['y'],v1['z']);}return attribute;}},{'key':'multiply','value':function multiply(m){return this[_0x22c1('0x6d')](this,m);}},{'key':_0x22c1('0x6e'),'value':function premultiply(m){return this['multiplyMatrices'](m,this);}},{'key':_0x22c1('0x6d'),'value':function multiplyMatrices(a,b){var ae=a['elements'];var be=b[_0x22c1('0x5b')];var te=this['elements'];var a11=ae[0x0];var a12=ae[0x3];var a13=ae[0x6];var a21=ae[0x1];var a22=ae[0x4];var a23=ae[0x7];var a31=ae[0x2];var a32=ae[0x5];var a33=ae[0x8];var b11=be[0x0];var b12=be[0x3];var b13=be[0x6];var b21=be[0x1];var b22=be[0x4];var b23=be[0x7];var b31=be[0x2];var b32=be[0x5];var b33=be[0x8];te[0x0]=a11*b11+a12*b21+a13*b31;te[0x3]=a11*b12+a12*b22+a13*b32;te[0x6]=a11*b13+a12*b23+a13*b33;te[0x1]=a21*b11+a22*b21+a23*b31;te[0x4]=a21*b12+a22*b22+a23*b32;te[0x7]=a21*b13+a22*b23+a23*b33;te[0x2]=a31*b11+a32*b21+a33*b31;te[0x5]=a31*b12+a32*b22+a33*b32;te[0x8]=a31*b13+a32*b23+a33*b33;return this;}},{'key':'multiplyScalar','value':function multiplyScalar(s){var te=this[_0x22c1('0x5b')];te[0x0]*=s;te[0x3]*=s;te[0x6]*=s;te[0x1]*=s;te[0x4]*=s;te[0x7]*=s;te[0x2]*=s;te[0x5]*=s;te[0x8]*=s;return this;}},{'key':'determinant','value':function determinant(){var te=this['elements'];var a=te[0x0];var b=te[0x1];var c=te[0x2];var d=te[0x3];var e=te[0x4];var f=te[0x5];var g=te[0x6];var h=te[0x7];var i=te[0x8];return a*e*i-a*f*h-b*d*i+b*f*g+c*d*h-c*e*g;}},{'key':'getInverse','value':function getInverse(matrix,throwOnDegenerate){if(matrix&&matrix[_0x22c1('0x5c')]){console[_0x22c1('0xb0')](_0x22c1('0xd8'));}var me=matrix[_0x22c1('0x5b')];var te=this[_0x22c1('0x5b')];var n11=me[0x0];var n21=me[0x1];var n31=me[0x2];var n12=me[0x3];var n22=me[0x4];var n32=me[0x5];var n13=me[0x6];var n23=me[0x7];var n33=me[0x8];var t11=n33*n22-n32*n23;var t12=n32*n13-n33*n12;var t13=n23*n12-n22*n13;var det=n11*t11+n21*t12+n31*t13;if(det===0x0){var msg='THREE.Matrix3:\x20.getInverse()\x20can\x27t\x20invert\x20matrix,\x20determinant\x20is\x200';if(throwOnDegenerate===!![]){throw new Error(msg);}else{console['warn'](msg);}return this[_0x22c1('0x5d')]();}var detInv=0x1/det;te[0x0]=t11*detInv;te[0x1]=(n31*n23-n33*n21)*detInv;te[0x2]=(n32*n21-n31*n22)*detInv;te[0x3]=t12*detInv;te[0x4]=(n33*n11-n31*n13)*detInv;te[0x5]=(n31*n12-n32*n11)*detInv;te[0x6]=t13*detInv;te[0x7]=(n21*n13-n23*n11)*detInv;te[0x8]=(n22*n11-n21*n12)*detInv;return this;}},{'key':_0x22c1('0x74'),'value':function transpose(){var tmp;var m=this['elements'];tmp=m[0x1];m[0x1]=m[0x3];m[0x3]=tmp;tmp=m[0x2];m[0x2]=m[0x6];m[0x6]=tmp;tmp=m[0x5];m[0x5]=m[0x7];m[0x7]=tmp;return this;}},{'key':_0x22c1('0xd9'),'value':function getNormalMatrix(matrix4){return this['setFromMatrix4'](matrix4)['getInverse'](this)[_0x22c1('0x74')]();}},{'key':'transposeIntoArray','value':function transposeIntoArray(r){var m=this['elements'];r[0x0]=m[0x0];r[0x1]=m[0x3];r[0x2]=m[0x6];r[0x3]=m[0x1];r[0x4]=m[0x4];r[0x5]=m[0x7];r[0x6]=m[0x2];r[0x7]=m[0x5];r[0x8]=m[0x8];return this;}},{'key':'setUvTransform','value':function setUvTransform(tx,ty,sx,sy,rotation,cx,cy){var c=Math[_0x22c1('0x7b')](rotation);var s=Math[_0x22c1('0x7c')](rotation);this[_0x22c1('0x5e')](sx*c,sx*s,-sx*(c*cx+s*cy)+cx+tx,-sy*s,sy*c,-sy*(-s*cx+c*cy)+cy+ty,0x0,0x0,0x1);}},{'key':_0x22c1('0x77'),'value':function scale(sx,sy){var te=this['elements'];te[0x0]*=sx;te[0x3]*=sx;te[0x6]*=sx;te[0x1]*=sy;te[0x4]*=sy;te[0x7]*=sy;return this;}},{'key':_0x22c1('0xda'),'value':function rotate(theta){var c=Math[_0x22c1('0x7b')](theta);var s=Math[_0x22c1('0x7c')](theta);var te=this['elements'];var a11=te[0x0];var a12=te[0x3];var a13=te[0x6];var a21=te[0x1];var a22=te[0x4];var a23=te[0x7];te[0x0]=c*a11+s*a21;te[0x3]=c*a12+s*a22;te[0x6]=c*a13+s*a23;te[0x1]=-s*a11+c*a21;te[0x4]=-s*a12+c*a22;te[0x7]=-s*a13+c*a23;return this;}},{'key':_0x22c1('0xdb'),'value':function translate(tx,ty){var te=this[_0x22c1('0x5b')];te[0x0]+=tx*te[0x2];te[0x3]+=tx*te[0x5];te[0x6]+=tx*te[0x8];te[0x1]+=ty*te[0x2];te[0x4]+=ty*te[0x5];te[0x7]+=ty*te[0x8];return this;}},{'key':_0x22c1('0x85'),'value':function equals(matrix){var te=this[_0x22c1('0x5b')];var me=matrix[_0x22c1('0x5b')];for(var i=0x0;i<0x9;i++){if(te[i]!==me[i])return![];}return!![];}},{'key':_0x22c1('0xa0'),'value':function fromArray(array,offset){if(offset===undefined)offset=0x0;for(var i=0x0;i<0x9;i++){this[_0x22c1('0x5b')][i]=array[i+offset];}return this;}},{'key':_0x22c1('0x86'),'value':function toArray(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0x0;var te=this[_0x22c1('0x5b')];array[offset]=te[0x0];array[offset+0x1]=te[0x1];array[offset+0x2]=te[0x2];array[offset+0x3]=te[0x3];array[offset+0x4]=te[0x4];array[offset+0x5]=te[0x5];array[offset+0x6]=te[0x6];array[offset+0x7]=te[0x7];array[offset+0x8]=te[0x8];return array;}}]);return Matrix3;}();var Box3=function(){function Box3(min,max){_classCallCheck(this,Box3);this['min']=min!==undefined?min:new Vector3(+Infinity,+Infinity,+Infinity);this['max']=max!==undefined?max:new Vector3(-Infinity,-Infinity,-Infinity);this[_0x22c1('0xdc')]=!![];}_createClass(Box3,[{'key':_0x22c1('0x5e'),'value':function set(min,max){this[_0x22c1('0x54')][_0x22c1('0x82')](min);this[_0x22c1('0x53')][_0x22c1('0x82')](max);return this;}},{'key':_0x22c1('0xdd'),'value':function setFromArray(array){var minX=+Infinity;var minY=+Infinity;var minZ=+Infinity;var maxX=-Infinity;var maxY=-Infinity;var maxZ=-Infinity;for(var i=0x0,l=array['length'];i<l;i+=0x3){var x=array[i];var y=array[i+0x1];var z=array[i+0x2];if(x<minX)minX=x;if(y<minY)minY=y;if(z<minZ)minZ=z;if(x>maxX)maxX=x;if(y>maxY)maxY=y;if(z>maxZ)maxZ=z;}this[_0x22c1('0x54')][_0x22c1('0x5e')](minX,minY,minZ);this['max'][_0x22c1('0x5e')](maxX,maxY,maxZ);return this;}},{'key':'setFromBufferAttribute','value':function setFromBufferAttribute(attribute){var minX=+Infinity;var minY=+Infinity;var minZ=+Infinity;var maxX=-Infinity;var maxY=-Infinity;var maxZ=-Infinity;for(var i=0x0,l=attribute[_0x22c1('0xd7')];i<l;i++){var x=attribute['getX'](i);var y=attribute[_0x22c1('0x71')](i);var z=attribute[_0x22c1('0x72')](i);if(x<minX)minX=x;if(y<minY)minY=y;if(z<minZ)minZ=z;if(x>maxX)maxX=x;if(y>maxY)maxY=y;if(z>maxZ)maxZ=z;}this[_0x22c1('0x54')]['set'](minX,minY,minZ);this[_0x22c1('0x53')][_0x22c1('0x5e')](maxX,maxY,maxZ);return this;}},{'key':_0x22c1('0xde'),'value':function setFromPoints(points){this[_0x22c1('0xdf')]();for(var i=0x0,il=points[_0x22c1('0x32')];i<il;i++){this[_0x22c1('0xe0')](points[i]);}return this;}},{'key':'setFromCenterAndSize','value':function setFromCenterAndSize(center,size){var halfSize=size[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0.5);this[_0x22c1('0x54')][_0x22c1('0x82')](center)[_0x22c1('0xab')](halfSize);this[_0x22c1('0x53')][_0x22c1('0x82')](center)[_0x22c1('0xc5')](halfSize);return this;}},{'key':_0x22c1('0xe1'),'value':function setFromObject(object){this[_0x22c1('0xdf')]();return this[_0x22c1('0xe2')](object);}},{'key':_0x22c1('0x8d'),'value':function clone(){return new Box3()[_0x22c1('0x82')](this);}},{'key':_0x22c1('0x82'),'value':function copy(box){this[_0x22c1('0x54')][_0x22c1('0x82')](box[_0x22c1('0x54')]);this['max'][_0x22c1('0x82')](box[_0x22c1('0x53')]);return this;}},{'key':'makeEmpty','value':function makeEmpty(){this[_0x22c1('0x54')]['x']=this['min']['y']=this[_0x22c1('0x54')]['z']=+Infinity;this['max']['x']=this[_0x22c1('0x53')]['y']=this[_0x22c1('0x53')]['z']=-Infinity;return this;}},{'key':_0x22c1('0xe3'),'value':function isEmpty(){return this[_0x22c1('0x53')]['x']<this[_0x22c1('0x54')]['x']||this['max']['y']<this[_0x22c1('0x54')]['y']||this[_0x22c1('0x53')]['z']<this[_0x22c1('0x54')]['z'];}},{'key':_0x22c1('0xe4'),'value':function getCenter(target){if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0xe5'));target=new Vector3();}return this[_0x22c1('0xe3')]()?target['set'](0x0,0x0,0x0):target[_0x22c1('0xa8')](this[_0x22c1('0x54')],this['max'])[_0x22c1('0x6f')](0.5);}},{'key':_0x22c1('0xe6'),'value':function getSize(){var target=new Vector3();return this[_0x22c1('0xe3')]()?target[_0x22c1('0x5e')](0x0,0x0,0x0):target[_0x22c1('0xad')](this[_0x22c1('0x53')],this[_0x22c1('0x54')]);}},{'key':_0x22c1('0xe0'),'value':function expandByPoint(point){this[_0x22c1('0x54')]['min'](point);this['max']['max'](point);return this;}},{'key':_0x22c1('0xe7'),'value':function expandByVector(vector){this[_0x22c1('0x54')][_0x22c1('0xab')](vector);this[_0x22c1('0x53')][_0x22c1('0xc5')](vector);return this;}},{'key':_0x22c1('0xe8'),'value':function expandByScalar(scalar){this[_0x22c1('0x54')][_0x22c1('0xa9')](-scalar);this[_0x22c1('0x53')][_0x22c1('0xa9')](scalar);return this;}},{'key':_0x22c1('0xe2'),'value':function expandByObject(object){var v1=new Vector3();function traverse(node){var geometry=node[_0x22c1('0xe9')];if(geometry!==undefined){if(geometry[_0x22c1('0xea')]){var vertices=geometry[_0x22c1('0xeb')];for(var i=0x0,l=vertices[_0x22c1('0x32')];i<l;i++){v1[_0x22c1('0x82')](vertices[i]);v1[_0x22c1('0xb7')](node[_0x22c1('0xbb')]);this[_0x22c1('0xe0')](v1);}}else if(geometry[_0x22c1('0xec')]){var attribute=geometry[_0x22c1('0xed')][_0x22c1('0xee')];if(attribute!==undefined){for(var _i=0x0,_l=attribute[_0x22c1('0xd7')];_i<_l;_i++){v1[_0x22c1('0xd1')](attribute,_i)[_0x22c1('0xb7')](node['matrixWorld']);this[_0x22c1('0xe0')](v1);}}}}}object[_0x22c1('0xef')](!![]);object[_0x22c1('0xf0')](traverse);return this;}},{'key':'containsPoint','value':function containsPoint(point){return!(point['x']<this[_0x22c1('0x54')]['x']||point['x']>this[_0x22c1('0x53')]['x']||point['y']<this[_0x22c1('0x54')]['y']||point['y']>this[_0x22c1('0x53')]['y']||point['z']<this[_0x22c1('0x54')]['z']||point['z']>this['max']['z']);}},{'key':_0x22c1('0xf1'),'value':function containsBox(box){return this[_0x22c1('0x54')]['x']<=box['min']['x']&&box['max']['x']<=this[_0x22c1('0x53')]['x']&&this[_0x22c1('0x54')]['y']<=box[_0x22c1('0x54')]['y']&&box['max']['y']<=this[_0x22c1('0x53')]['y']&&this[_0x22c1('0x54')]['z']<=box[_0x22c1('0x54')]['z']&&box[_0x22c1('0x53')]['z']<=this[_0x22c1('0x53')]['z'];}},{'key':'getParameter','value':function getParameter(point,target){if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0xf2'));target=new Vector3();}return target[_0x22c1('0x5e')]((point['x']-this[_0x22c1('0x54')]['x'])/(this[_0x22c1('0x53')]['x']-this['min']['x']),(point['y']-this[_0x22c1('0x54')]['y'])/(this[_0x22c1('0x53')]['y']-this[_0x22c1('0x54')]['y']),(point['z']-this[_0x22c1('0x54')]['z'])/(this[_0x22c1('0x53')]['z']-this[_0x22c1('0x54')]['z']));}},{'key':_0x22c1('0xf3'),'value':function intersectsBox(box){return!(box[_0x22c1('0x53')]['x']<this['min']['x']||box['min']['x']>this[_0x22c1('0x53')]['x']||box['max']['y']<this[_0x22c1('0x54')]['y']||box['min']['y']>this[_0x22c1('0x53')]['y']||box['max']['z']<this['min']['z']||box[_0x22c1('0x54')]['z']>this[_0x22c1('0x53')]['z']);}},{'key':_0x22c1('0xf4'),'value':function clampPoint(point,target){if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0xf5'));target=new Vector3();}return target['copy'](point)[_0x22c1('0x98')](this[_0x22c1('0x54')],this[_0x22c1('0x53')]);}},{'key':_0x22c1('0xf6'),'value':function distanceToPoint(point){var clampedPoint=point[_0x22c1('0x8d')]()[_0x22c1('0x98')](this[_0x22c1('0x54')],this[_0x22c1('0x53')]);return clampedPoint[_0x22c1('0xab')](point)[_0x22c1('0x32')]();}},{'key':_0x22c1('0xf7'),'value':function getBoundingSphere(target){if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0xf8'));target=new Sphere();}this[_0x22c1('0xe4')](target[_0x22c1('0xf9')]);target['radius']=this[_0x22c1('0xe6')]()[_0x22c1('0x32')]()*0.5;return target;}},{'key':'intersect','value':function intersect(box){this[_0x22c1('0x54')][_0x22c1('0x53')](box[_0x22c1('0x54')]);this[_0x22c1('0x53')][_0x22c1('0x54')](box['max']);if(this['isEmpty']())this[_0x22c1('0xdf')]();return this;}},{'key':_0x22c1('0xfa'),'value':function union(box){this[_0x22c1('0x54')][_0x22c1('0x54')](box['min']);this['max'][_0x22c1('0x53')](box['max']);return this;}},{'key':_0x22c1('0xb7'),'value':function applyMatrix4(matrix){if(this['isEmpty']())return this;var points=[new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3(),new Vector3()];points[0x0]['set'](this[_0x22c1('0x54')]['x'],this[_0x22c1('0x54')]['y'],this[_0x22c1('0x54')]['z'])['applyMatrix4'](matrix);points[0x1][_0x22c1('0x5e')](this[_0x22c1('0x54')]['x'],this[_0x22c1('0x54')]['y'],this[_0x22c1('0x53')]['z'])[_0x22c1('0xb7')](matrix);points[0x2]['set'](this[_0x22c1('0x54')]['x'],this['max']['y'],this[_0x22c1('0x54')]['z'])[_0x22c1('0xb7')](matrix);points[0x3]['set'](this[_0x22c1('0x54')]['x'],this[_0x22c1('0x53')]['y'],this[_0x22c1('0x53')]['z'])[_0x22c1('0xb7')](matrix);points[0x4]['set'](this['max']['x'],this['min']['y'],this[_0x22c1('0x54')]['z'])['applyMatrix4'](matrix);points[0x5][_0x22c1('0x5e')](this[_0x22c1('0x53')]['x'],this[_0x22c1('0x54')]['y'],this[_0x22c1('0x53')]['z'])['applyMatrix4'](matrix);points[0x6][_0x22c1('0x5e')](this['max']['x'],this[_0x22c1('0x53')]['y'],this[_0x22c1('0x54')]['z'])[_0x22c1('0xb7')](matrix);points[0x7][_0x22c1('0x5e')](this[_0x22c1('0x53')]['x'],this['max']['y'],this['max']['z'])[_0x22c1('0xb7')](matrix);this[_0x22c1('0xde')](points);return this;}},{'key':'translate','value':function translate(offset){this[_0x22c1('0x54')]['add'](offset);this[_0x22c1('0x53')][_0x22c1('0xc5')](offset);return this;}},{'key':'equals','value':function equals(box){return box['min'][_0x22c1('0x85')](this[_0x22c1('0x54')])&&box[_0x22c1('0x53')][_0x22c1('0x85')](this['max']);}}]);return Box3;}();var Sphere=function(){function Sphere(center,radius){_classCallCheck(this,Sphere);this['center']=center!==undefined?center:new Vector3();this[_0x22c1('0xcf')]=radius!==undefined?radius:0x0;}_createClass(Sphere,[{'key':_0x22c1('0x5e'),'value':function set(center,radius){this[_0x22c1('0xf9')][_0x22c1('0x82')](center);this['radius']=radius;return this;}},{'key':'setFromPoints','value':function setFromPoints(points,optionalCenter){var box=new Box3();var center=this['center'];if(optionalCenter!==undefined){center[_0x22c1('0x82')](optionalCenter);}else{box[_0x22c1('0xde')](points)['getCenter'](center);}var maxRadiusSq=0x0;for(var i=0x0,il=points[_0x22c1('0x32')];i<il;i++){maxRadiusSq=Math[_0x22c1('0x53')](maxRadiusSq,center[_0x22c1('0xc9')](points[i]));}this[_0x22c1('0xcf')]=Math[_0x22c1('0x8a')](maxRadiusSq);return this;}},{'key':_0x22c1('0x8d'),'value':function clone(){return new this[(_0x22c1('0xd'))]()['copy'](this);}},{'key':_0x22c1('0x82'),'value':function copy(sphere){this[_0x22c1('0xf9')][_0x22c1('0x82')](sphere[_0x22c1('0xf9')]);this[_0x22c1('0xcf')]=sphere['radius'];return this;}},{'key':_0x22c1('0xfb'),'value':function empty(){return this['radius']<=0x0;}},{'key':'containsPoint','value':function containsPoint(point){return point[_0x22c1('0xc9')](this[_0x22c1('0xf9')])<=this['radius']*this[_0x22c1('0xcf')];}},{'key':_0x22c1('0xf6'),'value':function distanceToPoint(point){return point['distanceTo'](this['center'])-this[_0x22c1('0xcf')];}},{'key':'intersectsSphere','value':function intersectsSphere(sphere){var radiusSum=this[_0x22c1('0xcf')]+sphere[_0x22c1('0xcf')];return sphere['center'][_0x22c1('0xc9')](this[_0x22c1('0xf9')])<=radiusSum*radiusSum;}},{'key':'intersectsBox','value':function intersectsBox(box){return box[_0x22c1('0xfc')](this);}},{'key':_0x22c1('0xfd'),'value':function intersectsPlane(plane){return Math[_0x22c1('0x69')](plane['distanceToPoint'](this[_0x22c1('0xf9')]))<=this[_0x22c1('0xcf')];}},{'key':_0x22c1('0xf4'),'value':function clampPoint(point,target){var deltaLengthSq=this[_0x22c1('0xf9')][_0x22c1('0xc9')](point);if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0xfe'));target=new Vector3();}target[_0x22c1('0x82')](point);if(deltaLengthSq>this['radius']*this[_0x22c1('0xcf')]){target[_0x22c1('0xab')](this[_0x22c1('0xf9')])[_0x22c1('0x6a')]();target['multiplyScalar'](this[_0x22c1('0xcf')])['add'](this[_0x22c1('0xf9')]);}return target;}},{'key':'getBoundingBox','value':function getBoundingBox(target){if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0xff'));target=new Box3();}target[_0x22c1('0x5e')](this['center'],this[_0x22c1('0xf9')]);target[_0x22c1('0xe8')](this[_0x22c1('0xcf')]);return target;}},{'key':_0x22c1('0xb7'),'value':function applyMatrix4(matrix){this[_0x22c1('0xf9')][_0x22c1('0xb7')](matrix);this['radius']=this['radius']*matrix[_0x22c1('0x78')]();return this;}},{'key':_0x22c1('0xdb'),'value':function translate(offset){this[_0x22c1('0xf9')][_0x22c1('0xc5')](offset);return this;}},{'key':_0x22c1('0x85'),'value':function equals(sphere){return sphere[_0x22c1('0xf9')][_0x22c1('0x85')](this[_0x22c1('0xf9')])&&sphere[_0x22c1('0xcf')]===this[_0x22c1('0xcf')];}}]);return Sphere;}();var Vector2=function(){function Vector2(x,y){_classCallCheck(this,Vector2);this['x']=x||0x0;this['y']=y||0x0;this[_0x22c1('0x100')]=!![];}_createClass(Vector2,[{'key':_0x22c1('0x5e'),'value':function set(x,y){this['x']=x;this['y']=y;return this;}},{'key':'setScalar','value':function setScalar(scalar){this['x']=scalar;this['y']=scalar;return this;}},{'key':'setX','value':function setX(x){this['x']=x;return this;}},{'key':_0x22c1('0x101'),'value':function setY(y){this['y']=y;return this;}},{'key':'setComponent','value':function setComponent(index,value){switch(index){case 0x0:this['x']=value;break;case 0x1:this['y']=value;break;default:throw new Error('index\x20is\x20out\x20of\x20range:\x20'+index);}return this;}},{'key':_0x22c1('0xa6'),'value':function getComponent(index){switch(index){case 0x0:return this['x'];case 0x1:return this['y'];default:throw new Error(_0x22c1('0xa5')+index);}}},{'key':'clone','value':function clone(){return new this[(_0x22c1('0xd'))](this['x'],this['y']);}},{'key':_0x22c1('0x82'),'value':function copy(v){this['x']=v['x'];this['y']=v['y'];return this;}},{'key':_0x22c1('0xc5'),'value':function add(v,w){if(w!==undefined){console[_0x22c1('0x6b')](_0x22c1('0x102'));return this['addVectors'](v,w);}this['x']+=v['x'];this['y']+=v['y'];return this;}},{'key':_0x22c1('0xa9'),'value':function addScalar(s){this['x']+=s;this['y']+=s;return this;}},{'key':_0x22c1('0xa8'),'value':function addVectors(a,b){this['x']=a['x']+b['x'];this['y']=a['y']+b['y'];return this;}},{'key':_0x22c1('0xaa'),'value':function addScaledVector(v,s){this['x']+=v['x']*s;this['y']+=v['y']*s;return this;}},{'key':_0x22c1('0xab'),'value':function sub(v,w){if(w!==undefined){console['warn']('THREE.Vector2:\x20.sub()\x20now\x20only\x20accepts\x20one\x20argument.\x20Use\x20.subVectors(\x20a,\x20b\x20)\x20instead.');return this[_0x22c1('0xad')](v,w);}this['x']-=v['x'];this['y']-=v['y'];return this;}},{'key':_0x22c1('0xac'),'value':function subScalar(s){this['x']-=s;this['y']-=s;return this;}},{'key':_0x22c1('0xad'),'value':function subVectors(a,b){this['x']=a['x']-b['x'];this['y']=a['y']-b['y'];return this;}},{'key':_0x22c1('0x9d'),'value':function multiply(v){this['x']*=v['x'];this['y']*=v['y'];return this;}},{'key':_0x22c1('0x6f'),'value':function multiplyScalar(scalar){this['x']*=scalar;this['y']*=scalar;return this;}},{'key':'divide','value':function divide(v){this['x']/=v['x'];this['y']/=v['y'];return this;}},{'key':_0x22c1('0x103'),'value':function divideScalar(scalar){return this[_0x22c1('0x6f')](0x1/scalar);}},{'key':_0x22c1('0x104'),'value':function applyMatrix3(m){var x=this['x'],y=this['y'];var e=m[_0x22c1('0x5b')];this['x']=e[0x0]*x+e[0x3]*y+e[0x6];this['y']=e[0x1]*x+e[0x4]*y+e[0x7];return this;}},{'key':_0x22c1('0x54'),'value':function min(v){this['x']=Math['min'](this['x'],v['x']);this['y']=Math[_0x22c1('0x54')](this['y'],v['y']);return this;}},{'key':_0x22c1('0x53'),'value':function max(v){this['x']=Math[_0x22c1('0x53')](this['x'],v['x']);this['y']=Math['max'](this['y'],v['y']);return this;}},{'key':_0x22c1('0x98'),'value':function clamp(min,max){this['x']=Math['max'](min['x'],Math[_0x22c1('0x54')](max['x'],this['x']));this['y']=Math[_0x22c1('0x53')](min['y'],Math[_0x22c1('0x54')](max['y'],this['y']));return this;}},{'key':_0x22c1('0xbe'),'value':function clampScalar(minVal,maxVal){var min=new Vector2(minVal,minVal);var max=new Vector2(maxVal,maxVal);return this['clamp'](min,max);}},{'key':_0x22c1('0xbf'),'value':function clampLength(min,max){var length=this[_0x22c1('0x32')]();return this[_0x22c1('0x103')](length||0x1)['multiplyScalar'](Math[_0x22c1('0x53')](min,Math['min'](max,length)));}},{'key':_0x22c1('0x55'),'value':function floor(){this['x']=Math['floor'](this['x']);this['y']=Math['floor'](this['y']);return this;}},{'key':_0x22c1('0x58'),'value':function ceil(){this['x']=Math[_0x22c1('0x58')](this['x']);this['y']=Math[_0x22c1('0x58')](this['y']);return this;}},{'key':_0x22c1('0xc0'),'value':function round(){this['x']=Math[_0x22c1('0xc0')](this['x']);this['y']=Math[_0x22c1('0xc0')](this['y']);return this;}},{'key':_0x22c1('0xc1'),'value':function roundToZero(){this['x']=this['x']<0x0?Math[_0x22c1('0x58')](this['x']):Math['floor'](this['x']);this['y']=this['y']<0x0?Math[_0x22c1('0x58')](this['y']):Math[_0x22c1('0x55')](this['y']);return this;}},{'key':_0x22c1('0xc2'),'value':function negate(){this['x']=-this['x'];this['y']=-this['y'];return this;}},{'key':_0x22c1('0x9c'),'value':function dot(v){return this['x']*v['x']+this['y']*v['y'];}},{'key':_0x22c1('0x105'),'value':function cross(v){return this['x']*v['y']-this['y']*v['x'];}},{'key':_0x22c1('0x67'),'value':function lengthSq(){return this['x']*this['x']+this['y']*this['y'];}},{'key':_0x22c1('0x32'),'value':function length(){return Math[_0x22c1('0x106')](this['x'],this['y']);}},{'key':_0x22c1('0xc3'),'value':function manhattanLength(){return Math[_0x22c1('0x69')](this['x'])+Math['abs'](this['y']);}},{'key':_0x22c1('0x6a'),'value':function normalize(){return this[_0x22c1('0x103')](this['length']()||0x1);}},{'key':'angle','value':function angle(){var angle=Math[_0x22c1('0x8b')](this['y'],this['x']);if(angle<0x0)angle+=0x2*Math['PI'];return angle;}},{'key':_0x22c1('0x107'),'value':function distanceTo(v){return Math['hypot'](v['x']-this['x'],v['y']-this['y']);}},{'key':_0x22c1('0xc9'),'value':function distanceToSquared(v){var dx=this['x']-v['x'];var dy=this['y']-v['y'];return dx*dx+dy*dy;}},{'key':'manhattanDistanceTo','value':function manhattanDistanceTo(v){return Math[_0x22c1('0x69')](this['x']-v['x'])+Math[_0x22c1('0x69')](this['y']-v['y']);}},{'key':_0x22c1('0xc4'),'value':function setLength(length){return this[_0x22c1('0x6a')]()[_0x22c1('0x6f')](length);}},{'key':_0x22c1('0x108'),'value':function lerp(v,alpha){this['x']+=(v['x']-this['x'])*alpha;this['y']+=(v['y']-this['y'])*alpha;return this;}},{'key':_0x22c1('0x109'),'value':function lerpVectors(v1,v2,alpha){return this['subVectors'](v2,v1)[_0x22c1('0x6f')](alpha)[_0x22c1('0xc5')](v1);}},{'key':_0x22c1('0x85'),'value':function equals(v){return v['x']===this['x']&&v['y']===this['y'];}},{'key':_0x22c1('0xa0'),'value':function fromArray(array,offset){if(offset===undefined)offset=0x0;this['x']=array[offset];this['y']=array[offset+0x1];return this;}},{'key':_0x22c1('0x86'),'value':function toArray(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0x0;array[offset]=this['x'];array[offset+0x1]=this['y'];return array;}},{'key':_0x22c1('0xd1'),'value':function fromBufferAttribute(attribute,index,offset){if(offset!==undefined){console[_0x22c1('0x6b')](_0x22c1('0x10a'));}this['x']=attribute[_0x22c1('0x70')](index);this['y']=attribute['getY'](index);return this;}},{'key':_0x22c1('0x10b'),'value':function rotateAround(center,angle){var c=Math[_0x22c1('0x7b')](angle);var s=Math['sin'](angle);var x=this['x']-center['x'];var y=this['y']-center['y'];this['x']=x*c-y*s+center['x'];this['y']=x*s+y*c+center['y'];return this;}}]);return Vector2;}();Object[_0x22c1('0x10c')](Vector2['prototype'],{'width':{'get':function get(){return this['x'];},'set':function set(value){this['x']=value;}},'height':{'get':function get(){return this['y'];},'set':function set(value){this['y']=value;}}});function Euler(x,y,z,order){this['_x']=x||0x0;this['_y']=y||0x0;this['_z']=z||0x0;this[_0x22c1('0x10d')]=order||Euler[_0x22c1('0x10e')];}Euler['RotationOrders']=[_0x22c1('0x10f'),_0x22c1('0x94'),_0x22c1('0x92'),'XZY',_0x22c1('0x91'),_0x22c1('0x93')];Euler[_0x22c1('0x10e')]=_0x22c1('0x10f');Object[_0x22c1('0x10c')](Euler[_0x22c1('0x1')],{'x':{'get':function get(){return this['_x'];},'set':function set(value){this['_x']=value;this[_0x22c1('0x8c')]();}},'y':{'get':function get(){return this['_y'];},'set':function set(value){this['_y']=value;this[_0x22c1('0x8c')]();}},'z':{'get':function get(){return this['_z'];},'set':function set(value){this['_z']=value;this[_0x22c1('0x8c')]();}},'order':{'get':function get(){return this['_order'];},'set':function set(value){this[_0x22c1('0x10d')]=value;this[_0x22c1('0x8c')]();}}});Object[_0x22c1('0x48')](Euler[_0x22c1('0x1')],{'isEuler':!![],'set':function set(x,y,z,order){this['_x']=x;this['_y']=y;this['_z']=z;this[_0x22c1('0x10d')]=order||this[_0x22c1('0x10d')];this[_0x22c1('0x8c')]();return this;},'clone':function clone(){return new this[(_0x22c1('0xd'))](this['_x'],this['_y'],this['_z'],this[_0x22c1('0x10d')]);},'copy':function copy(euler){this['_x']=euler['_x'];this['_y']=euler['_y'];this['_z']=euler['_z'];this[_0x22c1('0x10d')]=euler['_order'];this['onChangeCallback']();return this;},'setFromRotationMatrix':function setFromRotationMatrix(m,order,update){var clamp=_Math['clamp'];var te=m[_0x22c1('0x5b')];var m11=te[0x0];var m12=te[0x4];var m13=te[0x8];var m21=te[0x1];var m22=te[0x5];var m23=te[0x9];var m31=te[0x2];var m32=te[0x6];var m33=te[0xa];order=order||this['_order'];if(order===_0x22c1('0x10f')){this['_y']=Math[_0x22c1('0x110')](clamp(m13,-0x1,0x1));if(Math[_0x22c1('0x69')](m13)<0.99999){this['_x']=Math[_0x22c1('0x8b')](-m23,m33);this['_z']=Math[_0x22c1('0x8b')](-m12,m11);}else{this['_x']=Math[_0x22c1('0x8b')](m32,m22);this['_z']=0x0;}}else if(order===_0x22c1('0x91')){this['_x']=Math[_0x22c1('0x110')](-clamp(m23,-0x1,0x1));if(Math[_0x22c1('0x69')](m23)<0.99999){this['_y']=Math[_0x22c1('0x8b')](m13,m33);this['_z']=Math[_0x22c1('0x8b')](m21,m22);}else{this['_y']=Math[_0x22c1('0x8b')](-m31,m11);this['_z']=0x0;}}else if(order==='ZXY'){this['_x']=Math[_0x22c1('0x110')](clamp(m32,-0x1,0x1));if(Math[_0x22c1('0x69')](m32)<0.99999){this['_y']=Math[_0x22c1('0x8b')](-m31,m33);this['_z']=Math[_0x22c1('0x8b')](-m12,m22);}else{this['_y']=0x0;this['_z']=Math['atan2'](m21,m11);}}else if(order===_0x22c1('0x93')){this['_y']=Math[_0x22c1('0x110')](-clamp(m31,-0x1,0x1));if(Math[_0x22c1('0x69')](m31)<0.99999){this['_x']=Math[_0x22c1('0x8b')](m32,m33);this['_z']=Math[_0x22c1('0x8b')](m21,m11);}else{this['_x']=0x0;this['_z']=Math['atan2'](-m12,m22);}}else if(order===_0x22c1('0x94')){this['_z']=Math['asin'](clamp(m21,-0x1,0x1));if(Math['abs'](m21)<0.99999){this['_x']=Math['atan2'](-m23,m22);this['_y']=Math[_0x22c1('0x8b')](-m31,m11);}else{this['_x']=0x0;this['_y']=Math['atan2'](m13,m33);}}else if(order===_0x22c1('0x111')){this['_z']=Math['asin'](-clamp(m12,-0x1,0x1));if(Math['abs'](m12)<0.99999){this['_x']=Math[_0x22c1('0x8b')](m32,m22);this['_y']=Math[_0x22c1('0x8b')](m13,m11);}else{this['_x']=Math[_0x22c1('0x8b')](-m23,m33);this['_y']=0x0;}}else{console['warn'](_0x22c1('0x112')+order);}this[_0x22c1('0x10d')]=order;if(update!==![])this['onChangeCallback']();return this;},'setFromQuaternion':function(){var matrix=new Matrix4();return function setFromQuaternion(q,order,update){matrix['makeRotationFromQuaternion'](q);return this[_0x22c1('0x83')](matrix,order,update);};}(),'setFromVector3':function setFromVector3(v,order){return this[_0x22c1('0x5e')](v['x'],v['y'],v['z'],order||this[_0x22c1('0x10d')]);},'reorder':function(){var q=new Quaternion();return function reorder(newOrder){q[_0x22c1('0x8e')](this);return this['setFromQuaternion'](q,newOrder);};}(),'equals':function equals(euler){return euler['_x']===this['_x']&&euler['_y']===this['_y']&&euler['_z']===this['_z']&&euler[_0x22c1('0x10d')]===this['_order'];},'fromArray':function fromArray(array){this['_x']=array[0x0];this['_y']=array[0x1];this['_z']=array[0x2];if(array[0x3]!==undefined)this[_0x22c1('0x10d')]=array[0x3];this[_0x22c1('0x8c')]();return this;},'toArray':function toArray(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0x0;array[offset]=this['_x'];array[offset+0x1]=this['_y'];array[offset+0x2]=this['_z'];array[offset+0x3]=this[_0x22c1('0x10d')];return array;},'toVector3':function toVector3(optionalResult){if(optionalResult){return optionalResult[_0x22c1('0x5e')](this['_x'],this['_y'],this['_z']);}else{return new Vector3(this['_x'],this['_y'],this['_z']);}},'onChange':function onChange(callback){this[_0x22c1('0x8c')]=callback;return this;},'onChangeCallback':function onChangeCallback(){}});function Layers(){this[_0x22c1('0x113')]=0x1|0x0;}Object['assign'](Layers[_0x22c1('0x1')],{'set':function set(channel){this['mask']=0x1<<channel|0x0;},'enable':function enable(channel){this[_0x22c1('0x113')]|=0x1<<channel|0x0;},'toggle':function toggle(channel){this['mask']^=0x1<<channel|0x0;},'disable':function disable(channel){this[_0x22c1('0x113')]&=~(0x1<<channel|0x0);},'test':function test(layers){return(this['mask']&layers['mask'])!==0x0;}});var object3DId=0x0;function Object3D(){Object[_0x22c1('0x12')](this,'id',{'value':object3DId++});this[_0x22c1('0x114')]=_Math[_0x22c1('0x115')]();this[_0x22c1('0x116')]='';this[_0x22c1('0x1f')]='Object3D';this[_0x22c1('0x117')]=null;this['children']=[];this['up']=Object3D['DefaultUp'][_0x22c1('0x8d')]();var position=new Vector3();var rotation=new Euler();var quaternion=new Quaternion();var scale=new Vector3(0x1,0x1,0x1);function onRotationChange(){quaternion[_0x22c1('0x8e')](rotation,![]);}function onQuaternionChange(){rotation[_0x22c1('0x118')](quaternion,undefined,![]);}rotation[_0x22c1('0xa1')](onRotationChange);quaternion[_0x22c1('0xa1')](onQuaternionChange);Object['defineProperties'](this,{'position':{'configurable':!![],'enumerable':!![],'value':position},'rotation':{'configurable':!![],'enumerable':!![],'value':rotation},'quaternion':{'configurable':!![],'enumerable':!![],'value':quaternion},'scale':{'configurable':!![],'enumerable':!![],'value':scale},'modelViewMatrix':{'value':new Matrix4()},'normalMatrix':{'value':new Matrix3()}});this[_0x22c1('0x119')]=new Matrix4();this[_0x22c1('0xbb')]=new Matrix4();this[_0x22c1('0x11a')]=Object3D[_0x22c1('0x11b')];this['matrixWorldNeedsUpdate']=![];this['layers']=new Layers();this[_0x22c1('0x11c')]=!![];this['castShadow']=![];this[_0x22c1('0x11d')]=![];this['frustumCulled']=!![];this['renderOrder']=0x0;this[_0x22c1('0x11e')]={};}Object3D[_0x22c1('0x11f')]=new Vector3(0x0,0x1,0x0);Object3D['DefaultMatrixAutoUpdate']=!![];Object3D['prototype']=Object['assign'](Object[_0x22c1('0x13')](EventDispatcher[_0x22c1('0x1')]),{'constructor':Object3D,'isObject3D':!![],'onBeforeRender':function onBeforeRender(){},'onAfterRender':function onAfterRender(){},'applyMatrix':function applyMatrix(matrix){this[_0x22c1('0x119')][_0x22c1('0x6d')](matrix,this[_0x22c1('0x119')]);this[_0x22c1('0x119')]['decompose'](this[_0x22c1('0xee')],this[_0x22c1('0x120')],this[_0x22c1('0x77')]);},'applyQuaternion':function applyQuaternion(q){this[_0x22c1('0x120')]['premultiply'](q);return this;},'setRotationFromAxisAngle':function setRotationFromAxisAngle(axis,angle){this[_0x22c1('0x120')]['setFromAxisAngle'](axis,angle);},'setRotationFromEuler':function setRotationFromEuler(euler){this[_0x22c1('0x120')][_0x22c1('0x8e')](euler,!![]);},'setRotationFromMatrix':function setRotationFromMatrix(m){this[_0x22c1('0x120')][_0x22c1('0x83')](m);},'setRotationFromQuaternion':function setRotationFromQuaternion(q){this[_0x22c1('0x120')][_0x22c1('0x82')](q);},'rotateOnAxis':function(){var q1=new Quaternion();return function rotateOnAxis(axis,angle){q1[_0x22c1('0xb4')](axis,angle);this['quaternion']['multiply'](q1);return this;};}(),'translateOnAxis':function(){var v1=new Vector3();return function translateOnAxis(axis,distance){v1['copy'](axis)['applyQuaternion'](this[_0x22c1('0x120')]);this['position'][_0x22c1('0xc5')](v1[_0x22c1('0x6f')](distance));return this;};}(),'translateX':function(){var v1=new Vector3(0x1,0x0,0x0);return function translateX(distance){return this[_0x22c1('0x121')](v1,distance);};}(),'translateY':function(){var v1=new Vector3(0x0,0x1,0x0);return function translateY(distance){return this['translateOnAxis'](v1,distance);};}(),'translateZ':function(){var v1=new Vector3(0x0,0x0,0x1);return function translateZ(distance){return this[_0x22c1('0x121')](v1,distance);};}(),'localToWorld':function localToWorld(vector){return vector[_0x22c1('0xb7')](this[_0x22c1('0xbb')]);},'worldToLocal':function(){var m1=new Matrix4();return function worldToLocal(vector){return vector[_0x22c1('0xb7')](m1['getInverse'](this[_0x22c1('0xbb')]));};}(),'lookAt':function(){var q1=new Quaternion();var m1=new Matrix4();var target=new Vector3();var position=new Vector3();return function lookAt(x,y,z){if(x[_0x22c1('0xa2')]){target[_0x22c1('0x82')](x);}else{target[_0x22c1('0x5e')](x,y,z);}var parent=this[_0x22c1('0x117')];this[_0x22c1('0x122')](!![],![]);position['setFromMatrixPosition'](this[_0x22c1('0xbb')]);if(this[_0x22c1('0x123')]){m1[_0x22c1('0x66')](position,target,this['up']);}else{m1[_0x22c1('0x66')](target,position,this['up']);}this[_0x22c1('0x120')][_0x22c1('0x83')](m1);if(parent){m1[_0x22c1('0x63')](parent[_0x22c1('0xbb')]);q1['setFromRotationMatrix'](m1);this['quaternion'][_0x22c1('0x6e')](q1[_0x22c1('0x9a')]());}};}(),'add':function add(object){if(arguments[_0x22c1('0x32')]>0x1){for(var i=0x0;i<arguments[_0x22c1('0x32')];i++){this[_0x22c1('0xc5')](arguments[i]);}return this;}if(object===this){console[_0x22c1('0xb0')]('THREE.Object3D.add:\x20object\x20can\x27t\x20be\x20added\x20as\x20a\x20child\x20of\x20itself.',object);return this;}if(object&&object['isObject3D']){if(object[_0x22c1('0x117')]!==null){object[_0x22c1('0x117')][_0x22c1('0x124')](object);}object['parent']=this;object[_0x22c1('0x125')]({'type':_0x22c1('0x126')});this[_0x22c1('0x127')]['push'](object);}else{console[_0x22c1('0xb0')](_0x22c1('0x128'),object);}return this;},'remove':function remove(object){if(arguments[_0x22c1('0x32')]>0x1){for(var i=0x0;i<arguments['length'];i++){this[_0x22c1('0x124')](arguments[i]);}return this;}var index=this[_0x22c1('0x127')][_0x22c1('0x4a')](object);if(index!==-0x1){object[_0x22c1('0x117')]=null;object['dispatchEvent']({'type':_0x22c1('0x129')});this['children'][_0x22c1('0x12a')](index,0x1);}return this;},'getObjectById':function getObjectById(id){return this[_0x22c1('0x12b')]('id',id);},'getObjectByName':function getObjectByName(name){return this[_0x22c1('0x12b')]('name',name);},'getObjectByProperty':function getObjectByProperty(name,value){if(this[name]===value)return this;for(var i=0x0,l=this[_0x22c1('0x127')][_0x22c1('0x32')];i<l;i++){var child=this[_0x22c1('0x127')][i];var object=child['getObjectByProperty'](name,value);if(object!==undefined){return object;}}return undefined;},'getWorldPosition':function getWorldPosition(target){if(target===undefined){console['warn'](_0x22c1('0x12c'));target=new Vector3();}this['updateMatrixWorld'](!![]);return target['setFromMatrixPosition'](this[_0x22c1('0xbb')]);},'getWorldQuaternion':function(){var position=new Vector3();var scale=new Vector3();return function getWorldQuaternion(target){if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0x12d'));target=new Quaternion();}this[_0x22c1('0xef')](!![]);this['matrixWorld']['decompose'](position,target,scale);return target;};}(),'getWorldScale':function(){var position=new Vector3();var quaternion=new Quaternion();return function getWorldScale(target){if(target===undefined){console[_0x22c1('0x6b')]('THREE.Object3D:\x20.getWorldScale()\x20target\x20is\x20now\x20required');target=new Vector3();}this[_0x22c1('0xef')](!![]);this[_0x22c1('0xbb')][_0x22c1('0x80')](position,quaternion,target);return target;};}(),'getWorldDirection':function getWorldDirection(target){if(target===undefined){console['warn']('THREE.Object3D:\x20.getWorldDirection()\x20target\x20is\x20now\x20required');target=new Vector3();}this[_0x22c1('0xef')](!![]);var e=this[_0x22c1('0xbb')]['elements'];return target[_0x22c1('0x5e')](e[0x8],e[0x9],e[0xa])[_0x22c1('0x6a')]();},'raycast':function raycast(){},'traverse':function traverse(callback){callback(this);var children=this[_0x22c1('0x127')];for(var i=0x0,l=children['length'];i<l;i++){children[i][_0x22c1('0xf0')](callback);}},'traverseVisible':function traverseVisible(callback){if(this['visible']===![])return;callback(this);var children=this[_0x22c1('0x127')];for(var i=0x0,l=children[_0x22c1('0x32')];i<l;i++){children[i][_0x22c1('0x12e')](callback);}},'traverseAncestors':function traverseAncestors(callback){var parent=this[_0x22c1('0x117')];if(parent!==null){callback(parent);parent[_0x22c1('0x12f')](callback);}},'updateMatrix':function updateMatrix(){this[_0x22c1('0x119')][_0x22c1('0x65')](this[_0x22c1('0xee')],this[_0x22c1('0x120')],this[_0x22c1('0x77')]);this['matrixWorldNeedsUpdate']=!![];},'updateMatrixWorld':function updateMatrixWorld(force){if(this['matrixAutoUpdate'])this['updateMatrix']();if(this[_0x22c1('0x130')]||force){if(this[_0x22c1('0x117')]===null){this[_0x22c1('0xbb')][_0x22c1('0x82')](this[_0x22c1('0x119')]);}else{this['matrixWorld'][_0x22c1('0x6d')](this[_0x22c1('0x117')][_0x22c1('0xbb')],this[_0x22c1('0x119')]);}this[_0x22c1('0x130')]=![];force=!![];}var children=this['children'];for(var i=0x0,l=children['length'];i<l;i++){children[i][_0x22c1('0xef')](force);}},'updateWorldMatrix':function updateWorldMatrix(updateParents,updateChildren){var parent=this['parent'];if(updateParents===!![]&&parent!==null){parent[_0x22c1('0x122')](!![],![]);}if(this[_0x22c1('0x11a')])this[_0x22c1('0x131')]();if(this[_0x22c1('0x117')]===null){this[_0x22c1('0xbb')][_0x22c1('0x82')](this[_0x22c1('0x119')]);}else{this[_0x22c1('0xbb')][_0x22c1('0x6d')](this[_0x22c1('0x117')][_0x22c1('0xbb')],this[_0x22c1('0x119')]);}if(updateChildren===!![]){var children=this[_0x22c1('0x127')];for(var i=0x0,l=children[_0x22c1('0x32')];i<l;i++){children[i][_0x22c1('0x122')](![],!![]);}}},'toJSON':function toJSON(meta){var isRootObject=meta===undefined||typeof meta==='string';var output={};if(isRootObject){meta={'geometries':{},'materials':{},'textures':{},'images':{},'shapes':{}};output[_0x22c1('0x132')]={'version':4.5,'type':_0x22c1('0x133'),'generator':_0x22c1('0x134')};}var object={};object[_0x22c1('0x114')]=this[_0x22c1('0x114')];object[_0x22c1('0x1f')]=this[_0x22c1('0x1f')];if(this[_0x22c1('0x116')]!=='')object[_0x22c1('0x116')]=this[_0x22c1('0x116')];if(this['castShadow']===!![])object['castShadow']=!![];if(this[_0x22c1('0x11d')]===!![])object[_0x22c1('0x11d')]=!![];if(this[_0x22c1('0x11c')]===![])object[_0x22c1('0x11c')]=![];if(this[_0x22c1('0x135')]===![])object[_0x22c1('0x135')]=![];if(this['renderOrder']!==0x0)object[_0x22c1('0x136')]=this['renderOrder'];if(JSON[_0x22c1('0x137')](this[_0x22c1('0x11e')])!=='{}')object[_0x22c1('0x11e')]=this[_0x22c1('0x11e')];object[_0x22c1('0x138')]=this['layers'][_0x22c1('0x113')];object[_0x22c1('0x119')]=this[_0x22c1('0x119')][_0x22c1('0x86')]();if(this[_0x22c1('0x11a')]===![])object['matrixAutoUpdate']=![];function serialize(library,element){if(library[element[_0x22c1('0x114')]]===undefined){library[element[_0x22c1('0x114')]]=element['toJSON'](meta);}return element['uuid'];}if(this[_0x22c1('0x139')]||this[_0x22c1('0x13a')]||this[_0x22c1('0x13b')]){object[_0x22c1('0xe9')]=serialize(meta[_0x22c1('0x13c')],this[_0x22c1('0xe9')]);var parameters=this[_0x22c1('0xe9')][_0x22c1('0x13d')];if(parameters!==undefined&&parameters['shapes']!==undefined){var shapes=parameters[_0x22c1('0x13e')];if(Array[_0x22c1('0xd4')](shapes)){for(var i=0x0,l=shapes['length'];i<l;i++){var shape=shapes[i];serialize(meta[_0x22c1('0x13e')],shape);}}else{serialize(meta[_0x22c1('0x13e')],shapes);}}}if(this[_0x22c1('0x13f')]!==undefined){if(Array[_0x22c1('0xd4')](this[_0x22c1('0x13f')])){var uuids=[];for(var i=0x0,l=this[_0x22c1('0x13f')][_0x22c1('0x32')];i<l;i++){uuids['push'](serialize(meta[_0x22c1('0x140')],this[_0x22c1('0x13f')][i]));}object['material']=uuids;}else{object[_0x22c1('0x13f')]=serialize(meta[_0x22c1('0x140')],this[_0x22c1('0x13f')]);}}if(this[_0x22c1('0x127')]['length']>0x0){object[_0x22c1('0x127')]=[];for(var i=0x0;i<this[_0x22c1('0x127')][_0x22c1('0x32')];i++){object[_0x22c1('0x127')][_0x22c1('0x2e')](this[_0x22c1('0x127')][i][_0x22c1('0x141')](meta)['object']);}}if(isRootObject){var geometries=extractFromCache(meta[_0x22c1('0x13c')]);var materials=extractFromCache(meta[_0x22c1('0x140')]);var textures=extractFromCache(meta[_0x22c1('0x142')]);var images=extractFromCache(meta[_0x22c1('0x143')]);var shapes=extractFromCache(meta[_0x22c1('0x13e')]);if(geometries['length']>0x0)output[_0x22c1('0x13c')]=geometries;if(materials[_0x22c1('0x32')]>0x0)output[_0x22c1('0x140')]=materials;if(textures['length']>0x0)output[_0x22c1('0x142')]=textures;if(images['length']>0x0)output[_0x22c1('0x143')]=images;if(shapes[_0x22c1('0x32')]>0x0)output[_0x22c1('0x13e')]=shapes;}output[_0x22c1('0x46')]=object;return output;function extractFromCache(cache){var values=[];for(var key in cache){var data=cache[key];delete data[_0x22c1('0x132')];values[_0x22c1('0x2e')](data);}return values;}},'clone':function clone(recursive){return new this['constructor']()[_0x22c1('0x82')](this,recursive);},'copy':function copy(source,recursive){if(recursive===undefined)recursive=!![];this['name']=source[_0x22c1('0x116')];this['up'][_0x22c1('0x82')](source['up']);this[_0x22c1('0xee')][_0x22c1('0x82')](source['position']);this[_0x22c1('0x120')][_0x22c1('0x82')](source[_0x22c1('0x120')]);this['scale']['copy'](source[_0x22c1('0x77')]);this['matrix'][_0x22c1('0x82')](source[_0x22c1('0x119')]);this['matrixWorld'][_0x22c1('0x82')](source['matrixWorld']);this[_0x22c1('0x11a')]=source[_0x22c1('0x11a')];this[_0x22c1('0x130')]=source[_0x22c1('0x130')];this[_0x22c1('0x138')]['mask']=source[_0x22c1('0x138')][_0x22c1('0x113')];this['visible']=source[_0x22c1('0x11c')];this[_0x22c1('0x144')]=source[_0x22c1('0x144')];this['receiveShadow']=source[_0x22c1('0x11d')];this['frustumCulled']=source[_0x22c1('0x135')];this['renderOrder']=source[_0x22c1('0x136')];this[_0x22c1('0x11e')]=JSON['parse'](JSON[_0x22c1('0x137')](source[_0x22c1('0x11e')]));if(recursive===!![]){for(var i=0x0;i<source[_0x22c1('0x127')][_0x22c1('0x32')];i++){var child=source[_0x22c1('0x127')][i];this[_0x22c1('0xc5')](child[_0x22c1('0x8d')]());}}return this;}});var arrayLikeToArray=createCommonjsModule(function(module){function _arrayLikeToArray(arr,len){if(len==null||len>arr[_0x22c1('0x32')])len=arr[_0x22c1('0x32')];for(var i=0x0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}module[_0x22c1('0x3')]=_arrayLikeToArray,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});unwrapExports(arrayLikeToArray);var arrayWithoutHoles=createCommonjsModule(function(module){function _arrayWithoutHoles(arr){if(Array[_0x22c1('0xd4')](arr))return arrayLikeToArray(arr);}module[_0x22c1('0x3')]=_arrayWithoutHoles,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module[_0x22c1('0x3')];});unwrapExports(arrayWithoutHoles);var iterableToArray=createCommonjsModule(function(module){function _iterableToArray(iter){if(typeof Symbol!==_0x22c1('0x0')&&iter[Symbol[_0x22c1('0xc')]]!=null||iter[_0x22c1('0xe')]!=null)return Array[_0x22c1('0x145')](iter);}module[_0x22c1('0x3')]=_iterableToArray,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});unwrapExports(iterableToArray);var unsupportedIterableToArray=createCommonjsModule(function(module){function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===_0x22c1('0x146'))return arrayLikeToArray(o,minLen);var n=Object[_0x22c1('0x1')][_0x22c1('0x50')][_0x22c1('0x2')](o)[_0x22c1('0x40')](0x8,-0x1);if(n===_0x22c1('0x133')&&o['constructor'])n=o[_0x22c1('0xd')][_0x22c1('0x116')];if(n===_0x22c1('0x147')||n==='Set')return Array['from'](o);if(n===_0x22c1('0x148')||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/[_0x22c1('0x149')](n))return arrayLikeToArray(o,minLen);}module[_0x22c1('0x3')]=_unsupportedIterableToArray,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module['exports'];});unwrapExports(unsupportedIterableToArray);var nonIterableSpread=createCommonjsModule(function(module){function _nonIterableSpread(){throw new TypeError(_0x22c1('0x14a'));}module[_0x22c1('0x3')]=_nonIterableSpread,module[_0x22c1('0x3')]['__esModule']=!![],module[_0x22c1('0x3')]['default']=module[_0x22c1('0x3')];});unwrapExports(nonIterableSpread);var toConsumableArray=createCommonjsModule(function(module){function _toConsumableArray(arr){return arrayWithoutHoles(arr)||iterableToArray(arr)||unsupportedIterableToArray(arr)||nonIterableSpread();}module[_0x22c1('0x3')]=_toConsumableArray,module['exports'][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});var _toConsumableArray=unwrapExports(toConsumableArray);var defineProperty=createCommonjsModule(function(module){function _defineProperty(obj,key,value){if(key in obj){Object[_0x22c1('0x12')](obj,key,{'value':value,'enumerable':!![],'configurable':!![],'writable':!![]});}else{obj[key]=value;}return obj;}module[_0x22c1('0x3')]=_defineProperty,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});var _defineProperty=unwrapExports(defineProperty);var arrayWithHoles=createCommonjsModule(function(module){function _arrayWithHoles(arr){if(Array[_0x22c1('0xd4')](arr))return arr;}module[_0x22c1('0x3')]=_arrayWithHoles,module[_0x22c1('0x3')]['__esModule']=!![],module[_0x22c1('0x3')]['default']=module['exports'];});unwrapExports(arrayWithHoles);var iterableToArrayLimit=createCommonjsModule(function(module){function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!==_0x22c1('0x0')&&arr[Symbol['iterator']]||arr[_0x22c1('0xe')];if(_i==null)return;var _arr=[];var _n=!![];var _d=![];var _s,_e;try{for(_i=_i[_0x22c1('0x2')](arr);!(_n=(_s=_i[_0x22c1('0x29')]())[_0x22c1('0x6')]);_n=!![]){_arr['push'](_s['value']);if(i&&_arr[_0x22c1('0x32')]===i)break;}}catch(_0x5e2bc4){_d=!![];_e=_0x5e2bc4;}finally{try{if(!_n&&_i[_0x22c1('0x1d')]!=null)_i[_0x22c1('0x1d')]();}finally{if(_d)throw _e;}}return _arr;}module[_0x22c1('0x3')]=_iterableToArrayLimit,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module['exports'];});unwrapExports(iterableToArrayLimit);var nonIterableRest=createCommonjsModule(function(module){function _nonIterableRest(){throw new TypeError(_0x22c1('0x14b'));}module['exports']=_nonIterableRest,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module['exports'];});unwrapExports(nonIterableRest);var slicedToArray=createCommonjsModule(function(module){function _slicedToArray(arr,i){return arrayWithHoles(arr)||iterableToArrayLimit(arr,i)||unsupportedIterableToArray(arr,i)||nonIterableRest();}module['exports']=_slicedToArray,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module[_0x22c1('0x3')];});var _slicedToArray=unwrapExports(slicedToArray);var s=0x3e8;var m=s*0x3c;var h=m*0x3c;var d=h*0x18;var w=d*0x7;var y=d*365.25;var ms=function ms(val,options){options=options||{};var type=_typeof(val);if(type===_0x22c1('0x146')&&val[_0x22c1('0x32')]>0x0){return parse(val);}else if(type==='number'&&isFinite(val)){return options['long']?fmtLong(val):fmtShort(val);}throw new Error(_0x22c1('0x14c')+JSON[_0x22c1('0x137')](val));};function parse(str){str=String(str);if(str[_0x22c1('0x32')]>0x64){return;}var match=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i['exec'](str);if(!match){return;}var n=parseFloat(match[0x1]);var type=(match[0x2]||'ms')['toLowerCase']();switch(type){case'years':case _0x22c1('0x14d'):case _0x22c1('0x14e'):case'yr':case'y':return n*y;case'weeks':case _0x22c1('0x14f'):case'w':return n*w;case _0x22c1('0x150'):case'day':case'd':return n*d;case _0x22c1('0x151'):case'hour':case _0x22c1('0x152'):case'hr':case'h':return n*h;case'minutes':case _0x22c1('0x153'):case _0x22c1('0x154'):case _0x22c1('0x54'):case'm':return n*m;case _0x22c1('0x155'):case _0x22c1('0x156'):case'secs':case _0x22c1('0x157'):case's':return n*s;case _0x22c1('0x158'):case _0x22c1('0x159'):case'msecs':case'msec':case'ms':return n;default:return undefined;}}function fmtShort(ms){var msAbs=Math['abs'](ms);if(msAbs>=d){return Math[_0x22c1('0xc0')](ms/d)+'d';}if(msAbs>=h){return Math['round'](ms/h)+'h';}if(msAbs>=m){return Math[_0x22c1('0xc0')](ms/m)+'m';}if(msAbs>=s){return Math[_0x22c1('0xc0')](ms/s)+'s';}return ms+'ms';}function fmtLong(ms){var msAbs=Math[_0x22c1('0x69')](ms);if(msAbs>=d){return plural(ms,msAbs,d,_0x22c1('0x15a'));}if(msAbs>=h){return plural(ms,msAbs,h,'hour');}if(msAbs>=m){return plural(ms,msAbs,m,_0x22c1('0x153'));}if(msAbs>=s){return plural(ms,msAbs,s,_0x22c1('0x156'));}return ms+_0x22c1('0x15b');}function plural(ms,msAbs,n,name){var isPlural=msAbs>=n*1.5;return Math[_0x22c1('0xc0')](ms/n)+'\x20'+name+(isPlural?'s':'');}function setup(env){createDebug['debug']=createDebug;createDebug[_0x22c1('0x4')]=createDebug;createDebug[_0x22c1('0x15c')]=coerce;createDebug['disable']=disable;createDebug[_0x22c1('0x15d')]=enable;createDebug['enabled']=enabled;createDebug['humanize']=ms;createDebug[_0x22c1('0x15e')]=destroy;Object['keys'](env)[_0x22c1('0x22')](function(key){createDebug[key]=env[key];});createDebug[_0x22c1('0x15f')]=[];createDebug[_0x22c1('0x160')]=[];createDebug[_0x22c1('0x161')]={};function selectColor(namespace){var hash=0x0;for(var i=0x0;i<namespace[_0x22c1('0x32')];i++){hash=(hash<<0x5)-hash+namespace[_0x22c1('0x162')](i);hash|=0x0;}return createDebug[_0x22c1('0x163')][Math['abs'](hash)%createDebug[_0x22c1('0x163')][_0x22c1('0x32')]];}createDebug[_0x22c1('0x164')]=selectColor;function createDebug(namespace){var prevTime;var enableOverride=null;var namespacesCache;var enabledCache;function debug(){for(var _len=arguments['length'],args=new Array(_len),_key=0x0;_key<_len;_key++){args[_key]=arguments[_key];}if(!debug[_0x22c1('0x165')]){return;}var self=debug;var curr=Number(new Date());var ms=curr-(prevTime||curr);self[_0x22c1('0x166')]=ms;self['prev']=prevTime;self[_0x22c1('0x167')]=curr;prevTime=curr;args[0x0]=createDebug['coerce'](args[0x0]);if(typeof args[0x0]!==_0x22c1('0x146')){args[_0x22c1('0x168')]('%O');}var index=0x0;args[0x0]=args[0x0][_0x22c1('0x169')](/%([a-zA-Z%])/g,function(match,format){if(match==='%%'){return'%';}index++;var formatter=createDebug[_0x22c1('0x161')][format];if(typeof formatter==='function'){var val=args[index];match=formatter[_0x22c1('0x2')](self,val);args[_0x22c1('0x12a')](index,0x1);index--;}return match;});createDebug[_0x22c1('0x16a')]['call'](self,args);var logFn=self[_0x22c1('0x59')]||createDebug[_0x22c1('0x59')];logFn[_0x22c1('0x7')](self,args);}debug['namespace']=namespace;debug[_0x22c1('0x16b')]=createDebug['useColors']();debug['color']=createDebug['selectColor'](namespace);debug['extend']=extend;debug[_0x22c1('0x15e')]=createDebug['destroy'];Object[_0x22c1('0x12')](debug,_0x22c1('0x165'),{'enumerable':!![],'configurable':![],'get':function get(){if(enableOverride!==null){return enableOverride;}if(namespacesCache!==createDebug[_0x22c1('0x16c')]){namespacesCache=createDebug[_0x22c1('0x16c')];enabledCache=createDebug[_0x22c1('0x165')](namespace);}return enabledCache;},'set':function set(v){enableOverride=v;}});if(typeof createDebug[_0x22c1('0x16d')]==='function'){createDebug['init'](debug);}return debug;}function extend(namespace,delimiter){var newDebug=createDebug(this[_0x22c1('0x16e')]+(typeof delimiter===_0x22c1('0x0')?':':delimiter)+namespace);newDebug['log']=this['log'];return newDebug;}function enable(namespaces){createDebug[_0x22c1('0x16f')](namespaces);createDebug['namespaces']=namespaces;createDebug[_0x22c1('0x15f')]=[];createDebug['skips']=[];var i;var split=(typeof namespaces===_0x22c1('0x146')?namespaces:'')[_0x22c1('0x170')](/[\s,]+/);var len=split[_0x22c1('0x32')];for(i=0x0;i<len;i++){if(!split[i]){continue;}namespaces=split[i]['replace'](/\*/g,'.*?');if(namespaces[0x0]==='-'){createDebug[_0x22c1('0x160')][_0x22c1('0x2e')](new RegExp('^'+namespaces[_0x22c1('0x40')](0x1)+'$'));}else{createDebug[_0x22c1('0x15f')]['push'](new RegExp('^'+namespaces+'$'));}}}function disable(){var namespaces=[][_0x22c1('0x171')](_toConsumableArray(createDebug[_0x22c1('0x15f')][_0x22c1('0x172')](toNamespace)),_toConsumableArray(createDebug[_0x22c1('0x160')][_0x22c1('0x172')](toNamespace)['map'](function(namespace){return'-'+namespace;})))[_0x22c1('0x173')](',');createDebug['enable']('');return namespaces;}function enabled(name){if(name[name['length']-0x1]==='*'){return!![];}var i;var len;for(i=0x0,len=createDebug[_0x22c1('0x160')][_0x22c1('0x32')];i<len;i++){if(createDebug['skips'][i]['test'](name)){return![];}}for(i=0x0,len=createDebug[_0x22c1('0x15f')]['length'];i<len;i++){if(createDebug['names'][i][_0x22c1('0x149')](name)){return!![];}}return![];}function toNamespace(regexp){return regexp['toString']()[_0x22c1('0x174')](0x2,regexp['toString']()[_0x22c1('0x32')]-0x2)[_0x22c1('0x169')](/\.\*\?$/,'*');}function coerce(val){if(val instanceof Error){return val[_0x22c1('0x175')]||val[_0x22c1('0x176')];}return val;}function destroy(){console[_0x22c1('0x6b')](_0x22c1('0x177'));}createDebug['enable'](createDebug['load']());return createDebug;}var common=setup;var browser=createCommonjsModule(function(module,exports){exports[_0x22c1('0x16a')]=formatArgs;exports[_0x22c1('0x16f')]=save;exports[_0x22c1('0x178')]=load;exports['useColors']=useColors;exports[_0x22c1('0x179')]=localstorage();exports[_0x22c1('0x15e')]=function(){var warned=![];return function(){if(!warned){warned=!![];console[_0x22c1('0x6b')](_0x22c1('0x177'));}};}();exports[_0x22c1('0x163')]=[_0x22c1('0x17a'),_0x22c1('0x17b'),'#0033CC','#0033FF',_0x22c1('0x17c'),_0x22c1('0x17d'),'#0099CC',_0x22c1('0x17e'),_0x22c1('0x17f'),_0x22c1('0x180'),_0x22c1('0x181'),_0x22c1('0x182'),_0x22c1('0x183'),_0x22c1('0x184'),_0x22c1('0x185'),_0x22c1('0x186'),_0x22c1('0x187'),_0x22c1('0x188'),_0x22c1('0x189'),_0x22c1('0x18a'),_0x22c1('0x18b'),'#3399FF',_0x22c1('0x18c'),'#33CC33',_0x22c1('0x18d'),_0x22c1('0x18e'),_0x22c1('0x18f'),_0x22c1('0x190'),_0x22c1('0x191'),_0x22c1('0x192'),_0x22c1('0x193'),_0x22c1('0x194'),_0x22c1('0x195'),_0x22c1('0x196'),'#9900CC',_0x22c1('0x197'),_0x22c1('0x198'),_0x22c1('0x199'),'#99CC00',_0x22c1('0x19a'),_0x22c1('0x19b'),_0x22c1('0x19c'),'#CC0066',_0x22c1('0x19d'),_0x22c1('0x19e'),'#CC00FF',_0x22c1('0x19f'),'#CC3333',_0x22c1('0x1a0'),_0x22c1('0x1a1'),'#CC33CC','#CC33FF',_0x22c1('0x1a2'),_0x22c1('0x1a3'),_0x22c1('0x1a4'),_0x22c1('0x1a5'),'#CCCC00',_0x22c1('0x1a6'),_0x22c1('0x1a7'),'#FF0033','#FF0066',_0x22c1('0x1a8'),'#FF00CC',_0x22c1('0x1a9'),_0x22c1('0x1aa'),_0x22c1('0x1ab'),_0x22c1('0x1ac'),_0x22c1('0x1ad'),_0x22c1('0x1ae'),_0x22c1('0x1af'),_0x22c1('0x1b0'),_0x22c1('0x1b1'),_0x22c1('0x1b2'),'#FF9933','#FFCC00',_0x22c1('0x1b3')];function useColors(){if(typeof window!==_0x22c1('0x0')&&window[_0x22c1('0x1b4')]&&(window[_0x22c1('0x1b4')][_0x22c1('0x1f')]===_0x22c1('0x1b5')||window['process']['__nwjs'])){return!![];}if(typeof navigator!==_0x22c1('0x0')&&navigator[_0x22c1('0x1b6')]&&navigator[_0x22c1('0x1b6')][_0x22c1('0x1b7')]()[_0x22c1('0x1b8')](/(edge|trident)\/(\d+)/)){return![];}return typeof document!==_0x22c1('0x0')&&document[_0x22c1('0x1b9')]&&document[_0x22c1('0x1b9')][_0x22c1('0x1ba')]&&document[_0x22c1('0x1b9')][_0x22c1('0x1ba')][_0x22c1('0x1bb')]||typeof window!==_0x22c1('0x0')&&window['console']&&(window[_0x22c1('0x1bc')][_0x22c1('0x1bd')]||window[_0x22c1('0x1bc')][_0x22c1('0x1be')]&&window['console']['table'])||typeof navigator!==_0x22c1('0x0')&&navigator['userAgent']&&navigator[_0x22c1('0x1b6')][_0x22c1('0x1b7')]()[_0x22c1('0x1b8')](/firefox\/(\d+)/)&&parseInt(RegExp['$1'],0xa)>=0x1f||typeof navigator!==_0x22c1('0x0')&&navigator[_0x22c1('0x1b6')]&&navigator[_0x22c1('0x1b6')][_0x22c1('0x1b7')]()[_0x22c1('0x1b8')](/applewebkit\/(\d+)/);}function formatArgs(args){args[0x0]=(this[_0x22c1('0x16b')]?'%c':'')+this[_0x22c1('0x16e')]+(this[_0x22c1('0x16b')]?'\x20%c':'\x20')+args[0x0]+(this[_0x22c1('0x16b')]?_0x22c1('0x1bf'):'\x20')+'+'+module['exports'][_0x22c1('0x1c0')](this[_0x22c1('0x166')]);if(!this['useColors']){return;}var c='color:\x20'+this[_0x22c1('0x1c1')];args[_0x22c1('0x12a')](0x1,0x0,c,_0x22c1('0x1c2'));var index=0x0;var lastC=0x0;args[0x0][_0x22c1('0x169')](/%[a-zA-Z%]/g,function(match){if(match==='%%'){return;}index++;if(match==='%c'){lastC=index;}});args[_0x22c1('0x12a')](lastC,0x0,c);}exports[_0x22c1('0x59')]=console[_0x22c1('0x1c3')]||console[_0x22c1('0x59')]||function(){};function save(namespaces){try{if(namespaces){exports[_0x22c1('0x179')]['setItem'](_0x22c1('0x1c3'),namespaces);}else{exports['storage']['removeItem'](_0x22c1('0x1c3'));}}catch(_0x495b53){}}function load(){var r;try{r=exports[_0x22c1('0x179')][_0x22c1('0x1c4')](_0x22c1('0x1c3'));}catch(_0x3ae2f0){}if(!r&&typeof process!=='undefined'&&'env'in process){r=process[_0x22c1('0x1c5')][_0x22c1('0x1c6')];}return r;}function localstorage(){try{return localStorage;}catch(_0xbb8d23){}}module[_0x22c1('0x3')]=common(exports);var formatters=module['exports']['formatters'];formatters['j']=function(v){try{return JSON[_0x22c1('0x137')](v);}catch(_0x85521e){return _0x22c1('0x1c7')+_0x85521e[_0x22c1('0x176')];}};});var browser_1=browser['formatArgs'];var browser_2=browser[_0x22c1('0x16f')];var browser_3=browser[_0x22c1('0x178')];var browser_4=browser[_0x22c1('0x16b')];var browser_5=browser[_0x22c1('0x179')];var browser_6=browser[_0x22c1('0x15e')];var browser_7=browser['colors'];var browser_8=browser[_0x22c1('0x59')];var PACKAGE_NAME=_0x22c1('0x1c8');var VERSION=_0x22c1('0x1c9');var AI_PARAMS_MAP={'fontSize':_0x22c1('0x1ca'),'fontWeight':_0x22c1('0x1cb'),'extrudeDepth':_0x22c1('0x1cc'),'quadEllipse':'quad_ellipse','halfEllipse':_0x22c1('0x1cd'),'triangulateMethod':_0x22c1('0x1ce'),'curveSegments':'curveSegmentsAdaptive'};function initTextGeometryOptions(options){var defaults=arguments['length']>0x1&&arguments[0x1]!==undefined?arguments[0x1]:{};Object[_0x22c1('0x3b')](defaults)[_0x22c1('0x22')](function(key){if(typeof options[key]===_0x22c1('0x0')){options[key]=defaults[key];}});return options;}function replaceWithMap(data,map){return Object[_0x22c1('0x1cf')](data)[_0x22c1('0x172')](function(_ref){var _ref2=_slicedToArray(_ref,0x2),key=_ref2[0x0],value=_ref2[0x1];return[map[key]||key,map[value]||value];})[_0x22c1('0x1d0')](function(options,entry){return Object[_0x22c1('0x48')](options,_defineProperty({},entry[0x0],entry[0x1]));},{});}var debug={'rootName':PACKAGE_NAME,'_store':new Map(),'_createDebug':function _createDebug(){var name=arguments[_0x22c1('0x32')]>0x0&&arguments[0x0]!==undefined?arguments[0x0]:'';return browser([this['rootName'],name][_0x22c1('0x173')](':'));},'_fire':function _fire(debug){for(var _len=arguments[_0x22c1('0x32')],data=new Array(_len>0x1?_len-0x1:0x0),_key=0x1;_key<_len;_key++){data[_key-0x1]=arguments[_key];}debug[_0x22c1('0x7')](void 0x0,[data[0x0]||''][_0x22c1('0x171')](_toConsumableArray(data[_0x22c1('0x40')](0x1))));},'log':function log(msg){for(var _len2=arguments[_0x22c1('0x32')],data=new Array(_len2>0x1?_len2-0x1:0x0),_key2=0x1;_key2<_len2;_key2++){data[_key2-0x1]=arguments[_key2];}this[_0x22c1('0x1d1')][_0x22c1('0x7')](this,[this[_0x22c1('0x1d2')](msg)][_0x22c1('0x171')](data));},'time':function time(msg){var debug=this[_0x22c1('0x1d2')](msg);if(this[_0x22c1('0x1d3')]['get'](msg)){console[_0x22c1('0x6b')](_0x22c1('0x1d4')[_0x22c1('0x171')](msg,_0x22c1('0x1d5')));}this[_0x22c1('0x1d3')][_0x22c1('0x5e')](msg,debug);for(var _len3=arguments[_0x22c1('0x32')],data=new Array(_len3>0x1?_len3-0x1:0x0),_key3=0x1;_key3<_len3;_key3++){data[_key3-0x1]=arguments[_key3];}this[_0x22c1('0x1d1')][_0x22c1('0x7')](this,[debug]['concat'](data));},'timeEnd':function timeEnd(msg){var debug=this[_0x22c1('0x1d3')][_0x22c1('0x1d6')](msg);if(debug){for(var _len4=arguments[_0x22c1('0x32')],data=new Array(_len4>0x1?_len4-0x1:0x0),_key4=0x1;_key4<_len4;_key4++){data[_key4-0x1]=arguments[_key4];}this[_0x22c1('0x1d1')]['apply'](this,[debug][_0x22c1('0x171')](data));this[_0x22c1('0x1d3')][_0x22c1('0x5e')](msg,null);}else{console[_0x22c1('0x6b')](_0x22c1('0x1d4')[_0x22c1('0x171')](msg,_0x22c1('0x1d7')));}}};var geometryId=0x0;function Geometry(){Object['defineProperty'](this,'id',{'value':geometryId+=0x2});this[_0x22c1('0x114')]=_Math[_0x22c1('0x115')]();this['name']='';this['type']=_0x22c1('0x1d8');this[_0x22c1('0xeb')]=[];this[_0x22c1('0x1d9')]=[];this[_0x22c1('0x1da')]=[[]];this[_0x22c1('0x1db')]=[];this[_0x22c1('0x1dc')]=[];this['skinWeights']=[];this[_0x22c1('0x1dd')]=[];this['lineDistances']=[];this['boundingBox']=null;this['boundingSphere']=null;this[_0x22c1('0x1de')]=![];this[_0x22c1('0x1df')]=![];this[_0x22c1('0x1e0')]=![];this[_0x22c1('0x1e1')]=![];this[_0x22c1('0x1e2')]=![];this[_0x22c1('0x1e3')]=![];}Geometry[_0x22c1('0x1')]=Object[_0x22c1('0x48')](Object[_0x22c1('0x13')](EventDispatcher['prototype']),{'constructor':Geometry,'isGeometry':!![],'applyMatrix':function applyMatrix(matrix){var normalMatrix=new Matrix3()['getNormalMatrix'](matrix);for(var i=0x0,il=this[_0x22c1('0xeb')][_0x22c1('0x32')];i<il;i++){var vertex=this[_0x22c1('0xeb')][i];vertex[_0x22c1('0xb7')](matrix);}for(var i=0x0,il=this[_0x22c1('0x1d9')][_0x22c1('0x32')];i<il;i++){var face=this[_0x22c1('0x1d9')][i];face['normal'][_0x22c1('0x104')](normalMatrix)['normalize']();for(var j=0x0,jl=face['vertexNormals'][_0x22c1('0x32')];j<jl;j++){face[_0x22c1('0xd3')][j]['applyMatrix3'](normalMatrix)[_0x22c1('0x6a')]();}}if(this[_0x22c1('0x1e4')]!==null){this[_0x22c1('0x1e5')]();}if(this[_0x22c1('0x1e6')]!==null){this[_0x22c1('0x1e7')]();}this[_0x22c1('0x1df')]=!![];this[_0x22c1('0x1e1')]=!![];return this;},'fromBufferGeometry':function fromBufferGeometry(geometry){var scope=this;var indices=geometry[_0x22c1('0x1e8')]!==null?geometry[_0x22c1('0x1e8')][_0x22c1('0x1e9')]:undefined;var attributes=geometry[_0x22c1('0xed')];var positions=attributes[_0x22c1('0xee')][_0x22c1('0x1e9')];var normals=attributes[_0x22c1('0x1e')]!==undefined?attributes[_0x22c1('0x1e')][_0x22c1('0x1e9')]:undefined;var uvs=attributes['uv']!==undefined?attributes['uv'][_0x22c1('0x1e9')]:undefined;var uvs2=attributes[_0x22c1('0x1ea')]!==undefined?attributes[_0x22c1('0x1ea')][_0x22c1('0x1e9')]:undefined;if(uvs2!==undefined)this[_0x22c1('0x1da')][0x1]=[];for(var i=0x0,j=0x0;i<positions[_0x22c1('0x32')];i+=0x3,j+=0x2){scope['vertices']['push'](new Vector3()[_0x22c1('0xa0')](positions,i));}function addFace(a,b,c,materialIndex){var vertexNormals=normals===undefined?[]:[new Vector3()['fromArray'](normals,a*0x3),new Vector3()[_0x22c1('0xa0')](normals,b*0x3),new Vector3()[_0x22c1('0xa0')](normals,c*0x3)];var face=new Face3(a,b,c,vertexNormals,materialIndex);scope[_0x22c1('0x1d9')][_0x22c1('0x2e')](face);if(uvs!==undefined){scope[_0x22c1('0x1da')][0x0]['push']([new Vector2()[_0x22c1('0xa0')](uvs,a*0x2),new Vector2()['fromArray'](uvs,b*0x2),new Vector2()[_0x22c1('0xa0')](uvs,c*0x2)]);}if(uvs2!==undefined){scope[_0x22c1('0x1da')][0x1][_0x22c1('0x2e')]([new Vector2()['fromArray'](uvs2,a*0x2),new Vector2()[_0x22c1('0xa0')](uvs2,b*0x2),new Vector2()[_0x22c1('0xa0')](uvs2,c*0x2)]);}}var groups=geometry['groups'];if(groups[_0x22c1('0x32')]>0x0){for(var i=0x0;i<groups[_0x22c1('0x32')];i++){var group=groups[i];var start=group['start'];var count=group['count'];for(var j=start,jl=start+count;j<jl;j+=0x3){if(indices!==undefined){addFace(indices[j],indices[j+0x1],indices[j+0x2],group[_0x22c1('0xd5')]);}else{addFace(j,j+0x1,j+0x2,group[_0x22c1('0xd5')]);}}}}else{if(indices!==undefined){for(var i=0x0;i<indices[_0x22c1('0x32')];i+=0x3){addFace(indices[i],indices[i+0x1],indices[i+0x2]);}}else{for(var i=0x0;i<positions['length']/0x3;i+=0x3){addFace(i,i+0x1,i+0x2);}}}this['computeFaceNormals']();if(geometry[_0x22c1('0x1e4')]!==null){this[_0x22c1('0x1e4')]=geometry[_0x22c1('0x1e4')][_0x22c1('0x8d')]();}if(geometry[_0x22c1('0x1e6')]!==null){this[_0x22c1('0x1e6')]=geometry[_0x22c1('0x1e6')]['clone']();}return this;},'center':function(){var offset=new Vector3();return function center(){this[_0x22c1('0x1e5')]();this[_0x22c1('0x1e4')][_0x22c1('0xe4')](offset)[_0x22c1('0xc2')]();this[_0x22c1('0xdb')](offset['x'],offset['y'],offset['z']);return this;};}(),'normalize':function normalize(){this[_0x22c1('0x1e7')]();var center=this[_0x22c1('0x1e6')][_0x22c1('0xf9')];var radius=this[_0x22c1('0x1e6')]['radius'];var s=radius===0x0?0x1:0x1/radius;var matrix=new Matrix4();matrix[_0x22c1('0x5e')](s,0x0,0x0,-s*center['x'],0x0,s,0x0,-s*center['y'],0x0,0x0,s,-s*center['z'],0x0,0x0,0x0,0x1);this[_0x22c1('0x1eb')](matrix);return this;},'computeFaceNormals':function computeFaceNormals(){var cb=new Vector3();var ab=new Vector3();for(var f=0x0,fl=this[_0x22c1('0x1d9')][_0x22c1('0x32')];f<fl;f++){var face=this[_0x22c1('0x1d9')][f];var vA=this[_0x22c1('0xeb')][face['a']];var vB=this[_0x22c1('0xeb')][face['b']];var vC=this[_0x22c1('0xeb')][face['c']];cb[_0x22c1('0xad')](vC,vB);ab[_0x22c1('0xad')](vA,vB);cb['cross'](ab);cb[_0x22c1('0x6a')]();face[_0x22c1('0x1e')]['copy'](cb);}},'computeVertexNormals':function computeVertexNormals(areaWeighted){if(areaWeighted===undefined)areaWeighted=!![];var v,vl,f,fl,face,vertices;vertices=new Array(this[_0x22c1('0xeb')][_0x22c1('0x32')]);for(v=0x0,vl=this[_0x22c1('0xeb')]['length'];v<vl;v++){vertices[v]=new Vector3();}if(areaWeighted){var vA,vB,vC;var cb=new Vector3();var ab=new Vector3();for(f=0x0,fl=this[_0x22c1('0x1d9')][_0x22c1('0x32')];f<fl;f++){face=this[_0x22c1('0x1d9')][f];vA=this[_0x22c1('0xeb')][face['a']];vB=this[_0x22c1('0xeb')][face['b']];vC=this[_0x22c1('0xeb')][face['c']];cb[_0x22c1('0xad')](vC,vB);ab[_0x22c1('0xad')](vA,vB);cb[_0x22c1('0x105')](ab);vertices[face['a']][_0x22c1('0xc5')](cb);vertices[face['b']]['add'](cb);vertices[face['c']]['add'](cb);}}else{this[_0x22c1('0x1ec')]();for(f=0x0,fl=this[_0x22c1('0x1d9')][_0x22c1('0x32')];f<fl;f++){face=this['faces'][f];vertices[face['a']][_0x22c1('0xc5')](face[_0x22c1('0x1e')]);vertices[face['b']][_0x22c1('0xc5')](face[_0x22c1('0x1e')]);vertices[face['c']][_0x22c1('0xc5')](face[_0x22c1('0x1e')]);}}for(v=0x0,vl=this[_0x22c1('0xeb')][_0x22c1('0x32')];v<vl;v++){vertices[v]['normalize']();}for(f=0x0,fl=this[_0x22c1('0x1d9')][_0x22c1('0x32')];f<fl;f++){face=this['faces'][f];var vertexNormals=face['vertexNormals'];if(vertexNormals['length']===0x3){vertexNormals[0x0][_0x22c1('0x82')](vertices[face['a']]);vertexNormals[0x1][_0x22c1('0x82')](vertices[face['b']]);vertexNormals[0x2][_0x22c1('0x82')](vertices[face['c']]);}else{vertexNormals[0x0]=vertices[face['a']][_0x22c1('0x8d')]();vertexNormals[0x1]=vertices[face['b']]['clone']();vertexNormals[0x2]=vertices[face['c']][_0x22c1('0x8d')]();}}if(this['faces']['length']>0x0){this[_0x22c1('0x1e1')]=!![];}},'computeFlatVertexNormals':function computeFlatVertexNormals(){var f,fl,face;this[_0x22c1('0x1ec')]();for(f=0x0,fl=this[_0x22c1('0x1d9')]['length'];f<fl;f++){face=this[_0x22c1('0x1d9')][f];var vertexNormals=face[_0x22c1('0xd3')];if(vertexNormals['length']===0x3){vertexNormals[0x0][_0x22c1('0x82')](face[_0x22c1('0x1e')]);vertexNormals[0x1][_0x22c1('0x82')](face[_0x22c1('0x1e')]);vertexNormals[0x2]['copy'](face[_0x22c1('0x1e')]);}else{vertexNormals[0x0]=face[_0x22c1('0x1e')]['clone']();vertexNormals[0x1]=face[_0x22c1('0x1e')][_0x22c1('0x8d')]();vertexNormals[0x2]=face['normal'][_0x22c1('0x8d')]();}}if(this['faces'][_0x22c1('0x32')]>0x0){this[_0x22c1('0x1e1')]=!![];}},'computeMorphNormals':function computeMorphNormals(){var i,il,f,fl,face;for(f=0x0,fl=this[_0x22c1('0x1d9')]['length'];f<fl;f++){face=this['faces'][f];if(!face[_0x22c1('0x1ed')]){face[_0x22c1('0x1ed')]=face['normal']['clone']();}else{face[_0x22c1('0x1ed')][_0x22c1('0x82')](face[_0x22c1('0x1e')]);}if(!face[_0x22c1('0x1ee')])face[_0x22c1('0x1ee')]=[];for(i=0x0,il=face['vertexNormals'][_0x22c1('0x32')];i<il;i++){if(!face[_0x22c1('0x1ee')][i]){face[_0x22c1('0x1ee')][i]=face[_0x22c1('0xd3')][i]['clone']();}else{face[_0x22c1('0x1ee')][i][_0x22c1('0x82')](face[_0x22c1('0xd3')][i]);}}}var tmpGeo=new Geometry();tmpGeo[_0x22c1('0x1d9')]=this['faces'];for(i=0x0,il=this[_0x22c1('0x1db')][_0x22c1('0x32')];i<il;i++){if(!this['morphNormals'][i]){this[_0x22c1('0x1dc')][i]={};this['morphNormals'][i][_0x22c1('0x1ef')]=[];this['morphNormals'][i]['vertexNormals']=[];var dstNormalsFace=this['morphNormals'][i]['faceNormals'];var dstNormalsVertex=this[_0x22c1('0x1dc')][i]['vertexNormals'];var faceNormal,vertexNormals;for(f=0x0,fl=this['faces'][_0x22c1('0x32')];f<fl;f++){faceNormal=new Vector3();vertexNormals={'a':new Vector3(),'b':new Vector3(),'c':new Vector3()};dstNormalsFace[_0x22c1('0x2e')](faceNormal);dstNormalsVertex[_0x22c1('0x2e')](vertexNormals);}}var morphNormals=this[_0x22c1('0x1dc')][i];tmpGeo[_0x22c1('0xeb')]=this[_0x22c1('0x1db')][i][_0x22c1('0xeb')];tmpGeo['computeFaceNormals']();tmpGeo['computeVertexNormals']();var faceNormal,vertexNormals;for(f=0x0,fl=this[_0x22c1('0x1d9')][_0x22c1('0x32')];f<fl;f++){face=this[_0x22c1('0x1d9')][f];faceNormal=morphNormals[_0x22c1('0x1ef')][f];vertexNormals=morphNormals['vertexNormals'][f];faceNormal[_0x22c1('0x82')](face['normal']);vertexNormals['a'][_0x22c1('0x82')](face[_0x22c1('0xd3')][0x0]);vertexNormals['b'][_0x22c1('0x82')](face[_0x22c1('0xd3')][0x1]);vertexNormals['c'][_0x22c1('0x82')](face[_0x22c1('0xd3')][0x2]);}}for(f=0x0,fl=this[_0x22c1('0x1d9')][_0x22c1('0x32')];f<fl;f++){face=this['faces'][f];face[_0x22c1('0x1e')]=face[_0x22c1('0x1ed')];face[_0x22c1('0xd3')]=face[_0x22c1('0x1ee')];}},'computeBoundingBox':function computeBoundingBox(){if(this[_0x22c1('0x1e4')]===null){this['boundingBox']=new Box3();}this[_0x22c1('0x1e4')]['setFromPoints'](this['vertices']);},'computeBoundingSphere':function computeBoundingSphere(){if(this[_0x22c1('0x1e6')]===null){this[_0x22c1('0x1e6')]=new Sphere();}this[_0x22c1('0x1e6')]['setFromPoints'](this[_0x22c1('0xeb')]);},'merge':function merge(geometry,matrix,materialIndexOffset){if(!(geometry&&geometry[_0x22c1('0xea')])){console['error'](_0x22c1('0x1f0'),geometry);return;}var normalMatrix;var vertexOffset=this[_0x22c1('0xeb')]['length'];var vertices1=this[_0x22c1('0xeb')];var vertices2=geometry[_0x22c1('0xeb')];var faces1=this['faces'];var faces2=geometry[_0x22c1('0x1d9')];var uvs1=this[_0x22c1('0x1da')][0x0];var uvs2=geometry[_0x22c1('0x1da')][0x0];if(materialIndexOffset===undefined)materialIndexOffset=0x0;if(matrix!==undefined){normalMatrix=new Matrix3()[_0x22c1('0xd9')](matrix);}for(var i=0x0,il=vertices2[_0x22c1('0x32')];i<il;i++){var vertex=vertices2[i];var vertexCopy=vertex[_0x22c1('0x8d')]();if(matrix!==undefined)vertexCopy[_0x22c1('0xb7')](matrix);vertices1[_0x22c1('0x2e')](vertexCopy);}for(i=0x0,il=faces2[_0x22c1('0x32')];i<il;i++){var face=faces2[i];var faceCopy;var normal;var faceVertexNormals=face[_0x22c1('0xd3')];faceCopy=new Face3(face['a']+vertexOffset,face['b']+vertexOffset,face['c']+vertexOffset);faceCopy['normal'][_0x22c1('0x82')](face['normal']);if(normalMatrix!==undefined){faceCopy[_0x22c1('0x1e')][_0x22c1('0x104')](normalMatrix)[_0x22c1('0x6a')]();}for(var j=0x0,jl=faceVertexNormals[_0x22c1('0x32')];j<jl;j++){normal=faceVertexNormals[j]['clone']();if(normalMatrix!==undefined){normal[_0x22c1('0x104')](normalMatrix)[_0x22c1('0x6a')]();}faceCopy[_0x22c1('0xd3')][_0x22c1('0x2e')](normal);}faceCopy[_0x22c1('0xd5')]=face[_0x22c1('0xd5')]+materialIndexOffset;faces1['push'](faceCopy);}for(i=0x0,il=uvs2[_0x22c1('0x32')];i<il;i++){var uv=uvs2[i];var uvCopy=[];if(uv===undefined){continue;}for(var j=0x0,jl=uv[_0x22c1('0x32')];j<jl;j++){uvCopy[_0x22c1('0x2e')](uv[j][_0x22c1('0x8d')]());}uvs1[_0x22c1('0x2e')](uvCopy);}},'mergeMesh':function mergeMesh(mesh){if(!(mesh&&mesh['isMesh'])){console[_0x22c1('0xb0')](_0x22c1('0x1f1'),mesh);return;}if(mesh['matrixAutoUpdate'])mesh[_0x22c1('0x131')]();this['merge'](mesh['geometry'],mesh['matrix']);},'mergeVertices':function mergeVertices(){var verticesMap={};var unique=[];var changes=[];var v,key;var precisionPoints=0x4;var precision=Math['pow'](0xa,precisionPoints);var i,il,face;var indices,j,jl;for(i=0x0,il=this['vertices'][_0x22c1('0x32')];i<il;i++){v=this[_0x22c1('0xeb')][i];key=Math[_0x22c1('0xc0')](v['x']*precision)+'_'+Math[_0x22c1('0xc0')](v['y']*precision)+'_'+Math['round'](v['z']*precision);if(verticesMap[key]===undefined){verticesMap[key]=i;unique['push'](this['vertices'][i]);changes[i]=unique[_0x22c1('0x32')]-0x1;}else{changes[i]=changes[verticesMap[key]];}}var faceIndicesToRemove=[];for(i=0x0,il=this[_0x22c1('0x1d9')][_0x22c1('0x32')];i<il;i++){face=this[_0x22c1('0x1d9')][i];face['a']=changes[face['a']];face['b']=changes[face['b']];face['c']=changes[face['c']];indices=[face['a'],face['b'],face['c']];for(var n=0x0;n<0x3;n++){if(indices[n]===indices[(n+0x1)%0x3]){faceIndicesToRemove[_0x22c1('0x2e')](i);break;}}}for(i=faceIndicesToRemove[_0x22c1('0x32')]-0x1;i>=0x0;i--){var idx=faceIndicesToRemove[i];this[_0x22c1('0x1d9')][_0x22c1('0x12a')](idx,0x1);for(j=0x0,jl=this[_0x22c1('0x1da')]['length'];j<jl;j++){this[_0x22c1('0x1da')][j][_0x22c1('0x12a')](idx,0x1);}}var diff=this[_0x22c1('0xeb')]['length']-unique['length'];this[_0x22c1('0xeb')]=unique;return diff;},'setFromPoints':function setFromPoints(points){this['vertices']=[];for(var i=0x0,l=points[_0x22c1('0x32')];i<l;i++){var point=points[i];this[_0x22c1('0xeb')][_0x22c1('0x2e')](new Vector3(point['x'],point['y'],point['z']||0x0));}return this;},'sortFacesByMaterialIndex':function sortFacesByMaterialIndex(){var faces=this['faces'];var length=faces[_0x22c1('0x32')];for(var i=0x0;i<length;i++){faces[i][_0x22c1('0x1f2')]=i;}function materialIndexSort(a,b){return a[_0x22c1('0xd5')]-b[_0x22c1('0xd5')];}faces[_0x22c1('0x1f3')](materialIndexSort);var uvs1=this['faceVertexUvs'][0x0];var uvs2=this['faceVertexUvs'][0x1];var newUvs1,newUvs2;if(uvs1&&uvs1[_0x22c1('0x32')]===length)newUvs1=[];if(uvs2&&uvs2[_0x22c1('0x32')]===length)newUvs2=[];for(var i=0x0;i<length;i++){var id=faces[i][_0x22c1('0x1f2')];if(newUvs1)newUvs1[_0x22c1('0x2e')](uvs1[id]);if(newUvs2)newUvs2[_0x22c1('0x2e')](uvs2[id]);}if(newUvs1)this[_0x22c1('0x1da')][0x0]=newUvs1;if(newUvs2)this[_0x22c1('0x1da')][0x1]=newUvs2;},'toJSON':function toJSON(){var data={'metadata':{'version':4.5,'type':_0x22c1('0x1d8'),'generator':_0x22c1('0x1f4')}};data['uuid']=this[_0x22c1('0x114')];data[_0x22c1('0x1f')]=this['type'];if(this[_0x22c1('0x116')]!=='')data[_0x22c1('0x116')]=this[_0x22c1('0x116')];if(this['parameters']!==undefined){var parameters=this[_0x22c1('0x13d')];for(var key in parameters){if(parameters[key]!==undefined)data[key]=parameters[key];}return data;}var vertices=[];for(var i=0x0;i<this[_0x22c1('0xeb')]['length'];i++){var vertex=this[_0x22c1('0xeb')][i];vertices[_0x22c1('0x2e')](vertex['x'],vertex['y'],vertex['z']);}var faces=[];var normals=[];var normalsHash={};var uvs=[];var uvsHash={};for(var i=0x0;i<this[_0x22c1('0x1d9')][_0x22c1('0x32')];i++){var face=this['faces'][i];var hasMaterial=!![];var hasFaceUv=![];var hasFaceVertexUv=this[_0x22c1('0x1da')][0x0][i]!==undefined;var hasFaceNormal=face[_0x22c1('0x1e')]['length']()>0x0;var hasFaceVertexNormal=face[_0x22c1('0xd3')][_0x22c1('0x32')]>0x0;var faceType=0x0;faceType=setBit(faceType,0x0,0x0);faceType=setBit(faceType,0x1,hasMaterial);faceType=setBit(faceType,0x2,hasFaceUv);faceType=setBit(faceType,0x3,hasFaceVertexUv);faceType=setBit(faceType,0x4,hasFaceNormal);faceType=setBit(faceType,0x5,hasFaceVertexNormal);faces[_0x22c1('0x2e')](faceType);faces[_0x22c1('0x2e')](face['a'],face['b'],face['c']);faces['push'](face[_0x22c1('0xd5')]);if(hasFaceVertexUv){var faceVertexUvs=this['faceVertexUvs'][0x0][i];faces['push'](getUvIndex(faceVertexUvs[0x0]),getUvIndex(faceVertexUvs[0x1]),getUvIndex(faceVertexUvs[0x2]));}if(hasFaceNormal){faces['push'](getNormalIndex(face['normal']));}if(hasFaceVertexNormal){var vertexNormals=face['vertexNormals'];faces[_0x22c1('0x2e')](getNormalIndex(vertexNormals[0x0]),getNormalIndex(vertexNormals[0x1]),getNormalIndex(vertexNormals[0x2]));}}function setBit(value,position,enabled){return enabled?value|0x1<<position:value&~(0x1<<position);}function getNormalIndex(normal){var hash=normal['x'][_0x22c1('0x50')]()+normal['y'][_0x22c1('0x50')]()+normal['z']['toString']();if(normalsHash[hash]!==undefined){return normalsHash[hash];}normalsHash[hash]=normals[_0x22c1('0x32')]/0x3;normals[_0x22c1('0x2e')](normal['x'],normal['y'],normal['z']);return normalsHash[hash];}function getUvIndex(uv){var hash=uv['x'][_0x22c1('0x50')]()+uv['y'][_0x22c1('0x50')]();if(uvsHash[hash]!==undefined){return uvsHash[hash];}uvsHash[hash]=uvs[_0x22c1('0x32')]/0x2;uvs[_0x22c1('0x2e')](uv['x'],uv['y']);return uvsHash[hash];}data[_0x22c1('0x1f5')]={};data['data'][_0x22c1('0xeb')]=vertices;data['data'][_0x22c1('0x1f6')]=normals;if(uvs['length']>0x0)data['data'][_0x22c1('0x1f7')]=[uvs];data[_0x22c1('0x1f5')]['faces']=faces;return data;},'clone':function clone(){return new Geometry()[_0x22c1('0x82')](this);},'copy':function copy(source){var i,il,j,jl,k,kl;this[_0x22c1('0xeb')]=[];this[_0x22c1('0x1d9')]=[];this['faceVertexUvs']=[[]];this[_0x22c1('0x1db')]=[];this[_0x22c1('0x1dc')]=[];this[_0x22c1('0x1f8')]=[];this[_0x22c1('0x1dd')]=[];this['lineDistances']=[];this[_0x22c1('0x1e4')]=null;this[_0x22c1('0x1e6')]=null;this['name']=source[_0x22c1('0x116')];var vertices=source[_0x22c1('0xeb')];for(i=0x0,il=vertices[_0x22c1('0x32')];i<il;i++){this[_0x22c1('0xeb')][_0x22c1('0x2e')](vertices[i][_0x22c1('0x8d')]());}var faces=source['faces'];for(i=0x0,il=faces[_0x22c1('0x32')];i<il;i++){this['faces'][_0x22c1('0x2e')](faces[i][_0x22c1('0x8d')]());}for(i=0x0,il=source[_0x22c1('0x1da')]['length'];i<il;i++){var faceVertexUvs=source['faceVertexUvs'][i];if(this[_0x22c1('0x1da')][i]===undefined){this[_0x22c1('0x1da')][i]=[];}for(j=0x0,jl=faceVertexUvs['length'];j<jl;j++){var uvs=faceVertexUvs[j];var uvsCopy=[];for(k=0x0,kl=uvs['length'];k<kl;k++){var uv=uvs[k];uvsCopy[_0x22c1('0x2e')](uv['clone']());}this[_0x22c1('0x1da')][i][_0x22c1('0x2e')](uvsCopy);}}var morphTargets=source[_0x22c1('0x1db')];for(i=0x0,il=morphTargets[_0x22c1('0x32')];i<il;i++){var morphTarget={};morphTarget[_0x22c1('0x116')]=morphTargets[i][_0x22c1('0x116')];if(morphTargets[i][_0x22c1('0xeb')]!==undefined){morphTarget[_0x22c1('0xeb')]=[];for(j=0x0,jl=morphTargets[i][_0x22c1('0xeb')][_0x22c1('0x32')];j<jl;j++){morphTarget[_0x22c1('0xeb')][_0x22c1('0x2e')](morphTargets[i][_0x22c1('0xeb')][j][_0x22c1('0x8d')]());}}if(morphTargets[i][_0x22c1('0x1f6')]!==undefined){morphTarget[_0x22c1('0x1f6')]=[];for(j=0x0,jl=morphTargets[i][_0x22c1('0x1f6')][_0x22c1('0x32')];j<jl;j++){morphTarget[_0x22c1('0x1f6')][_0x22c1('0x2e')](morphTargets[i][_0x22c1('0x1f6')][j][_0x22c1('0x8d')]());}}this[_0x22c1('0x1db')][_0x22c1('0x2e')](morphTarget);}var morphNormals=source[_0x22c1('0x1dc')];for(i=0x0,il=morphNormals['length'];i<il;i++){var morphNormal={};if(morphNormals[i][_0x22c1('0xd3')]!==undefined){morphNormal[_0x22c1('0xd3')]=[];for(j=0x0,jl=morphNormals[i][_0x22c1('0xd3')]['length'];j<jl;j++){var srcVertexNormal=morphNormals[i][_0x22c1('0xd3')][j];var destVertexNormal={};destVertexNormal['a']=srcVertexNormal['a'][_0x22c1('0x8d')]();destVertexNormal['b']=srcVertexNormal['b'][_0x22c1('0x8d')]();destVertexNormal['c']=srcVertexNormal['c'][_0x22c1('0x8d')]();morphNormal[_0x22c1('0xd3')][_0x22c1('0x2e')](destVertexNormal);}}if(morphNormals[i][_0x22c1('0x1ef')]!==undefined){morphNormal['faceNormals']=[];for(j=0x0,jl=morphNormals[i][_0x22c1('0x1ef')][_0x22c1('0x32')];j<jl;j++){morphNormal[_0x22c1('0x1ef')][_0x22c1('0x2e')](morphNormals[i][_0x22c1('0x1ef')][j]['clone']());}}this[_0x22c1('0x1dc')]['push'](morphNormal);}var skinWeights=source[_0x22c1('0x1f8')];for(i=0x0,il=skinWeights[_0x22c1('0x32')];i<il;i++){this[_0x22c1('0x1f8')][_0x22c1('0x2e')](skinWeights[i][_0x22c1('0x8d')]());}var skinIndices=source[_0x22c1('0x1dd')];for(i=0x0,il=skinIndices['length'];i<il;i++){this[_0x22c1('0x1dd')]['push'](skinIndices[i][_0x22c1('0x8d')]());}var lineDistances=source['lineDistances'];for(i=0x0,il=lineDistances[_0x22c1('0x32')];i<il;i++){this[_0x22c1('0x1f9')][_0x22c1('0x2e')](lineDistances[i]);}var boundingBox=source[_0x22c1('0x1e4')];if(boundingBox!==null){this[_0x22c1('0x1e4')]=boundingBox['clone']();}var boundingSphere=source[_0x22c1('0x1e6')];if(boundingSphere!==null){this[_0x22c1('0x1e6')]=boundingSphere[_0x22c1('0x8d')]();}this[_0x22c1('0x1de')]=source[_0x22c1('0x1de')];this[_0x22c1('0x1df')]=source[_0x22c1('0x1df')];this[_0x22c1('0x1e0')]=source[_0x22c1('0x1e0')];this['normalsNeedUpdate']=source[_0x22c1('0x1e1')];this[_0x22c1('0x1e2')]=source[_0x22c1('0x1e2')];this['groupsNeedUpdate']=source[_0x22c1('0x1e3')];return this;},'dispose':function dispose(){this[_0x22c1('0x125')]({'type':_0x22c1('0x1fa')});}});var readOnlyError=createCommonjsModule(function(module){function _readOnlyError(name){throw new TypeError('\x22'+name+_0x22c1('0x1fb'));}module[_0x22c1('0x3')]=_readOnlyError,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')]['default']=module['exports'];});var _readOnlyError=unwrapExports(readOnlyError);function Vector4(x,y,z,w){this['x']=x||0x0;this['y']=y||0x0;this['z']=z||0x0;this['w']=w!==undefined?w:0x1;}Object[_0x22c1('0x48')](Vector4['prototype'],{'isVector4':!![],'set':function set(x,y,z,w){this['x']=x;this['y']=y;this['z']=z;this['w']=w;return this;},'setScalar':function setScalar(scalar){this['x']=scalar;this['y']=scalar;this['z']=scalar;this['w']=scalar;return this;},'setX':function setX(x){this['x']=x;return this;},'setY':function setY(y){this['y']=y;return this;},'setZ':function setZ(z){this['z']=z;return this;},'setW':function setW(w){this['w']=w;return this;},'setComponent':function setComponent(index,value){switch(index){case 0x0:this['x']=value;break;case 0x1:this['y']=value;break;case 0x2:this['z']=value;break;case 0x3:this['w']=value;break;default:throw new Error(_0x22c1('0xa5')+index);}return this;},'getComponent':function getComponent(index){switch(index){case 0x0:return this['x'];case 0x1:return this['y'];case 0x2:return this['z'];case 0x3:return this['w'];default:throw new Error('index\x20is\x20out\x20of\x20range:\x20'+index);}},'clone':function clone(){return new this[(_0x22c1('0xd'))](this['x'],this['y'],this['z'],this['w']);},'copy':function copy(v){this['x']=v['x'];this['y']=v['y'];this['z']=v['z'];this['w']=v['w']!==undefined?v['w']:0x1;return this;},'add':function add(v,w){if(w!==undefined){console['warn'](_0x22c1('0x1fc'));return this['addVectors'](v,w);}this['x']+=v['x'];this['y']+=v['y'];this['z']+=v['z'];this['w']+=v['w'];return this;},'addScalar':function addScalar(s){this['x']+=s;this['y']+=s;this['z']+=s;this['w']+=s;return this;},'addVectors':function addVectors(a,b){this['x']=a['x']+b['x'];this['y']=a['y']+b['y'];this['z']=a['z']+b['z'];this['w']=a['w']+b['w'];return this;},'addScaledVector':function addScaledVector(v,s){this['x']+=v['x']*s;this['y']+=v['y']*s;this['z']+=v['z']*s;this['w']+=v['w']*s;return this;},'sub':function sub(v,w){if(w!==undefined){console[_0x22c1('0x6b')](_0x22c1('0x1fd'));return this[_0x22c1('0xad')](v,w);}this['x']-=v['x'];this['y']-=v['y'];this['z']-=v['z'];this['w']-=v['w'];return this;},'subScalar':function subScalar(s){this['x']-=s;this['y']-=s;this['z']-=s;this['w']-=s;return this;},'subVectors':function subVectors(a,b){this['x']=a['x']-b['x'];this['y']=a['y']-b['y'];this['z']=a['z']-b['z'];this['w']=a['w']-b['w'];return this;},'multiplyScalar':function multiplyScalar(scalar){this['x']*=scalar;this['y']*=scalar;this['z']*=scalar;this['w']*=scalar;return this;},'applyMatrix4':function applyMatrix4(m){var x=this['x'];var y=this['y'];var z=this['z'];var w=this['w'];var e=m[_0x22c1('0x5b')];this['x']=e[0x0]*x+e[0x4]*y+e[0x8]*z+e[0xc]*w;this['y']=e[0x1]*x+e[0x5]*y+e[0x9]*z+e[0xd]*w;this['z']=e[0x2]*x+e[0x6]*y+e[0xa]*z+e[0xe]*w;this['w']=e[0x3]*x+e[0x7]*y+e[0xb]*z+e[0xf]*w;return this;},'divideScalar':function divideScalar(scalar){return this['multiplyScalar'](0x1/scalar);},'setAxisAngleFromQuaternion':function setAxisAngleFromQuaternion(q){this['w']=0x2*Math['acos'](q['w']);var s=Math[_0x22c1('0x8a')](0x1-q['w']*q['w']);if(s<0.0001){this['x']=0x1;this['y']=0x0;this['z']=0x0;}else{this['x']=q['x']/s;this['y']=q['y']/s;this['z']=q['z']/s;}return this;},'setAxisAngleFromRotationMatrix':function setAxisAngleFromRotationMatrix(m){var angle;var x;var y;var z;var epsilon=0.01;var epsilon2=0.1;var te=m[_0x22c1('0x5b')];var m11=te[0x0];var m12=te[0x4];var m13=te[0x8];var m21=te[0x1];var m22=te[0x5];var m23=te[0x9];var m31=te[0x2];var m32=te[0x6];var m33=te[0xa];if(Math[_0x22c1('0x69')](m12-m21)<epsilon&&Math[_0x22c1('0x69')](m13-m31)<epsilon&&Math[_0x22c1('0x69')](m23-m32)<epsilon){if(Math['abs'](m12+m21)<epsilon2&&Math[_0x22c1('0x69')](m13+m31)<epsilon2&&Math[_0x22c1('0x69')](m23+m32)<epsilon2&&Math[_0x22c1('0x69')](m11+m22+m33-0x3)<epsilon2){this[_0x22c1('0x5e')](0x1,0x0,0x0,0x0);return this;}angle=Math['PI'];var xx=(m11+0x1)/0x2;var yy=(m22+0x1)/0x2;var zz=(m33+0x1)/0x2;var xy=(m12+m21)/0x4;var xz=(m13+m31)/0x4;var yz=(m23+m32)/0x4;if(xx>yy&&xx>zz){if(xx<epsilon){x=0x0;y=0.707106781;z=0.707106781;}else{x=Math[_0x22c1('0x8a')](xx);y=xy/x;z=xz/x;}}else if(yy>zz){if(yy<epsilon){x=0.707106781;y=0x0;z=0.707106781;}else{y=Math[_0x22c1('0x8a')](yy);x=xy/y;z=yz/y;}}else{if(zz<epsilon){x=0.707106781;y=0.707106781;z=0x0;}else{z=Math[_0x22c1('0x8a')](zz);x=xz/z;y=yz/z;}}this[_0x22c1('0x5e')](x,y,z,angle);return this;}var s=Math[_0x22c1('0x8a')]((m32-m23)*(m32-m23)+(m13-m31)*(m13-m31)+(m21-m12)*(m21-m12));if(Math[_0x22c1('0x69')](s)<0.001)s=0x1;this['x']=(m32-m23)/s;this['y']=(m13-m31)/s;this['z']=(m21-m12)/s;this['w']=Math['acos']((m11+m22+m33-0x1)/0x2);return this;},'min':function min(v){this['x']=Math[_0x22c1('0x54')](this['x'],v['x']);this['y']=Math['min'](this['y'],v['y']);this['z']=Math['min'](this['z'],v['z']);this['w']=Math[_0x22c1('0x54')](this['w'],v['w']);return this;},'max':function max(v){this['x']=Math[_0x22c1('0x53')](this['x'],v['x']);this['y']=Math[_0x22c1('0x53')](this['y'],v['y']);this['z']=Math[_0x22c1('0x53')](this['z'],v['z']);this['w']=Math[_0x22c1('0x53')](this['w'],v['w']);return this;},'clamp':function clamp(min,max){this['x']=Math[_0x22c1('0x53')](min['x'],Math['min'](max['x'],this['x']));this['y']=Math[_0x22c1('0x53')](min['y'],Math[_0x22c1('0x54')](max['y'],this['y']));this['z']=Math[_0x22c1('0x53')](min['z'],Math['min'](max['z'],this['z']));this['w']=Math[_0x22c1('0x53')](min['w'],Math['min'](max['w'],this['w']));return this;},'clampScalar':function(){var min,max;return function clampScalar(minVal,maxVal){if(min===undefined){min=new Vector4();max=new Vector4();}min[_0x22c1('0x5e')](minVal,minVal,minVal,minVal);max[_0x22c1('0x5e')](maxVal,maxVal,maxVal,maxVal);return this[_0x22c1('0x98')](min,max);};}(),'clampLength':function clampLength(min,max){var length=this['length']();return this['divideScalar'](length||0x1)[_0x22c1('0x6f')](Math['max'](min,Math[_0x22c1('0x54')](max,length)));},'floor':function floor(){this['x']=Math[_0x22c1('0x55')](this['x']);this['y']=Math[_0x22c1('0x55')](this['y']);this['z']=Math[_0x22c1('0x55')](this['z']);this['w']=Math[_0x22c1('0x55')](this['w']);return this;},'ceil':function ceil(){this['x']=Math['ceil'](this['x']);this['y']=Math[_0x22c1('0x58')](this['y']);this['z']=Math[_0x22c1('0x58')](this['z']);this['w']=Math[_0x22c1('0x58')](this['w']);return this;},'round':function round(){this['x']=Math[_0x22c1('0xc0')](this['x']);this['y']=Math[_0x22c1('0xc0')](this['y']);this['z']=Math['round'](this['z']);this['w']=Math[_0x22c1('0xc0')](this['w']);return this;},'roundToZero':function roundToZero(){this['x']=this['x']<0x0?Math[_0x22c1('0x58')](this['x']):Math[_0x22c1('0x55')](this['x']);this['y']=this['y']<0x0?Math['ceil'](this['y']):Math[_0x22c1('0x55')](this['y']);this['z']=this['z']<0x0?Math['ceil'](this['z']):Math[_0x22c1('0x55')](this['z']);this['w']=this['w']<0x0?Math['ceil'](this['w']):Math[_0x22c1('0x55')](this['w']);return this;},'negate':function negate(){this['x']=-this['x'];this['y']=-this['y'];this['z']=-this['z'];this['w']=-this['w'];return this;},'dot':function dot(v){return this['x']*v['x']+this['y']*v['y']+this['z']*v['z']+this['w']*v['w'];},'lengthSq':function lengthSq(){return this['x']*this['x']+this['y']*this['y']+this['z']*this['z']+this['w']*this['w'];},'length':function length(){return Math[_0x22c1('0x8a')](this['x']*this['x']+this['y']*this['y']+this['z']*this['z']+this['w']*this['w']);},'manhattanLength':function manhattanLength(){return Math[_0x22c1('0x69')](this['x'])+Math[_0x22c1('0x69')](this['y'])+Math[_0x22c1('0x69')](this['z'])+Math[_0x22c1('0x69')](this['w']);},'normalize':function normalize(){return this[_0x22c1('0x103')](this[_0x22c1('0x32')]()||0x1);},'setLength':function setLength(length){return this[_0x22c1('0x6a')]()['multiplyScalar'](length);},'lerp':function lerp(v,alpha){this['x']+=(v['x']-this['x'])*alpha;this['y']+=(v['y']-this['y'])*alpha;this['z']+=(v['z']-this['z'])*alpha;this['w']+=(v['w']-this['w'])*alpha;return this;},'lerpVectors':function lerpVectors(v1,v2,alpha){return this[_0x22c1('0xad')](v2,v1)['multiplyScalar'](alpha)[_0x22c1('0xc5')](v1);},'equals':function equals(v){return v['x']===this['x']&&v['y']===this['y']&&v['z']===this['z']&&v['w']===this['w'];},'fromArray':function fromArray(array,offset){if(offset===undefined)offset=0x0;this['x']=array[offset];this['y']=array[offset+0x1];this['z']=array[offset+0x2];this['w']=array[offset+0x3];return this;},'toArray':function toArray(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0x0;array[offset]=this['x'];array[offset+0x1]=this['y'];array[offset+0x2]=this['z'];array[offset+0x3]=this['w'];return array;},'fromBufferAttribute':function fromBufferAttribute(attribute,index,offset){if(offset!==undefined){console['warn'](_0x22c1('0x1fe'));}this['x']=attribute[_0x22c1('0x70')](index);this['y']=attribute[_0x22c1('0x71')](index);this['z']=attribute[_0x22c1('0x72')](index);this['w']=attribute[_0x22c1('0x1ff')](index);return this;}});function BufferAttribute(array,itemSize,normalized){if(Array[_0x22c1('0xd4')](array)){throw new TypeError('THREE.BufferAttribute:\x20array\x20should\x20be\x20a\x20Typed\x20Array.');}this[_0x22c1('0x116')]='';this[_0x22c1('0x1e9')]=array;this['itemSize']=itemSize;this[_0x22c1('0xd7')]=array!==undefined?array[_0x22c1('0x32')]/ itemSize:0x0;this['normalized']=normalized===!![];this['dynamic']=![];this[_0x22c1('0x200')]={'offset':0x0,'count':-0x1};this[_0x22c1('0x201')]=0x0;}Object['defineProperty'](BufferAttribute['prototype'],_0x22c1('0x202'),{'set':function set(value){if(value===!![])this[_0x22c1('0x201')]++;}});Object[_0x22c1('0x48')](BufferAttribute[_0x22c1('0x1')],{'isBufferAttribute':!![],'onUploadCallback':function onUploadCallback(){},'setArray':function setArray(array){if(Array[_0x22c1('0xd4')](array)){throw new TypeError(_0x22c1('0x203'));}this['count']=array!==undefined?array['length']/this[_0x22c1('0x204')]:0x0;this[_0x22c1('0x1e9')]=array;return this;},'setDynamic':function setDynamic(value){this[_0x22c1('0x205')]=value;return this;},'copy':function copy(source){this[_0x22c1('0x116')]=source['name'];this['array']=new source[(_0x22c1('0x1e9'))][(_0x22c1('0xd'))](source['array']);this['itemSize']=source[_0x22c1('0x204')];this[_0x22c1('0xd7')]=source[_0x22c1('0xd7')];this['normalized']=source['normalized'];this[_0x22c1('0x205')]=source[_0x22c1('0x205')];return this;},'copyAt':function copyAt(index1,attribute,index2){index1*=this['itemSize'];index2*=attribute['itemSize'];for(var i=0x0,l=this['itemSize'];i<l;i++){this[_0x22c1('0x1e9')][index1+i]=attribute[_0x22c1('0x1e9')][index2+i];}return this;},'copyArray':function copyArray(array){this[_0x22c1('0x1e9')][_0x22c1('0x5e')](array);return this;},'copyVector2sArray':function copyVector2sArray(vectors){var array=this[_0x22c1('0x1e9')];var offset=0x0;for(var i=0x0,l=vectors['length'];i<l;i++){var vector=vectors[i];if(vector===undefined){console[_0x22c1('0x6b')]('THREE.BufferAttribute.copyVector2sArray():\x20vector\x20is\x20undefined',i);vector=new Vector2();}array[offset++]=vector['x'];array[offset++]=vector['y'];}return this;},'copyVector3sArray':function copyVector3sArray(vectors){var array=this[_0x22c1('0x1e9')];var offset=0x0;for(var i=0x0,l=vectors['length'];i<l;i++){var vector=vectors[i];if(vector===undefined){console['warn'](_0x22c1('0x206'),i);vector=new Vector3();}array[offset++]=vector['x'];array[offset++]=vector['y'];array[offset++]=vector['z'];}return this;},'copyVector4sArray':function copyVector4sArray(vectors){var array=this[_0x22c1('0x1e9')];var offset=0x0;for(var i=0x0,l=vectors[_0x22c1('0x32')];i<l;i++){var vector=vectors[i];if(vector===undefined){console[_0x22c1('0x6b')](_0x22c1('0x207'),i);vector=new Vector4();}array[offset++]=vector['x'];array[offset++]=vector['y'];array[offset++]=vector['z'];array[offset++]=vector['w'];}return this;},'set':function set(value,offset){if(offset===undefined)offset=0x0;this[_0x22c1('0x1e9')][_0x22c1('0x5e')](value,offset);return this;},'getX':function getX(index){return this[_0x22c1('0x1e9')][index*this[_0x22c1('0x204')]];},'setX':function setX(index,x){this[_0x22c1('0x1e9')][index*this[_0x22c1('0x204')]]=x;return this;},'getY':function getY(index){return this[_0x22c1('0x1e9')][index*this[_0x22c1('0x204')]+0x1];},'setY':function setY(index,y){this[_0x22c1('0x1e9')][index*this[_0x22c1('0x204')]+0x1]=y;return this;},'getZ':function getZ(index){return this[_0x22c1('0x1e9')][index*this[_0x22c1('0x204')]+0x2];},'setZ':function setZ(index,z){this[_0x22c1('0x1e9')][index*this[_0x22c1('0x204')]+0x2]=z;return this;},'getW':function getW(index){return this['array'][index*this['itemSize']+0x3];},'setW':function setW(index,w){this[_0x22c1('0x1e9')][index*this[_0x22c1('0x204')]+0x3]=w;return this;},'setXY':function setXY(index,x,y){index*=this['itemSize'];this[_0x22c1('0x1e9')][index+0x0]=x;this['array'][index+0x1]=y;return this;},'setXYZ':function setXYZ(index,x,y,z){index*=this[_0x22c1('0x204')];this[_0x22c1('0x1e9')][index+0x0]=x;this[_0x22c1('0x1e9')][index+0x1]=y;this[_0x22c1('0x1e9')][index+0x2]=z;return this;},'setXYZW':function setXYZW(index,x,y,z,w){index*=this[_0x22c1('0x204')];this[_0x22c1('0x1e9')][index+0x0]=x;this[_0x22c1('0x1e9')][index+0x1]=y;this[_0x22c1('0x1e9')][index+0x2]=z;this[_0x22c1('0x1e9')][index+0x3]=w;return this;},'onUpload':function onUpload(callback){this[_0x22c1('0x208')]=callback;return this;},'clone':function clone(){return new this[(_0x22c1('0xd'))](this['array'],this['itemSize'])[_0x22c1('0x82')](this);}});function Int8BufferAttribute(array,itemSize,normalized){BufferAttribute[_0x22c1('0x2')](this,new Int8Array(array),itemSize,normalized);}Int8BufferAttribute[_0x22c1('0x1')]=Object[_0x22c1('0x13')](BufferAttribute[_0x22c1('0x1')]);Int8BufferAttribute[_0x22c1('0x1')][_0x22c1('0xd')]=Int8BufferAttribute;function Uint8BufferAttribute(array,itemSize,normalized){BufferAttribute['call'](this,new Uint8Array(array),itemSize,normalized);}Uint8BufferAttribute[_0x22c1('0x1')]=Object[_0x22c1('0x13')](BufferAttribute[_0x22c1('0x1')]);Uint8BufferAttribute[_0x22c1('0x1')][_0x22c1('0xd')]=Uint8BufferAttribute;function Uint8ClampedBufferAttribute(array,itemSize,normalized){BufferAttribute['call'](this,new Uint8ClampedArray(array),itemSize,normalized);}Uint8ClampedBufferAttribute['prototype']=Object[_0x22c1('0x13')](BufferAttribute['prototype']);Uint8ClampedBufferAttribute[_0x22c1('0x1')][_0x22c1('0xd')]=Uint8ClampedBufferAttribute;function Int16BufferAttribute(array,itemSize,normalized){BufferAttribute['call'](this,new Int16Array(array),itemSize,normalized);}Int16BufferAttribute[_0x22c1('0x1')]=Object[_0x22c1('0x13')](BufferAttribute[_0x22c1('0x1')]);Int16BufferAttribute[_0x22c1('0x1')][_0x22c1('0xd')]=Int16BufferAttribute;function Uint16BufferAttribute(array,itemSize,normalized){BufferAttribute[_0x22c1('0x2')](this,new Uint16Array(array),itemSize,normalized);}Uint16BufferAttribute[_0x22c1('0x1')]=Object['create'](BufferAttribute['prototype']);Uint16BufferAttribute['prototype'][_0x22c1('0xd')]=Uint16BufferAttribute;function Int32BufferAttribute(array,itemSize,normalized){BufferAttribute['call'](this,new Int32Array(array),itemSize,normalized);}Int32BufferAttribute['prototype']=Object[_0x22c1('0x13')](BufferAttribute['prototype']);Int32BufferAttribute['prototype'][_0x22c1('0xd')]=Int32BufferAttribute;function Uint32BufferAttribute(array,itemSize,normalized){BufferAttribute[_0x22c1('0x2')](this,new Uint32Array(array),itemSize,normalized);}Uint32BufferAttribute[_0x22c1('0x1')]=Object['create'](BufferAttribute[_0x22c1('0x1')]);Uint32BufferAttribute[_0x22c1('0x1')]['constructor']=Uint32BufferAttribute;function Float32BufferAttribute(array,itemSize,normalized){BufferAttribute[_0x22c1('0x2')](this,new Float32Array(array),itemSize,normalized);}Float32BufferAttribute[_0x22c1('0x1')]=Object['create'](BufferAttribute[_0x22c1('0x1')]);Float32BufferAttribute[_0x22c1('0x1')][_0x22c1('0xd')]=Float32BufferAttribute;function Float64BufferAttribute(array,itemSize,normalized){BufferAttribute['call'](this,new Float64Array(array),itemSize,normalized);}Float64BufferAttribute[_0x22c1('0x1')]=Object[_0x22c1('0x13')](BufferAttribute['prototype']);Float64BufferAttribute['prototype'][_0x22c1('0xd')]=Float64BufferAttribute;function DirectGeometry(){this[_0x22c1('0xeb')]=[];this[_0x22c1('0x1f6')]=[];this[_0x22c1('0x1f7')]=[];this[_0x22c1('0x209')]=[];this['groups']=[];this[_0x22c1('0x1db')]={};this['skinWeights']=[];this['skinIndices']=[];this['boundingBox']=null;this[_0x22c1('0x1e6')]=null;this[_0x22c1('0x1df')]=![];this[_0x22c1('0x1e1')]=![];this[_0x22c1('0x1e0')]=![];this[_0x22c1('0x1e3')]=![];}Object['assign'](DirectGeometry[_0x22c1('0x1')],{'computeGroups':function computeGroups(geometry){var group;var groups=[];var materialIndex=undefined;var faces=geometry[_0x22c1('0x1d9')];for(var i=0x0;i<faces[_0x22c1('0x32')];i++){var face=faces[i];if(face[_0x22c1('0xd5')]!==materialIndex){materialIndex=face[_0x22c1('0xd5')];if(group!==undefined){group[_0x22c1('0xd7')]=i*0x3-group[_0x22c1('0x20a')];groups[_0x22c1('0x2e')](group);}group={'start':i*0x3,'materialIndex':materialIndex};}}if(group!==undefined){group['count']=i*0x3-group[_0x22c1('0x20a')];groups[_0x22c1('0x2e')](group);}this[_0x22c1('0x20b')]=groups;},'fromGeometry':function fromGeometry(geometry){var faces=geometry[_0x22c1('0x1d9')];var vertices=geometry[_0x22c1('0xeb')];var faceVertexUvs=geometry[_0x22c1('0x1da')];var hasFaceVertexUv=faceVertexUvs[0x0]&&faceVertexUvs[0x0][_0x22c1('0x32')]>0x0;var hasFaceVertexUv2=faceVertexUvs[0x1]&&faceVertexUvs[0x1][_0x22c1('0x32')]>0x0;var morphTargets=geometry[_0x22c1('0x1db')];var morphTargetsLength=morphTargets[_0x22c1('0x32')];var morphTargetsPosition;if(morphTargetsLength>0x0){morphTargetsPosition=[];for(var i=0x0;i<morphTargetsLength;i++){morphTargetsPosition[i]={'name':morphTargets[i][_0x22c1('0x116')],'data':[]};}this[_0x22c1('0x1db')]['position']=morphTargetsPosition;}var morphNormals=geometry['morphNormals'];var morphNormalsLength=morphNormals[_0x22c1('0x32')];var morphTargetsNormal;if(morphNormalsLength>0x0){morphTargetsNormal=[];for(var i=0x0;i<morphNormalsLength;i++){morphTargetsNormal[i]={'name':morphNormals[i][_0x22c1('0x116')],'data':[]};}this[_0x22c1('0x1db')]['normal']=morphTargetsNormal;}var skinIndices=geometry[_0x22c1('0x1dd')];var skinWeights=geometry['skinWeights'];var hasSkinIndices=skinIndices[_0x22c1('0x32')]===vertices[_0x22c1('0x32')];var hasSkinWeights=skinWeights[_0x22c1('0x32')]===vertices[_0x22c1('0x32')];if(vertices[_0x22c1('0x32')]>0x0&&faces[_0x22c1('0x32')]===0x0){console[_0x22c1('0xb0')](_0x22c1('0x20c'));}for(var i=0x0;i<faces[_0x22c1('0x32')];i++){var face=faces[i];this[_0x22c1('0xeb')]['push'](vertices[face['a']],vertices[face['b']],vertices[face['c']]);var vertexNormals=face['vertexNormals'];if(vertexNormals[_0x22c1('0x32')]===0x3){this[_0x22c1('0x1f6')][_0x22c1('0x2e')](vertexNormals[0x0],vertexNormals[0x1],vertexNormals[0x2]);}else{var normal=face[_0x22c1('0x1e')];this[_0x22c1('0x1f6')]['push'](normal,normal,normal);}if(hasFaceVertexUv===!![]){var vertexUvs=faceVertexUvs[0x0][i];if(vertexUvs!==undefined){this['uvs'][_0x22c1('0x2e')](vertexUvs[0x0],vertexUvs[0x1],vertexUvs[0x2]);}else{console[_0x22c1('0x6b')](_0x22c1('0x20d'),i);this[_0x22c1('0x1f7')][_0x22c1('0x2e')](new Vector2(),new Vector2(),new Vector2());}}if(hasFaceVertexUv2===!![]){var vertexUvs=faceVertexUvs[0x1][i];if(vertexUvs!==undefined){this[_0x22c1('0x209')][_0x22c1('0x2e')](vertexUvs[0x0],vertexUvs[0x1],vertexUvs[0x2]);}else{console[_0x22c1('0x6b')](_0x22c1('0x20e'),i);this[_0x22c1('0x209')]['push'](new Vector2(),new Vector2(),new Vector2());}}for(var j=0x0;j<morphTargetsLength;j++){var morphTarget=morphTargets[j]['vertices'];morphTargetsPosition[j][_0x22c1('0x1f5')][_0x22c1('0x2e')](morphTarget[face['a']],morphTarget[face['b']],morphTarget[face['c']]);}for(var j=0x0;j<morphNormalsLength;j++){var morphNormal=morphNormals[j][_0x22c1('0xd3')][i];morphTargetsNormal[j][_0x22c1('0x1f5')]['push'](morphNormal['a'],morphNormal['b'],morphNormal['c']);}if(hasSkinIndices){this['skinIndices'][_0x22c1('0x2e')](skinIndices[face['a']],skinIndices[face['b']],skinIndices[face['c']]);}if(hasSkinWeights){this[_0x22c1('0x1f8')][_0x22c1('0x2e')](skinWeights[face['a']],skinWeights[face['b']],skinWeights[face['c']]);}}this['computeGroups'](geometry);this[_0x22c1('0x1df')]=geometry['verticesNeedUpdate'];this[_0x22c1('0x1e1')]=geometry[_0x22c1('0x1e1')];this['uvsNeedUpdate']=geometry[_0x22c1('0x1e0')];this[_0x22c1('0x1e3')]=geometry[_0x22c1('0x1e3')];return this;}});function arrayMax(array){if(array['length']===0x0)return-Infinity;var max=array[0x0];for(var i=0x1,l=array[_0x22c1('0x32')];i<l;++i){if(array[i]>max)max=array[i];}return max;}var bufferGeometryId=0x1;function BufferGeometry(){Object[_0x22c1('0x12')](this,'id',{'value':bufferGeometryId+=0x2});this[_0x22c1('0x114')]=_Math[_0x22c1('0x115')]();this[_0x22c1('0x116')]='';this[_0x22c1('0x1f')]=_0x22c1('0x20f');this[_0x22c1('0x1e8')]=null;this[_0x22c1('0xed')]={};this[_0x22c1('0x210')]={};this[_0x22c1('0x20b')]=[];this[_0x22c1('0x1e4')]=null;this[_0x22c1('0x1e6')]=null;this[_0x22c1('0x211')]={'start':0x0,'count':Infinity};this[_0x22c1('0x11e')]={};this[_0x22c1('0x212')]=[];this[_0x22c1('0x213')]=[];this[_0x22c1('0x214')]=[];this[_0x22c1('0x215')]=[];this[_0x22c1('0x216')]=[];}BufferGeometry['prototype']=Object[_0x22c1('0x48')](Object[_0x22c1('0x13')](EventDispatcher['prototype']),{'constructor':BufferGeometry,'isBufferGeometry':!![],'getIndex':function getIndex(){return this[_0x22c1('0x1e8')];},'setIndex':function setIndex(index){if(Array['isArray'](index)){this[_0x22c1('0x1e8')]=new((arrayMax(index))>0xffff?Uint32BufferAttribute:Uint16BufferAttribute)(index,0x1);}else{this[_0x22c1('0x1e8')]=index;}},'setIndexYunyang':function setIndexYunyang(index){if(Array['isArray'](index)){this[_0x22c1('0x1e8')]=new Uint32BufferAttribute(index,0x1);}else{this[_0x22c1('0x1e8')]=index;}},'addAttribute':function addAttribute(name,attribute){if(!(attribute&&attribute[_0x22c1('0x217')])&&!(attribute&&attribute[_0x22c1('0x218')])){console[_0x22c1('0x6b')]('THREE.BufferGeometry:\x20.addAttribute()\x20now\x20expects\x20(\x20name,\x20attribute\x20).');return this[_0x22c1('0x219')](name,new BufferAttribute(arguments[0x1],arguments[0x2]));}if(name==='index'){console['warn'](_0x22c1('0x21a'));this[_0x22c1('0x21b')](attribute);return this;}this[_0x22c1('0xed')][name]=attribute;return this;},'getAttribute':function getAttribute(name){return this[_0x22c1('0xed')][name];},'removeAttribute':function removeAttribute(name){delete this[_0x22c1('0xed')][name];return this;},'addGroup':function addGroup(start,count,materialIndex){this[_0x22c1('0x20b')]['push']({'start':start,'count':count,'materialIndex':materialIndex!==undefined?materialIndex:0x0});},'clearGroups':function clearGroups(){this[_0x22c1('0x20b')]=[];},'setDrawRange':function setDrawRange(start,count){this['drawRange'][_0x22c1('0x20a')]=start;this[_0x22c1('0x211')][_0x22c1('0xd7')]=count;},'applyMatrix':function applyMatrix(matrix){var position=this[_0x22c1('0xed')][_0x22c1('0xee')];if(position!==undefined){matrix[_0x22c1('0x21c')](position);position[_0x22c1('0x202')]=!![];}var normal=this[_0x22c1('0xed')][_0x22c1('0x1e')];if(normal!==undefined){var normalMatrix=new Matrix3()[_0x22c1('0xd9')](matrix);normalMatrix['applyToBufferAttribute'](normal);normal['needsUpdate']=!![];}if(this[_0x22c1('0x1e4')]!==null){this[_0x22c1('0x1e5')]();}if(this[_0x22c1('0x1e6')]!==null){this[_0x22c1('0x1e7')]();}return this;},'translate':function(){var m1=new Matrix4();return function translate(x,y,z){m1['makeTranslation'](x,y,z);this[_0x22c1('0x1eb')](m1);return this;};}(),'scale':function(){var m1=new Matrix4();return function scale(x,y,z){m1[_0x22c1('0x7f')](x,y,z);this['applyMatrix'](m1);return this;};}(),'center':function(){var offset=new Vector3();return function center(){this[_0x22c1('0x1e5')]();this[_0x22c1('0x1e4')][_0x22c1('0xe4')](offset)[_0x22c1('0xc2')]();this[_0x22c1('0xdb')](offset['x'],offset['y'],offset['z']);return this;};}(),'setFromObject':function setFromObject(object){var geometry=object[_0x22c1('0xe9')];if(object[_0x22c1('0x13b')]||object[_0x22c1('0x13a')]){var positions=new Float32BufferAttribute(geometry[_0x22c1('0xeb')]['length']*0x3,0x3);this[_0x22c1('0x219')](_0x22c1('0xee'),positions[_0x22c1('0x21d')](geometry['vertices']));if(geometry[_0x22c1('0x1f9')]&&geometry[_0x22c1('0x1f9')]['length']===geometry[_0x22c1('0xeb')][_0x22c1('0x32')]){var lineDistances=new Float32BufferAttribute(geometry['lineDistances']['length'],0x1);this[_0x22c1('0x219')]('lineDistance',lineDistances[_0x22c1('0x21e')](geometry[_0x22c1('0x1f9')]));}if(geometry[_0x22c1('0x1e6')]!==null){this[_0x22c1('0x1e6')]=geometry['boundingSphere']['clone']();}if(geometry[_0x22c1('0x1e4')]!==null){this[_0x22c1('0x1e4')]=geometry[_0x22c1('0x1e4')][_0x22c1('0x8d')]();}}else if(object[_0x22c1('0x139')]){if(geometry&&geometry['isGeometry']){this['fromGeometry'](geometry);}}return this;},'setFromPoints':function setFromPoints(points){var position=[];for(var i=0x0,l=points[_0x22c1('0x32')];i<l;i++){var point=points[i];position['push'](point['x'],point['y'],point['z']||0x0);}this[_0x22c1('0x219')](_0x22c1('0xee'),new Float32BufferAttribute(position,0x3));return this;},'fromGeometry':function fromGeometry(geometry){geometry['__directGeometry']=new DirectGeometry()[_0x22c1('0x21f')](geometry);return this[_0x22c1('0x220')](geometry[_0x22c1('0x221')]);},'computeBoundingBox':function computeBoundingBox(){if(!this[_0x22c1('0x1e4')]){this[_0x22c1('0x1e4')]=new Box3();}var position=this['attributes']['position'];if(position!==undefined){this[_0x22c1('0x1e4')][_0x22c1('0x222')](position);}else{this['boundingBox'][_0x22c1('0xdf')]();}if(isNaN(this['boundingBox']['min']['x'])||isNaN(this[_0x22c1('0x1e4')][_0x22c1('0x54')]['y'])||isNaN(this[_0x22c1('0x1e4')][_0x22c1('0x54')]['z'])){console[_0x22c1('0xb0')](_0x22c1('0x223'),this);}},'computeFaceNormals':function computeFaceNormals(){},'computeVertexNormals':function computeVertexNormals(){var index=this[_0x22c1('0x1e8')];var attributes=this['attributes'];if(attributes[_0x22c1('0xee')]){var positions=attributes[_0x22c1('0xee')][_0x22c1('0x1e9')];if(attributes[_0x22c1('0x1e')]===undefined){this['addAttribute']('normal',new BufferAttribute(new Float32Array(positions['length']),0x3));}else{var array=attributes[_0x22c1('0x1e')]['array'];for(var i=0x0,il=array[_0x22c1('0x32')];i<il;i++){array[i]=0x0;}}var normals=attributes['normal']['array'];var vA,vB,vC;var pA=new Vector3();var pB=new Vector3();var pC=new Vector3();var cb=new Vector3();var ab=new Vector3();if(index){var indices=index[_0x22c1('0x1e9')];for(var _i=0x0,_il=index['count'];_i<_il;_i+=0x3){vA=indices[_i+0x0]*0x3;vB=indices[_i+0x1]*0x3;vC=indices[_i+0x2]*0x3;pA[_0x22c1('0xa0')](positions,vA);pB['fromArray'](positions,vB);pC[_0x22c1('0xa0')](positions,vC);cb[_0x22c1('0xad')](pC,pB);ab[_0x22c1('0xad')](pA,pB);cb[_0x22c1('0x105')](ab);normals[vA]+=cb['x'];normals[vA+0x1]+=cb['y'];normals[vA+0x2]+=cb['z'];normals[vB]+=cb['x'];normals[vB+0x1]+=cb['y'];normals[vB+0x2]+=cb['z'];normals[vC]+=cb['x'];normals[vC+0x1]+=cb['y'];normals[vC+0x2]+=cb['z'];}}else{for(var _i2=0x0,_il2=positions[_0x22c1('0x32')];_i2<_il2;_i2+=0x9){pA[_0x22c1('0xa0')](positions,_i2);pB[_0x22c1('0xa0')](positions,_i2+0x3);pC[_0x22c1('0xa0')](positions,_i2+0x6);cb['subVectors'](pC,pB);ab[_0x22c1('0xad')](pA,pB);cb[_0x22c1('0x105')](ab);normals[_i2]=cb['x'];normals[_i2+0x1]=cb['y'];normals[_i2+0x2]=cb['z'];normals[_i2+0x3]=cb['x'];normals[_i2+0x4]=cb['y'];normals[_i2+0x5]=cb['z'];normals[_i2+0x6]=cb['x'];normals[_i2+0x7]=cb['y'];normals[_i2+0x8]=cb['z'];}}this[_0x22c1('0x224')]();attributes[_0x22c1('0x1e')]['needsUpdate']=!![];}},'computeVertexNormals4TextgeometryYunyang':function computeVertexNormals4TextgeometryYunyang(shadingSmoothAngle){var attributes=this[_0x22c1('0xed')];if(attributes[_0x22c1('0xee')]){var positions=attributes['position'][_0x22c1('0x1e9')];if(attributes[_0x22c1('0x1e')]===undefined){this[_0x22c1('0x219')](_0x22c1('0x1e'),new BufferAttribute(new Float32Array(positions['length']),0x3));}else{var array=attributes['normal'][_0x22c1('0x1e9')];for(var i=0x0,il=array[_0x22c1('0x32')];i<il;i++){array[i]=0x0;}}var normals=attributes['normal']['array'];var faceIdAndNormalMap={};var positionIdAndKeyMap={};var KeyAndPositionIdMap={};var pA=new Vector3();var materialIDs=[];for(var _i3=0x0,_il3=positions['length'];_i3<_il3;_i3+=0x3){pA[_0x22c1('0xa0')](positions,_i3);var id=_i3/0x3;var materialId=-0x1;for(var gId=0x0;gId<this[_0x22c1('0x20b')][_0x22c1('0x32')];gId++){if(id>=this['groups'][gId][_0x22c1('0x20a')]&&id<=this[_0x22c1('0x20b')][gId][_0x22c1('0x20a')]+this[_0x22c1('0x20b')][gId][_0x22c1('0xd7')]-0x1){materialId=this[_0x22c1('0x20b')][gId][_0x22c1('0xd5')];break;}}if(materialId===-0x1){console['log'](_0x22c1('0x225'));}if(materialId===0x2)materialId=0x1;materialIDs['push'](materialId);var key=''+Math['floor'](pA['x']*0x2710)+Math[_0x22c1('0x55')](pA['y']*0x2710)+Math[_0x22c1('0x55')](pA['z']*0x2710)+materialId;positionIdAndKeyMap[id]=key;if(!KeyAndPositionIdMap[key]){KeyAndPositionIdMap[key]=[];}KeyAndPositionIdMap[key]['push'](id);}var pB=new Vector3();var pC=new Vector3();for(var _i4=0x0,_il4=positions['length'];_i4<_il4;_i4+=0x9){var cb=new Vector3();var ab=new Vector3();pA[_0x22c1('0xa0')](positions,_i4);pB[_0x22c1('0xa0')](positions,_i4+0x3);pC['fromArray'](positions,_i4+0x6);cb[_0x22c1('0xad')](pC,pB);ab[_0x22c1('0xad')](pA,pB);cb['cross'](ab);cb[_0x22c1('0x6a')]();var faceId=~~(_i4/0x9);faceIdAndNormalMap[faceId]=cb;}var rad2degree=0xb4/Math['PI'];for(var _i5=0x0,_il5=positions[_0x22c1('0x32')];_i5<_il5;_i5+=0x3){var thisPositionId=_i5/0x3;var _key=positionIdAndKeyMap[thisPositionId];var thisFaceId=parseInt(thisPositionId/0x3);var thisNormal=faceIdAndNormalMap[thisFaceId];var sumNormal=new Vector3(0x0,0x0,0x0);var positionIdList=KeyAndPositionIdMap[_key];for(var m=0x0;m<positionIdList[_0x22c1('0x32')];m++){var _faceId=parseInt(positionIdList[m]/0x3);var faceNormal=faceIdAndNormalMap[_faceId];var angle=thisNormal[_0x22c1('0x96')](faceNormal)*rad2degree;if(angle<shadingSmoothAngle){sumNormal['add'](faceNormal);}}sumNormal['normalize']();normals[_i5]=sumNormal['x'];normals[_i5+0x1]=sumNormal['y'];normals[_i5+0x2]=sumNormal['z'];}attributes[_0x22c1('0x1e')][_0x22c1('0x202')]=!![];}},'perCharCalculation':function perCharCalculation(){var attributes=this[_0x22c1('0xed')];var positions=attributes[_0x22c1('0xee')][_0x22c1('0x1e9')];var vertexNumb=parseInt(positions['length']/0x3);if(this[_0x22c1('0x1e4')]===null){this[_0x22c1('0x1e5')]();}var center=new Vector3();this['boundingBox'][_0x22c1('0xe4')](center);var minX=this[_0x22c1('0x1e4')]['min']['x'];var maxX=this[_0x22c1('0x1e4')][_0x22c1('0x53')]['x'];for(var i=0x0;i<vertexNumb;i++){var charID=this[_0x22c1('0x212')][i];if(this['charBBoxArray'][charID]===undefined){this['charBBoxArray'][charID]=new Box3();}if(this[_0x22c1('0x213')][charID]===undefined){this[_0x22c1('0x213')][charID]=new Vector3();}var tempPosition=new Vector3();tempPosition['fromArray'](positions,i*0x3);this[_0x22c1('0x216')][charID][_0x22c1('0xe0')](tempPosition);if(this['charVertexCountArray'][charID]===undefined){this[_0x22c1('0x215')][charID]=0x0;}this[_0x22c1('0x215')][charID]=this[_0x22c1('0x215')][charID]+0x1;}for(var _i6=0x0;_i6<this[_0x22c1('0x215')][_0x22c1('0x32')];_i6++){var _charID=_i6;this[_0x22c1('0x216')][_charID][_0x22c1('0xe4')](this[_0x22c1('0x213')][_charID]);this['charCenterArrayT']['push']((this[_0x22c1('0x213')][_charID]['x']-minX)/(maxX-minX));}},'mergeSameVertex':function mergeSameVertex(){debug[_0x22c1('0x226')](_0x22c1('0x227'));var attributes=this['attributes'];var positions=attributes[_0x22c1('0xee')][_0x22c1('0x1e9')];var normals=attributes[_0x22c1('0x1e')][_0x22c1('0x1e9')];var uvs=attributes['uv'][_0x22c1('0x1e9')];debug[_0x22c1('0x59')]('before\x20merge\x20the\x20vertex\x20number\x20is\x20'+positions['length']);var indexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var KeyAndPositionIdMap={};var newIndex=[];var newPositions=[];var newNormals=[];var newUvs=[];var newCharVertexFlagArray=[];var newIndexCount=0x0;for(var i=0x0;i<indexNumb;i++){var tempPosition=new Vector3();var tempNormal=new Vector3();var tempUv=new Vector2();var tempCharVertexFlag=this[_0x22c1('0x212')][i];tempPosition[_0x22c1('0xa0')](positions,i*0x3);tempNormal['fromArray'](normals,i*0x3);tempUv[_0x22c1('0xa0')](uvs,i*0x2);var materialId=0x1;for(var gId=0x0;gId<this['groups'][_0x22c1('0x32')];gId=gId+0x2){if(i>=this['groups'][gId][_0x22c1('0x20a')]&&i<=this[_0x22c1('0x20b')][gId][_0x22c1('0x20a')]+this['groups'][gId][_0x22c1('0xd7')]-0x1){materialId=0x0;break;}}var key=''+Math[_0x22c1('0x55')](tempPosition['x']*0x2710)+Math['floor'](tempPosition['y']*0x2710)+Math[_0x22c1('0x55')](tempPosition['z']*0x2710)+Math[_0x22c1('0x55')](tempNormal['x']*0x2710)+Math[_0x22c1('0x55')](tempNormal['y']*0x2710)+Math[_0x22c1('0x55')](tempNormal['z']*0x2710)+Math[_0x22c1('0x55')](tempUv['x']*0x2710)+Math[_0x22c1('0x55')](tempUv['y']*0x2710)+materialId;if(!KeyAndPositionIdMap[key]){KeyAndPositionIdMap[key]=newIndexCount;newPositions['push'](tempPosition);newNormals[_0x22c1('0x2e')](tempNormal);newUvs[_0x22c1('0x2e')](tempUv);newIndex[_0x22c1('0x2e')](newIndexCount);newIndexCount++;newCharVertexFlagArray[_0x22c1('0x2e')](tempCharVertexFlag);}else{newIndex[_0x22c1('0x2e')](KeyAndPositionIdMap[key]);}}var newPositionBufferAttribute=new Float32BufferAttribute(new Float32Array(newPositions[_0x22c1('0x32')]*0x3),0x3);newPositionBufferAttribute[_0x22c1('0x21d')](newPositions);var newNormalBufferAttribute=new Float32BufferAttribute(new Float32Array(newPositions[_0x22c1('0x32')]*0x3),0x3);newNormalBufferAttribute[_0x22c1('0x21d')](newNormals);var newUvBufferAttribute=new Float32BufferAttribute(new Float32Array(newUvs[_0x22c1('0x32')]*0x2),0x2);newUvBufferAttribute[_0x22c1('0x228')](newUvs);this[_0x22c1('0x229')](newIndex);attributes[_0x22c1('0xee')]['copy'](newPositionBufferAttribute);attributes[_0x22c1('0x1e')][_0x22c1('0x82')](newNormalBufferAttribute);attributes['uv'][_0x22c1('0x82')](newUvBufferAttribute);attributes[_0x22c1('0xee')][_0x22c1('0x202')]=!![];attributes[_0x22c1('0x1e')][_0x22c1('0x202')]=!![];attributes['uv']['needsUpdate']=!![];this[_0x22c1('0x212')]=newCharVertexFlagArray;debug[_0x22c1('0x59')](_0x22c1('0x22a')+newPositions[_0x22c1('0x32')]);debug[_0x22c1('0x22b')](_0x22c1('0x227'));},'merge':function merge(geometry,offset){if(!(geometry&&geometry[_0x22c1('0xec')])){console['error']('THREE.BufferGeometry.merge():\x20geometry\x20not\x20an\x20instance\x20of\x20THREE.BufferGeometry.',geometry);return;}if(offset===undefined){offset=0x0;console['warn'](_0x22c1('0x22c')+_0x22c1('0x22d'));}var attributes=this[_0x22c1('0xed')];for(var key in attributes){if(geometry[_0x22c1('0xed')][key]===undefined)continue;var attribute1=attributes[key];var attributeArray1=attribute1[_0x22c1('0x1e9')];var attribute2=geometry[_0x22c1('0xed')][key];var attributeArray2=attribute2[_0x22c1('0x1e9')];var attributeSize=attribute2[_0x22c1('0x204')];for(var i=0x0,j=attributeSize*offset;i<attributeArray2[_0x22c1('0x32')];i++,j++){attributeArray1[j]=attributeArray2[i];}}return this;},'normalizeNormals':function(){var vector=new Vector3();return function normalizeNormals(){var normals=this[_0x22c1('0xed')][_0x22c1('0x1e')];for(var i=0x0,il=normals[_0x22c1('0xd7')];i<il;i++){vector['x']=normals['getX'](i);vector['y']=normals[_0x22c1('0x71')](i);vector['z']=normals[_0x22c1('0x72')](i);vector[_0x22c1('0x6a')]();normals[_0x22c1('0x73')](i,vector['x'],vector['y'],vector['z']);}};}(),'toNonIndexed':function toNonIndexed(){if(this['index']===null){console['warn'](_0x22c1('0x22e'));return this;}var geometry2=new BufferGeometry();var indices=this[_0x22c1('0x1e8')][_0x22c1('0x1e9')];var attributes=this['attributes'];for(var name in attributes){var attribute=attributes[name];var array=attribute[_0x22c1('0x1e9')];var itemSize=attribute[_0x22c1('0x204')];var array2=new array[(_0x22c1('0xd'))](indices[_0x22c1('0x32')]*itemSize);var index=0x0;var index2=0x0;for(var i=0x0,l=indices[_0x22c1('0x32')];i<l;i++){index=indices[i]*itemSize;for(var j=0x0;j<itemSize;j++){array2[index2++]=array[index++];}}geometry2[_0x22c1('0x219')](name,new BufferAttribute(array2,itemSize));}var groups=this[_0x22c1('0x20b')];for(var _i7=0x0,_l=groups[_0x22c1('0x32')];_i7<_l;_i7++){var group=groups[_i7];geometry2['addGroup'](group[_0x22c1('0x20a')],group[_0x22c1('0xd7')],group['materialIndex']);}return geometry2;},'toJSON':function toJSON(){var data={'metadata':{'version':4.5,'type':'BufferGeometry','generator':'BufferGeometry.toJSON'}};data[_0x22c1('0x114')]=this[_0x22c1('0x114')];data['type']=this[_0x22c1('0x1f')];if(this[_0x22c1('0x116')]!=='')data['name']=this['name'];if(Object[_0x22c1('0x3b')](this[_0x22c1('0x11e')])['length']>0x0)data['userData']=this[_0x22c1('0x11e')];if(this['parameters']!==undefined){var parameters=this[_0x22c1('0x13d')];for(var key in parameters){if(parameters[key]!==undefined)data[key]=parameters[key];}return data;}data[_0x22c1('0x1f5')]={'attributes':{}};var index=this['index'];if(index!==null){var array=Array[_0x22c1('0x1')][_0x22c1('0x40')][_0x22c1('0x2')](index['array']);data[_0x22c1('0x1f5')][_0x22c1('0x1e8')]={'type':index[_0x22c1('0x1e9')][_0x22c1('0xd')][_0x22c1('0x116')],'array':array};}var attributes=this[_0x22c1('0xed')];for(var _key2 in attributes){var attribute=attributes[_key2];var _array=Array[_0x22c1('0x1')][_0x22c1('0x40')]['call'](attribute[_0x22c1('0x1e9')]);data[_0x22c1('0x1f5')]['attributes'][_key2]={'itemSize':attribute[_0x22c1('0x204')],'type':attribute[_0x22c1('0x1e9')]['constructor'][_0x22c1('0x116')],'array':_array,'normalized':attribute['normalized']};}var groups=this[_0x22c1('0x20b')];if(groups[_0x22c1('0x32')]>0x0){data[_0x22c1('0x1f5')][_0x22c1('0x20b')]=JSON[_0x22c1('0x22f')](JSON[_0x22c1('0x137')](groups));}var boundingSphere=this[_0x22c1('0x1e6')];if(boundingSphere!==null){data[_0x22c1('0x1f5')][_0x22c1('0x1e6')]={'center':boundingSphere[_0x22c1('0xf9')][_0x22c1('0x86')](),'radius':boundingSphere['radius']};}return data;},'clone':function clone(){return new BufferGeometry()[_0x22c1('0x82')](this);},'copy':function copy(source){var name,i,l;this[_0x22c1('0x1e8')]=null;this['attributes']={};this[_0x22c1('0x210')]={};this['groups']=[];this['boundingBox']=null;this['boundingSphere']=null;this[_0x22c1('0x116')]=source[_0x22c1('0x116')];var index=source[_0x22c1('0x1e8')];if(index!==null){this[_0x22c1('0x21b')](index['clone']());}var attributes=source[_0x22c1('0xed')];for(name in attributes){var attribute=attributes[name];this['addAttribute'](name,attribute['clone']());}var morphAttributes=source[_0x22c1('0x210')];for(name in morphAttributes){var array=[];var morphAttribute=morphAttributes[name];for(i=0x0,l=morphAttribute['length'];i<l;i++){array[_0x22c1('0x2e')](morphAttribute[i][_0x22c1('0x8d')]());}this[_0x22c1('0x210')][name]=array;}var groups=source[_0x22c1('0x20b')];for(i=0x0,l=groups[_0x22c1('0x32')];i<l;i++){var group=groups[i];this[_0x22c1('0x230')](group['start'],group['count'],group[_0x22c1('0xd5')]);}var boundingBox=source[_0x22c1('0x1e4')];if(boundingBox!==null){this[_0x22c1('0x1e4')]=boundingBox[_0x22c1('0x8d')]();}var boundingSphere=source['boundingSphere'];if(boundingSphere!==null){this[_0x22c1('0x1e6')]=boundingSphere[_0x22c1('0x8d')]();}this[_0x22c1('0x211')]['start']=source['drawRange'][_0x22c1('0x20a')];this[_0x22c1('0x211')][_0x22c1('0xd7')]=source[_0x22c1('0x211')][_0x22c1('0xd7')];this['userData']=source['userData'];return this;},'dispose':function dispose(){this[_0x22c1('0x125')]({'type':_0x22c1('0x1fa')});}});var Box2=function(){function Box2(min,max){_classCallCheck(this,Box2);this[_0x22c1('0x54')]=min!==undefined?min:new Vector2(+Infinity,+Infinity);this[_0x22c1('0x53')]=max!==undefined?max:new Vector2(-Infinity,-Infinity);}_createClass(Box2,[{'key':_0x22c1('0x5e'),'value':function set(min,max){this[_0x22c1('0x54')][_0x22c1('0x82')](min);this[_0x22c1('0x53')][_0x22c1('0x82')](max);return this;}},{'key':_0x22c1('0xde'),'value':function setFromPoints(points){this['makeEmpty']();for(var i=0x0,il=points[_0x22c1('0x32')];i<il;i++){this['expandByPoint'](points[i]);}return this;}},{'key':_0x22c1('0x231'),'value':function setFromCenterAndSize(center,size){var halfSize=size[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0.5);this[_0x22c1('0x54')][_0x22c1('0x82')](center)[_0x22c1('0xab')](halfSize);this['max'][_0x22c1('0x82')](center)[_0x22c1('0xc5')](halfSize);return this;}},{'key':'clone','value':function clone(){return new this[(_0x22c1('0xd'))]()[_0x22c1('0x82')](this);}},{'key':_0x22c1('0x82'),'value':function copy(box){this['min']['copy'](box[_0x22c1('0x54')]);this[_0x22c1('0x53')][_0x22c1('0x82')](box[_0x22c1('0x53')]);return this;}},{'key':'makeEmpty','value':function makeEmpty(){this[_0x22c1('0x54')]['x']=this['min']['y']=+Infinity;this[_0x22c1('0x53')]['x']=this[_0x22c1('0x53')]['y']=-Infinity;return this;}},{'key':_0x22c1('0xe3'),'value':function isEmpty(){return this[_0x22c1('0x53')]['x']<this['min']['x']||this[_0x22c1('0x53')]['y']<this[_0x22c1('0x54')]['y'];}},{'key':'getCenter','value':function getCenter(target){if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0x232'));target=new Vector2();}return this[_0x22c1('0xe3')]()?target[_0x22c1('0x5e')](0x0,0x0):target['addVectors'](this[_0x22c1('0x54')],this[_0x22c1('0x53')])[_0x22c1('0x6f')](0.5);}},{'key':_0x22c1('0xe6'),'value':function getSize(target){if(target===undefined){console[_0x22c1('0x6b')](_0x22c1('0x233'));target=new Vector2();}return this[_0x22c1('0xe3')]()?target[_0x22c1('0x5e')](0x0,0x0):target[_0x22c1('0xad')](this[_0x22c1('0x53')],this[_0x22c1('0x54')]);}},{'key':_0x22c1('0xe0'),'value':function expandByPoint(point){this[_0x22c1('0x54')][_0x22c1('0x54')](point);this[_0x22c1('0x53')]['max'](point);return this;}},{'key':_0x22c1('0xe7'),'value':function expandByVector(vector){this[_0x22c1('0x54')][_0x22c1('0xab')](vector);this[_0x22c1('0x53')][_0x22c1('0xc5')](vector);return this;}},{'key':_0x22c1('0xe8'),'value':function expandByScalar(scalar){this['min'][_0x22c1('0xa9')](-scalar);this[_0x22c1('0x53')]['addScalar'](scalar);return this;}},{'key':_0x22c1('0x234'),'value':function containsPoint(point){return!(point['x']<this[_0x22c1('0x54')]['x']||point['x']>this[_0x22c1('0x53')]['x']||point['y']<this[_0x22c1('0x54')]['y']||point['y']>this[_0x22c1('0x53')]['y']);}},{'key':_0x22c1('0xf1'),'value':function containsBox(box){return this[_0x22c1('0x54')]['x']<=box[_0x22c1('0x54')]['x']&&box['max']['x']<=this[_0x22c1('0x53')]['x']&&this[_0x22c1('0x54')]['y']<=box['min']['y']&&box[_0x22c1('0x53')]['y']<=this[_0x22c1('0x53')]['y'];}},{'key':'getParameter','value':function getParameter(point,target){if(target===undefined){console['warn'](_0x22c1('0x235'));target=new Vector2();}return target['set']((point['x']-this[_0x22c1('0x54')]['x'])/(this[_0x22c1('0x53')]['x']-this[_0x22c1('0x54')]['x']),(point['y']-this[_0x22c1('0x54')]['y'])/(this[_0x22c1('0x53')]['y']-this[_0x22c1('0x54')]['y']));}},{'key':_0x22c1('0xf3'),'value':function intersectsBox(box){return!(box[_0x22c1('0x53')]['x']<this[_0x22c1('0x54')]['x']||box[_0x22c1('0x54')]['x']>this[_0x22c1('0x53')]['x']||box['max']['y']<this['min']['y']||box[_0x22c1('0x54')]['y']>this[_0x22c1('0x53')]['y']);}},{'key':_0x22c1('0xf4'),'value':function clampPoint(point,target){if(target===undefined){console['warn'](_0x22c1('0x236'));target=new Vector2();}return target[_0x22c1('0x82')](point)['clamp'](this[_0x22c1('0x54')],this[_0x22c1('0x53')]);}},{'key':'distanceToPoint','value':function distanceToPoint(point){var clampedPoint=point[_0x22c1('0x8d')]()[_0x22c1('0x98')](this[_0x22c1('0x54')],this[_0x22c1('0x53')]);return clampedPoint['sub'](point)[_0x22c1('0x32')]();}},{'key':_0x22c1('0x237'),'value':function intersect(box){this[_0x22c1('0x54')]['max'](box[_0x22c1('0x54')]);this[_0x22c1('0x53')]['min'](box[_0x22c1('0x53')]);return this;}},{'key':_0x22c1('0xfa'),'value':function union(box){this[_0x22c1('0x54')]['min'](box['min']);this[_0x22c1('0x53')][_0x22c1('0x53')](box[_0x22c1('0x53')]);return this;}},{'key':'translate','value':function translate(offset){this[_0x22c1('0x54')][_0x22c1('0xc5')](offset);this[_0x22c1('0x53')][_0x22c1('0xc5')](offset);return this;}},{'key':_0x22c1('0x85'),'value':function equals(box){return box[_0x22c1('0x54')][_0x22c1('0x85')](this[_0x22c1('0x54')])&&box[_0x22c1('0x53')][_0x22c1('0x85')](this[_0x22c1('0x53')]);}}]);return Box2;}();var earcut_1=earcut;var default_1=earcut;function earcut(data,holeIndices,dim){dim=dim||0x2;var hasHoles=holeIndices&&holeIndices['length'],outerLen=hasHoles?holeIndices[0x0]*dim:data[_0x22c1('0x32')],outerNode=linkedList(data,0x0,outerLen,dim,!![]),triangles=[];if(!outerNode||outerNode[_0x22c1('0x29')]===outerNode['prev'])return triangles;var minX,minY,maxX,maxY,x,y,invSize;if(hasHoles)outerNode=eliminateHoles(data,holeIndices,outerNode,dim);if(data[_0x22c1('0x32')]>0x50*dim){minX=maxX=data[0x0];minY=maxY=data[0x1];for(var i=dim;i<outerLen;i+=dim){x=data[i];y=data[i+0x1];if(x<minX)minX=x;if(y<minY)minY=y;if(x>maxX)maxX=x;if(y>maxY)maxY=y;}invSize=Math['max'](maxX-minX,maxY-minY);invSize=invSize!==0x0?0x1/ invSize:0x0;}earcutLinked(outerNode,triangles,dim,minX,minY,invSize);return triangles;}function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===signedArea(data,start,end,dim)>0x0){for(i=start;i<end;i+=dim){last=insertNode(i,data[i],data[i+0x1],last);}}else{for(i=end-dim;i>=start;i-=dim){last=insertNode(i,data[i],data[i+0x1],last);}}if(last&&equals(last,last['next'])){removeNode(last);last=last[_0x22c1('0x29')];}return last;}function filterPoints(start,end){if(!start)return start;if(!end)end=start;var p=start,again;do{again=![];if(!p[_0x22c1('0x238')]&&(equals(p,p['next'])||area(p['prev'],p,p[_0x22c1('0x29')])===0x0)){removeNode(p);p=end=p['prev'];if(p===p[_0x22c1('0x29')])break;again=!![];}else{p=p[_0x22c1('0x29')];}}while(again||p!==end);return end;}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(!ear)return;if(!pass&&invSize)indexCurve(ear,minX,minY,invSize);var stop=ear,prev,next;while(ear[_0x22c1('0x3d')]!==ear[_0x22c1('0x29')]){prev=ear[_0x22c1('0x3d')];next=ear[_0x22c1('0x29')];if(invSize?isEarHashed(ear,minX,minY,invSize):isEar(ear)){triangles[_0x22c1('0x2e')](prev['i']/dim);triangles[_0x22c1('0x2e')](ear['i']/dim);triangles[_0x22c1('0x2e')](next['i']/dim);removeNode(ear);ear=next[_0x22c1('0x29')];stop=next[_0x22c1('0x29')];continue;}ear=next;if(ear===stop){if(!pass){earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,0x1);}else if(pass===0x1){ear=cureLocalIntersections(filterPoints(ear),triangles,dim);earcutLinked(ear,triangles,dim,minX,minY,invSize,0x2);}else if(pass===0x2){splitEarcut(ear,triangles,dim,minX,minY,invSize);}break;}}}function isEar(ear){var a=ear[_0x22c1('0x3d')],b=ear,c=ear[_0x22c1('0x29')];if(area(a,b,c)>=0x0)return![];var p=ear[_0x22c1('0x29')][_0x22c1('0x29')];while(p!==ear[_0x22c1('0x3d')]){if(pointInTriangle(a['x'],a['y'],b['x'],b['y'],c['x'],c['y'],p['x'],p['y'])&&area(p['prev'],p,p[_0x22c1('0x29')])>=0x0)return![];p=p[_0x22c1('0x29')];}return!![];}function isEarHashed(ear,minX,minY,invSize){var a=ear[_0x22c1('0x3d')],b=ear,c=ear[_0x22c1('0x29')];if(area(a,b,c)>=0x0)return![];var minTX=a['x']<b['x']?a['x']<c['x']?a['x']:c['x']:b['x']<c['x']?b['x']:c['x'],minTY=a['y']<b['y']?a['y']<c['y']?a['y']:c['y']:b['y']<c['y']?b['y']:c['y'],maxTX=a['x']>b['x']?a['x']>c['x']?a['x']:c['x']:b['x']>c['x']?b['x']:c['x'],maxTY=a['y']>b['y']?a['y']>c['y']?a['y']:c['y']:b['y']>c['y']?b['y']:c['y'];var minZ=zOrder(minTX,minTY,minX,minY,invSize),maxZ=zOrder(maxTX,maxTY,minX,minY,invSize);var p=ear['prevZ'],n=ear[_0x22c1('0x239')];while(p&&p['z']>=minZ&&n&&n['z']<=maxZ){if(p!==ear[_0x22c1('0x3d')]&&p!==ear['next']&&pointInTriangle(a['x'],a['y'],b['x'],b['y'],c['x'],c['y'],p['x'],p['y'])&&area(p['prev'],p,p['next'])>=0x0)return![];p=p[_0x22c1('0x23a')];if(n!==ear['prev']&&n!==ear[_0x22c1('0x29')]&&pointInTriangle(a['x'],a['y'],b['x'],b['y'],c['x'],c['y'],n['x'],n['y'])&&area(n['prev'],n,n[_0x22c1('0x29')])>=0x0)return![];n=n[_0x22c1('0x239')];}while(p&&p['z']>=minZ){if(p!==ear['prev']&&p!==ear['next']&&pointInTriangle(a['x'],a['y'],b['x'],b['y'],c['x'],c['y'],p['x'],p['y'])&&area(p['prev'],p,p['next'])>=0x0)return![];p=p[_0x22c1('0x23a')];}while(n&&n['z']<=maxZ){if(n!==ear[_0x22c1('0x3d')]&&n!==ear[_0x22c1('0x29')]&&pointInTriangle(a['x'],a['y'],b['x'],b['y'],c['x'],c['y'],n['x'],n['y'])&&area(n[_0x22c1('0x3d')],n,n[_0x22c1('0x29')])>=0x0)return![];n=n[_0x22c1('0x239')];}return!![];}function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p[_0x22c1('0x3d')],b=p['next']['next'];if(!equals(a,b)&&intersects(a,p,p[_0x22c1('0x29')],b)&&locallyInside(a,b)&&locallyInside(b,a)){triangles[_0x22c1('0x2e')](a['i']/dim);triangles[_0x22c1('0x2e')](p['i']/dim);triangles[_0x22c1('0x2e')](b['i']/dim);removeNode(p);removeNode(p[_0x22c1('0x29')]);p=start=b;}p=p['next'];}while(p!==start);return filterPoints(p);}function splitEarcut(start,triangles,dim,minX,minY,invSize){var a=start;do{var b=a['next']['next'];while(b!==a[_0x22c1('0x3d')]){if(a['i']!==b['i']&&isValidDiagonal(a,b)){var c=splitPolygon(a,b);a=filterPoints(a,a['next']);c=filterPoints(c,c[_0x22c1('0x29')]);earcutLinked(a,triangles,dim,minX,minY,invSize);earcutLinked(c,triangles,dim,minX,minY,invSize);return;}b=b['next'];}a=a[_0x22c1('0x29')];}while(a!==start);}function eliminateHoles(data,holeIndices,outerNode,dim){var queue=[],i,len,start,end,list;for(i=0x0,len=holeIndices['length'];i<len;i++){start=holeIndices[i]*dim;end=i<len-0x1?holeIndices[i+0x1]*dim:data[_0x22c1('0x32')];list=linkedList(data,start,end,dim,![]);if(list===list[_0x22c1('0x29')])list[_0x22c1('0x238')]=!![];queue[_0x22c1('0x2e')](getLeftmost(list));}queue[_0x22c1('0x1f3')](compareX);for(i=0x0;i<queue[_0x22c1('0x32')];i++){eliminateHole(queue[i],outerNode);outerNode=filterPoints(outerNode,outerNode[_0x22c1('0x29')]);}return outerNode;}function compareX(a,b){return a['x']-b['x'];}function eliminateHole(hole,outerNode){outerNode=findHoleBridge(hole,outerNode);if(outerNode){var b=splitPolygon(outerNode,hole);filterPoints(outerNode,outerNode['next']);filterPoints(b,b[_0x22c1('0x29')]);}}function findHoleBridge(hole,outerNode){var p=outerNode,hx=hole['x'],hy=hole['y'],qx=-Infinity,m;do{if(hy<=p['y']&&hy>=p[_0x22c1('0x29')]['y']&&p[_0x22c1('0x29')]['y']!==p['y']){var x=p['x']+(hy-p['y'])*(p[_0x22c1('0x29')]['x']-p['x'])/(p[_0x22c1('0x29')]['y']-p['y']);if(x<=hx&&x>qx){qx=x;if(x===hx){if(hy===p['y'])return p;if(hy===p['next']['y'])return p[_0x22c1('0x29')];}m=p['x']<p[_0x22c1('0x29')]['x']?p:p[_0x22c1('0x29')];}}p=p[_0x22c1('0x29')];}while(p!==outerNode);if(!m)return null;if(hx===qx)return m;var stop=m,mx=m['x'],my=m['y'],tanMin=Infinity,tan;p=m;do{if(hx>=p['x']&&p['x']>=mx&&hx!==p['x']&&pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p['x'],p['y'])){tan=Math[_0x22c1('0x69')](hy-p['y'])/(hx-p['x']);if(locallyInside(p,hole)&&(tan<tanMin||tan===tanMin&&(p['x']>m['x']||p['x']===m['x']&&sectorContainsSector(m,p)))){m=p;tanMin=tan;}}p=p['next'];}while(p!==stop);return m;}function sectorContainsSector(m,p){return area(m[_0x22c1('0x3d')],m,p[_0x22c1('0x3d')])<0x0&&area(p['next'],m,m['next'])<0x0;}function indexCurve(start,minX,minY,invSize){var p=start;do{if(p['z']===null)p['z']=zOrder(p['x'],p['y'],minX,minY,invSize);p[_0x22c1('0x23a')]=p[_0x22c1('0x3d')];p[_0x22c1('0x239')]=p['next'];p=p['next'];}while(p!==start);p[_0x22c1('0x23a')][_0x22c1('0x239')]=null;p['prevZ']=null;sortLinked(p);}function sortLinked(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=0x1;do{p=list;list=null;tail=null;numMerges=0x0;while(p){numMerges++;q=p;pSize=0x0;for(i=0x0;i<inSize;i++){pSize++;q=q[_0x22c1('0x239')];if(!q)break;}qSize=inSize;while(pSize>0x0||qSize>0x0&&q){if(pSize!==0x0&&(qSize===0x0||!q||p['z']<=q['z'])){e=p;p=p['nextZ'];pSize--;}else{e=q;q=q[_0x22c1('0x239')];qSize--;}if(tail)tail[_0x22c1('0x239')]=e;else list=e;e['prevZ']=tail;tail=e;}p=q;}tail[_0x22c1('0x239')]=null;inSize*=0x2;}while(numMerges>0x1);return list;}function zOrder(x,y,minX,minY,invSize){x=0x7fff*(x-minX)*invSize;y=0x7fff*(y-minY)*invSize;x=(x|x<<0x8)&0xff00ff;x=(x|x<<0x4)&0xf0f0f0f;x=(x|x<<0x2)&0x33333333;x=(x|x<<0x1)&0x55555555;y=(y|y<<0x8)&0xff00ff;y=(y|y<<0x4)&0xf0f0f0f;y=(y|y<<0x2)&0x33333333;y=(y|y<<0x1)&0x55555555;return x|y<<0x1;}function getLeftmost(start){var p=start,leftmost=start;do{if(p['x']<leftmost['x']||p['x']===leftmost['x']&&p['y']<leftmost['y'])leftmost=p;p=p[_0x22c1('0x29')];}while(p!==start);return leftmost;}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)-(ax-px)*(cy-py)>=0x0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0x0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0x0;}function isValidDiagonal(a,b){return a[_0x22c1('0x29')]['i']!==b['i']&&a[_0x22c1('0x3d')]['i']!==b['i']&&!intersectsPolygon(a,b)&&(locallyInside(a,b)&&locallyInside(b,a)&&middleInside(a,b)&&(area(a['prev'],a,b[_0x22c1('0x3d')])||area(a,b[_0x22c1('0x3d')],b))||equals(a,b)&&area(a[_0x22c1('0x3d')],a,a[_0x22c1('0x29')])>0x0&&area(b[_0x22c1('0x3d')],b,b[_0x22c1('0x29')])>0x0);}function area(p,q,r){return(q['y']-p['y'])*(r['x']-q['x'])-(q['x']-p['x'])*(r['y']-q['y']);}function equals(p1,p2){return p1['x']===p2['x']&&p1['y']===p2['y'];}function intersects(p1,q1,p2,q2){var o1=sign(area(p1,q1,p2));var o2=sign(area(p1,q1,q2));var o3=sign(area(p2,q2,p1));var o4=sign(area(p2,q2,q1));if(o1!==o2&&o3!==o4)return!![];if(o1===0x0&&onSegment(p1,p2,q1))return!![];if(o2===0x0&&onSegment(p1,q2,q1))return!![];if(o3===0x0&&onSegment(p2,p1,q2))return!![];if(o4===0x0&&onSegment(p2,q1,q2))return!![];return![];}function onSegment(p,q,r){return q['x']<=Math[_0x22c1('0x53')](p['x'],r['x'])&&q['x']>=Math['min'](p['x'],r['x'])&&q['y']<=Math[_0x22c1('0x53')](p['y'],r['y'])&&q['y']>=Math[_0x22c1('0x54')](p['y'],r['y']);}function sign(num){return num>0x0?0x1:num<0x0?-0x1:0x0;}function intersectsPolygon(a,b){var p=a;do{if(p['i']!==a['i']&&p[_0x22c1('0x29')]['i']!==a['i']&&p['i']!==b['i']&&p[_0x22c1('0x29')]['i']!==b['i']&&intersects(p,p['next'],a,b))return!![];p=p[_0x22c1('0x29')];}while(p!==a);return![];}function locallyInside(a,b){return area(a[_0x22c1('0x3d')],a,a['next'])<0x0?area(a,b,a[_0x22c1('0x29')])>=0x0&&area(a,a[_0x22c1('0x3d')],b)>=0x0:area(a,b,a['prev'])<0x0||area(a,a[_0x22c1('0x29')],b)<0x0;}function middleInside(a,b){var p=a,inside=![],px=(a['x']+b['x'])/0x2,py=(a['y']+b['y'])/0x2;do{if(p['y']>py!==p['next']['y']>py&&p[_0x22c1('0x29')]['y']!==p['y']&&px<(p[_0x22c1('0x29')]['x']-p['x'])*(py-p['y'])/(p[_0x22c1('0x29')]['y']-p['y'])+p['x'])inside=!inside;p=p[_0x22c1('0x29')];}while(p!==a);return inside;}function splitPolygon(a,b){var a2=new Node(a['i'],a['x'],a['y']),b2=new Node(b['i'],b['x'],b['y']),an=a[_0x22c1('0x29')],bp=b[_0x22c1('0x3d')];a['next']=b;b[_0x22c1('0x3d')]=a;a2['next']=an;an[_0x22c1('0x3d')]=a2;b2[_0x22c1('0x29')]=a2;a2[_0x22c1('0x3d')]=b2;bp['next']=b2;b2['prev']=bp;return b2;}function insertNode(i,x,y,last){var p=new Node(i,x,y);if(!last){p[_0x22c1('0x3d')]=p;p[_0x22c1('0x29')]=p;}else{p[_0x22c1('0x29')]=last[_0x22c1('0x29')];p[_0x22c1('0x3d')]=last;last['next'][_0x22c1('0x3d')]=p;last[_0x22c1('0x29')]=p;}return p;}function removeNode(p){p[_0x22c1('0x29')][_0x22c1('0x3d')]=p['prev'];p[_0x22c1('0x3d')]['next']=p[_0x22c1('0x29')];if(p[_0x22c1('0x23a')])p[_0x22c1('0x23a')][_0x22c1('0x239')]=p[_0x22c1('0x239')];if(p[_0x22c1('0x239')])p[_0x22c1('0x239')]['prevZ']=p[_0x22c1('0x23a')];}function Node(i,x,y){this['i']=i;this['x']=x;this['y']=y;this[_0x22c1('0x3d')]=null;this[_0x22c1('0x29')]=null;this['z']=null;this['prevZ']=null;this[_0x22c1('0x239')]=null;this[_0x22c1('0x238')]=![];}earcut[_0x22c1('0x23b')]=function(data,holeIndices,dim,triangles){var hasHoles=holeIndices&&holeIndices[_0x22c1('0x32')];var outerLen=hasHoles?holeIndices[0x0]*dim:data[_0x22c1('0x32')];var polygonArea=Math['abs'](signedArea(data,0x0,outerLen,dim));if(hasHoles){for(var i=0x0,len=holeIndices[_0x22c1('0x32')];i<len;i++){var start=holeIndices[i]*dim;var end=i<len-0x1?holeIndices[i+0x1]*dim:data[_0x22c1('0x32')];polygonArea-=Math['abs'](signedArea(data,start,end,dim));}}var trianglesArea=0x0;for(i=0x0;i<triangles[_0x22c1('0x32')];i+=0x3){var a=triangles[i]*dim;var b=triangles[i+0x1]*dim;var c=triangles[i+0x2]*dim;trianglesArea+=Math[_0x22c1('0x69')]((data[a]-data[c])*(data[b+0x1]-data[a+0x1])-(data[a]-data[b])*(data[c+0x1]-data[a+0x1]));}return polygonArea===0x0&&trianglesArea===0x0?0x0:Math['abs']((trianglesArea-polygonArea)/polygonArea);};function signedArea(data,start,end,dim){var sum=0x0;for(var i=start,j=end-dim;i<end;i+=dim){sum+=(data[j]-data[i])*(data[i+0x1]+data[j+0x1]);j=i;}return sum;}earcut['flatten']=function(data){var dim=data[0x0][0x0][_0x22c1('0x32')],result={'vertices':[],'holes':[],'dimensions':dim},holeIndex=0x0;for(var i=0x0;i<data['length'];i++){for(var j=0x0;j<data[i][_0x22c1('0x32')];j++){for(var d=0x0;d<dim;d++){result[_0x22c1('0xeb')][_0x22c1('0x2e')](data[i][j][d]);}}if(i>0x0){holeIndex+=data[i-0x1][_0x22c1('0x32')];result['holes'][_0x22c1('0x2e')](holeIndex);}}return result;};earcut_1[_0x22c1('0x4')]=default_1;var version=_0x22c1('0x23c');var version$1={'version':version};var version$2=Object[_0x22c1('0x23d')]({'__proto__':null,'version':version,'default':version$1});function toStringBase(p){return'('+p['x']+';'+p['y']+')';}function toString(p){var s=p[_0x22c1('0x50')]();return s===_0x22c1('0x23e')?toStringBase(p):s;}function compare(a,b){if(a['y']===b['y']){return a['x']-b['x'];}else{return a['y']-b['y'];}}function equals$1(a,b){return a['x']===b['x']&&a['y']===b['y'];}var xy={'toString':toString,'toStringBase':toStringBase,'compare':compare,'equals':equals$1};var PointError=function PointError(message,points){this['name']=_0x22c1('0x23f');this[_0x22c1('0x240')]=points=points||[];this[_0x22c1('0x176')]=message||'Invalid\x20Points!';for(var i=0x0;i<points['length'];i++){this[_0x22c1('0x176')]+='\x20'+xy[_0x22c1('0x50')](points[i]);}};PointError[_0x22c1('0x1')]=new Error();PointError[_0x22c1('0x1')]['constructor']=PointError;var pointerror=PointError;var Point=function Point(x,y){this['x']=+x||0x0;this['y']=+y||0x0;this['_p2t_edge_list']=null;};Point['prototype'][_0x22c1('0x50')]=function(){return xy[_0x22c1('0x241')](this);};Point['prototype'][_0x22c1('0x141')]=function(){return{'x':this['x'],'y':this['y']};};Point[_0x22c1('0x1')][_0x22c1('0x8d')]=function(){return new Point(this['x'],this['y']);};Point[_0x22c1('0x1')][_0x22c1('0x242')]=function(){this['x']=0x0;this['y']=0x0;return this;};Point[_0x22c1('0x1')]['set']=function(x,y){this['x']=+x||0x0;this['y']=+y||0x0;return this;};Point[_0x22c1('0x1')]['negate']=function(){this['x']=-this['x'];this['y']=-this['y'];return this;};Point[_0x22c1('0x1')][_0x22c1('0xc5')]=function(n){this['x']+=n['x'];this['y']+=n['y'];return this;};Point[_0x22c1('0x1')][_0x22c1('0xab')]=function(n){this['x']-=n['x'];this['y']-=n['y'];return this;};Point['prototype'][_0x22c1('0x243')]=function(s){this['x']*=s;this['y']*=s;return this;};Point['prototype'][_0x22c1('0x32')]=function(){return Math['sqrt'](this['x']*this['x']+this['y']*this['y']);};Point['prototype'][_0x22c1('0x6a')]=function(){var len=this[_0x22c1('0x32')]();this['x']/=len;this['y']/=len;return len;};Point['prototype'][_0x22c1('0x85')]=function(p){return this['x']===p['x']&&this['y']===p['y'];};Point[_0x22c1('0xc2')]=function(p){return new Point(-p['x'],-p['y']);};Point['add']=function(a,b){return new Point(a['x']+b['x'],a['y']+b['y']);};Point[_0x22c1('0xab')]=function(a,b){return new Point(a['x']-b['x'],a['y']-b['y']);};Point[_0x22c1('0x243')]=function(s,p){return new Point(s*p['x'],s*p['y']);};Point[_0x22c1('0x105')]=function(a,b){if(typeof a===_0x22c1('0x244')){if(typeof b===_0x22c1('0x244')){return a*b;}else{return new Point(-a*b['y'],a*b['x']);}}else{if(typeof b==='number'){return new Point(b*a['y'],-b*a['x']);}else{return a['x']*b['y']-a['y']*b['x'];}}};Point['toString']=xy[_0x22c1('0x50')];Point[_0x22c1('0x245')]=xy[_0x22c1('0x245')];Point[_0x22c1('0x246')]=xy[_0x22c1('0x245')];Point[_0x22c1('0x85')]=xy['equals'];Point[_0x22c1('0x9c')]=function(a,b){return a['x']*b['x']+a['y']*b['y'];};var point=Point;var Triangle=function Triangle(a,b,c){this['points_']=[a,b,c];this['neighbors_']=[null,null,null];this[_0x22c1('0x247')]=![];this['constrained_edge']=[![],![],![]];this[_0x22c1('0x248')]=[![],![],![]];};var p2s=xy['toString'];Triangle['prototype'][_0x22c1('0x50')]=function(){return'['+p2s(this[_0x22c1('0x249')][0x0])+p2s(this[_0x22c1('0x249')][0x1])+p2s(this[_0x22c1('0x249')][0x2])+']';};Triangle[_0x22c1('0x1')][_0x22c1('0x24a')]=function(index){return this[_0x22c1('0x249')][index];};Triangle['prototype']['GetPoint']=Triangle['prototype'][_0x22c1('0x24a')];Triangle['prototype']['getPoints']=function(){return this[_0x22c1('0x249')];};Triangle[_0x22c1('0x1')][_0x22c1('0x24b')]=function(index){return this[_0x22c1('0x24c')][index];};Triangle[_0x22c1('0x1')][_0x22c1('0x234')]=function(point){var points=this[_0x22c1('0x249')];return point===points[0x0]||point===points[0x1]||point===points[0x2];};Triangle[_0x22c1('0x1')]['containsEdge']=function(edge){return this[_0x22c1('0x234')](edge['p'])&&this['containsPoint'](edge['q']);};Triangle[_0x22c1('0x1')]['containsPoints']=function(p1,p2){return this[_0x22c1('0x234')](p1)&&this['containsPoint'](p2);};Triangle[_0x22c1('0x1')]['isInterior']=function(){return this[_0x22c1('0x247')];};Triangle[_0x22c1('0x1')]['setInterior']=function(interior){this['interior_']=interior;return this;};Triangle['prototype'][_0x22c1('0x24d')]=function(p1,p2,t){var points=this[_0x22c1('0x249')];if(p1===points[0x2]&&p2===points[0x1]||p1===points[0x1]&&p2===points[0x2]){this[_0x22c1('0x24c')][0x0]=t;}else if(p1===points[0x0]&&p2===points[0x2]||p1===points[0x2]&&p2===points[0x0]){this[_0x22c1('0x24c')][0x1]=t;}else if(p1===points[0x0]&&p2===points[0x1]||p1===points[0x1]&&p2===points[0x0]){this['neighbors_'][0x2]=t;}else{throw new Error('poly2tri\x20Invalid\x20Triangle.markNeighborPointers()\x20call');}};Triangle[_0x22c1('0x1')][_0x22c1('0x24e')]=function(t){var points=this[_0x22c1('0x249')];if(t['containsPoints'](points[0x1],points[0x2])){this['neighbors_'][0x0]=t;t[_0x22c1('0x24d')](points[0x1],points[0x2],this);}else if(t['containsPoints'](points[0x0],points[0x2])){this['neighbors_'][0x1]=t;t[_0x22c1('0x24d')](points[0x0],points[0x2],this);}else if(t[_0x22c1('0x24f')](points[0x0],points[0x1])){this[_0x22c1('0x24c')][0x2]=t;t[_0x22c1('0x24d')](points[0x0],points[0x1],this);}};Triangle['prototype'][_0x22c1('0x250')]=function(){this['neighbors_'][0x0]=null;this[_0x22c1('0x24c')][0x1]=null;this[_0x22c1('0x24c')][0x2]=null;};Triangle[_0x22c1('0x1')]['clearDelaunayEdges']=function(){this[_0x22c1('0x248')][0x0]=![];this['delaunay_edge'][0x1]=![];this[_0x22c1('0x248')][0x2]=![];};Triangle[_0x22c1('0x1')]['pointCW']=function(p){var points=this['points_'];if(p===points[0x0]){return points[0x2];}else if(p===points[0x1]){return points[0x0];}else if(p===points[0x2]){return points[0x1];}else{return null;}};Triangle[_0x22c1('0x1')][_0x22c1('0x251')]=function(p){var points=this[_0x22c1('0x249')];if(p===points[0x0]){return points[0x1];}else if(p===points[0x1]){return points[0x2];}else if(p===points[0x2]){return points[0x0];}else{return null;}};Triangle[_0x22c1('0x1')][_0x22c1('0x252')]=function(p){if(p===this[_0x22c1('0x249')][0x0]){return this[_0x22c1('0x24c')][0x1];}else if(p===this[_0x22c1('0x249')][0x1]){return this['neighbors_'][0x2];}else{return this[_0x22c1('0x24c')][0x0];}};Triangle['prototype'][_0x22c1('0x253')]=function(p){if(p===this[_0x22c1('0x249')][0x0]){return this['neighbors_'][0x2];}else if(p===this[_0x22c1('0x249')][0x1]){return this[_0x22c1('0x24c')][0x0];}else{return this['neighbors_'][0x1];}};Triangle['prototype'][_0x22c1('0x254')]=function(p){if(p===this[_0x22c1('0x249')][0x0]){return this[_0x22c1('0x255')][0x1];}else if(p===this['points_'][0x1]){return this[_0x22c1('0x255')][0x2];}else{return this[_0x22c1('0x255')][0x0];}};Triangle[_0x22c1('0x1')]['getConstrainedEdgeCCW']=function(p){if(p===this['points_'][0x0]){return this[_0x22c1('0x255')][0x2];}else if(p===this[_0x22c1('0x249')][0x1]){return this['constrained_edge'][0x0];}else{return this['constrained_edge'][0x1];}};Triangle['prototype']['getConstrainedEdgeAcross']=function(p){if(p===this[_0x22c1('0x249')][0x0]){return this[_0x22c1('0x255')][0x0];}else if(p===this[_0x22c1('0x249')][0x1]){return this[_0x22c1('0x255')][0x1];}else{return this[_0x22c1('0x255')][0x2];}};Triangle[_0x22c1('0x1')]['setConstrainedEdgeCW']=function(p,ce){if(p===this[_0x22c1('0x249')][0x0]){this[_0x22c1('0x255')][0x1]=ce;}else if(p===this[_0x22c1('0x249')][0x1]){this[_0x22c1('0x255')][0x2]=ce;}else{this[_0x22c1('0x255')][0x0]=ce;}};Triangle['prototype']['setConstrainedEdgeCCW']=function(p,ce){if(p===this[_0x22c1('0x249')][0x0]){this[_0x22c1('0x255')][0x2]=ce;}else if(p===this[_0x22c1('0x249')][0x1]){this[_0x22c1('0x255')][0x0]=ce;}else{this[_0x22c1('0x255')][0x1]=ce;}};Triangle['prototype']['getDelaunayEdgeCW']=function(p){if(p===this[_0x22c1('0x249')][0x0]){return this[_0x22c1('0x248')][0x1];}else if(p===this[_0x22c1('0x249')][0x1]){return this[_0x22c1('0x248')][0x2];}else{return this[_0x22c1('0x248')][0x0];}};Triangle[_0x22c1('0x1')][_0x22c1('0x256')]=function(p){if(p===this[_0x22c1('0x249')][0x0]){return this[_0x22c1('0x248')][0x2];}else if(p===this[_0x22c1('0x249')][0x1]){return this[_0x22c1('0x248')][0x0];}else{return this[_0x22c1('0x248')][0x1];}};Triangle['prototype'][_0x22c1('0x257')]=function(p,e){if(p===this[_0x22c1('0x249')][0x0]){this[_0x22c1('0x248')][0x1]=e;}else if(p===this[_0x22c1('0x249')][0x1]){this[_0x22c1('0x248')][0x2]=e;}else{this[_0x22c1('0x248')][0x0]=e;}};Triangle[_0x22c1('0x1')][_0x22c1('0x258')]=function(p,e){if(p===this[_0x22c1('0x249')][0x0]){this[_0x22c1('0x248')][0x2]=e;}else if(p===this[_0x22c1('0x249')][0x1]){this[_0x22c1('0x248')][0x0]=e;}else{this['delaunay_edge'][0x1]=e;}};Triangle[_0x22c1('0x1')][_0x22c1('0x259')]=function(p){if(p===this[_0x22c1('0x249')][0x0]){return this['neighbors_'][0x0];}else if(p===this[_0x22c1('0x249')][0x1]){return this['neighbors_'][0x1];}else{return this[_0x22c1('0x24c')][0x2];}};Triangle['prototype'][_0x22c1('0x25a')]=function(t,p){var cw=t[_0x22c1('0x25b')](p);return this['pointCW'](cw);};Triangle[_0x22c1('0x1')][_0x22c1('0x25c')]=function(opoint,npoint){var points=this[_0x22c1('0x249')];if(opoint===points[0x0]){points[0x1]=points[0x0];points[0x0]=points[0x2];points[0x2]=npoint;}else if(opoint===points[0x1]){points[0x2]=points[0x1];points[0x1]=points[0x0];points[0x0]=npoint;}else if(opoint===points[0x2]){points[0x0]=points[0x2];points[0x2]=points[0x1];points[0x1]=npoint;}else{throw new Error(_0x22c1('0x25d'));}};Triangle[_0x22c1('0x1')]['index']=function(p){var points=this[_0x22c1('0x249')];if(p===points[0x0]){return 0x0;}else if(p===points[0x1]){return 0x1;}else if(p===points[0x2]){return 0x2;}else{throw new Error(_0x22c1('0x25e'));}};Triangle[_0x22c1('0x1')][_0x22c1('0x25f')]=function(p1,p2){var points=this[_0x22c1('0x249')];if(p1===points[0x0]){if(p2===points[0x1]){return 0x2;}else if(p2===points[0x2]){return 0x1;}}else if(p1===points[0x1]){if(p2===points[0x2]){return 0x0;}else if(p2===points[0x0]){return 0x2;}}else if(p1===points[0x2]){if(p2===points[0x0]){return 0x1;}else if(p2===points[0x1]){return 0x0;}}return-0x1;};Triangle[_0x22c1('0x1')]['markConstrainedEdgeByIndex']=function(index){this['constrained_edge'][index]=!![];};Triangle[_0x22c1('0x1')]['markConstrainedEdgeByEdge']=function(edge){this[_0x22c1('0x260')](edge['p'],edge['q']);};Triangle[_0x22c1('0x1')]['markConstrainedEdgeByPoints']=function(p,q){var points=this[_0x22c1('0x249')];if(q===points[0x0]&&p===points[0x1]||q===points[0x1]&&p===points[0x0]){this['constrained_edge'][0x2]=!![];}else if(q===points[0x0]&&p===points[0x2]||q===points[0x2]&&p===points[0x0]){this[_0x22c1('0x255')][0x1]=!![];}else if(q===points[0x1]&&p===points[0x2]||q===points[0x2]&&p===points[0x1]){this[_0x22c1('0x255')][0x0]=!![];}};var triangle=Triangle;function assert(condition,message){if(!condition){throw new Error(message||_0x22c1('0x261'));}}var assert_1=assert;var Node$1=function Node(p,t){this[_0x22c1('0x262')]=p;this[_0x22c1('0x263')]=t||null;this[_0x22c1('0x29')]=null;this['prev']=null;this[_0x22c1('0x5')]=p['x'];};var AdvancingFront=function AdvancingFront(head,tail){this[_0x22c1('0x264')]=head;this[_0x22c1('0x265')]=tail;this[_0x22c1('0x266')]=head;};AdvancingFront['prototype'][_0x22c1('0x267')]=function(){return this[_0x22c1('0x264')];};AdvancingFront[_0x22c1('0x1')][_0x22c1('0x268')]=function(node){this['head_']=node;};AdvancingFront[_0x22c1('0x1')][_0x22c1('0x269')]=function(){return this['tail_'];};AdvancingFront[_0x22c1('0x1')][_0x22c1('0x26a')]=function(node){this['tail_']=node;};AdvancingFront[_0x22c1('0x1')][_0x22c1('0x26b')]=function(){return this[_0x22c1('0x266')];};AdvancingFront[_0x22c1('0x1')][_0x22c1('0x26c')]=function(node){this[_0x22c1('0x266')]=node;};AdvancingFront[_0x22c1('0x1')]['findSearchNode']=function(){return this[_0x22c1('0x266')];};AdvancingFront['prototype']['locateNode']=function(x){var node=this[_0x22c1('0x266')];if(x<node['value']){while(node=node[_0x22c1('0x3d')]){if(x>=node['value']){this[_0x22c1('0x266')]=node;return node;}}}else{while(node=node[_0x22c1('0x29')]){if(x<node[_0x22c1('0x5')]){this['search_node_']=node[_0x22c1('0x3d')];return node['prev'];}}}return null;};AdvancingFront[_0x22c1('0x1')]['locatePoint']=function(point){var px=point['x'];var node=this[_0x22c1('0x26d')](px);var nx=node[_0x22c1('0x262')]['x'];if(px===nx){if(point!==node[_0x22c1('0x262')]){if(point===node[_0x22c1('0x3d')]['point']){node=node[_0x22c1('0x3d')];}else if(point===node[_0x22c1('0x29')][_0x22c1('0x262')]){node=node[_0x22c1('0x29')];}else{throw new Error(_0x22c1('0x26e'));}}}else if(px<nx){while(node=node['prev']){if(point===node[_0x22c1('0x262')]){break;}}}else{while(node=node[_0x22c1('0x29')]){if(point===node[_0x22c1('0x262')]){break;}}}if(node){this[_0x22c1('0x266')]=node;}return node;};var advancingfront=AdvancingFront;var Node_1=Node$1;advancingfront[_0x22c1('0x26f')]=Node_1;var EPSILON=1e-12;var EPSILON_1=EPSILON;var Orientation={'CW':0x1,'CCW':-0x1,'COLLINEAR':0x0};var Orientation_1=Orientation;function orient2d(pa,pb,pc){var detleft=(pa['x']-pc['x'])*(pb['y']-pc['y']);var detright=(pa['y']-pc['y'])*(pb['x']-pc['x']);var val=detleft-detright;if(val>-EPSILON&&val<EPSILON){return Orientation['COLLINEAR'];}else if(val>0x0){return Orientation[_0x22c1('0x270')];}else{return Orientation['CW'];}}var orient2d_1=orient2d;function inScanArea(pa,pb,pc,pd){var oadb=(pa['x']-pb['x'])*(pd['y']-pb['y'])-(pd['x']-pb['x'])*(pa['y']-pb['y']);if(oadb>=-EPSILON){return![];}var oadc=(pa['x']-pc['x'])*(pd['y']-pc['y'])-(pd['x']-pc['x'])*(pa['y']-pc['y']);if(oadc<=EPSILON){return![];}return!![];}var inScanArea_1=inScanArea;function isAngleObtuse(pa,pb,pc){var ax=pb['x']-pa['x'];var ay=pb['y']-pa['y'];var bx=pc['x']-pa['x'];var by=pc['y']-pa['y'];return ax*bx+ay*by<0x0;}var isAngleObtuse_1=isAngleObtuse;var utils={'EPSILON':EPSILON_1,'Orientation':Orientation_1,'orient2d':orient2d_1,'inScanArea':inScanArea_1,'isAngleObtuse':isAngleObtuse_1};var Node$2=advancingfront[_0x22c1('0x26f')];var EPSILON$1=utils['EPSILON'];var Orientation$1=utils[_0x22c1('0x271')];var orient2d$1=utils[_0x22c1('0x272')];var inScanArea$1=utils[_0x22c1('0x273')];var isAngleObtuse$1=utils[_0x22c1('0x274')];function triangulate(tcx){tcx[_0x22c1('0x275')]();tcx[_0x22c1('0x276')]();sweepPoints(tcx);finalizationPolygon(tcx);}function sweepPoints(tcx){var i,len=tcx[_0x22c1('0x277')]();for(i=0x1;i<len;++i){var point=tcx[_0x22c1('0x24a')](i);var node=pointEvent(tcx,point);var edges=point['_p2t_edge_list'];for(var j=0x0;edges&&j<edges[_0x22c1('0x32')];++j){edgeEventByEdge(tcx,edges[j],node);}}}function finalizationPolygon(tcx){var t=tcx['front']()[_0x22c1('0x267')]()[_0x22c1('0x29')][_0x22c1('0x263')];var p=tcx[_0x22c1('0x278')]()[_0x22c1('0x267')]()['next'][_0x22c1('0x262')];while(!t[_0x22c1('0x254')](p)){t=t[_0x22c1('0x253')](p);}tcx[_0x22c1('0x279')](t);}function pointEvent(tcx,point){var node=tcx['locateNode'](point);var new_node=newFrontTriangle(tcx,point,node);if(point['x']<=node['point']['x']+EPSILON$1){fill(tcx,node);}fillAdvancingFront(tcx,new_node);return new_node;}function edgeEventByEdge(tcx,edge,node){tcx['edge_event'][_0x22c1('0x255')]=edge;tcx['edge_event']['right']=edge['p']['x']>edge['q']['x'];if(isEdgeSideOfTriangle(node[_0x22c1('0x263')],edge['p'],edge['q'])){return;}fillEdgeEvent(tcx,edge,node);edgeEventByPoints(tcx,edge['p'],edge['q'],node[_0x22c1('0x263')],edge['q']);}function edgeEventByPoints(tcx,ep,eq,triangle,point){if(isEdgeSideOfTriangle(triangle,ep,eq)){return;}var p1=triangle[_0x22c1('0x251')](point);var o1=orient2d$1(eq,p1,ep);if(o1===Orientation$1[_0x22c1('0x27a')]){throw new pointerror('poly2tri\x20EdgeEvent:\x20Collinear\x20not\x20supported!',[eq,p1,ep]);}var p2=triangle[_0x22c1('0x25b')](point);var o2=orient2d$1(eq,p2,ep);if(o2===Orientation$1[_0x22c1('0x27a')]){throw new pointerror(_0x22c1('0x27b'),[eq,p2,ep]);}if(o1===o2){if(o1===Orientation$1['CW']){triangle=triangle[_0x22c1('0x253')](point);}else{triangle=triangle[_0x22c1('0x252')](point);}edgeEventByPoints(tcx,ep,eq,triangle,point);}else{flipEdgeEvent(tcx,ep,eq,triangle,point);}}function isEdgeSideOfTriangle(triangle,ep,eq){var index=triangle[_0x22c1('0x25f')](ep,eq);if(index!==-0x1){triangle['markConstrainedEdgeByIndex'](index);var t=triangle[_0x22c1('0x24b')](index);if(t){t[_0x22c1('0x260')](ep,eq);}return!![];}return![];}function newFrontTriangle(tcx,point,node){var triangle$1=new triangle(point,node[_0x22c1('0x262')],node[_0x22c1('0x29')]['point']);triangle$1[_0x22c1('0x24e')](node[_0x22c1('0x263')]);tcx[_0x22c1('0x27c')](triangle$1);var new_node=new Node$2(point);new_node[_0x22c1('0x29')]=node[_0x22c1('0x29')];new_node[_0x22c1('0x3d')]=node;node[_0x22c1('0x29')]['prev']=new_node;node[_0x22c1('0x29')]=new_node;if(!legalize(tcx,triangle$1)){tcx[_0x22c1('0x27d')](triangle$1);}return new_node;}function fill(tcx,node){var triangle$1=new triangle(node[_0x22c1('0x3d')]['point'],node[_0x22c1('0x262')],node[_0x22c1('0x29')]['point']);triangle$1['markNeighbor'](node['prev'][_0x22c1('0x263')]);triangle$1[_0x22c1('0x24e')](node[_0x22c1('0x263')]);tcx[_0x22c1('0x27c')](triangle$1);node[_0x22c1('0x3d')][_0x22c1('0x29')]=node['next'];node[_0x22c1('0x29')][_0x22c1('0x3d')]=node[_0x22c1('0x3d')];if(!legalize(tcx,triangle$1)){tcx[_0x22c1('0x27d')](triangle$1);}}function fillAdvancingFront(tcx,n){var node=n[_0x22c1('0x29')];while(node[_0x22c1('0x29')]){if(isAngleObtuse$1(node[_0x22c1('0x262')],node[_0x22c1('0x29')]['point'],node['prev']['point'])){break;}fill(tcx,node);node=node[_0x22c1('0x29')];}node=n[_0x22c1('0x3d')];while(node['prev']){if(isAngleObtuse$1(node[_0x22c1('0x262')],node[_0x22c1('0x29')][_0x22c1('0x262')],node[_0x22c1('0x3d')][_0x22c1('0x262')])){break;}fill(tcx,node);node=node[_0x22c1('0x3d')];}if(n['next']&&n[_0x22c1('0x29')][_0x22c1('0x29')]){if(isBasinAngleRight(n)){fillBasin(tcx,n);}}}function isBasinAngleRight(node){var ax=node['point']['x']-node[_0x22c1('0x29')]['next']['point']['x'];var ay=node[_0x22c1('0x262')]['y']-node[_0x22c1('0x29')][_0x22c1('0x29')][_0x22c1('0x262')]['y'];assert_1(ay>=0x0,_0x22c1('0x27e'));return ax>=0x0||Math['abs'](ax)<ay;}function legalize(tcx,t){for(var i=0x0;i<0x3;++i){if(t[_0x22c1('0x248')][i]){continue;}var ot=t['getNeighbor'](i);if(ot){var p=t[_0x22c1('0x24a')](i);var op=ot['oppositePoint'](t,p);var oi=ot[_0x22c1('0x1e8')](op);if(ot[_0x22c1('0x255')][oi]||ot[_0x22c1('0x248')][oi]){t[_0x22c1('0x255')][i]=ot[_0x22c1('0x255')][oi];continue;}var inside=inCircle(p,t['pointCCW'](p),t['pointCW'](p),op);if(inside){t[_0x22c1('0x248')][i]=!![];ot[_0x22c1('0x248')][oi]=!![];rotateTrianglePair(t,p,ot,op);var not_legalized=!legalize(tcx,t);if(not_legalized){tcx[_0x22c1('0x27d')](t);}not_legalized=!legalize(tcx,ot);if(not_legalized){tcx[_0x22c1('0x27d')](ot);}t[_0x22c1('0x248')][i]=![];ot['delaunay_edge'][oi]=![];return!![];}}}return![];}function inCircle(pa,pb,pc,pd){var adx=pa['x']-pd['x'];var ady=pa['y']-pd['y'];var bdx=pb['x']-pd['x'];var bdy=pb['y']-pd['y'];var adxbdy=adx*bdy;var bdxady=bdx*ady;var oabd=adxbdy-bdxady;if(oabd<=0x0){return![];}var cdx=pc['x']-pd['x'];var cdy=pc['y']-pd['y'];var cdxady=cdx*ady;var adxcdy=adx*cdy;var ocad=cdxady-adxcdy;if(ocad<=0x0){return![];}var bdxcdy=bdx*cdy;var cdxbdy=cdx*bdy;var alift=adx*adx+ady*ady;var blift=bdx*bdx+bdy*bdy;var clift=cdx*cdx+cdy*cdy;var det=alift*(bdxcdy-cdxbdy)+blift*ocad+clift*oabd;return det>0x0;}function rotateTrianglePair(t,p,ot,op){var n1,n2,n3,n4;n1=t[_0x22c1('0x253')](p);n2=t[_0x22c1('0x252')](p);n3=ot['neighborCCW'](op);n4=ot[_0x22c1('0x252')](op);var ce1,ce2,ce3,ce4;ce1=t[_0x22c1('0x27f')](p);ce2=t[_0x22c1('0x254')](p);ce3=ot[_0x22c1('0x27f')](op);ce4=ot[_0x22c1('0x254')](op);var de1,de2,de3,de4;de1=t[_0x22c1('0x256')](p);de2=t[_0x22c1('0x280')](p);de3=ot[_0x22c1('0x256')](op);de4=ot[_0x22c1('0x280')](op);t[_0x22c1('0x25c')](p,op);ot[_0x22c1('0x25c')](op,p);ot[_0x22c1('0x258')](p,de1);t[_0x22c1('0x257')](p,de2);t[_0x22c1('0x258')](op,de3);ot[_0x22c1('0x257')](op,de4);ot[_0x22c1('0x281')](p,ce1);t[_0x22c1('0x282')](p,ce2);t[_0x22c1('0x281')](op,ce3);ot[_0x22c1('0x282')](op,ce4);t[_0x22c1('0x250')]();ot[_0x22c1('0x250')]();if(n1){ot['markNeighbor'](n1);}if(n2){t[_0x22c1('0x24e')](n2);}if(n3){t[_0x22c1('0x24e')](n3);}if(n4){ot['markNeighbor'](n4);}t[_0x22c1('0x24e')](ot);}function fillBasin(tcx,node){if(orient2d$1(node['point'],node[_0x22c1('0x29')][_0x22c1('0x262')],node[_0x22c1('0x29')][_0x22c1('0x29')][_0x22c1('0x262')])===Orientation$1[_0x22c1('0x270')]){tcx['basin']['left_node']=node[_0x22c1('0x29')][_0x22c1('0x29')];}else{tcx[_0x22c1('0x283')][_0x22c1('0x284')]=node[_0x22c1('0x29')];}tcx['basin'][_0x22c1('0x285')]=tcx['basin'][_0x22c1('0x284')];while(tcx[_0x22c1('0x283')][_0x22c1('0x285')][_0x22c1('0x29')]&&tcx[_0x22c1('0x283')]['bottom_node']['point']['y']>=tcx['basin'][_0x22c1('0x285')][_0x22c1('0x29')][_0x22c1('0x262')]['y']){tcx[_0x22c1('0x283')]['bottom_node']=tcx['basin'][_0x22c1('0x285')][_0x22c1('0x29')];}if(tcx[_0x22c1('0x283')][_0x22c1('0x285')]===tcx[_0x22c1('0x283')][_0x22c1('0x284')]){return;}tcx[_0x22c1('0x283')][_0x22c1('0x286')]=tcx[_0x22c1('0x283')][_0x22c1('0x285')];while(tcx[_0x22c1('0x283')][_0x22c1('0x286')][_0x22c1('0x29')]&&tcx[_0x22c1('0x283')]['right_node'][_0x22c1('0x262')]['y']<tcx[_0x22c1('0x283')][_0x22c1('0x286')][_0x22c1('0x29')][_0x22c1('0x262')]['y']){tcx[_0x22c1('0x283')][_0x22c1('0x286')]=tcx[_0x22c1('0x283')][_0x22c1('0x286')][_0x22c1('0x29')];}if(tcx['basin'][_0x22c1('0x286')]===tcx[_0x22c1('0x283')][_0x22c1('0x285')]){return;}tcx[_0x22c1('0x283')][_0x22c1('0x287')]=tcx[_0x22c1('0x283')][_0x22c1('0x286')][_0x22c1('0x262')]['x']-tcx[_0x22c1('0x283')]['left_node'][_0x22c1('0x262')]['x'];tcx[_0x22c1('0x283')][_0x22c1('0x288')]=tcx['basin'][_0x22c1('0x284')][_0x22c1('0x262')]['y']>tcx[_0x22c1('0x283')][_0x22c1('0x286')][_0x22c1('0x262')]['y'];fillBasinReq(tcx,tcx[_0x22c1('0x283')][_0x22c1('0x285')]);}function fillBasinReq(tcx,node){if(isShallow(tcx,node)){return;}fill(tcx,node);var o;if(node['prev']===tcx['basin'][_0x22c1('0x284')]&&node[_0x22c1('0x29')]===tcx[_0x22c1('0x283')]['right_node']){return;}else if(node[_0x22c1('0x3d')]===tcx[_0x22c1('0x283')][_0x22c1('0x284')]){o=orient2d$1(node[_0x22c1('0x262')],node[_0x22c1('0x29')][_0x22c1('0x262')],node[_0x22c1('0x29')][_0x22c1('0x29')][_0x22c1('0x262')]);if(o===Orientation$1['CW']){return;}node=node[_0x22c1('0x29')];}else if(node[_0x22c1('0x29')]===tcx[_0x22c1('0x283')][_0x22c1('0x286')]){o=orient2d$1(node[_0x22c1('0x262')],node[_0x22c1('0x3d')]['point'],node[_0x22c1('0x3d')]['prev']['point']);if(o===Orientation$1[_0x22c1('0x270')]){return;}node=node['prev'];}else{if(node['prev'][_0x22c1('0x262')]['y']<node[_0x22c1('0x29')]['point']['y']){node=node[_0x22c1('0x3d')];}else{node=node['next'];}}fillBasinReq(tcx,node);}function isShallow(tcx,node){var height;if(tcx['basin']['left_highest']){height=tcx[_0x22c1('0x283')][_0x22c1('0x284')][_0x22c1('0x262')]['y']-node[_0x22c1('0x262')]['y'];}else{height=tcx[_0x22c1('0x283')]['right_node'][_0x22c1('0x262')]['y']-node['point']['y'];}if(tcx[_0x22c1('0x283')][_0x22c1('0x287')]>height){return!![];}return![];}function fillEdgeEvent(tcx,edge,node){if(tcx[_0x22c1('0x289')][_0x22c1('0x28a')]){fillRightAboveEdgeEvent(tcx,edge,node);}else{fillLeftAboveEdgeEvent(tcx,edge,node);}}function fillRightAboveEdgeEvent(tcx,edge,node){while(node['next'][_0x22c1('0x262')]['x']<edge['p']['x']){if(orient2d$1(edge['q'],node[_0x22c1('0x29')][_0x22c1('0x262')],edge['p'])===Orientation$1['CCW']){fillRightBelowEdgeEvent(tcx,edge,node);}else{node=node[_0x22c1('0x29')];}}}function fillRightBelowEdgeEvent(tcx,edge,node){if(node['point']['x']<edge['p']['x']){if(orient2d$1(node[_0x22c1('0x262')],node[_0x22c1('0x29')][_0x22c1('0x262')],node[_0x22c1('0x29')]['next'][_0x22c1('0x262')])===Orientation$1[_0x22c1('0x270')]){fillRightConcaveEdgeEvent(tcx,edge,node);}else{fillRightConvexEdgeEvent(tcx,edge,node);fillRightBelowEdgeEvent(tcx,edge,node);}}}function fillRightConcaveEdgeEvent(tcx,edge,node){fill(tcx,node[_0x22c1('0x29')]);if(node[_0x22c1('0x29')][_0x22c1('0x262')]!==edge['p']){if(orient2d$1(edge['q'],node[_0x22c1('0x29')][_0x22c1('0x262')],edge['p'])===Orientation$1[_0x22c1('0x270')]){if(orient2d$1(node[_0x22c1('0x262')],node[_0x22c1('0x29')][_0x22c1('0x262')],node[_0x22c1('0x29')][_0x22c1('0x29')]['point'])===Orientation$1[_0x22c1('0x270')]){fillRightConcaveEdgeEvent(tcx,edge,node);}}}}function fillRightConvexEdgeEvent(tcx,edge,node){if(orient2d$1(node[_0x22c1('0x29')][_0x22c1('0x262')],node['next']['next'][_0x22c1('0x262')],node[_0x22c1('0x29')]['next'][_0x22c1('0x29')][_0x22c1('0x262')])===Orientation$1['CCW']){fillRightConcaveEdgeEvent(tcx,edge,node[_0x22c1('0x29')]);}else{if(orient2d$1(edge['q'],node[_0x22c1('0x29')][_0x22c1('0x29')][_0x22c1('0x262')],edge['p'])===Orientation$1['CCW']){fillRightConvexEdgeEvent(tcx,edge,node[_0x22c1('0x29')]);}}}function fillLeftAboveEdgeEvent(tcx,edge,node){while(node[_0x22c1('0x3d')]['point']['x']>edge['p']['x']){if(orient2d$1(edge['q'],node['prev'][_0x22c1('0x262')],edge['p'])===Orientation$1['CW']){fillLeftBelowEdgeEvent(tcx,edge,node);}else{node=node[_0x22c1('0x3d')];}}}function fillLeftBelowEdgeEvent(tcx,edge,node){if(node[_0x22c1('0x262')]['x']>edge['p']['x']){if(orient2d$1(node[_0x22c1('0x262')],node[_0x22c1('0x3d')][_0x22c1('0x262')],node[_0x22c1('0x3d')][_0x22c1('0x3d')][_0x22c1('0x262')])===Orientation$1['CW']){fillLeftConcaveEdgeEvent(tcx,edge,node);}else{fillLeftConvexEdgeEvent(tcx,edge,node);fillLeftBelowEdgeEvent(tcx,edge,node);}}}function fillLeftConvexEdgeEvent(tcx,edge,node){if(orient2d$1(node[_0x22c1('0x3d')][_0x22c1('0x262')],node[_0x22c1('0x3d')][_0x22c1('0x3d')][_0x22c1('0x262')],node[_0x22c1('0x3d')][_0x22c1('0x3d')][_0x22c1('0x3d')]['point'])===Orientation$1['CW']){fillLeftConcaveEdgeEvent(tcx,edge,node[_0x22c1('0x3d')]);}else{if(orient2d$1(edge['q'],node[_0x22c1('0x3d')][_0x22c1('0x3d')][_0x22c1('0x262')],edge['p'])===Orientation$1['CW']){fillLeftConvexEdgeEvent(tcx,edge,node[_0x22c1('0x3d')]);}}}function fillLeftConcaveEdgeEvent(tcx,edge,node){fill(tcx,node[_0x22c1('0x3d')]);if(node['prev'][_0x22c1('0x262')]!==edge['p']){if(orient2d$1(edge['q'],node['prev'][_0x22c1('0x262')],edge['p'])===Orientation$1['CW']){if(orient2d$1(node[_0x22c1('0x262')],node['prev'][_0x22c1('0x262')],node[_0x22c1('0x3d')][_0x22c1('0x3d')][_0x22c1('0x262')])===Orientation$1['CW']){fillLeftConcaveEdgeEvent(tcx,edge,node);}}}}function flipEdgeEvent(tcx,ep,eq,t,p){var ot=t[_0x22c1('0x259')](p);assert_1(ot,'FLIP\x20failed\x20due\x20to\x20missing\x20triangle!');var op=ot[_0x22c1('0x25a')](t,p);if(t[_0x22c1('0x28b')](p)){var index=t[_0x22c1('0x1e8')](p);throw new pointerror(_0x22c1('0x28c'),[p,op,t['getPoint']((index+0x1)%0x3),t[_0x22c1('0x24a')]((index+0x2)%0x3)]);}if(inScanArea$1(p,t[_0x22c1('0x251')](p),t[_0x22c1('0x25b')](p),op)){rotateTrianglePair(t,p,ot,op);tcx['mapTriangleToNodes'](t);tcx[_0x22c1('0x27d')](ot);if(p===eq&&op===ep){if(eq===tcx[_0x22c1('0x289')][_0x22c1('0x255')]['q']&&ep===tcx[_0x22c1('0x289')][_0x22c1('0x255')]['p']){t[_0x22c1('0x260')](ep,eq);ot[_0x22c1('0x260')](ep,eq);legalize(tcx,t);legalize(tcx,ot);}}else{var o=orient2d$1(eq,op,ep);t=nextFlipTriangle(tcx,o,t,ot,p,op);flipEdgeEvent(tcx,ep,eq,t,p);}}else{var newP=nextFlipPoint(ep,eq,ot,op);flipScanEdgeEvent(tcx,ep,eq,t,ot,newP);edgeEventByPoints(tcx,ep,eq,t,p);}}function nextFlipTriangle(tcx,o,t,ot,p,op){var edge_index;if(o===Orientation$1[_0x22c1('0x270')]){edge_index=ot[_0x22c1('0x25f')](p,op);ot[_0x22c1('0x248')][edge_index]=!![];legalize(tcx,ot);ot['clearDelaunayEdges']();return t;}edge_index=t[_0x22c1('0x25f')](p,op);t['delaunay_edge'][edge_index]=!![];legalize(tcx,t);t[_0x22c1('0x28d')]();return ot;}function nextFlipPoint(ep,eq,ot,op){var o2d=orient2d$1(eq,op,ep);if(o2d===Orientation$1['CW']){return ot['pointCCW'](op);}else if(o2d===Orientation$1[_0x22c1('0x270')]){return ot[_0x22c1('0x25b')](op);}else{throw new pointerror(_0x22c1('0x28e'),[eq,op,ep]);}}function flipScanEdgeEvent(tcx,ep,eq,flip_triangle,t,p){var ot=t[_0x22c1('0x259')](p);assert_1(ot,_0x22c1('0x28f'));var op=ot['oppositePoint'](t,p);if(inScanArea$1(eq,flip_triangle[_0x22c1('0x251')](eq),flip_triangle['pointCW'](eq),op)){flipEdgeEvent(tcx,eq,op,ot,op);}else{var newP=nextFlipPoint(ep,eq,ot,op);flipScanEdgeEvent(tcx,ep,eq,flip_triangle,ot,newP);}}var triangulate_1=triangulate;var sweep={'triangulate':triangulate_1};var Node$3=advancingfront['Node'];var kAlpha=0.3;var Edge=function Edge(p1,p2){this['p']=p1;this['q']=p2;if(p1['y']>p2['y']){this['q']=p1;this['p']=p2;}else if(p1['y']===p2['y']){if(p1['x']>p2['x']){this['q']=p1;this['p']=p2;}else if(p1['x']===p2['x']){throw new pointerror(_0x22c1('0x290'),[p1]);}}if(!this['q'][_0x22c1('0x291')]){this['q'][_0x22c1('0x291')]=[];}this['q']['_p2t_edge_list'][_0x22c1('0x2e')](this);};var Basin=function Basin(){this[_0x22c1('0x284')]=null;this[_0x22c1('0x285')]=null;this[_0x22c1('0x286')]=null;this[_0x22c1('0x287')]=0x0;this[_0x22c1('0x288')]=![];};Basin['prototype'][_0x22c1('0x292')]=function(){this[_0x22c1('0x284')]=null;this[_0x22c1('0x285')]=null;this['right_node']=null;this[_0x22c1('0x287')]=0x0;this[_0x22c1('0x288')]=![];};var EdgeEvent=function EdgeEvent(){this[_0x22c1('0x255')]=null;this[_0x22c1('0x28a')]=![];};var SweepContext=function SweepContext(contour,options){options=options||{};this[_0x22c1('0x293')]=[];this[_0x22c1('0x294')]=[];this[_0x22c1('0x249')]=options[_0x22c1('0x295')]?contour[_0x22c1('0x40')](0x0):contour;this['edge_list']=[];this[_0x22c1('0x296')]=this['pmax_']=null;this[_0x22c1('0x297')]=null;this['head_']=null;this[_0x22c1('0x265')]=null;this['af_head_']=null;this[_0x22c1('0x298')]=null;this[_0x22c1('0x299')]=null;this[_0x22c1('0x283')]=new Basin();this[_0x22c1('0x289')]=new EdgeEvent();this[_0x22c1('0x29a')](this[_0x22c1('0x249')]);};SweepContext['prototype'][_0x22c1('0x29b')]=function(polyline){this[_0x22c1('0x29a')](polyline);var i,len=polyline[_0x22c1('0x32')];for(i=0x0;i<len;i++){this[_0x22c1('0x249')][_0x22c1('0x2e')](polyline[i]);}return this;};SweepContext[_0x22c1('0x1')][_0x22c1('0x29c')]=SweepContext[_0x22c1('0x1')][_0x22c1('0x29b')];SweepContext['prototype'][_0x22c1('0x29d')]=function(holes){var i,len=holes[_0x22c1('0x32')];for(i=0x0;i<len;i++){this[_0x22c1('0x29a')](holes[i]);}this[_0x22c1('0x249')]=this[_0x22c1('0x249')][_0x22c1('0x171')]['apply'](this[_0x22c1('0x249')],holes);return this;};SweepContext['prototype'][_0x22c1('0x29e')]=function(point){this[_0x22c1('0x249')][_0x22c1('0x2e')](point);return this;};SweepContext[_0x22c1('0x1')]['AddPoint']=SweepContext['prototype'][_0x22c1('0x29e')];SweepContext[_0x22c1('0x1')][_0x22c1('0x29f')]=function(points){this[_0x22c1('0x249')]=this[_0x22c1('0x249')]['concat'](points);return this;};SweepContext[_0x22c1('0x1')][_0x22c1('0x2a0')]=function(){sweep[_0x22c1('0x2a0')](this);return this;};SweepContext['prototype'][_0x22c1('0x2a1')]=function(){return{'min':this[_0x22c1('0x296')],'max':this[_0x22c1('0x2a2')]};};SweepContext['prototype'][_0x22c1('0x2a3')]=function(){return this['triangles_'];};SweepContext[_0x22c1('0x1')][_0x22c1('0x2a4')]=SweepContext['prototype'][_0x22c1('0x2a3')];SweepContext[_0x22c1('0x1')][_0x22c1('0x278')]=function(){return this[_0x22c1('0x297')];};SweepContext[_0x22c1('0x1')][_0x22c1('0x277')]=function(){return this[_0x22c1('0x249')][_0x22c1('0x32')];};SweepContext[_0x22c1('0x1')][_0x22c1('0x267')]=function(){return this[_0x22c1('0x264')];};SweepContext[_0x22c1('0x1')][_0x22c1('0x268')]=function(p1){this[_0x22c1('0x264')]=p1;};SweepContext[_0x22c1('0x1')][_0x22c1('0x269')]=function(){return this[_0x22c1('0x265')];};SweepContext[_0x22c1('0x1')][_0x22c1('0x26a')]=function(p1){this[_0x22c1('0x265')]=p1;};SweepContext['prototype'][_0x22c1('0x2a5')]=function(){return this[_0x22c1('0x294')];};SweepContext['prototype'][_0x22c1('0x275')]=function(){var xmax=this[_0x22c1('0x249')][0x0]['x'];var xmin=this['points_'][0x0]['x'];var ymax=this[_0x22c1('0x249')][0x0]['y'];var ymin=this[_0x22c1('0x249')][0x0]['y'];var i,len=this[_0x22c1('0x249')][_0x22c1('0x32')];for(i=0x1;i<len;i++){var p=this[_0x22c1('0x249')][i];p['x']>xmax&&(xmax=p['x']);p['x']<xmin&&(xmin=p['x']);p['y']>ymax&&(ymax=p['y']);p['y']<ymin&&(ymin=p['y']);}this[_0x22c1('0x296')]=new point(xmin,ymin);this[_0x22c1('0x2a2')]=new point(xmax,ymax);var dx=kAlpha*(xmax-xmin);var dy=kAlpha*(ymax-ymin);this['head_']=new point(xmax+dx,ymin-dy);this['tail_']=new point(xmin-dx,ymin-dy);this[_0x22c1('0x249')][_0x22c1('0x1f3')](point['compare']);};SweepContext[_0x22c1('0x1')][_0x22c1('0x29a')]=function(polyline){var i,len=polyline['length'];for(i=0x0;i<len;++i){this['edge_list'][_0x22c1('0x2e')](new Edge(polyline[i],polyline[(i+0x1)%len]));}};SweepContext[_0x22c1('0x1')]['getPoint']=function(index){return this['points_'][index];};SweepContext[_0x22c1('0x1')][_0x22c1('0x27c')]=function(triangle){this[_0x22c1('0x294')][_0x22c1('0x2e')](triangle);};SweepContext['prototype'][_0x22c1('0x2a6')]=function(point){return this['front_']['locateNode'](point['x']);};SweepContext[_0x22c1('0x1')][_0x22c1('0x276')]=function(){var head;var middle;var tail;var triangle$1=new triangle(this[_0x22c1('0x249')][0x0],this[_0x22c1('0x265')],this[_0x22c1('0x264')]);this['map_'][_0x22c1('0x2e')](triangle$1);head=new Node$3(triangle$1[_0x22c1('0x24a')](0x1),triangle$1);middle=new Node$3(triangle$1['getPoint'](0x0),triangle$1);tail=new Node$3(triangle$1[_0x22c1('0x24a')](0x2));this[_0x22c1('0x297')]=new advancingfront(head,tail);head[_0x22c1('0x29')]=middle;middle[_0x22c1('0x29')]=tail;middle['prev']=head;tail[_0x22c1('0x3d')]=middle;};SweepContext[_0x22c1('0x1')][_0x22c1('0x2a7')]=function(node){};SweepContext[_0x22c1('0x1')]['mapTriangleToNodes']=function(t){for(var i=0x0;i<0x3;++i){if(!t[_0x22c1('0x24b')](i)){var n=this[_0x22c1('0x297')][_0x22c1('0x2a8')](t[_0x22c1('0x25b')](t[_0x22c1('0x24a')](i)));if(n){n[_0x22c1('0x263')]=t;}}}};SweepContext[_0x22c1('0x1')][_0x22c1('0x2a9')]=function(triangle){var i,map=this[_0x22c1('0x294')],len=map[_0x22c1('0x32')];for(i=0x0;i<len;i++){if(map[i]===triangle){map['splice'](i,0x1);break;}}};SweepContext[_0x22c1('0x1')][_0x22c1('0x279')]=function(triangle){var triangles=[triangle],t,i;while(t=triangles['pop']()){if(!t[_0x22c1('0x2aa')]()){t['setInterior'](!![]);this[_0x22c1('0x293')]['push'](t);for(i=0x0;i<0x3;i++){if(!t['constrained_edge'][i]){triangles[_0x22c1('0x2e')](t[_0x22c1('0x24b')](i));}}}}};var sweepcontext=SweepContext;var require$$0=getCjsExportFromNamespace(version$2);var poly2tri=createCommonjsModule(function(module,exports){var previousPoly2tri=commonjsGlobal[_0x22c1('0x2ab')];exports[_0x22c1('0x2ac')]=function(){commonjsGlobal['poly2tri']=previousPoly2tri;return exports;};exports[_0x22c1('0x2ad')]=require$$0[_0x22c1('0x201')];exports[_0x22c1('0x23f')]=pointerror;exports['Point']=point;exports['Triangle']=triangle;exports['SweepContext']=sweepcontext;exports['triangulate']=sweep[_0x22c1('0x2a0')];exports[_0x22c1('0x2ae')]={'Triangulate':sweep[_0x22c1('0x2a0')]};});var poly2tri_1=poly2tri[_0x22c1('0x2ac')];var poly2tri_2=poly2tri['VERSION'];var poly2tri_3=poly2tri[_0x22c1('0x23f')];var poly2tri_4=poly2tri[_0x22c1('0x2af')];var poly2tri_5=poly2tri[_0x22c1('0x2b0')];var poly2tri_6=poly2tri['SweepContext'];var poly2tri_7=poly2tri[_0x22c1('0x2a0')];var poly2tri_8=poly2tri[_0x22c1('0x2ae')];var ShapeUtils={'area':function area(contour){var n=contour[_0x22c1('0x32')];var a=0x0;for(var p=n-0x1,q=0x0;q<n;p=q++){a+=contour[p]['x']*contour[q]['y']-contour[q]['x']*contour[p]['y'];}return a*0.5;},'isClockWise':function isClockWise(pts){return ShapeUtils[_0x22c1('0x2b1')](pts)<0x0;},'triangulateShape':function triangulateShape(contour,holes){var vertices=[];var holeIndices=[];var faces=[];removeDupEndPts(contour);addContour(vertices,contour);var holeIndex=contour[_0x22c1('0x32')];holes[_0x22c1('0x22')](removeDupEndPts);for(var i=0x0;i<holes['length'];i++){holeIndices[_0x22c1('0x2e')](holeIndex);holeIndex+=holes[i][_0x22c1('0x32')];addContour(vertices,holes[i]);}var triangles=earcut_1(vertices,holeIndices);for(var _i=0x0;_i<triangles[_0x22c1('0x32')];_i+=0x3){faces['push'](triangles[_0x22c1('0x40')](_i,_i+0x3));}return faces;},'triangulateShapePoly2tri':function triangulateShapePoly2tri(contour,holes){removeDupEndPts(contour);holes['forEach'](removeDupEndPts);var pointMap={};var count=0x0;var points=makePoints(contour);var sweepContext=new poly2tri_6(points);for(var i=0x0,il=holes[_0x22c1('0x32')];i<il;i++){points=makePoints(holes[i]);sweepContext[_0x22c1('0x29b')](points);points=points[_0x22c1('0x171')](points);}var object=sweepContext['triangulate']();var triangles=object[_0x22c1('0x293')];var a;var b;var c;var result=[];for(var _i2=0x0,_il=triangles[_0x22c1('0x32')];_i2<_il;_i2++){points=triangles[_i2][_0x22c1('0x249')];a=pointMap[points[0x0]['x']+','+points[0x0]['y']];b=pointMap[points[0x1]['x']+','+points[0x1]['y']];c=pointMap[points[0x2]['x']+','+points[0x2]['y']];result[_0x22c1('0x2e')]([a,b,c]);}return result;function makePoints(a){var il=a[_0x22c1('0x32')];var points=[];for(var _i3=0x0;_i3<il;_i3++){points['push'](new poly2tri_4(a[_i3]['x'],a[_i3]['y']));pointMap[a[_i3]['x']+','+a[_i3]['y']]=count;count++;}return points;}},'triangulateShapeTessy':function triangulateShapeTessy(contour,holes,tessy){removeDupEndPts(contour);holes[_0x22c1('0x22')](removeDupEndPts);var triangles=[];var pointMap={};var count=0x0;tessy[_0x22c1('0x2b2')](0x0,0x0,0x1);tessy[_0x22c1('0x2b3')](triangles);var points=makePoints(contour);for(var i=0x0,il=holes[_0x22c1('0x32')];i<il;i++){points=makePoints(holes[i]);}tessy['gluTessEndPolygon']();debug['log'](_0x22c1('0x2b4'));var a;var b;var c;var result=[];for(var _i4=0x0,_il2=triangles['length'];_i4<_il2;_i4+=0x6){a=pointMap[triangles[_i4]+','+triangles[_i4+0x1]];b=pointMap[triangles[_i4+0x2]+','+triangles[_i4+0x3]];c=pointMap[triangles[_i4+0x4]+','+triangles[_i4+0x5]];result[_0x22c1('0x2e')]([a,b,c]);}return result;function makePoints(a){var il=a['length'];tessy[_0x22c1('0x2b5')]();for(var _i5=0x0;_i5<il;_i5++){var coordinates=[a[_i5]['x'],a[_i5]['y'],0x0];tessy[_0x22c1('0x2b6')](coordinates,coordinates);pointMap[a[_i5]['x']+','+a[_i5]['y']]=count;count++;}tessy['gluTessEndContour']();return points;}}};function removeDupEndPts(points){var l=points[_0x22c1('0x32')];if(l>0x2&&points[l-0x1][_0x22c1('0x85')](points[0x0])){points['pop']();}}function addContour(vertices,contour){for(var i=0x0;i<contour[_0x22c1('0x32')];i++){vertices[_0x22c1('0x2e')](contour[i]['x']);vertices['push'](contour[i]['y']);}}function ExtrudeBufferGeometry(shapes,options){BufferGeometry[_0x22c1('0x2')](this);this[_0x22c1('0x1f')]=_0x22c1('0x2b7');this[_0x22c1('0x13d')]={'shapes':shapes,'options':options};options[_0x22c1('0x2b8')]=0x1;shapes=Array[_0x22c1('0xd4')](shapes)?shapes:[shapes];var scope=this;var verticesArray=[];var uvArray=[];var curveSegmentsAdaptive=options['curveSegmentsAdaptive']!==undefined?options[_0x22c1('0x2b9')]:0.1;var shapesExtractedPoints=new Array(shapes[_0x22c1('0x32')]);for(var i=0x0,l=shapes[_0x22c1('0x32')];i<l;i++){var shape=shapes[i];shape[_0x22c1('0x2ba')]=options[_0x22c1('0x2ba')];shapesExtractedPoints[i]=shape['extractPointsAdaptively'](curveSegmentsAdaptive);}var shapes_center=new Vector2(0x0,0x0);var boundingbox_for_shapes=new Box2();for(var _i=0x0,_l=shapes['length'];_i<_l;_i++){var _shape=shapes[_i];var ret=calculateShapeCenter(_shape,shapesExtractedPoints[_i]);var shape_center_ret=ret[0x0];var boundingbox=ret[0x1];shapes_center['x']=shapes_center['x']+shape_center_ret['x'];shapes_center['y']=shapes_center['y']+shape_center_ret['y'];boundingbox_for_shapes['union'](boundingbox);}if(options[_0x22c1('0x2bb')]!=undefined){var vlen=options['extrudePath'][_0x22c1('0x240')][_0x22c1('0x32')];for(var _i2=0x0;_i2<vlen;_i2++){var temp=options[_0x22c1('0x2bb')]['points'][_i2];options['extrudePath']['points'][_i2][_0x22c1('0x5e')](temp['x']+shapes_center['x'],temp['y']+shapes_center['y'],temp['z']);}}var charVertexGroup=[];var charCount=0x0;for(var _i3=0x0,_l2=shapes[_0x22c1('0x32')];_i3<_l2;_i3++){if(options[_0x22c1('0x2bc')][charCount]==_i3){charCount=charCount+0x1;charVertexGroup[_0x22c1('0x2e')](verticesArray[_0x22c1('0x32')]/0x3);}var _shape2=shapes[_i3];addShape(_shape2,shapes_center,boundingbox_for_shapes,shapesExtractedPoints[_i3]);}charVertexGroup['push'](verticesArray[_0x22c1('0x32')]/0x3);for(var _i4=0x0;_i4<verticesArray[_0x22c1('0x32')]/0x3;_i4++){for(var j=0x0;j<charVertexGroup[_0x22c1('0x32')]-0x1;j++){if(_i4>=charVertexGroup[j]&&_i4<charVertexGroup[j+0x1]){this[_0x22c1('0x212')][_0x22c1('0x2e')](j);break;}}}this[_0x22c1('0x219')](_0x22c1('0xee'),new Float32BufferAttribute(verticesArray,0x3));this[_0x22c1('0x219')]('uv',new Float32BufferAttribute(uvArray,0x2));if(options[_0x22c1('0x2bd')]==0x0){this['computeVertexNormals']();}else{this[_0x22c1('0x2be')](options[_0x22c1('0x2bd')]);}this[_0x22c1('0x227')]();this[_0x22c1('0xf9')]();this['perCharCalculation']();function calculateShapeCenter(shape,shapePoints){var vertices=shapePoints[_0x22c1('0x2bf')];var boundingbox=new Box2();boundingbox[_0x22c1('0xde')](vertices);var vlen=vertices[_0x22c1('0x32')];var shapeCenter=new Vector2();var weight=0x1/vlen;for(var _i5=0x0;_i5<vlen;_i5++){shapeCenter['x']+=vertices[_i5]['x']*weight;shapeCenter['y']+=vertices[_i5]['y']*weight;}return[shapeCenter,boundingbox];}function laplacianSmooth(vertices,iteration_numb){if(iteration_numb==0x0)return;for(var it=0x0;it<iteration_numb;it++){var vertices_old=[];for(var _i6=0x0;_i6<vertices[_0x22c1('0x32')];_i6++){var vec2_temp=new Vector2();vec2_temp[_0x22c1('0x82')](vertices[_i6]);vertices_old[_0x22c1('0x2e')](vec2_temp);}for(var _i7=0x0,il=vertices_old[_0x22c1('0x32')],_j=il-0x1,k=_i7+0x1;_i7<il;_i7++,_j++,k++){if(_j===il)_j=0x0;if(k===il)k=0x0;vertices[_i7]['x']=0.5*(vertices_old[_j]['x']+vertices_old[k]['x']);vertices[_i7]['y']=0.5*(vertices_old[_j]['y']+vertices_old[k]['y']);}}}function addShape(shape,shapes_center,boundingbox_for_shapes,shapePoints){var placeholder=[];var steps=options[_0x22c1('0x2c0')]!==undefined?options[_0x22c1('0x2c0')]:0x1;var depth=options['depth']!==undefined?options[_0x22c1('0x2c1')]:0x64;var scale=options[_0x22c1('0x77')]!==undefined?options[_0x22c1('0x77')]:0x0;var triangulateMethod=options[_0x22c1('0x2c2')]!==undefined?options[_0x22c1('0x2c2')]:_0x22c1('0x2c3');var bevelEnabled=options['bevelEnabled']!==undefined?options[_0x22c1('0x2c4')]:!![];var bevelThickness=options['bevelThickness']!==undefined?options[_0x22c1('0x2c5')]:0x6;var bevelSize=options['bevelSize']!==undefined?options[_0x22c1('0x2c6')]:bevelThickness-0x2;var bevelSegments=options[_0x22c1('0x2c7')]!==undefined?options[_0x22c1('0x2c7')]:0x3;var bevelType=options[_0x22c1('0x2c8')]!==undefined?options['bevelType']:_0x22c1('0x2c9');var bevelBackEnabled=![];var extrudePath=options['extrudePath'];var extrudeScale=options[_0x22c1('0x2b8')];var uvgen=options[_0x22c1('0x2ca')]!==undefined?options[_0x22c1('0x2ca')]:WorldUVGenerator;var _options$extrudeOffse=options['extrudeOffsetX'],extrudeOffsetX=_options$extrudeOffse===void 0x0?0x0:_options$extrudeOffse;var _options$extrudeOffse2=options[_0x22c1('0x2cb')],extrudeOffsetY=_options$extrudeOffse2===void 0x0?0x0:_options$extrudeOffse2;var laplacianIterationNumb=options[_0x22c1('0x2cc')];var uvSideWallLengthOffset=0x0;if(options['amount']!==undefined){console['warn'](_0x22c1('0x2cd'));options[_0x22c1('0x2ce')],_readOnlyError(_0x22c1('0x2c1'));}var extrudePts;var extrudeByPath=![];var splineTube;var boundingbox=new Box2();if(extrudePath){extrudePts=extrudePath[_0x22c1('0x2cf')](steps);extrudeByPath=!![];_readOnlyError(_0x22c1('0x2c4'));splineTube=extrudePath[_0x22c1('0x2d0')](steps,![]);}if(!bevelEnabled){bevelSegments=0x0;bevelThickness=0x0;bevelSize=0x0;}var ahole;var vertices=shapePoints[_0x22c1('0x2bf')];var holes=shapePoints[_0x22c1('0x2d1')];var reverse=!ShapeUtils[_0x22c1('0x2d2')](vertices);if(reverse){vertices=vertices['reverse']();for(var _h=0x0,_hl=holes[_0x22c1('0x32')];_h<_hl;_h++){ahole=holes[_h];if(ShapeUtils[_0x22c1('0x2d2')](ahole)){holes[_h]=ahole[_0x22c1('0x2d3')]();}}}laplacianSmooth(vertices,laplacianIterationNumb);for(var _h2=0x0,_hl2=holes['length'];_h2<_hl2;_h2++){var _ahole=holes[_h2];laplacianSmooth(_ahole,laplacianIterationNumb);}boundingbox[_0x22c1('0x82')](boundingbox_for_shapes);var faces;if(triangulateMethod===_0x22c1('0x2c3')){faces=ShapeUtils[_0x22c1('0x2d4')](vertices,holes);}else if(triangulateMethod==='poly2tri'){try{faces=ShapeUtils[_0x22c1('0x2d5')](vertices,holes);}catch(_0x4b18c7){faces=ShapeUtils[_0x22c1('0x2d4')](vertices,holes);console[_0x22c1('0xb0')](_0x4b18c7);}}var contour=vertices;for(var _h3=0x0,_hl3=holes[_0x22c1('0x32')];_h3<_hl3;_h3++){var _ahole2=holes[_h3];vertices=vertices[_0x22c1('0x171')](_ahole2);}function scalePt2(pt,vec,size){if(!vec)console[_0x22c1('0xb0')]('THREE.ExtrudeGeometry:\x20vec\x20does\x20not\x20exist');return vec[_0x22c1('0x8d')]()['multiplyScalar'](size)[_0x22c1('0xc5')](pt);}var bs;var z;var vert;var vlen=vertices[_0x22c1('0x32')];function getBevelVec(inPt,inPrev,inNext){var v_trans_x,v_trans_y,shrink_by;var v_prev_x=inPt['x']-inPrev['x'];var v_prev_y=inPt['y']-inPrev['y'];var v_next_x=inNext['x']-inPt['x'];var v_next_y=inNext['y']-inPt['y'];var v_prev_lensq=v_prev_x*v_prev_x+v_prev_y*v_prev_y;if(v_prev_lensq<Number[_0x22c1('0x89')])console[_0x22c1('0xb0')](_0x22c1('0x2d6'));var v_next_lensq=v_next_x*v_next_x+v_next_y*v_next_y;if(v_next_lensq<Number[_0x22c1('0x89')])console['error']('inPt\x20and\x20inNext\x20are\x20the\x20same\x20point');var collinear0=v_prev_x*v_next_y-v_prev_y*v_next_x;var epslion=0.01;if(Math[_0x22c1('0x69')](collinear0)>epslion){var v_prev_len=Math[_0x22c1('0x8a')](v_prev_lensq);var v_next_len=Math[_0x22c1('0x8a')](v_next_x*v_next_x+v_next_y*v_next_y);var ptPrevShift_x=inPrev['x']-v_prev_y/v_prev_len;var ptPrevShift_y=inPrev['y']+v_prev_x/v_prev_len;var ptNextShift_x=inNext['x']-v_next_y/v_next_len;var ptNextShift_y=inNext['y']+v_next_x/v_next_len;var sf=((ptNextShift_x-ptPrevShift_x)*v_next_y-(ptNextShift_y-ptPrevShift_y)*v_next_x)/(v_prev_x*v_next_y-v_prev_y*v_next_x);v_trans_x=ptPrevShift_x+v_prev_x*sf-inPt['x'];v_trans_y=ptPrevShift_y+v_prev_y*sf-inPt['y'];var v_trans_lensq=v_trans_x*v_trans_x+v_trans_y*v_trans_y;if(v_trans_lensq<=0x2){return new Vector2(v_trans_x,v_trans_y);}else{shrink_by=Math[_0x22c1('0x8a')](v_trans_lensq/0x2);return new Vector2(v_trans_x/shrink_by,v_trans_y/shrink_by);}}else{var _v_prev_len=Math['sqrt'](v_prev_lensq);var _v_trans_x=-v_prev_y/_v_prev_len;var _v_trans_y=v_prev_x/_v_prev_len;return new Vector2(_v_trans_x,_v_trans_y);}}function getMovement(contour,holes,bevelSize){var contourMovements=[];for(var _i8=0x0,_il=contour[_0x22c1('0x32')],_j2=_il-0x1,k=_i8+0x1;_i8<_il;_i8++,_j2++,k++){if(_j2===_il)_j2=0x0;if(k===_il)k=0x0;contourMovements[_i8]=getBevelVec(contour[_i8],contour[_j2],contour[k])[_0x22c1('0x6f')](Math[_0x22c1('0x69')](bevelSize));}var holesMovements=[];var oneHoleMovements;var verticesMovements=contourMovements[_0x22c1('0x171')]();for(var _h4=0x0,_hl4=holes[_0x22c1('0x32')];_h4<_hl4;_h4++){var _ahole3=holes[_h4];oneHoleMovements=[];for(var _i10=0x0,_il3=_ahole3[_0x22c1('0x32')],_j4=_il3-0x1,_k2=_i10+0x1;_i10<_il3;_i10++,_j4++,_k2++){if(_j4===_il3)_j4=0x0;if(_k2===_il3)_k2=0x0;oneHoleMovements[_i10]=getBevelVec(_ahole3[_i10],_ahole3[_j4],_ahole3[_k2])[_0x22c1('0x6f')](Math['abs'](bevelSize));}holesMovements[_0x22c1('0x2e')](oneHoleMovements);verticesMovements=verticesMovements['concat'](oneHoleMovements);}var Arrays=new Array();Arrays['push'](contourMovements);Arrays[_0x22c1('0x2e')](holesMovements);Arrays['push'](verticesMovements);return Arrays;}var Arrays=getMovement(contour,holes,bevelSize*0.06);var contourMovements=Arrays[0x0];var holesMovements=Arrays[0x1];var Arrays4ExtrudeScale=getMovement(contour,holes,0.5);var contourMovements4ExtrudeScale=Arrays4ExtrudeScale[0x0];var holesMovements4ExtrudeScale=Arrays4ExtrudeScale[0x1];if(scale>0x0){var Arrays4Scale=getMovement(contour,holes,scale);var contourMovements4Scale=Arrays4Scale[0x0];var holesMovements4Scale=Arrays4Scale[0x1];for(var _i12=0x0;_i12<contour[_0x22c1('0x32')];_i12++){contour[_i12]=scalePt2(contour[_i12],contourMovements4Scale[_i12],0x1);}for(var _h5=0x0;_h5<holes['length'];_h5++){var _ahole4=holes[_h5];var oneHoleMovements=holesMovements4Scale[_h5];for(var _i13=0x0;_i13<_ahole4[_0x22c1('0x32')];_i13++){_ahole4[_i13]=scalePt2(_ahole4[_i13],oneHoleMovements[_i13],0x1);}holes[_h5]=_ahole4;}}if(bevelEnabled){for(var _i14=0x0;_i14<contour[_0x22c1('0x32')];_i14++){if(Math[_0x22c1('0x2d7')](bevelSize)==-0x1){contour[_i14]=contour[_i14];}else{contour[_i14]=contour[_i14];}}for(var _h6=0x0;_h6<holes[_0x22c1('0x32')];_h6++){var _ahole5=holes[_h6];var _oneHoleMovements=holesMovements[_h6];for(var _i15=0x0;_i15<_ahole5['length'];_i15++){if(Math['sign'](bevelSize)==-0x1){_ahole5[_i15]=_ahole5[_i15];}else{_ahole5[_i15]=_ahole5[_i15];}}holes[_h6]=_ahole5;}}var flen=faces[_0x22c1('0x32')];for(var _b=0x0;_b<bevelSegments;_b++){var _t=_b/bevelSegments;if(bevelType=='quad_ellipse'){_t=_t*_t;z=bevelThickness*Math[_0x22c1('0x7b')](_t*Math['PI']/0x2);bs=Math['sin'](_t*Math['PI']/0x2);}else if(bevelType==_0x22c1('0x2d8')){z=bevelThickness*(0x1-_t);bs=_t;}else if(bevelType==_0x22c1('0x1cd')){z=bevelThickness*Math[_0x22c1('0x7b')](_t*Math['PI']-Math['PI']/0x2);bs=_t;}for(var _i16=0x0,_il5=contour[_0x22c1('0x32')];_i16<_il5;_i16++){var _vert=scalePt2(contour[_i16],contourMovements[_i16],bs);placeholder['push'](_vert['x'],_vert['y'],z);}for(var _h7=0x0,_hl5=holes[_0x22c1('0x32')];_h7<_hl5;_h7++){var _ahole6=holes[_h7];var _oneHoleMovements2=holesMovements[_h7];for(var _i17=0x0,_il6=_ahole6[_0x22c1('0x32')];_i17<_il6;_i17++){vert=scalePt2(_ahole6[_i17],_oneHoleMovements2[_i17],bs);placeholder[_0x22c1('0x2e')](vert['x'],vert['y'],z);}}}bs=bevelSize;for(var s=0x0;s<=steps;s++){var extrudeX=extrudeOffsetX;var extrudeY=extrudeOffsetY;if(bevelEnabled){for(var _i18=0x0;_i18<contour[_0x22c1('0x32')];_i18++){vert=contour[_i18]['clone']()['add'](contourMovements[_i18])['add'](contourMovements4ExtrudeScale[_i18][_0x22c1('0x8d')]()[_0x22c1('0x6f')](extrudeScale/steps*s));placeholder[_0x22c1('0x2e')](vert['x']+extrudeX/steps*s,vert['y']+extrudeY/steps*s,-depth/steps*s);}for(var _h8=0x0;_h8<holes[_0x22c1('0x32')];_h8++){var _ahole7=holes[_h8];var _oneHoleMovements3=holesMovements[_h8];var oneHoleMovements4ExtrudeScale=holesMovements4ExtrudeScale[_h8];for(var _i19=0x0;_i19<_ahole7[_0x22c1('0x32')];_i19++){vert=_ahole7[_i19][_0x22c1('0x8d')]()[_0x22c1('0xc5')](_oneHoleMovements3[_i19])[_0x22c1('0xc5')](oneHoleMovements4ExtrudeScale[_i19][_0x22c1('0x8d')]()[_0x22c1('0x6f')](extrudeScale/steps*s));placeholder[_0x22c1('0x2e')](vert['x']+extrudeX/steps*s,vert['y']+extrudeY/steps*s,-depth/steps*s);}}}else{for(var _i20=0x0;_i20<contour[_0x22c1('0x32')];_i20++){vert=contour[_i20][_0x22c1('0x8d')]()[_0x22c1('0xc5')](contourMovements4ExtrudeScale[_i20]['clone']()[_0x22c1('0x6f')](extrudeScale/steps*s));placeholder['push'](vert['x']+extrudeX/steps*s,vert['y']+extrudeY/steps*s,-depth/steps*s);}for(var _h9=0x0;_h9<holes['length'];_h9++){var _ahole8=holes[_h9];var _oneHoleMovements4=holesMovements4ExtrudeScale[_h9];for(var _i21=0x0;_i21<_ahole8[_0x22c1('0x32')];_i21++){vert=_ahole8[_i21][_0x22c1('0x8d')]()[_0x22c1('0xc5')](_oneHoleMovements4[_i21][_0x22c1('0x8d')]()[_0x22c1('0x6f')](extrudeScale/steps*s));placeholder[_0x22c1('0x2e')](vert['x']+extrudeX/steps*s,vert['y']+extrudeY/steps*s,-depth/steps*s);}}}}if(bevelEnabled&&bevelBackEnabled){var _extrudeX=extrudeOffsetX;var _extrudeY=extrudeOffsetY;for(var _b2=bevelSegments-0x1;_b2>=0x0;_b2--){var _t2=_b2/bevelSegments;if(bevelType==_0x22c1('0x2c9')){z=bevelThickness*Math[_0x22c1('0x7b')](_t2*Math['PI']/0x2);bs=Math[_0x22c1('0x7c')](_t2*Math['PI']/0x2);}else if(bevelType==_0x22c1('0x2d8')){z=bevelThickness*(0x1-_t2);bs=_t2;}else if(bevelType==_0x22c1('0x1cd')){z=bevelThickness*Math[_0x22c1('0x7b')](_t2*Math['PI']-Math['PI']/0x2);bs=_t2;}for(var _i22=0x0;_i22<contour[_0x22c1('0x32')];_i22++){var _vert2=scalePt2(contour[_i22],contourMovements[_i22],bs);_vert2[_0x22c1('0xc5')](contourMovements4ExtrudeScale[_i22]['clone']()[_0x22c1('0x6f')](extrudeScale));placeholder[_0x22c1('0x2e')](_vert2['x']+_extrudeX,_vert2['y']+_extrudeY,-depth-z);}for(var _h10=0x0;_h10<holes['length'];_h10++){var _ahole9=holes[_h10];var _oneHoleMovements5=holesMovements[_h10];var _oneHoleMovements4ExtrudeScale=holesMovements4ExtrudeScale[_h10];for(var _i23=0x0,_il7=_ahole9[_0x22c1('0x32')];_i23<_il7;_i23++){vert=scalePt2(_ahole9[_i23],_oneHoleMovements5[_i23],bs);vert[_0x22c1('0xc5')](_oneHoleMovements4ExtrudeScale[_i23][_0x22c1('0x8d')]()[_0x22c1('0x6f')](extrudeScale));if(!extrudeByPath){placeholder[_0x22c1('0x2e')](vert['x']+_extrudeX,vert['y']+_extrudeY,-depth-z);}else{placeholder[_0x22c1('0x2e')](vert['x'],vert['y']+extrudePts[steps-0x1]['y'],extrudePts[steps-0x1]['x']+z);}}}}}else if(bevelEnabled&&!bevelBackEnabled){var _extrudeX2=extrudeOffsetX;var _extrudeY2=extrudeOffsetY;var _s=steps;for(var _i24=0x0;_i24<contour[_0x22c1('0x32')];_i24++){var _vert3=contour[_i24][_0x22c1('0x8d')]()[_0x22c1('0xc5')](contourMovements4ExtrudeScale[_i24][_0x22c1('0x8d')]()[_0x22c1('0x6f')](extrudeScale/steps*_s));placeholder[_0x22c1('0x2e')](_vert3['x']+_extrudeX2/steps*_s,_vert3['y']+_extrudeY2/steps*_s,-depth/steps*_s);}for(var _h11=0x0;_h11<holes['length'];_h11++){var _ahole10=holes[_h11];var _oneHoleMovements6=holesMovements4ExtrudeScale[_h11];for(var _i25=0x0;_i25<_ahole10['length'];_i25++){vert=_ahole10[_i25][_0x22c1('0x8d')]()['add'](_oneHoleMovements6[_i25]['clone']()[_0x22c1('0x6f')](extrudeScale/steps*_s));placeholder[_0x22c1('0x2e')](vert['x']+_extrudeX2/steps*_s,vert['y']+_extrudeY2/steps*_s,-depth/steps*_s);}}}buildLidFaces();buildBevelFaces();buildSideFaces();function buildLidFaces(){var start=verticesArray[_0x22c1('0x32')]/0x3;if(bevelEnabled){var layer=0x0;var offset=vlen*layer;for(var _i26=0x0;_i26<flen;_i26++){var _face=faces[_i26];triangleToPoint(_face[0x0]+offset,_face[0x1]+offset,_face[0x2]+offset);}layer=steps+bevelSegments*0x1;offset=vlen*layer;for(var _i27=0x0;_i27<flen;_i27++){var _face2=faces[_i27];triangleToPoint(_face2[0x2]+offset,_face2[0x1]+offset,_face2[0x0]+offset);}}else{for(var _i28=0x0;_i28<flen;_i28++){var _face3=faces[_i28];triangleToPoint(_face3[0x0],_face3[0x1],_face3[0x2]);}for(var _i29=0x0;_i29<flen;_i29++){var _face4=faces[_i29];triangleToPoint(_face4[0x2]+vlen*steps,_face4[0x1]+vlen*steps,_face4[0x0]+vlen*steps);}}scope[_0x22c1('0x230')](start,verticesArray[_0x22c1('0x32')]/0x3-start,0x0);}function buildBevelFaces(){if(bevelSegments==0x0||!bevelEnabled)return 0x0;var start=verticesArray[_0x22c1('0x32')]/0x3;var layeroffset=0x0;bevelwalls(contour,layeroffset);layeroffset+=contour[_0x22c1('0x32')];for(var _h12=0x0,_hl6=holes[_0x22c1('0x32')];_h12<_hl6;_h12++){ahole=holes[_h12];bevelwalls(ahole,layeroffset);layeroffset+=ahole[_0x22c1('0x32')];}scope['addGroup'](start,verticesArray['length']/0x3-start,0x1);}function bevelwalls(contour,layeroffset){var contour_length=[];var closedContour=[];for(var _i30=0x0;_i30<contour[_0x22c1('0x32')];_i30++){closedContour[_0x22c1('0x2e')](contour[_i30]);}closedContour[_0x22c1('0x2e')](contour[0x0]);contour_length[0x0]=0x0;for(var x=0x1;x<closedContour[_0x22c1('0x32')];x++){var _temp=contour_length[x-0x1]+closedContour[x][_0x22c1('0x8d')]()['sub'](closedContour[x-0x1])[_0x22c1('0x32')]();contour_length[x]=_temp;}var sl=bevelSegments;var sideWallLength=[];sideWallLength[0x0]=0x0;var j=0x1;for(var _s2=0x0;_s2<sl;_s2++){var slen1=vlen*_s2;var slen2=vlen*(_s2+0x1);var a=layeroffset+j+slen1;var d=layeroffset+j+slen2;var va=new Vector3(placeholder[a*0x3+0x0],placeholder[a*0x3+0x1],placeholder[a*0x3+0x2]);var vd=new Vector3(placeholder[d*0x3+0x0],placeholder[d*0x3+0x1],placeholder[d*0x3+0x2]);var _temp2=vd[_0x22c1('0xab')](va)[_0x22c1('0x32')]();sideWallLength[_0x22c1('0x2e')](sideWallLength[sideWallLength['length']-0x1]+_temp2);}uvSideWallLengthOffset=sideWallLength[sideWallLength[_0x22c1('0x32')]-0x1];var i=contour['length'];while(--i>=0x0){var _j6=i;var _k4=i-0x1;if(_k4<0x0)_k4=contour['length']-0x1;for(var _s3=0x0;_s3<sl;_s3++){var _slen=vlen*_s3;var _slen2=vlen*(_s3+0x1);var _a=layeroffset+_j6+_slen;var _b3=layeroffset+_k4+_slen;var c=layeroffset+_k4+_slen2;var _d=layeroffset+_j6+_slen2;quadToPoint(contour_length,sideWallLength,i,_s3,_b3,_a,_d,c);}}}function buildSideFaces(){var start=verticesArray[_0x22c1('0x32')]/0x3;var layeroffset=vlen*bevelSegments;sidewalls(contour,layeroffset);layeroffset+=contour[_0x22c1('0x32')];for(var _h13=0x0,_hl7=holes[_0x22c1('0x32')];_h13<_hl7;_h13++){ahole=holes[_h13];sidewalls(ahole,layeroffset);layeroffset+=ahole['length'];}scope['addGroup'](start,verticesArray['length']/0x3-start,0x1);}function sidewalls(contour,layeroffset){var contour_length=[];var closedContour=[];for(var _i31=0x0;_i31<contour[_0x22c1('0x32')];_i31++){closedContour[_0x22c1('0x2e')](contour[_i31]);}closedContour[_0x22c1('0x2e')](contour[0x0]);contour_length[0x0]=0x0;for(var x=0x1;x<closedContour[_0x22c1('0x32')];x++){var _temp3=contour_length[x-0x1]+closedContour[x][_0x22c1('0x8d')]()[_0x22c1('0xab')](closedContour[x-0x1])[_0x22c1('0x32')]();contour_length[x]=_temp3;}var sl=steps;var sideWallLength=[];sideWallLength[0x0]=uvSideWallLengthOffset;var j=0x1;for(var _s4=0x0;_s4<sl;_s4++){var slen1=vlen*_s4;var slen2=vlen*(_s4+0x1);var a=layeroffset+j+slen1;var d=layeroffset+j+slen2;var va=new Vector3(placeholder[a*0x3+0x0],placeholder[a*0x3+0x1],placeholder[a*0x3+0x2]);var vd=new Vector3(placeholder[d*0x3+0x0],placeholder[d*0x3+0x1],placeholder[d*0x3+0x2]);var _temp4=vd[_0x22c1('0xab')](va)[_0x22c1('0x32')]();sideWallLength[_0x22c1('0x2e')](sideWallLength[sideWallLength[_0x22c1('0x32')]-0x1]+_temp4);}var i=contour['length'];while(--i>=0x0){var _j7=i;var _k5=i-0x1;if(_k5<0x0)_k5=contour[_0x22c1('0x32')]-0x1;for(var _s5=0x0;_s5<sl;_s5++){var _slen3=vlen*_s5;var _slen4=vlen*(_s5+0x1);var _a2=layeroffset+_j7+_slen3;var _b4=layeroffset+_k5+_slen3;var c=layeroffset+_k5+_slen4;var _d2=layeroffset+_j7+_slen4;quadToPoint(contour_length,sideWallLength,i,_s5,_b4,_a2,_d2,c);}}}function triangleToPoint(a,b,c){addVertex(a);addVertex(b);addVertex(c);var nextIndex=verticesArray[_0x22c1('0x32')]/0x3;var uvs=uvgen[_0x22c1('0x2d9')](scope,verticesArray,boundingbox,nextIndex-0x3,nextIndex-0x2,nextIndex-0x1);addUV(uvs[0x0]);addUV(uvs[0x1]);addUV(uvs[0x2]);}function quadToPoint(contour_length,sideWallLength,uvStartIndex,uvStartIndexDepthDirection,a,b,c,d){addVertex(a);addVertex(b);addVertex(d);addVertex(b);addVertex(c);addVertex(d);var nextIndex=verticesArray[_0x22c1('0x32')]/0x3;var uvs=uvgen[_0x22c1('0x2da')](scope,verticesArray,boundingbox,depth,contour_length,sideWallLength,uvStartIndex,uvStartIndexDepthDirection,nextIndex-0x6,nextIndex-0x3,nextIndex-0x2,nextIndex-0x1);addUV(uvs[0x0]);addUV(uvs[0x1]);addUV(uvs[0x3]);addUV(uvs[0x1]);addUV(uvs[0x2]);addUV(uvs[0x3]);}function addVertex(index){verticesArray[_0x22c1('0x2e')](placeholder[index*0x3+0x0],placeholder[index*0x3+0x1],placeholder[index*0x3+0x2]);}function addUV(vector2){uvArray[_0x22c1('0x2e')](vector2['x']);uvArray[_0x22c1('0x2e')](vector2['y']);}}}ExtrudeBufferGeometry[_0x22c1('0x1')]=Object['create'](BufferGeometry['prototype']);ExtrudeBufferGeometry['prototype'][_0x22c1('0xd')]=ExtrudeBufferGeometry;ExtrudeBufferGeometry[_0x22c1('0x1')][_0x22c1('0x141')]=function(){var data=BufferGeometry['prototype'][_0x22c1('0x141')]['call'](this);var shapes=this['parameters']['shapes'];var options=this[_0x22c1('0x13d')]['options'];return toJSON(shapes,options,data);};function rotateCoord45degree(x,y,new_x,new_y){new_x=Math[_0x22c1('0x2db')]*x-Math[_0x22c1('0x2db')]*y;new_y=Math[_0x22c1('0x2db')]*x+Math[_0x22c1('0x2db')]*y;return[new_x,new_y];}var WorldUVGenerator={'generateTopUV':function generateTopUV(geometry,vertices,boundingbox,indexA,indexB,indexC){var a_x=vertices[indexA*0x3];var a_y=vertices[indexA*0x3+0x1];var b_x=vertices[indexB*0x3];var b_y=vertices[indexB*0x3+0x1];var c_x=vertices[indexC*0x3];var c_y=vertices[indexC*0x3+0x1];var bb=boundingbox;var bby=bb['max']['y']-bb[_0x22c1('0x54')]['y'];var amt=bby;return[new Vector2((a_x-bb[_0x22c1('0x54')]['x'])/amt,0x1-(a_y-bb['min']['y'])/amt),new Vector2((b_x-bb[_0x22c1('0x54')]['x'])/amt,0x1-(b_y-bb[_0x22c1('0x54')]['y'])/amt),new Vector2((c_x-bb['min']['x'])/amt,0x1-(c_y-bb[_0x22c1('0x54')]['y'])/amt)];},'generateBottomUV':function generateBottomUV(geometry,vertices,boundingbox,indexA,indexB,indexC){return this[_0x22c1('0x2d9')](geometry,boundingbox,indexA,indexB,indexC);},'generateSideWallUV':function generateSideWallUV(geometry,vertices,boundingbox,extrudeheight,indexA,indexB,indexC,indexD){var ax=vertices[indexA*0x3];var ay=vertices[indexA*0x3+0x1];var az=vertices[indexA*0x3+0x2];var bx=vertices[indexB*0x3];var by=vertices[indexB*0x3+0x1];var bz=vertices[indexB*0x3+0x2];var cx=vertices[indexC*0x3];var cy=vertices[indexC*0x3+0x1];var cz=vertices[indexC*0x3+0x2];var dx=vertices[indexD*0x3];var dy=vertices[indexD*0x3+0x1];var dz=vertices[indexD*0x3+0x2];var bb=boundingbox;var bbx=bb[_0x22c1('0x53')]['x']-bb[_0x22c1('0x54')]['x'];var bby=bb['max']['y']-bb[_0x22c1('0x54')]['y'];var bbz=bb[_0x22c1('0x53')]['z']-bb[_0x22c1('0x54')]['z'];var amt=bby;var ba=new Vector3(bx-ax,by-ay,0x0);var xAxis=new Vector3(0x1,0x0,0x0);var abAngle=ba[_0x22c1('0x96')](xAxis)*0xb4/Math['PI'];if(abAngle<0x0||abAngle>0xb4)console[_0x22c1('0xb0')](_0x22c1('0x2dc'),abAngle);var angleConst=0x1e;if(abAngle<angleConst||abAngle>0xb4-angleConst){return[new Vector2(ax/amt,az/amt),new Vector2(bx/amt,bz/amt),new Vector2(cx/amt,cz/amt),new Vector2(dx/amt,dz/amt)];}else if(abAngle>0x5a-angleConst&&abAngle<0x5a+angleConst){return[new Vector2(ay/amt,az/amt),new Vector2(by/amt,bz/amt),new Vector2(cy/amt,cz/amt),new Vector2(dy/amt,dz/amt)];}else{var _rotateCoord45degree=rotateCoord45degree(ax,ay),_rotateCoord45degree2=_slicedToArray(_rotateCoord45degree,0x2),new_ax=_rotateCoord45degree2[0x0],new_ay=_rotateCoord45degree2[0x1];var _rotateCoord45degree3=rotateCoord45degree(bx,by),_rotateCoord45degree4=_slicedToArray(_rotateCoord45degree3,0x2),new_bx=_rotateCoord45degree4[0x0],new_by=_rotateCoord45degree4[0x1];var _ba=new Vector3(new_bx-new_ax,new_by-new_ay,0x0);var newAbAngle=_ba[_0x22c1('0x96')](xAxis)*0xb4/Math['PI'];var new_amt=amt/1.41421;var newAngleConst=0x2d-angleConst;if(newAbAngle<newAngleConst||newAbAngle>0xb4-newAngleConst){return[new Vector2(ax/new_amt,az/amt),new Vector2(bx/new_amt,bz/amt),new Vector2(cx/new_amt,cz/amt),new Vector2(dx/new_amt,dz/amt)];}{return[new Vector2(ay/new_amt,az/amt),new Vector2(by/new_amt,bz/amt),new Vector2(cy/new_amt,cz/amt),new Vector2(dy/new_amt,dz/amt)];}}},'generateSideWallUVExtend':function generateSideWallUVExtend(geometry,vertices,boundingbox,extrudeheight,contour_length,sideWallLength,uvStartIndex,uvStartIndexDepthDirection,indexA,indexB,indexC,indexD){var bb=boundingbox;var bby=bb[_0x22c1('0x53')]['y']-bb[_0x22c1('0x54')]['y'];var amt=bby;if(uvStartIndex-0x1<0x0){uvStartIndex=contour_length[_0x22c1('0x32')]-0x1;}var uv0U=contour_length[uvStartIndex-0x1]/amt;var uv1U=contour_length[uvStartIndex]/amt;return[new Vector2(uv0U,sideWallLength[uvStartIndexDepthDirection]/amt),new Vector2(uv1U,sideWallLength[uvStartIndexDepthDirection]/amt),new Vector2(uv1U,sideWallLength[uvStartIndexDepthDirection+0x1]/amt),new Vector2(uv0U,sideWallLength[uvStartIndexDepthDirection+0x1]/amt)];}};function toJSON(shapes,options,data){data[_0x22c1('0x13e')]=[];if(Array[_0x22c1('0xd4')](shapes)){for(var i=0x0,l=shapes[_0x22c1('0x32')];i<l;i++){var shape=shapes[i];data[_0x22c1('0x13e')]['push'](shape['uuid']);}}else{data[_0x22c1('0x13e')][_0x22c1('0x2e')](shapes[_0x22c1('0x114')]);}if(options['extrudePath']!==undefined)data[_0x22c1('0x2dd')][_0x22c1('0x2bb')]=options[_0x22c1('0x2bb')][_0x22c1('0x141')]();return data;}var kIsNodeJS=Object[_0x22c1('0x1')]['toString'][_0x22c1('0x2')](typeof process!==_0x22c1('0x0')?process:0x0)===_0x22c1('0x2de');var kRequire=kIsNodeJS?module[_0x22c1('0x2df')]:null;function createBase64WorkerFactory(base64){var sourcemap=arguments['length']>0x1&&arguments[0x1]!==undefined?arguments[0x1]:null;var source=kIsNodeJS?Buffer[_0x22c1('0x145')](base64,_0x22c1('0x2e0'))[_0x22c1('0x50')](_0x22c1('0x2e1')):atob(base64);var start=source[_0x22c1('0x4a')]('\x0a',0xa)+0x1;var body=source['substring'](start)+(sourcemap?'//#\x20sourceMappingURL='[_0x22c1('0x171')](sourcemap):'');if(kIsNodeJS){var _Worker3=kRequire(_0x22c1('0x2e2'))[_0x22c1('0x2e3')];return function WorkerFactory(options){return new _Worker3(body,Object[_0x22c1('0x48')]({},options,{'eval':!![]}));};}var blob=new Blob([body],{'type':'application/javascript'});var url=URL['createObjectURL'](blob);return function WorkerFactory(options){return new Worker(url,options);};}var WorkerFactory=createBase64WorkerFactory(_0x22c1('0x2e4'),null);var getPrototypeOf=createCommonjsModule(function(module){function _getPrototypeOf(o){module[_0x22c1('0x3')]=_getPrototypeOf=Object[_0x22c1('0x36')]?Object[_0x22c1('0x21')][_0x22c1('0x2e5')]():function _getPrototypeOf(o){return o[_0x22c1('0x37')]||Object[_0x22c1('0x21')](o);},module['exports']['__esModule']=!![],module['exports'][_0x22c1('0x4')]=module['exports'];return _getPrototypeOf(o);}module[_0x22c1('0x3')]=_getPrototypeOf,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')]['default']=module[_0x22c1('0x3')];});var _getPrototypeOf=unwrapExports(getPrototypeOf);var superPropBase=createCommonjsModule(function(module){function _superPropBase(object,property){while(!Object['prototype']['hasOwnProperty']['call'](object,property)){object=getPrototypeOf(object);if(object===null)break;}return object;}module['exports']=_superPropBase,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});unwrapExports(superPropBase);var get=createCommonjsModule(function(module){function _get(){if(typeof Reflect!=='undefined'&&Reflect[_0x22c1('0x1d6')]){module[_0x22c1('0x3')]=_get=Reflect[_0x22c1('0x1d6')][_0x22c1('0x2e5')](),module['exports'][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')]['default']=module[_0x22c1('0x3')];}else{module[_0x22c1('0x3')]=_get=function _get(target,property,receiver){var base=superPropBase(target,property);if(!base)return;var desc=Object[_0x22c1('0x2e6')](base,property);if(desc[_0x22c1('0x1d6')]){return desc[_0x22c1('0x1d6')]['call'](arguments[_0x22c1('0x32')]<0x3?target:receiver);}return desc[_0x22c1('0x5')];},module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];}return _get[_0x22c1('0x7')](this,arguments);}module[_0x22c1('0x3')]=_get,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});var _get=unwrapExports(get);var setPrototypeOf=createCommonjsModule(function(module){function _setPrototypeOf(o,p){module[_0x22c1('0x3')]=_setPrototypeOf=Object['setPrototypeOf']?Object[_0x22c1('0x36')][_0x22c1('0x2e5')]():function _setPrototypeOf(o,p){o[_0x22c1('0x37')]=p;return o;},module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module[_0x22c1('0x3')];return _setPrototypeOf(o,p);}module[_0x22c1('0x3')]=_setPrototypeOf,module['exports']['__esModule']=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module[_0x22c1('0x3')];});unwrapExports(setPrototypeOf);var inherits=createCommonjsModule(function(module){function _inherits(subClass,superClass){if(typeof superClass!==_0x22c1('0xa')&&superClass!==null){throw new TypeError('Super\x20expression\x20must\x20either\x20be\x20null\x20or\x20a\x20function');}subClass[_0x22c1('0x1')]=Object[_0x22c1('0x13')](superClass&&superClass[_0x22c1('0x1')],{'constructor':{'value':subClass,'writable':!![],'configurable':!![]}});Object[_0x22c1('0x12')](subClass,_0x22c1('0x1'),{'writable':![]});if(superClass)setPrototypeOf(subClass,superClass);}module[_0x22c1('0x3')]=_inherits,module['exports'][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')][_0x22c1('0x4')]=module['exports'];});var _inherits=unwrapExports(inherits);var assertThisInitialized=createCommonjsModule(function(module){function _assertThisInitialized(self){if(self===void 0x0){throw new ReferenceError(_0x22c1('0x2e7'));}return self;}module[_0x22c1('0x3')]=_assertThisInitialized,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module['exports'][_0x22c1('0x4')]=module[_0x22c1('0x3')];});unwrapExports(assertThisInitialized);var possibleConstructorReturn=createCommonjsModule(function(module){var _typeof=_typeof_1[_0x22c1('0x4')];function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)===_0x22c1('0x46')||typeof call===_0x22c1('0xa'))){return call;}else if(call!==void 0x0){throw new TypeError(_0x22c1('0x2e8'));}return assertThisInitialized(self);}module[_0x22c1('0x3')]=_possibleConstructorReturn,module[_0x22c1('0x3')][_0x22c1('0x8')]=!![],module[_0x22c1('0x3')]['default']=module[_0x22c1('0x3')];});var _possibleConstructorReturn=unwrapExports(possibleConstructorReturn);var Curve=function(){function Curve(){_classCallCheck(this,Curve);this[_0x22c1('0x1f')]=_0x22c1('0x2e9');this[_0x22c1('0x2ea')]=0xc8;this[_0x22c1('0x2eb')]=0x0;}_createClass(Curve,[{'key':_0x22c1('0x2ec'),'value':function getPointAt(u){var t=this[_0x22c1('0x2ed')](u);return this['getPoint'](t);}},{'key':_0x22c1('0x2ee'),'value':function getPoints(divisions){if(divisions===undefined)divisions=0x5;var points=[];for(var d=0x0;d<=divisions;d++){points[_0x22c1('0x2e')](this[_0x22c1('0x24a')](d/divisions));}return points;}},{'key':_0x22c1('0x2ef'),'value':function getPointsByStepsize(stepSize){if(stepSize===undefined)stepSize=0x5;var length=this[_0x22c1('0x2f0')]();var divisions;if(stepSize>length){divisions=0x1;}else{divisions=Math[_0x22c1('0xc0')](length/stepSize);}return this[_0x22c1('0x2ee')](divisions);}},{'key':_0x22c1('0x2f1'),'value':function triangleArea(p,q,r){return Math[_0x22c1('0x69')]((q['x']-p['x'])*(r['y']-p['y'])-(q['y']-p['y'])*(r['x']-p['x']));}},{'key':_0x22c1('0x2f2'),'value':function checkFlat(pointP,pointQ,pointR,tolerance){return this[_0x22c1('0x2f1')](pointP,pointQ,pointR)<tolerance;}},{'key':_0x22c1('0x2f3'),'value':function sample(tP,tQ,tolerance,samplePoints){if(this[_0x22c1('0x2eb')]>0x64){return;}this[_0x22c1('0x2eb')]++;var pointP=this[_0x22c1('0x2ec')](tP);var pointQ=this['getPointAt'](tQ);var t=0.45;var tR=tP+(tQ-tP)*t;var pointR=this[_0x22c1('0x2ec')](tR);if(this['checkFlat'](pointP,pointQ,pointR,tolerance)){samplePoints['add'](pointQ);}else{this[_0x22c1('0x2f3')](tP,tR,tolerance,samplePoints);this['sample'](tR,tQ,tolerance,samplePoints);}}},{'key':_0x22c1('0x2f4'),'value':function getPointsAdaptively4Curve(){var tolerance=arguments['length']>0x0&&arguments[0x0]!==undefined?arguments[0x0]:0.01;this[_0x22c1('0x2eb')]=0x0;var samplePoints=new Set();var tP=0x0;var tQ=0x1;samplePoints[_0x22c1('0xc5')](this['getPointAt'](0x0));this['sample'](tP,tQ,tolerance,samplePoints);return Array[_0x22c1('0x145')](samplePoints);}},{'key':_0x22c1('0x2cf'),'value':function getSpacedPoints(divisions){if(divisions===undefined)divisions=0x5;var points=[];for(var d=0x0;d<=divisions;d++){points[_0x22c1('0x2e')](this[_0x22c1('0x2ec')](d/divisions));}return points;}},{'key':_0x22c1('0x2f0'),'value':function getLength(){var lengths=this[_0x22c1('0x2f5')]();return lengths[lengths[_0x22c1('0x32')]-0x1];}},{'key':_0x22c1('0x2f5'),'value':function getLengths(divisions){if(divisions===undefined)divisions=this[_0x22c1('0x2ea')];if(this[_0x22c1('0x2f6')]&&this[_0x22c1('0x2f6')][_0x22c1('0x32')]===divisions+0x1&&!this['needsUpdate']){return this[_0x22c1('0x2f6')];}this[_0x22c1('0x202')]=![];var cache=[];var current;var last=this[_0x22c1('0x24a')](0x0);var p;var sum=0x0;cache['push'](0x0);for(p=0x1;p<=divisions;p++){current=this['getPoint'](p/divisions);sum+=current[_0x22c1('0x107')](last);cache[_0x22c1('0x2e')](sum);last=current;}this['cacheArcLengths']=cache;return cache;}},{'key':_0x22c1('0x2f7'),'value':function updateArcLengths(){this['needsUpdate']=!![];this[_0x22c1('0x2f5')]();}},{'key':'getUtoTmapping','value':function getUtoTmapping(u,distance){var arcLengths=this['getLengths']();var i=0x0;var il=arcLengths[_0x22c1('0x32')];var targetArcLength;if(distance){targetArcLength=distance;}else{targetArcLength=u*arcLengths[il-0x1];}var low=0x0;var high=il-0x1;var comparison;while(low<=high){i=Math[_0x22c1('0x55')](low+(high-low)/0x2);comparison=arcLengths[i]-targetArcLength;if(comparison<0x0){low=i+0x1;}else if(comparison>0x0){high=i-0x1;}else{high=i;break;}}i=high;if(arcLengths[i]===targetArcLength){return i/(il-0x1);}var lengthBefore=arcLengths[i];var lengthAfter=arcLengths[i+0x1];var segmentLength=lengthAfter-lengthBefore;var segmentFraction=(targetArcLength-lengthBefore)/segmentLength;var t=(i+segmentFraction)/(il-0x1);return t;}},{'key':'getNormal','value':function getNormal(t){var _this$getTangent=this[_0x22c1('0x2f8')](t),x=_this$getTangent['x'],y=_this$getTangent['y'];var normal=new Vector2(y,-x);return normal[_0x22c1('0x6a')]();}},{'key':_0x22c1('0x2f8'),'value':function getTangent(t){var delta=0.0001;var t1=t-delta;var t2=t+delta;if(t1<0x0)t1=0x0;if(t2>0x1)t2=0x1;var pt1=this[_0x22c1('0x24a')](t1);var pt2=this[_0x22c1('0x24a')](t2);var vec=pt2[_0x22c1('0x8d')]()[_0x22c1('0xab')](pt1);return vec['normalize']();}},{'key':_0x22c1('0x2f9'),'value':function getTangentAt(u){var t=this[_0x22c1('0x2ed')](u);return this[_0x22c1('0x2f8')](t);}},{'key':_0x22c1('0x2d0'),'value':function computeFrenetFrames(segments,closed){var normal=new Vector3();var tangents=[];var normals=[];var binormals=[];var vec=new Vector3();var mat=new Matrix4();var i,u,theta;for(i=0x0;i<=segments;i++){u=i/segments;tangents[i]=this[_0x22c1('0x2f9')](u);tangents[i]['normalize']();}normals[0x0]=new Vector3();binormals[0x0]=new Vector3();var min=Number[_0x22c1('0x2fa')];var tx=Math[_0x22c1('0x69')](tangents[0x0]['x']);var ty=Math[_0x22c1('0x69')](tangents[0x0]['y']);var tz=Math[_0x22c1('0x69')](tangents[0x0]['z']);if(tx<=min){min=tx;normal['set'](0x1,0x0,0x0);}if(ty<=min){min=ty;normal['set'](0x0,0x1,0x0);}if(tz<=min){normal[_0x22c1('0x5e')](0x0,0x0,0x1);}vec[_0x22c1('0x68')](tangents[0x0],normal)['normalize']();normals[0x0]['crossVectors'](tangents[0x0],vec);binormals[0x0][_0x22c1('0x68')](tangents[0x0],normals[0x0]);for(i=0x1;i<=segments;i++){normals[i]=normals[i-0x1][_0x22c1('0x8d')]();binormals[i]=binormals[i-0x1]['clone']();vec[_0x22c1('0x68')](tangents[i-0x1],tangents[i]);if(vec[_0x22c1('0x32')]()>Number[_0x22c1('0x89')]){vec['normalize']();theta=Math[_0x22c1('0x97')](_Math[_0x22c1('0x98')](tangents[i-0x1]['dot'](tangents[i]),-0x1,0x1));normals[i][_0x22c1('0xb7')](mat['makeRotationAxis'](vec,theta));}binormals[i][_0x22c1('0x68')](tangents[i],normals[i]);}if(closed===!![]){theta=Math['acos'](_Math[_0x22c1('0x98')](normals[0x0][_0x22c1('0x9c')](normals[segments]),-0x1,0x1));theta/=segments;if(tangents[0x0]['dot'](vec[_0x22c1('0x68')](normals[0x0],normals[segments]))>0x0){theta=-theta;}for(i=0x1;i<=segments;i++){normals[i][_0x22c1('0xb7')](mat[_0x22c1('0x7e')](tangents[i],theta*i));binormals[i][_0x22c1('0x68')](tangents[i],normals[i]);}}return{'tangents':tangents,'normals':normals,'binormals':binormals};}},{'key':'clone','value':function clone(){return Object[_0x22c1('0x48')]({},this);}},{'key':'copy','value':function copy(source){this['arcLengthDivisions']=source[_0x22c1('0x2ea')];return this;}}]);return Curve;}();function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect['construct'](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x701bee){return![];}}var LineCurve=function(_Curve){_inherits(LineCurve,_Curve);var _super=_createSuper(LineCurve);function LineCurve(v1,v2){var _this;_classCallCheck(this,LineCurve);_this=_super[_0x22c1('0x2')](this);_this[_0x22c1('0x1f')]='LineCurve';_this['v1']=v1||new Vector2();_this['v2']=v2||new Vector2();_this[_0x22c1('0x2fe')]=!![];return _this;}_createClass(LineCurve,[{'key':_0x22c1('0x2ff'),'value':function getPole(min,max){var v1=this['v1'],v2=this['v2'];min['x']=Math[_0x22c1('0x54')](min['x'],v1['x'],v2['x']);min['y']=Math[_0x22c1('0x54')](min['y'],v1['y'],v2['y']);max['x']=Math[_0x22c1('0x53')](max['x'],v1['x'],v2['x']);max['y']=Math[_0x22c1('0x53')](max['y'],v1['y'],v2['y']);}},{'key':'pointApplyFunc','value':function pointApplyFunc(func){func(this['v1']);func(this['v2']);}},{'key':'split','value':function split(_ref){var x=_ref['x'],y=_ref['y'];var v1=this['v1'],v2=this['v2'];var splitByX=x!==undefined&&(v1['x']-x)*(v2['x']-x)<0x0;var splitByY=y!==undefined&&(v1['y']-y)*(v2['y']-y)<0x0;if(splitByX){y=v1['y']+(v2['y']-v1['y'])/(v2['x']-v1['x'])*(x-v1['x']);}if(splitByY){x=v1['x']+(v2['x']-v1['x'])/(v2['y']-v1['y'])*(y-v1['y']);}if(splitByX||splitByY){var lineCurve1=new LineCurve(v1,new Vector2(x,y));var lineCurve2=new LineCurve(new Vector2(x,y),v2);return[lineCurve1,lineCurve2];}else{return[this];}}},{'key':'getLength','value':function getLength(){var v1=this['v1'],v2=this['v2'];return Math['hypot'](v1['x']-v2['x'],v1['y']-v2['y']);}},{'key':'getPoint','value':function getPoint(t){var point=new Vector2();if(t===0x1){point[_0x22c1('0x82')](this['v2']);}else{point[_0x22c1('0x82')](this['v2'])[_0x22c1('0xab')](this['v1']);point[_0x22c1('0x6f')](t)[_0x22c1('0xc5')](this['v1']);}return point;}},{'key':'getNormal','value':function getNormal(){var x=this['v2']['x']-this['v1']['x'];var y=this['v2']['y']-this['v1']['y'];var normal=new Vector2(y,-x);return normal[_0x22c1('0x6a')]();}},{'key':'getTangent','value':function getTangent(){var tangent=this['v2'][_0x22c1('0x8d')]()[_0x22c1('0xab')](this['v1']);return tangent[_0x22c1('0x6a')]();}},{'key':'copy','value':function copy(source){_get(_getPrototypeOf(LineCurve[_0x22c1('0x1')]),_0x22c1('0x82'),this)['call'](this,source);this['v1'][_0x22c1('0x82')](source['v1']);this['v2']['copy'](source['v2']);return this;}}]);return LineCurve;}(Curve);function _createSuper$1(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$1();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super['apply'](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$1(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x106607){return![];}}var CurvePath=function(_Curve){_inherits(CurvePath,_Curve);var _super=_createSuper$1(CurvePath);function CurvePath(){var _this;_classCallCheck(this,CurvePath);_this=_super['call'](this);_this[_0x22c1('0x1f')]='CurvePath';_this[_0x22c1('0x300')]=[];_this[_0x22c1('0x301')]=![];_this[_0x22c1('0x2ba')]=![];return _this;}_createClass(CurvePath,[{'key':'add','value':function add(curve){this[_0x22c1('0x300')][_0x22c1('0x2e')](curve);}},{'key':'closePath','value':function closePath(){var startPoint=this['curves'][0x0][_0x22c1('0x24a')](0x0);var endPoint=this[_0x22c1('0x300')][this[_0x22c1('0x300')][_0x22c1('0x32')]-0x1][_0x22c1('0x24a')](0x1);if(!startPoint[_0x22c1('0x85')](endPoint)){this[_0x22c1('0x300')][_0x22c1('0x2e')](new LineCurve(endPoint,startPoint));}}},{'key':'getPoint','value':function getPoint(t){var d=t*this[_0x22c1('0x2f0')]();var curveLengths=this[_0x22c1('0x302')]();var i=0x0;while(i<curveLengths[_0x22c1('0x32')]){if(curveLengths[i]>=d){var diff=curveLengths[i]-d;var curve=this[_0x22c1('0x300')][i];var segmentLength=curve[_0x22c1('0x2f0')]();var u=segmentLength===0x0?0x0:0x1-diff/segmentLength;return curve[_0x22c1('0x2ec')](u);}i++;}return null;}},{'key':_0x22c1('0x2f0'),'value':function getLength(){var lens=this['getCurveLengths']();return lens[lens['length']-0x1];}},{'key':_0x22c1('0x2f7'),'value':function updateArcLengths(){this[_0x22c1('0x202')]=!![];this['cacheLengths']=null;this[_0x22c1('0x302')]();}},{'key':_0x22c1('0x302'),'value':function getCurveLengths(){if(this[_0x22c1('0x303')]&&this[_0x22c1('0x303')]['length']===this[_0x22c1('0x300')][_0x22c1('0x32')]){return this['cacheLengths'];}var lengths=[];var sums=0x0;for(var i=0x0,l=this[_0x22c1('0x300')]['length'];i<l;i++){sums+=this[_0x22c1('0x300')][i][_0x22c1('0x2f0')]();lengths[_0x22c1('0x2e')](sums);}this['cacheLengths']=lengths;return lengths;}},{'key':_0x22c1('0x2cf'),'value':function getSpacedPoints(divisions){if(divisions===undefined)divisions=0x28;var points=[];for(var i=0x0;i<=divisions;i++){points[_0x22c1('0x2e')](this[_0x22c1('0x24a')](i/divisions));}if(this[_0x22c1('0x301')]){points[_0x22c1('0x2e')](points[0x0]);}return points;}},{'key':_0x22c1('0x2ee'),'value':function getPoints(divisions){divisions=divisions||0xc;var points=[];var last;for(var i=0x0;i<this[_0x22c1('0x300')][_0x22c1('0x32')];i++){var curve=this[_0x22c1('0x300')][i];var resolution=curve&&curve[_0x22c1('0x304')]?divisions*0x2:curve&&(curve[_0x22c1('0x2fe')]||curve['isLineCurve3'])?0x1:curve&&curve[_0x22c1('0x305')]?divisions*curve['points']['length']:divisions;if(curve&&curve['isLineCurve']){resolution=divisions;}var pts=curve[_0x22c1('0x2ee')](resolution);for(var j=0x0;j<pts[_0x22c1('0x32')];j++){var point=pts[j];if(last&&last['equals'](point))continue;points[_0x22c1('0x2e')](point);last=point;}}if(this[_0x22c1('0x301')]&&points[_0x22c1('0x32')]>0x1&&!points[points[_0x22c1('0x32')]-0x1]['equals'](points[0x0])){points[_0x22c1('0x2e')](points[0x0]);}return points;}},{'key':_0x22c1('0x306'),'value':function getPointsByStepSize(stepSize){stepSize=stepSize||0x1;var points=[];var last;for(var i=0x0,curves=this['curves'];i<curves[_0x22c1('0x32')];i++){var curve=curves[i];var curveLength=curve[_0x22c1('0x2f0')](0x14);var resolution=parseInt(Math[_0x22c1('0x53')](0x1,curveLength/stepSize));debug['log'](_0x22c1('0x307'),resolution);var pts=curve['getPoints'](resolution);for(var j=0x0;j<pts[_0x22c1('0x32')];j++){var point=pts[j];if(last&&last[_0x22c1('0x85')](point))continue;points[_0x22c1('0x2e')](point);last=point;}}if(this[_0x22c1('0x301')]&&points[_0x22c1('0x32')]>0x1&&!points[points[_0x22c1('0x32')]-0x1]['equals'](points[0x0])){points['push'](points[0x0]);}return points;}},{'key':_0x22c1('0x308'),'value':function getPointsAdaptively(tolerance){tolerance=tolerance||0.01;var points=[];var last;for(var i=0x0,curves=this['curves'];i<curves[_0x22c1('0x32')];i++){var curve=curves[i];var pts=void 0x0;if(curve[_0x22c1('0x2fe')]&&this['isDeformationON']){var curveLength=curve[_0x22c1('0x2f0')](0x14);var stepSize=Math['max'](0x1,tolerance*1.5);var resolution=parseInt(Math[_0x22c1('0x53')](0x1,curveLength/stepSize));resolution=Math['min'](0x14,resolution);pts=curve[_0x22c1('0x2ee')](resolution);}else{pts=curve[_0x22c1('0x2f4')](tolerance);}for(var j=0x0;j<pts['length'];j++){var point=pts[j];if(last&&last[_0x22c1('0x85')](point))continue;points[_0x22c1('0x2e')](point);last=point;}}if(this[_0x22c1('0x301')]&&points[_0x22c1('0x32')]>0x1&&!points[points[_0x22c1('0x32')]-0x1][_0x22c1('0x85')](points[0x0])){points[_0x22c1('0x2e')](points[0x0]);}return points;}},{'key':'copy','value':function copy(source){Object[_0x22c1('0x48')](this,source);this[_0x22c1('0x300')]=[];for(var i=0x0,l=source[_0x22c1('0x300')][_0x22c1('0x32')];i<l;i++){var curve=source[_0x22c1('0x300')][i];this[_0x22c1('0x300')][_0x22c1('0x2e')](curve['clone']());}return this;}}]);return CurvePath;}(Curve);function _createSuper$2(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$2();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$2(){if(typeof Reflect===_0x22c1('0x0')||!Reflect['construct'])return![];if(Reflect[_0x22c1('0x2fb')]['sham'])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x54c666){return![];}}var EllipseCurve=function(_Curve){_inherits(EllipseCurve,_Curve);var _super=_createSuper$2(EllipseCurve);function EllipseCurve(aX,aY,xRadius,yRadius,startAngle,endAngle,clockwise,rotation){var _this;_classCallCheck(this,EllipseCurve);_this=_super['call'](this);_this[_0x22c1('0x1f')]=_0x22c1('0x309');_this['aX']=aX||0x0;_this['aY']=aY||0x0;_this[_0x22c1('0x30a')]=xRadius||0x1;_this[_0x22c1('0x30b')]=yRadius||0x1;_this[_0x22c1('0x30c')]=startAngle||0x0;_this[_0x22c1('0x30d')]=endAngle||0x2*Math['PI'];_this[_0x22c1('0x30e')]=clockwise||![];_this[_0x22c1('0x30f')]=rotation||0x0;_this['isEllipseCurve']=!![];return _this;}_createClass(EllipseCurve,[{'key':'getPoint','value':function getPoint(t){var twoPi=Math['PI']*0x2;var aX=this['aX'],aY=this['aY'],rotation=this[_0x22c1('0x30f')],xRadius=this[_0x22c1('0x30a')],yRadius=this[_0x22c1('0x30b')],startAngle=this[_0x22c1('0x30c')],endAngle=this[_0x22c1('0x30d')];var angle=startAngle+t*(endAngle-startAngle);angle%=twoPi;if(angle<0x0){angle+=twoPi;}var x=aX+xRadius*Math[_0x22c1('0x7b')](angle);var y=aY+yRadius*Math[_0x22c1('0x7c')](angle);if(rotation){var cos=Math[_0x22c1('0x7b')](this[_0x22c1('0x30f')]);var sin=Math[_0x22c1('0x7c')](this['rotation']);var tx=x-aX;var ty=y-aY;x=tx*cos-ty*sin+aX;y=tx*sin+ty*cos+aY;}return new Vector2(x,y);}},{'key':_0x22c1('0x82'),'value':function copy(source){_get(_getPrototypeOf(EllipseCurve['prototype']),'copy',this)['call'](this,source);this['aX']=source['aX'];this['aY']=source['aY'];this['xRadius']=source[_0x22c1('0x30a')];this['yRadius']=source[_0x22c1('0x30b')];this[_0x22c1('0x30c')]=source[_0x22c1('0x310')];this[_0x22c1('0x30d')]=source[_0x22c1('0x311')];this[_0x22c1('0x30e')]=source[_0x22c1('0x312')];this[_0x22c1('0x30f')]=source['aRotation'];return this;}}]);return EllipseCurve;}(Curve);function CatmullRom(t,p0,p1,p2,p3){var v0=(p2-p0)*0.5;var v1=(p3-p1)*0.5;var t2=t*t;var t3=t*t2;return(0x2*p1-0x2*p2+v0+v1)*t3+(-0x3*p1+0x3*p2-0x2*v0-v1)*t2+v0*t+p1;}function QuadraticBezierP0(t,p){var k=0x1-t;return k*k*p;}function QuadraticBezierP1(t,p){return 0x2*(0x1-t)*t*p;}function QuadraticBezierP2(t,p){return t*t*p;}function QuadraticBezier(t,p0,p1,p2){return QuadraticBezierP0(t,p0)+QuadraticBezierP1(t,p1)+QuadraticBezierP2(t,p2);}function CubicBezierP0(t,p){var k=0x1-t;return k*k*k*p;}function CubicBezierP1(t,p){var k=0x1-t;return 0x3*k*k*t*p;}function CubicBezierP2(t,p){return 0x3*(0x1-t)*t*t*p;}function CubicBezierP3(t,p){return t*t*t*p;}function CubicBezier(t,p0,p1,p2,p3){return CubicBezierP0(t,p0)+CubicBezierP1(t,p1)+CubicBezierP2(t,p2)+CubicBezierP3(t,p3);}function _createSuper$3(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$3();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$3(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy==='function')return!![];try{Boolean[_0x22c1('0x1')]['valueOf']['call'](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x378033){return![];}}var SplineCurve=function(_Curve){_inherits(SplineCurve,_Curve);var _super=_createSuper$3(SplineCurve);function SplineCurve(points){var _this;_classCallCheck(this,SplineCurve);_this=_super[_0x22c1('0x2')](this);_this[_0x22c1('0x1f')]=_0x22c1('0x313');_this[_0x22c1('0x240')]=points||[];_this[_0x22c1('0x305')]=!![];return _this;}_createClass(SplineCurve,[{'key':_0x22c1('0x24a'),'value':function getPoint(t){var point=new Vector2();var points=this[_0x22c1('0x240')];var p=(points[_0x22c1('0x32')]-0x1)*t;var intPoint=Math[_0x22c1('0x55')](p);var weight=p-intPoint;var p0=points[intPoint===0x0?intPoint:intPoint-0x1];var p1=points[intPoint];var p2=points[intPoint>points[_0x22c1('0x32')]-0x2?points[_0x22c1('0x32')]-0x1:intPoint+0x1];var p3=points[intPoint>points[_0x22c1('0x32')]-0x3?points[_0x22c1('0x32')]-0x1:intPoint+0x2];point[_0x22c1('0x5e')](CatmullRom(weight,p0['x'],p1['x'],p2['x'],p3['x']),CatmullRom(weight,p0['y'],p1['y'],p2['y'],p3['y']));return point;}},{'key':_0x22c1('0x82'),'value':function copy(source){_get(_getPrototypeOf(SplineCurve['prototype']),_0x22c1('0x82'),this)[_0x22c1('0x2')](this,source);this[_0x22c1('0x240')]=[];for(var i=0x0,l=source[_0x22c1('0x240')][_0x22c1('0x32')];i<l;i++){var point=source[_0x22c1('0x240')][i];this[_0x22c1('0x240')]['push'](point['clone']());}return this;}}]);return SplineCurve;}(Curve);function _createSuper$4(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$4();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$4(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy==='function')return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x147081){return![];}}var CubicBezierCurve=function(_Curve){_inherits(CubicBezierCurve,_Curve);var _super=_createSuper$4(CubicBezierCurve);function CubicBezierCurve(v0,v1,v2,v3){var _this;_classCallCheck(this,CubicBezierCurve);_this=_super[_0x22c1('0x2')](this);_this[_0x22c1('0x1f')]=_0x22c1('0x314');_this['v0']=v0||new Vector2();_this['v1']=v1||new Vector2();_this['v2']=v2||new Vector2();_this['v3']=v3||new Vector2();_this[_0x22c1('0x315')]=!![];return _this;}_createClass(CubicBezierCurve,[{'key':'getPole','value':function getPole(min,max){var v0=this['v0'],v1=this['v1'],v2=this['v2'],v3=this['v3'];min['x']=Math[_0x22c1('0x54')](min['x'],v0['x'],v1['x'],v2['x'],v3['x']);min['y']=Math['min'](min['y'],v0['y'],v1['y'],v2['y'],v3['y']);max['x']=Math[_0x22c1('0x53')](max['x'],v0['x'],v1['x'],v2['x'],v3['x']);max['y']=Math['max'](max['y'],v0['y'],v1['y'],v2['y'],v3['y']);}},{'key':_0x22c1('0x24a'),'value':function getPoint(t,optionalTarget){var point=optionalTarget||new Vector2();var v0=this['v0'],v1=this['v1'],v2=this['v2'],v3=this['v3'];point['set'](CubicBezier(t,v0['x'],v1['x'],v2['x'],v3['x']),CubicBezier(t,v0['y'],v1['y'],v2['y'],v3['y']));return point;}},{'key':_0x22c1('0x316'),'value':function pointApplyFunc(func){func(this['v0']);func(this['v1']);func(this['v2']);func(this['v3']);}},{'key':'copy','value':function copy(source){_get(_getPrototypeOf(CubicBezierCurve['prototype']),_0x22c1('0x82'),this)[_0x22c1('0x2')](this,source);this['v0'][_0x22c1('0x82')](source['v0']);this['v1'][_0x22c1('0x82')](source['v1']);this['v2'][_0x22c1('0x82')](source['v2']);this['v3']['copy'](source['v3']);return this;}},{'key':'split','value':function split(_ref){var x=_ref['x'],y=_ref['y'];var v0=this['v0'],v1=this['v1'],v2=this['v2'],v3=this['v3'];var min=new Vector2(Infinity,Infinity);var max=new Vector2(-Infinity,-Infinity);this[_0x22c1('0x2ff')](min,max);var splitByX=x!==undefined&&(min['x']-x)*(max['x']-x)<0x0;var splitByY=y!==undefined&&(min['y']-y)*(max['y']-y)<0x0;if(splitByX||splitByY){x=0.5*v0['x']+0.5*v1['x'];y=0.5*v0['y']+0.5*v1['y'];var point1=new Vector2(x,y);x=0.25*v0['x']+0.5*v1['x']+0.25*v2['x'];y=0.25*v0['y']+0.5*v1['y']+0.25*v2['y'];var point2=new Vector2(x,y);x=0.125*v0['x']+0.375*v1['x']+0.375*v2['x']+0.125*v3['x'];y=0.125*v0['y']+0.375*v1['y']+0.375*v2['y']+0.125*v3['y'];var point3=new Vector2(x,y);x=0.25*v1['x']+0.5*v2['x']+0.25*v3['x'];y=0.25*v1['y']+0.5*v2['y']+0.25*v3['y'];var point4=new Vector2(x,y);x=0.5*v2['x']+0.5*v3['x'];y=0.5*v2['y']+0.5*v3['y'];var point5=new Vector2(x,y);var curve1=new CubicBezierCurve(v0,point1,point2,point3);var curve2=new CubicBezierCurve(point3[_0x22c1('0x8d')](),point4,point5,v3);return[curve1,curve2];}return[this];}}]);return CubicBezierCurve;}(Curve);function _createSuper$5(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$5();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$5(){if(typeof Reflect===_0x22c1('0x0')||!Reflect['construct'])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x201155){return![];}}var QuadraticBezierCurve=function(_Curve){_inherits(QuadraticBezierCurve,_Curve);var _super=_createSuper$5(QuadraticBezierCurve);function QuadraticBezierCurve(v0,v1,v2){var _this;_classCallCheck(this,QuadraticBezierCurve);_this=_super['call'](this);_this['type']=_0x22c1('0x317');_this['v0']=v0||new Vector2();_this['v1']=v1||new Vector2();_this['v2']=v2||new Vector2();_this['isQuadraticBezierCurve']=!![];return _this;}_createClass(QuadraticBezierCurve,[{'key':_0x22c1('0x2ff'),'value':function getPole(min,max){var v0=this['v0'],v1=this['v1'],v2=this['v2'];var x1=0.5*(v0['x']+v1['x']);var y1=0.5*(v0['y']+v1['y']);var x2=0.5*(v0['x']+v2['x']);var y2=0.5*(v0['y']+v2['y']);min['x']=Math[_0x22c1('0x54')](min['x'],v0['x'],v2['x'],x1,x2);min['y']=Math[_0x22c1('0x54')](min['y'],v0['y'],v2['y'],y1,y2);max['x']=Math[_0x22c1('0x53')](max['x'],v0['x'],v2['x'],x1,x2);max['y']=Math['max'](max['y'],v0['y'],v2['y'],y1,y2);}},{'key':_0x22c1('0x316'),'value':function pointApplyFunc(func){func(this['v0']);func(this['v1']);func(this['v2']);}},{'key':_0x22c1('0x170'),'value':function split(_ref){var x=_ref['x'],y=_ref['y'];var v0=this['v0'],v1=this['v1'],v2=this['v2'];var splitByX=x!==undefined&&Math[_0x22c1('0x69')](Math[_0x22c1('0x2d7')](v0['x']-x)+Math[_0x22c1('0x2d7')](v1['x']-x)+Math[_0x22c1('0x2d7')](v2['x']-x))===0x1;var splitByY=y!==undefined&&Math['abs'](Math[_0x22c1('0x2d7')](v0['y']-x)+Math['sign'](v1['y']-x)+Math[_0x22c1('0x2d7')](v2['y']-x))===0x1;var a,b,c,d;if(splitByX){a=v0['x']-0x2*v1['x']+v2['x'];b=0x2*(-v0['x']+v1['x']);c=v0['x']-x;}if(splitByY){a=v0['y']-0x2*v1['y']+v2['y'];b=0x2*(-v0['y']+v1['y']);c=v0['y']-y;}if(splitByX||splitByY){d=b*b-0x4*a*c;if(d>0x0){var e=Math['sqrt'](d);var t1=(-b+e)/0x2/a;var t2=(-b-e)/0x2/a;var t=[t1,t2][_0x22c1('0x318')](function(x){return x>0x0&&x<0x1;});if(t){var point1=new Vector2()[_0x22c1('0x109')](v0,v1,t);var point3=new Vector2()[_0x22c1('0x109')](v1,v2,t);var point2=new Vector2()[_0x22c1('0x109')](point1,point3,t);var curve1=new QuadraticBezierCurve(v0,point1,point2);var curve2=new QuadraticBezierCurve(point2[_0x22c1('0x8d')](),point3,v2);return[curve1,curve2];}}}return[this];}},{'key':_0x22c1('0x24a'),'value':function getPoint(t){var point=new Vector2();var v0=this['v0'],v1=this['v1'],v2=this['v2'];point['set'](QuadraticBezier(t,v0['x'],v1['x'],v2['x']),QuadraticBezier(t,v0['y'],v1['y'],v2['y']));return point;}},{'key':_0x22c1('0x82'),'value':function copy(source){_get(_getPrototypeOf(QuadraticBezierCurve[_0x22c1('0x1')]),_0x22c1('0x82'),this)['call'](this,source);this['v0'][_0x22c1('0x82')](source['v0']);this['v1'][_0x22c1('0x82')](source['v1']);this['v2'][_0x22c1('0x82')](source['v2']);return this;}}]);return QuadraticBezierCurve;}(Curve);function _createSuper$6(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$6();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$6(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy==='function')return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')]['call'](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x5ee9dc){return![];}}var Path=function(_CurvePath){_inherits(Path,_CurvePath);var _super=_createSuper$6(Path);function Path(points){var _this;_classCallCheck(this,Path);_this=_super[_0x22c1('0x2')](this,points);_this['type']='Path';_this[_0x22c1('0x319')]=new Vector2();if(points){_this[_0x22c1('0xde')](points);}return _this;}_createClass(Path,[{'key':'setFromPoints','value':function setFromPoints(points){this[_0x22c1('0x31a')](points[0x0]['x'],points[0x0]['y']);for(var i=0x1,l=points[_0x22c1('0x32')];i<l;i++){this['lineTo'](points[i]['x'],points[i]['y']);}}},{'key':'moveTo','value':function moveTo(x,y){this[_0x22c1('0x319')][_0x22c1('0x5e')](x,y);}},{'key':_0x22c1('0x31b'),'value':function lineTo(x,y){var curve=new LineCurve(this[_0x22c1('0x319')][_0x22c1('0x8d')](),new Vector2(x,y));this[_0x22c1('0x300')][_0x22c1('0x2e')](curve);this[_0x22c1('0x319')][_0x22c1('0x5e')](x,y);}},{'key':_0x22c1('0x31c'),'value':function quadraticCurveTo(aCPx,aCPy,aX,aY){var curve=new QuadraticBezierCurve(this['currentPoint'][_0x22c1('0x8d')](),new Vector2(aCPx,aCPy),new Vector2(aX,aY));this[_0x22c1('0x300')]['push'](curve);this[_0x22c1('0x319')][_0x22c1('0x5e')](aX,aY);}},{'key':_0x22c1('0x31d'),'value':function bezierCurveTo(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){var curve=new CubicBezierCurve(this['currentPoint']['clone'](),new Vector2(aCP1x,aCP1y),new Vector2(aCP2x,aCP2y),new Vector2(aX,aY));this[_0x22c1('0x300')]['push'](curve);this[_0x22c1('0x319')][_0x22c1('0x5e')](aX,aY);}},{'key':'splineThru','value':function splineThru(pts){var npts=[this[_0x22c1('0x319')][_0x22c1('0x8d')]()][_0x22c1('0x171')](pts);var curve=new SplineCurve(npts);this['curves'][_0x22c1('0x2e')](curve);this['currentPoint']['copy'](pts[pts[_0x22c1('0x32')]-0x1]);}},{'key':_0x22c1('0x31e'),'value':function arc(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){var x0=this[_0x22c1('0x319')]['x'];var y0=this[_0x22c1('0x319')]['y'];this['absarc'](aX+x0,aY+y0,aRadius,aStartAngle,aEndAngle,aClockwise);}},{'key':_0x22c1('0x31f'),'value':function absarc(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){this['absellipse'](aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise);}},{'key':_0x22c1('0x320'),'value':function ellipse(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){var x0=this[_0x22c1('0x319')]['x'];var y0=this[_0x22c1('0x319')]['y'];this[_0x22c1('0x321')](aX+x0,aY+y0,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation);}},{'key':'absellipse','value':function absellipse(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){var curve=new EllipseCurve(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation);if(this[_0x22c1('0x300')][_0x22c1('0x32')]>0x0){var firstPoint=curve[_0x22c1('0x24a')](0x0);if(!firstPoint[_0x22c1('0x85')](this[_0x22c1('0x319')])){this[_0x22c1('0x31b')](firstPoint['x'],firstPoint['y']);}}this[_0x22c1('0x300')]['push'](curve);var lastPoint=curve[_0x22c1('0x24a')](0x1);this[_0x22c1('0x319')][_0x22c1('0x82')](lastPoint);}},{'key':_0x22c1('0x82'),'value':function copy(source){_get(_getPrototypeOf(Path['prototype']),'copy',this)[_0x22c1('0x2')](this,source);this[_0x22c1('0x319')][_0x22c1('0x82')](source[_0x22c1('0x319')]);return this;}}]);return Path;}(CurvePath);function _createSuper$7(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$7();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$7(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean['prototype'][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x304059){return![];}}var Shape=function(_Path){_inherits(Shape,_Path);var _super=_createSuper$7(Shape);function Shape(points){var _this;_classCallCheck(this,Shape);_this=_super['call'](this,points);_this[_0x22c1('0x114')]=_Math['generateUUID']();_this[_0x22c1('0x1f')]=_0x22c1('0x322');_this[_0x22c1('0x2d1')]=[];return _this;}_createClass(Shape,[{'key':_0x22c1('0x323'),'value':function getPointsHoles(divisions){var holesPts=[];for(var i=0x0,l=this[_0x22c1('0x2d1')][_0x22c1('0x32')];i<l;i++){holesPts[i]=this[_0x22c1('0x2d1')][i][_0x22c1('0x2ee')](divisions);}return holesPts;}},{'key':_0x22c1('0x324'),'value':function getPointsHolesByStepSize(stepSize){var holesPts=[];for(var i=0x0,l=this[_0x22c1('0x2d1')][_0x22c1('0x32')];i<l;i++){holesPts[i]=this[_0x22c1('0x2d1')][i][_0x22c1('0x306')](stepSize);}return holesPts;}},{'key':_0x22c1('0x325'),'value':function getPointsHolesAdaptively(tolerance){var holesPts=[];for(var i=0x0,l=this[_0x22c1('0x2d1')][_0x22c1('0x32')];i<l;i++){holesPts[i]=this['holes'][i]['getPointsAdaptively'](tolerance);}return holesPts;}},{'key':'extractPoints','value':function extractPoints(divisions){return{'shape':this[_0x22c1('0x2ee')](divisions),'holes':this[_0x22c1('0x323')](divisions)};}},{'key':_0x22c1('0x326'),'value':function extractPointsByStepSize(stepSize){return{'shape':this[_0x22c1('0x306')](stepSize),'holes':this[_0x22c1('0x324')](stepSize)};}},{'key':_0x22c1('0x327'),'value':function extractPointsAdaptively(tolerance){return{'shape':this[_0x22c1('0x308')](tolerance),'holes':this[_0x22c1('0x325')](tolerance)};}},{'key':_0x22c1('0x82'),'value':function copy(source){_get(_getPrototypeOf(Shape['prototype']),_0x22c1('0x82'),this)[_0x22c1('0x2')](this,source);this[_0x22c1('0x2d1')]=[];for(var i=0x0,l=source['holes'][_0x22c1('0x32')];i<l;i++){var hole=source[_0x22c1('0x2d1')][i];this[_0x22c1('0x2d1')][_0x22c1('0x2e')](hole[_0x22c1('0x8d')]());}return this;}}]);return Shape;}(Path);var ShapePath=function(){function ShapePath(){_classCallCheck(this,ShapePath);this[_0x22c1('0x1f')]=_0x22c1('0x328');this['subPaths']=[];this[_0x22c1('0x329')]=null;}_createClass(ShapePath,[{'key':'moveTo','value':function moveTo(x,y){this[_0x22c1('0x329')]=new Path();this['subPaths'][_0x22c1('0x2e')](this['currentPath']);this[_0x22c1('0x329')][_0x22c1('0x31a')](x,y);}},{'key':'lineTo','value':function lineTo(x,y){this[_0x22c1('0x329')][_0x22c1('0x31b')](x,y);}},{'key':_0x22c1('0x31c'),'value':function quadraticCurveTo(aCPx,aCPy,aX,aY){this[_0x22c1('0x329')][_0x22c1('0x31c')](aCPx,aCPy,aX,aY);}},{'key':_0x22c1('0x31d'),'value':function bezierCurveTo(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){this['currentPath'][_0x22c1('0x31d')](aCP1x,aCP1y,aCP2x,aCP2y,aX,aY);}},{'key':_0x22c1('0x32a'),'value':function splineThru(pts){this[_0x22c1('0x329')][_0x22c1('0x32a')](pts);}},{'key':_0x22c1('0x32b'),'value':function toShapes(isCCW,noHoles){function toShapesNoHoles(inSubpaths){var shapes=[];for(var i=0x0,l=inSubpaths['length'];i<l;i++){var _tmpPath=inSubpaths[i];var _tmpShape=new Shape();_tmpShape['curves']=_tmpPath['curves'];shapes[_0x22c1('0x2e')](_tmpShape);}return shapes;}function isPointInsidePolygon(inPt,inPolygon){var polyLen=inPolygon[_0x22c1('0x32')];var inside=![];for(var i=polyLen-0x1,q=0x0;q<polyLen;i=q++){var edgeLowPt=inPolygon[i];var edgeHighPt=inPolygon[q];var edgeDx=edgeHighPt['x']-edgeLowPt['x'];var edgeDy=edgeHighPt['y']-edgeLowPt['y'];if(Math[_0x22c1('0x69')](edgeDy)>Number[_0x22c1('0x89')]){if(edgeDy<0x0){edgeLowPt=inPolygon[q];edgeDx=-edgeDx;edgeHighPt=inPolygon[i];edgeDy=-edgeDy;}if(inPt['y']<edgeLowPt['y']||inPt['y']>edgeHighPt['y'])continue;if(inPt['y']===edgeLowPt['y']){if(inPt['x']===edgeLowPt['x'])return!![];}else{var perpEdge=edgeDy*(inPt['x']-edgeLowPt['x'])-edgeDx*(inPt['y']-edgeLowPt['y']);if(perpEdge===0x0)return!![];if(perpEdge<0x0)continue;inside=!inside;}}else{if(inPt['y']!==edgeLowPt['y'])continue;if(edgeHighPt['x']<=inPt['x']&&inPt['x']<=edgeLowPt['x']||edgeLowPt['x']<=inPt['x']&&inPt['x']<=edgeHighPt['x'])return!![];}}return inside;}var isClockWise=ShapeUtils['isClockWise'];var subPaths=this[_0x22c1('0x32c')];if(subPaths[_0x22c1('0x32')]===0x0)return[];if(noHoles===!![])return toShapesNoHoles(subPaths);var solid,tmpPath,tmpShape;var shapes=[];if(subPaths[_0x22c1('0x32')]===0x1){tmpPath=subPaths[0x0];tmpShape=new Shape();tmpShape[_0x22c1('0x300')]=tmpPath[_0x22c1('0x300')];shapes[_0x22c1('0x2e')](tmpShape);return shapes;}var holesFirst=!isClockWise(subPaths[0x0]['getPoints']());holesFirst=isCCW?!holesFirst:holesFirst;var betterShapeHoles=[];var newShapes=[];var newShapeHoles=[];var mainIdx=0x0;var tmpPoints;newShapes[mainIdx]=undefined;newShapeHoles[mainIdx]=[];for(var i=0x0,l=subPaths[_0x22c1('0x32')];i<l;i++){tmpPath=subPaths[i];tmpPoints=tmpPath[_0x22c1('0x2ee')]();solid=isClockWise(tmpPoints);solid=isCCW?!solid:solid;if(solid){if(!holesFirst&&newShapes[mainIdx])mainIdx++;newShapes[mainIdx]={'s':new Shape(),'p':tmpPoints};newShapes[mainIdx]['s'][_0x22c1('0x300')]=tmpPath[_0x22c1('0x300')];if(holesFirst)mainIdx++;newShapeHoles[mainIdx]=[];}else{newShapeHoles[mainIdx][_0x22c1('0x2e')]({'h':tmpPath,'p':tmpPoints[0x0]});}}if(!newShapes[0x0])return toShapesNoHoles(subPaths);if(newShapes['length']>0x1){var ambiguous=![];var toChange=[];for(var sIdx=0x0,sLen=newShapes[_0x22c1('0x32')];sIdx<sLen;sIdx++){betterShapeHoles[sIdx]=[];}for(var _sIdx=0x0,_sLen=newShapes[_0x22c1('0x32')];_sIdx<_sLen;_sIdx++){var sho=newShapeHoles[_sIdx];for(var hIdx=0x0;hIdx<sho[_0x22c1('0x32')];hIdx++){var ho=sho[hIdx];var holeUnassigned=!![];for(var s2Idx=0x0;s2Idx<newShapes[_0x22c1('0x32')];s2Idx++){if(!isPointInsidePolygon(ho['p'],newShapes[s2Idx]['p'])){continue;}if(_sIdx!==s2Idx)toChange['push']({'froms':_sIdx,'tos':s2Idx,'hole':hIdx});if(holeUnassigned){holeUnassigned=![];betterShapeHoles[s2Idx][_0x22c1('0x2e')](ho);}else{ambiguous=!![];}}if(!holeUnassigned){continue;}betterShapeHoles[_sIdx][_0x22c1('0x2e')](ho);}}if(toChange['length']>0x0){if(!ambiguous)newShapeHoles=betterShapeHoles;}}var tmpHoles;for(var _i=0x0,il=newShapes['length'];_i<il;_i++){tmpShape=newShapes[_i]['s'];if(getShapeSize(tmpShape)>0x1){shapes[_0x22c1('0x2e')](tmpShape);}tmpHoles=newShapeHoles[_i];for(var j=0x0,jl=tmpHoles[_0x22c1('0x32')];j<jl;j++){tmpShape[_0x22c1('0x2d1')][_0x22c1('0x2e')](tmpHoles[j]['h']);}}return shapes;}}]);return ShapePath;}();function getShapeSize(shape){var min={'x':Infinity,'y':Infinity};var max={'x':-Infinity,'y':-Infinity};shape['curves'][_0x22c1('0x22')](function(curve){curve[_0x22c1('0x2ff')](min,max);});return Math[_0x22c1('0x106')](min['x']-max['x'],min['y']-max['y']);}var Font=function(){function Font(data){_classCallCheck(this,Font);this[_0x22c1('0x1f')]='Font';this[_0x22c1('0x1f5')]=data;this['isFont']=!![];}_createClass(Font,null,[{'key':'generateShapes','value':function generateShapes(glyphs){var size=arguments['length']>0x1&&arguments[0x1]!==undefined?arguments[0x1]:0x64;var data=arguments[_0x22c1('0x32')]>0x2?arguments[0x2]:undefined;var offsetScale=arguments[_0x22c1('0x32')]>0x3?arguments[0x3]:undefined;var shapes=[];var pathData=createPaths(glyphs,size,data,offsetScale);var paths=pathData[_0x22c1('0x32d')];var charFlag=[];var count=0x0;for(var i=0x0;i<paths[_0x22c1('0x32')];i++){var tempShapes=paths[i][_0x22c1('0x32b')]();shapes['push'][_0x22c1('0x7')](shapes,_toConsumableArray(tempShapes));charFlag['push'](count);count+=tempShapes['length'];}var resultData={'shapes':shapes};resultData[_0x22c1('0x32e')]=Object[_0x22c1('0x48')]({},pathData[_0x22c1('0x32e')],{'charFlag':charFlag});return resultData;}}]);return Font;}();function createPaths(glyphs){var size=arguments[_0x22c1('0x32')]>0x1&&arguments[0x1]!==undefined?arguments[0x1]:0x64;var data=arguments['length']>0x2?arguments[0x2]:undefined;var offsetScale=arguments['length']>0x3?arguments[0x3]:undefined;var letterSpacing=data[_0x22c1('0x32f')],lineHeight=data[_0x22c1('0x330')],lineHeightData=data['lineHeightData'],textAlign=data['textAlign'];var _lineHeightData$emSiz=lineHeightData['emSize'],emSize=_lineHeightData$emSiz===void 0x0?0x400:_lineHeightData$emSiz;var scale=size/emSize;var realLineHeight=size*lineHeight;var shapePaths=[];var charPosDatas=[];var linesWidth=[0x0];var j=0x0;var offsetX=0x0;var offsetY=0x0;var k=-0x1;for(var i=0x0;i<glyphs['length'];i++){var glyph=glyphs[i];if(glyph[_0x22c1('0x116')]==='\x0a'){linesWidth[++j]=0x0;k=-0x1;}else{offsetX=glyph['ha']*scale*offsetScale+letterSpacing;linesWidth[j]+=offsetX;if(glyph[_0x22c1('0x116')]&&glyph[_0x22c1('0x116')]!=='\x20'){charPosDatas[_0x22c1('0x2e')]({'rowNum':j,'columnNum':++k});}}}var maxLineWidth=Math[_0x22c1('0x53')][_0x22c1('0x7')](Math,linesWidth);offsetX=0x0;j=0x0;for(var _i=0x0;_i<glyphs[_0x22c1('0x32')];_i++){var _glyph=glyphs[_i];if(_glyph[_0x22c1('0x116')]==='\x0a'){offsetY-=realLineHeight;switch(textAlign){case _0x22c1('0xf9'):offsetX-=(linesWidth[j]+linesWidth[++j])/0x2;break;case _0x22c1('0x28a'):offsetX-=linesWidth[++j];break;default:offsetX=0x0;}}else if(_glyph[_0x22c1('0x116')]==='\x20'||!_glyph[_0x22c1('0x116')]){offsetX+=_glyph['ha']*scale+letterSpacing;}else{var ret=createPath(_glyph,scale,offsetX,offsetY,offsetScale);offsetX+=ret[_0x22c1('0x331')]+letterSpacing;shapePaths[_0x22c1('0x2e')](ret[_0x22c1('0x332')]);}}var resultData={'paths':shapePaths};resultData[_0x22c1('0x32e')]={'baseLineHeight':size,'charPosDatas':charPosDatas,'realLineHeight':realLineHeight,'maxLineWidth':maxLineWidth};return resultData;}function createPath(glyph,scale,offsetX,offsetY,offsetScale){if(!glyph)return;var shapePath=new ShapePath();var x,y,cpx,cpy,cpx1,cpy1,cpx2,cpy2;if(glyph['o']){var outline=glyph[_0x22c1('0x333')]||(glyph[_0x22c1('0x333')]=glyph['o'][_0x22c1('0x170')]('\x20'));var startX=0x0;var startY=0x0;for(var i=0x0,l=outline[_0x22c1('0x32')];i<l;){var action=outline[i++];switch(action){case'm':x=outline[i++]*scale+offsetX;y=outline[i++]*scale+offsetY;shapePath['moveTo'](x,y);startX=x;startY=y;break;case'l':x=outline[i++]*scale+offsetX;y=outline[i++]*scale+offsetY;shapePath['lineTo'](x,y);break;case'q':cpx=outline[i++]*scale+offsetX;cpy=outline[i++]*scale+offsetY;cpx1=outline[i++]*scale+offsetX;cpy1=outline[i++]*scale+offsetY;shapePath[_0x22c1('0x31c')](cpx1,cpy1,cpx,cpy);break;case'b':cpx=outline[i++]*scale+offsetX;cpy=outline[i++]*scale+offsetY;cpx1=outline[i++]*scale+offsetX;cpy1=outline[i++]*scale+offsetY;cpx2=outline[i++]*scale+offsetX;cpy2=outline[i++]*scale+offsetY;shapePath[_0x22c1('0x31d')](cpx1,cpy1,cpx2,cpy2,cpx,cpy);break;case'z':x=startX;y=startY;shapePath[_0x22c1('0x31b')](x,y);break;}}}return{'offsetX':glyph['ha']*scale*offsetScale,'offsetY':glyph['ha']*scale*offsetScale,'path':shapePath};}var extrudeBufferGeometryWorker=null;function TextBufferGeometry(text){var parameters=arguments[_0x22c1('0x32')]>0x1&&arguments[0x1]!==undefined?arguments[0x1]:{'lineHeight':0x1,'letterSpacing':0x1};var font=parameters[_0x22c1('0x334')];if(!font||!font[_0x22c1('0x335')]){console[_0x22c1('0xb0')](_0x22c1('0x336'));return new Geometry();}var chars=Array[_0x22c1('0x145')]?Array[_0x22c1('0x145')](text):String(text)[_0x22c1('0x170')]('');var glyphs=chars[_0x22c1('0x172')](function(_char){return Object[_0x22c1('0x48')]({'name':_char},font['data'][_0x22c1('0x337')][_char]||font[_0x22c1('0x1f5')]['glyphs']['?']);});var data={'lineHeightData':font[_0x22c1('0x1f5')][_0x22c1('0x338')],'resolution':font['data'][_0x22c1('0x307')],'boundingBox':font[_0x22c1('0x1f5')][_0x22c1('0x1e4')],'lineHeight':parameters['lineHeight'],'letterSpacing':parameters['letterSpacing'],'textAlign':parameters[_0x22c1('0x339')]};parameters[_0x22c1('0x2c1')]=parameters[_0x22c1('0x1cc')]||0x32;parameters[_0x22c1('0x2c5')]=parameters[_0x22c1('0x2c5')]||0xa;parameters[_0x22c1('0x2c6')]=parameters[_0x22c1('0x2c6')]||0x1;parameters[_0x22c1('0x2c4')]=parameters[_0x22c1('0x2c4')]||![];parameters[_0x22c1('0x2bd')]=parameters[_0x22c1('0x2bd')]||0x0;parameters[_0x22c1('0x2c6')]=-Math[_0x22c1('0x69')](parameters[_0x22c1('0x2c6')]);this[_0x22c1('0x1f')]=_0x22c1('0x33a');this['parameters']={'glyphs':glyphs,'data':data,'options':parameters};}TextBufferGeometry[_0x22c1('0x1')]=Object['create'](ExtrudeBufferGeometry[_0x22c1('0x1')]);Object[_0x22c1('0x48')](TextBufferGeometry[_0x22c1('0x1')],{'constructor':TextBufferGeometry,'init':function init(){var _this=this;return _asyncToGenerator(regenerator[_0x22c1('0x33b')](function _callee(){var promise;return regenerator[_0x22c1('0x20')](function _callee$(_context){while(0x1){switch(_context[_0x22c1('0x3d')]=_context[_0x22c1('0x29')]){case 0x0:promise=new Promise(function(resolve,reject){if(_this[_0x22c1('0x13d')]['options'][_0x22c1('0x33c')]){if(!extrudeBufferGeometryWorker){extrudeBufferGeometryWorker=new WorkerFactory();}extrudeBufferGeometryWorker['onmessage']=function(e){Object[_0x22c1('0x3b')](e['data'][_0x22c1('0xed')])[_0x22c1('0x22')](function(key){Object['setPrototypeOf'](e[_0x22c1('0x1f5')]['attributes'][key],BufferAttribute['prototype']);});Object[_0x22c1('0x48')](_this,e['data']);Object[_0x22c1('0x36')](e[_0x22c1('0x1f5')]['boundingBox'],Box3[_0x22c1('0x1')]);Object['setPrototypeOf'](e[_0x22c1('0x1f5')][_0x22c1('0x1e4')][_0x22c1('0x54')],Vector3[_0x22c1('0x1')]);Object[_0x22c1('0x36')](e[_0x22c1('0x1f5')][_0x22c1('0x1e4')][_0x22c1('0x53')],Vector3[_0x22c1('0x1')]);resolve(_this);};extrudeBufferGeometryWorker[_0x22c1('0x33d')]=function(err){reject(err);};extrudeBufferGeometryWorker[_0x22c1('0x33e')](_this['parameters']);}else{var _this$parameters=_this[_0x22c1('0x13d')],data=_this$parameters[_0x22c1('0x1f5')],glyphs=_this$parameters[_0x22c1('0x337')],options=_this$parameters[_0x22c1('0x2dd')];var size=options[_0x22c1('0x1ca')],offsetScale=options[_0x22c1('0x33f')];var _Font$generateShapes=Font['generateShapes'](glyphs,size,data,offsetScale),shapes=_Font$generateShapes[_0x22c1('0x13e')],para=_Font$generateShapes[_0x22c1('0x32e')];Object['assign'](options,para);ExtrudeBufferGeometry[_0x22c1('0x2')](_this,shapes,options);resolve(_this);}});return _context[_0x22c1('0x340')](_0x22c1('0x1d'),promise);case 0x2:case _0x22c1('0x42'):return _context[_0x22c1('0x341')]();}}},_callee);}))();}});function parse$1(fontFile){var font=_0x30de3a(fontFile);var emSize=font['unitsPerEm']||0x800;var scale=0x1;var result={'glyphs':{}};var glyphs=Object[_0x22c1('0x342')](font['glyphs']['glyphs']);result[_0x22c1('0x343')]=[];glyphs['forEach'](function(glyph){if(glyph[_0x22c1('0x344')]!==undefined){var glyphCharacter=String[_0x22c1('0x345')](glyph[_0x22c1('0x344')]);result[_0x22c1('0x343')][_0x22c1('0x2e')](glyphCharacter);Object[_0x22c1('0x12')](result['glyphs'],glyphCharacter,{'get':function get(){var token={};var commands=glyph[_0x22c1('0x332')][_0x22c1('0x346')];token['ha']=Math[_0x22c1('0xc0')](glyph[_0x22c1('0x347')]*scale);token[_0x22c1('0x348')]=Math[_0x22c1('0xc0')](glyph['xMin']*scale);token[_0x22c1('0x349')]=Math[_0x22c1('0xc0')](glyph[_0x22c1('0x34a')]*scale);token['o']='';var reverseTagList=checkIfNeedReverseForEveryPolys(commands);commands=reverseCommands(commands,reverseTagList);var parentOfHoles=getFirstParentOfHoles(commands);var Polycommands=getPolygonsCommand(commands);commands=rearrangeCommands(Polycommands,parentOfHoles);commands[_0x22c1('0x22')](function(command){if(command[_0x22c1('0x1f')][_0x22c1('0x1b7')]()==='c'){command['type']='b';}token['o']+=command[_0x22c1('0x1f')][_0x22c1('0x1b7')]();token['o']+='\x20';if(command['x']!==undefined&&command['y']!==undefined){token['o']+=Math[_0x22c1('0xc0')](command['x']*scale);token['o']+='\x20';token['o']+=Math['round'](command['y']*scale);token['o']+='\x20';}if(command['x1']!==undefined&&command['y1']!==undefined){token['o']+=Math['round'](command['x1']*scale);token['o']+='\x20';token['o']+=Math[_0x22c1('0xc0')](command['y1']*scale);token['o']+='\x20';}if(command['x2']!==undefined&&command['y2']!==undefined){token['o']+=Math[_0x22c1('0xc0')](command['x2']*scale);token['o']+='\x20';token['o']+=Math['round'](command['y2']*scale);token['o']+='\x20';}});return token;}});}});result[_0x22c1('0x34b')]=font['familyName'];result[_0x22c1('0x338')]={'ascender':font[_0x22c1('0x34c')],'descender':font[_0x22c1('0x34d')],'emSize':emSize};result['underlinePosition']=Math[_0x22c1('0xc0')](font[_0x22c1('0x34e')][_0x22c1('0x34f')][_0x22c1('0x350')]*scale);result[_0x22c1('0x351')]=Math[_0x22c1('0xc0')](font[_0x22c1('0x34e')][_0x22c1('0x34f')][_0x22c1('0x351')]*scale);var head=font[_0x22c1('0x34e')][_0x22c1('0x267')];result[_0x22c1('0x1e4')]={'yMin':Math['round'](head['yMin']*scale),'xMin':Math['round'](head[_0x22c1('0x352')]*scale),'yMax':Math[_0x22c1('0xc0')](head[_0x22c1('0x353')]*scale),'xMax':Math[_0x22c1('0xc0')](head[_0x22c1('0x34a')]*scale)};result['resolution']=0x3e8;result[_0x22c1('0x354')]=font[_0x22c1('0x34e')][_0x22c1('0x116')];var styleName=font[_0x22c1('0x15f')][_0x22c1('0x355')]['en'];if(styleName[_0x22c1('0x1b7')]()[_0x22c1('0x4a')](_0x22c1('0x356'))>-0x1){result[_0x22c1('0x357')]='bold';}else{result[_0x22c1('0x357')]='normal';}if(styleName[_0x22c1('0x1b7')]()[_0x22c1('0x4a')]('italic')>-0x1){result[_0x22c1('0x358')]='italic';}else{result[_0x22c1('0x358')]=_0x22c1('0x1e');}return result;}function reverseCommands(commands,reverseTagList){if(reverseTagList===undefined){debug[_0x22c1('0x59')](_0x22c1('0x359'));return commands;}var paths=[];var path;commands[_0x22c1('0x22')](function(c){if(c[_0x22c1('0x1f')][_0x22c1('0x1b7')]()==='m'){path=[c];paths[_0x22c1('0x2e')](path);}else if(c[_0x22c1('0x1f')][_0x22c1('0x1b7')]()!=='z'){path[_0x22c1('0x2e')](c);}});var reversed=[];for(var pathID=0x0;pathID<paths[_0x22c1('0x32')];pathID++){if(!reverseTagList[pathID]){var _p=paths[pathID];for(var i=0x0;i<_p[_0x22c1('0x32')];i++){reversed['push'](_p[i]);}var _result={'type':'z'};reversed['push'](_result);continue;}var p=paths[pathID];var result={'type':'m','x':p[p['length']-0x1]['x'],'y':p[p['length']-0x1]['y']};reversed[_0x22c1('0x2e')](result);for(var _i=p[_0x22c1('0x32')]-0x1;_i>0x0;_i--){var command=p[_i];result={'type':command[_0x22c1('0x1f')]};if(command['x2']!==undefined&&command['y2']!==undefined){result['x1']=command['x2'];result['y1']=command['y2'];result['x2']=command['x1'];result['y2']=command['y1'];}else if(command['x1']!==undefined&&command['y1']!==undefined){result['x1']=command['x1'];result['y1']=command['y1'];}result['x']=p[_i-0x1]['x'];result['y']=p[_i-0x1]['y'];reversed['push'](result);}result={'type':'z'};reversed[_0x22c1('0x2e')](result);}return reversed;}function getArea(points){var n=points[_0x22c1('0x32')];var a=0x0;for(var p=n-0x1,q=0x0;q<n;p=q++){a+=points[p]['x']*points[q]['y']-points[q]['x']*points[p]['y'];}return a*0.5;}function getAbsArea(points){var n=points[_0x22c1('0x32')];var a=0x0;for(var p=n-0x1,q=0x0;q<n;p=q++){a+=points[p]['x']*points[q]['y']-points[q]['x']*points[p]['y'];}return Math[_0x22c1('0x69')](a*0.5);}function isClockwise(points){return getArea(points)<0x0;}function getPolygons(commands){var paths=[];var path;commands[_0x22c1('0x22')](function(c){if(c['type']['toLowerCase']()==='m'){path=[c];paths['push'](path);}else if(c[_0x22c1('0x1f')]['toLowerCase']()!=='z'){path[_0x22c1('0x2e')](c);}});var polys=[];paths[_0x22c1('0x22')](function(p){var poly=[];for(var i=0x0;i<p[_0x22c1('0x32')];i++){var command=p[i];if(command['x2']!==undefined&&command['y2']!==undefined){var point1={'x':0x0,'y':0x0};point1['x']=command['x1'];point1['y']=command['y1'];poly[_0x22c1('0x2e')](point1);var point2={'x':0x0,'y':0x0};point2['x']=command['x2'];point2['y']=command['y2'];poly[_0x22c1('0x2e')](point2);}else if(command['x1']!==undefined&&command['y1']!==undefined){var _point={'x':0x0,'y':0x0};_point['x']=command['x1'];_point['y']=command['y1'];poly['push'](_point);}var point={'x':0x0,'y':0x0};point['x']=command['x'];point['y']=command['y'];poly[_0x22c1('0x2e')](point);}if(!(poly[0x0]['x']===poly[poly[_0x22c1('0x32')]-0x1]['x']&&poly[0x0]['y']===poly[poly[_0x22c1('0x32')]-0x1]['y'])){var _point2={'x':poly[0x0]['x'],'y':poly[0x0]['y']};poly[_0x22c1('0x2e')](_point2);}polys[_0x22c1('0x2e')](poly);});return polys;}function getPolygonsCommand(commands){var paths=[];var path;commands[_0x22c1('0x22')](function(c){if(c[_0x22c1('0x1f')][_0x22c1('0x1b7')]()==='m'){path=[c];paths['push'](path);}else if(c['type'][_0x22c1('0x1b7')]()!=='z'){path[_0x22c1('0x2e')](c);}});return paths;}function pointInsidePolygon(point,polygon){var i;var j;var c=0x0;for(i=0x0,j=polygon[_0x22c1('0x32')]-0x1;i<polygon['length'];j=i++){if(polygon[i]['y']>point['y']!==polygon[j]['y']>point['y']&&point['x']<(polygon[j]['x']-polygon[i]['x'])*(point['y']-polygon[i]['y'])/(polygon[j]['y']-polygon[i]['y'])+polygon[i]['x']){c=!c;}}return c;}function checkIfPolyIsHole(inPolyId,polygons){var insideNumber=0x0;for(var polyId=0x0;polyId<polygons['length'];polyId++){if(polyId===inPolyId)continue;if(checkIfPolygon1IsInsidePolygon2(inPolyId,polyId,polygons)){insideNumber++;}}if(insideNumber%0x2===0x0)return![];else return!![];}function checkIfNeedReverseForEveryPolys(commands,glyphCharacter){if(commands[_0x22c1('0x32')]===0x0)return;var polys=getPolygons(commands);var reverseTagList=[];for(var polyId=0x0;polyId<polys[_0x22c1('0x32')];polyId++){var poly=polys[polyId];var isHole=checkIfPolyIsHole(polyId,polys);if(isHole){if(isClockwise(poly)){reverseTagList[_0x22c1('0x2e')](!![]);}else{reverseTagList[_0x22c1('0x2e')](![]);}}else{if(isClockwise(poly)){reverseTagList[_0x22c1('0x2e')](![]);}else{reverseTagList['push'](!![]);}}}return reverseTagList;}function checkIfPolygon1IsInsidePolygon2(polyId1,polyId2,polys){var insideCount=0x0;for(var pointId=0x0;pointId<polys[polyId1][_0x22c1('0x32')];pointId++){if(pointInsidePolygon(polys[polyId1][pointId],polys[polyId2])){insideCount++;}}if(insideCount/polys[polyId1][_0x22c1('0x32')]>0.6){return!![];}else return![];}function getFirstParentOfHoles(commands,glyphCharacter){if(commands[_0x22c1('0x32')]===0x0)return;var polys=getPolygons(commands);var parentOfHoles=[];for(var polyId=0x0;polyId<polys[_0x22c1('0x32')];polyId++){var poly=polys[polyId];if(isClockwise(poly)){var polyNode={'hole':![],'parent':-0x1,'area':-0x1};polyNode[_0x22c1('0x35a')]=![];polyNode[_0x22c1('0x2b1')]=getAbsArea(poly);parentOfHoles[_0x22c1('0x2e')](polyNode);}else{var _polyNode={'hole':![],'parent':-0x1,'area':-0x1};_polyNode['hole']=!![];_polyNode['area']=getAbsArea(poly);parentOfHoles['push'](_polyNode);}}for(var _polyId=0x0;_polyId<polys['length'];_polyId++){var _polyNode2=parentOfHoles[_polyId];if(_polyNode2[_0x22c1('0x35a')]){var currentParentArea=Number[_0x22c1('0x2fa')];for(var polyNotHoleId=0x0;polyNotHoleId<polys[_0x22c1('0x32')];polyNotHoleId++){if(_polyId===polyNotHoleId)continue;var polyNode1=parentOfHoles[polyNotHoleId];if(polyNode1[_0x22c1('0x35a')]||!checkIfPolygon1IsInsidePolygon2(_polyId,polyNotHoleId,polys)||polyNode1[_0x22c1('0x2b1')]<=_polyNode2['area']||polyNode1[_0x22c1('0x2b1')]>=currentParentArea){continue;}_polyNode2[_0x22c1('0x117')]=polyNotHoleId;currentParentArea=polyNode1[_0x22c1('0x2b1')];}if(_polyNode2[_0x22c1('0x117')]===-0x1){console[_0x22c1('0xb0')](_0x22c1('0x35b'),_polyId,'is\x20hole,\x20but\x20cannnot\x20find\x20parent');}}}return parentOfHoles;}function rearrangeCommands(Polycommands,parentOfHoles){var outlines=[];for(var pathID=0x0;pathID<Polycommands[_0x22c1('0x32')];pathID++){var polyNode=parentOfHoles[pathID];if(!polyNode[_0x22c1('0x35a')]){var outlineNode={'path_id':pathID,'child':[]};outlines[_0x22c1('0x2e')](outlineNode);}}for(var i=0x0;i<Polycommands[_0x22c1('0x32')];i++){var _polyNode3=parentOfHoles[i];if(_polyNode3[_0x22c1('0x35a')]){for(var j=0x0;j<outlines[_0x22c1('0x32')];j++){if(outlines[j]['path_id']===_polyNode3['parent']){outlines[j][_0x22c1('0x35c')][_0x22c1('0x2e')](i);}}}}var rearrange=[];for(var _i2=0x0;_i2<outlines[_0x22c1('0x32')];_i2++){var outline=outlines[_i2];var p=Polycommands[outline[_0x22c1('0x35d')]];for(var _i3=0x0;_i3<p['length'];_i3++){rearrange[_0x22c1('0x2e')](p[_i3]);}var result={'type':'z'};rearrange[_0x22c1('0x2e')](result);for(var _j=0x0;_j<outline[_0x22c1('0x35c')][_0x22c1('0x32')];_j++){var _p2=Polycommands[outline[_0x22c1('0x35c')][_j]];for(var _i4=0x0;_i4<_p2[_0x22c1('0x32')];_i4++){rearrange[_0x22c1('0x2e')](_p2[_i4]);}var _result2={'type':'z'};rearrange[_0x22c1('0x2e')](_result2);}}return rearrange;}var Bend=function(){function Bend(){_classCallCheck(this,Bend);}_createClass(Bend,[{'key':_0x22c1('0x35e'),'value':function runPattern(bufferGeometry,options){var direction;var axis;var angle;var _options$bendType=options[_0x22c1('0x35f')],bendType=_options$bendType===void 0x0?0x0:_options$bendType;switch(bendType){case'0':direction=new Vector3(-0x1,0x0,0x0)['multiplyScalar'](Math[_0x22c1('0x2d7')](options['bend_intersity']));axis=new Vector3(0x0,0x0,0x1);angle=Math['PI']*Math[_0x22c1('0x69')](options[_0x22c1('0x360')]);break;case'1':direction=new Vector3(0x0,0x1,0x0)[_0x22c1('0x6f')](Math['sign'](options[_0x22c1('0x360')]));axis=new Vector3(0x0,0x0,0x1);angle=Math['PI']*Math[_0x22c1('0x69')](options[_0x22c1('0x360')]);break;case'2':direction=new Vector3(0x0,0x0,0x1)[_0x22c1('0x6f')](Math[_0x22c1('0x2d7')](options[_0x22c1('0x360')]));axis=new Vector3(0x0,0x1,0x0);angle=Math['PI']*Math[_0x22c1('0x69')](options[_0x22c1('0x360')]);break;case'3':direction=new Vector3(0x0,0x0,0x1)['multiplyScalar'](Math['sign'](options[_0x22c1('0x360')]));axis=new Vector3(0x1,0x0,0x0);angle=Math['PI']*Math[_0x22c1('0x69')](options[_0x22c1('0x360')]);}this[_0x22c1('0x361')](bufferGeometry,direction,axis,angle);}},{'key':_0x22c1('0x361'),'value':function RUN(bufferGeometry,direction,axis,angle){if(angle===0x0)return;var thirdAxis=new Vector3();thirdAxis[_0x22c1('0x68')](direction,axis);var newVertices=[];var meshGeometryBoundingBoxMaxx=0x0;var meshGeometryBoundingBoxMinx=0x0;var meshGeometryBoundingBoxMaxy=0x0;var meshGeometryBoundingBoxMiny=0x0;var meshGeometryBoundingBoxMaxz=0x0;var meshGeometryBoundingBoxMinz=0x0;var positions=bufferGeometry['attributes'][_0x22c1('0xee')][_0x22c1('0x1e9')];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);for(var i=0x0;i<vertexNumb;i++){var tempPosition=new Vector3();tempPosition[_0x22c1('0xa0')](positions,i*0x3);tempPosition['x']=Math[_0x22c1('0x362')]=Math['max'](meshGeometryBoundingBoxMaxx,tempPosition['x']);meshGeometryBoundingBoxMinx=Math[_0x22c1('0x54')](meshGeometryBoundingBoxMinx,tempPosition['x']);meshGeometryBoundingBoxMaxy=Math[_0x22c1('0x53')](meshGeometryBoundingBoxMaxy,tempPosition['y']);meshGeometryBoundingBoxMiny=Math['min'](meshGeometryBoundingBoxMiny,tempPosition['y']);meshGeometryBoundingBoxMaxz=Math['max'](meshGeometryBoundingBoxMaxz,tempPosition['z']);meshGeometryBoundingBoxMinz=Math[_0x22c1('0x54')](meshGeometryBoundingBoxMinz,tempPosition['z']);}var meshWidthX=meshGeometryBoundingBoxMaxx-meshGeometryBoundingBoxMinx;var center=new Vector3(0.5*(meshGeometryBoundingBoxMaxx+meshGeometryBoundingBoxMinx),0.5*(meshGeometryBoundingBoxMaxy+meshGeometryBoundingBoxMiny),0.5*(meshGeometryBoundingBoxMaxz+meshGeometryBoundingBoxMinz));var radius=meshWidthX/angle;for(var _i=0x0;_i<vertexNumb;_i++){newVertices[_i]=new Vector3();var _tempPosition=new Vector3();_tempPosition[_0x22c1('0xa0')](positions,_i*0x3);newVertices[_i]['copy'](_tempPosition)['sub'](center);var x=newVertices[_i][_0x22c1('0x9c')](thirdAxis);var y=newVertices[_i][_0x22c1('0x9c')](direction);var z=newVertices[_i]['dot'](axis);newVertices[_i]=new Vector3(x,y,z);}var circleCenterInLocalCoord=new Vector3(0x0,radius,0x0);for(var _i2=0x0;_i2<vertexNumb;_i2++){var s=newVertices[_i2]['x'];var h=newVertices[_i2]['y'];var alpha=s*angle/meshWidthX;var s0=(radius-h)*Math[_0x22c1('0x7c')](alpha);var h0=-(radius-h)*Math[_0x22c1('0x7b')](alpha);var offsetFromCircleCenter=new Vector3(s0,h0,newVertices[_i2]['z']);newVertices[_i2]=new Vector3();newVertices[_i2]['add'](circleCenterInLocalCoord)[_0x22c1('0xc5')](offsetFromCircleCenter);var finalVertices=new Vector3();finalVertices[_0x22c1('0xc5')](thirdAxis[_0x22c1('0x8d')]()[_0x22c1('0x6f')](newVertices[_i2]['x']));finalVertices['add'](direction[_0x22c1('0x8d')]()[_0x22c1('0x6f')](newVertices[_i2]['y']));finalVertices['add'](axis[_0x22c1('0x8d')]()[_0x22c1('0x6f')](newVertices[_i2]['z']));finalVertices[_0x22c1('0xc5')](center);positions[_i2*0x3+0x0]=finalVertices['x'];positions[_i2*0x3+0x1]=finalVertices['y'];positions[_i2*0x3+0x2]=finalVertices['z'];}}}]);return Bend;}();function _createSuper$8(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$8();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$8(){if(typeof Reflect==='undefined'||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x55dfed){return![];}}var CircleCurve=function(_Curve){_inherits(CircleCurve,_Curve);var _super=_createSuper$8(CircleCurve);function CircleCurve(center,radius,startNum,endNum){var _this;_classCallCheck(this,CircleCurve);_this=_super[_0x22c1('0x2')](this);_this[_0x22c1('0x1f')]='circleCurve';_this['center']=center[_0x22c1('0x8d')]();_this[_0x22c1('0xcf')]=radius;_this[_0x22c1('0x363')]=startNum;_this[_0x22c1('0x364')]=endNum;_this[_0x22c1('0x365')]=!![];return _this;}_createClass(CircleCurve,[{'key':'getPole','value':function getPole(min,max){min['x']=Math[_0x22c1('0x54')](min['x'],this[_0x22c1('0xf9')]['x']-this[_0x22c1('0xcf')]);min['y']=Math[_0x22c1('0x54')](min['y'],this[_0x22c1('0xf9')]['y']-this[_0x22c1('0xcf')]);max['x']=Math[_0x22c1('0x53')](max['x'],this['center']['x']+this[_0x22c1('0xcf')]);max['y']=Math[_0x22c1('0x53')](max['y'],this[_0x22c1('0xf9')]['y']+this[_0x22c1('0xcf')]);}},{'key':_0x22c1('0x24a'),'value':function getPoint(t){var normal=this[_0x22c1('0x366')](t);var radius=this['radius'],center=this[_0x22c1('0xf9')];var point=center[_0x22c1('0x8d')]()[_0x22c1('0xaa')](normal,radius);return point;}},{'key':'getNormal','value':function getNormal(t){var startNum=this[_0x22c1('0x363')],endNum=this[_0x22c1('0x364')];var angle=t*(endNum-startNum)+startNum-0.5*Math['PI'];var normal=new Vector2(Math['cos'](angle),Math[_0x22c1('0x7c')](angle));return normal;}},{'key':_0x22c1('0x2f8'),'value':function getTangent(t){var _this$getNormal=this[_0x22c1('0x366')](t),x=_this$getNormal['x'],y=_this$getNormal['y'];return new Vector2(-y,x);}}]);return CircleCurve;}(Curve);function _createSuper$9(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$9();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$9(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')]['valueOf'][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x6ebdd9){return![];}}var LineCurve3=function(_Curve){_inherits(LineCurve3,_Curve);var _super=_createSuper$9(LineCurve3);function LineCurve3(v1,v2){var _this;_classCallCheck(this,LineCurve3);_this=_super['call'](this);_this['type']=_0x22c1('0x367');_this['v1']=v1||new Vector3();_this['v2']=v2||new Vector3();_this[_0x22c1('0x368')]=!![];return _this;}_createClass(LineCurve3,[{'key':_0x22c1('0x24a'),'value':function getPoint(t){return new Vector3()[_0x22c1('0x109')](this['v1'],this['v2'],t);}},{'key':_0x22c1('0x2ec'),'value':function getPointAt(u){return this[_0x22c1('0x24a')](u);}}]);return LineCurve3;}(Curve);function _createSuper$a(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$a();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$a(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect['construct'](Boolean,[],function(){}));return!![];}catch(_0x222075){return![];}}var QuadraticBezierCurve3=function(_Curve){_inherits(QuadraticBezierCurve3,_Curve);var _super=_createSuper$a(QuadraticBezierCurve3);function QuadraticBezierCurve3(v0,v1,v2){var _this;_classCallCheck(this,QuadraticBezierCurve3);_this=_super[_0x22c1('0x2')](this);_this[_0x22c1('0x1f')]=_0x22c1('0x369');_this['v0']=v0||new Vector3();_this['v1']=v1||new Vector3();_this['v2']=v2||new Vector3();return _this;}_createClass(QuadraticBezierCurve3,[{'key':_0x22c1('0x24a'),'value':function getPoint(t){var point=new Vector3();var v0=this['v0'],v1=this['v1'],v2=this['v2'];point['set'](QuadraticBezier(t,v0['x'],v1['x'],v2['x']),QuadraticBezier(t,v0['y'],v1['y'],v2['y']),QuadraticBezier(t,v0['z'],v1['z'],v2['z']));return point;}},{'key':'copy','value':function copy(source){_get(_getPrototypeOf(QuadraticBezierCurve3[_0x22c1('0x1')]),_0x22c1('0x82'),this)[_0x22c1('0x2')](source);this['v0'][_0x22c1('0x82')](source['v0']);this['v1'][_0x22c1('0x82')](source['v1']);this['v2'][_0x22c1('0x82')](source['v2']);return this;}}]);return QuadraticBezierCurve3;}(Curve);function _createSuper$b(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$b();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super['apply'](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$b(){if(typeof Reflect===_0x22c1('0x0')||!Reflect['construct'])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0xfa0d8d){return![];}}var PolygonCurve=function(_Curve){_inherits(PolygonCurve,_Curve);var _super=_createSuper$b(PolygonCurve);function PolygonCurve(center,radius,num){var _this;var startNum=arguments[_0x22c1('0x32')]>0x3&&arguments[0x3]!==undefined?arguments[0x3]:0x0;var endNum=arguments[_0x22c1('0x32')]>0x4&&arguments[0x4]!==undefined?arguments[0x4]:0x1;_classCallCheck(this,PolygonCurve);_this=_super[_0x22c1('0x2')](this);_this[_0x22c1('0x1f')]=_0x22c1('0x36a');_this[_0x22c1('0xf9')]=center[_0x22c1('0x8d')]();_this[_0x22c1('0xcf')]=radius;_this[_0x22c1('0x36b')]=Math['round'](num);_this['startNum']=startNum;_this[_0x22c1('0x364')]=endNum;_this[_0x22c1('0x16d')]();return _this;}_createClass(PolygonCurve,[{'key':_0x22c1('0x16d'),'value':function init(){this[_0x22c1('0x36c')]=[];this[_0x22c1('0x240')]=[];for(var i=0x0;i<this[_0x22c1('0x36b')];i++){var angle=i*0x2*Math['PI']/this[_0x22c1('0x36b')];angle-=0.5*Math['PI'];var point=new Vector2(this[_0x22c1('0xcf')]*Math['cos'](angle),this[_0x22c1('0xcf')]*Math[_0x22c1('0x7c')](angle));point[_0x22c1('0xc5')](this[_0x22c1('0xf9')]);this[_0x22c1('0x240')][_0x22c1('0x2e')](point);}for(var _i=0x0;_i<this[_0x22c1('0x36b')];_i++){var line=new LineCurve(this['points'][_i],this[_0x22c1('0x240')][(_i+0x1)%this[_0x22c1('0x36b')]]);this['lineCurves'][_0x22c1('0x2e')](line);}}},{'key':_0x22c1('0x24a'),'value':function getPoint(t){this['getCurrentLine'](t);var point=this[_0x22c1('0x36d')][_0x22c1('0x24a')](this['pointK']);return point;}},{'key':_0x22c1('0x2ec'),'value':function getPointAt(t){return this[_0x22c1('0x24a')](t);}},{'key':_0x22c1('0x36e'),'value':function getCurrentLine(t){var posNum=(t*(this[_0x22c1('0x364')]-this[_0x22c1('0x363')])+this['startNum'])%0x1;if(posNum<0x0){posNum+=0x1;}var k=posNum*this[_0x22c1('0x36b')];var lineNum=Math['floor'](k);this[_0x22c1('0x36f')]=k-lineNum;this[_0x22c1('0x36d')]=this[_0x22c1('0x36c')][lineNum];return this[_0x22c1('0x36d')];}},{'key':'getTangent','value':function getTangent(t){this[_0x22c1('0x36e')](t);var tangent=this['currentLine']['getTangent']();return tangent[_0x22c1('0x6a')]();}},{'key':_0x22c1('0x366'),'value':function getNormal(t){this[_0x22c1('0x36e')](t);var normal=this['currentLine'][_0x22c1('0x366')]();return normal[_0x22c1('0x6a')]();}}]);return PolygonCurve;}(Curve);function _createSuper$c(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$c();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$c(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x10c34d){return![];}}var HeartCurve=function(_Curve){_inherits(HeartCurve,_Curve);var _super=_createSuper$c(HeartCurve);function HeartCurve(center,size){var _this;var startNum=arguments[_0x22c1('0x32')]>0x2&&arguments[0x2]!==undefined?arguments[0x2]:0x0;var endNum=arguments['length']>0x3&&arguments[0x3]!==undefined?arguments[0x3]:0x1;_classCallCheck(this,HeartCurve);_this=_super['call'](this);_this[_0x22c1('0x1f')]='RectangularCurve';_this['center']=center[_0x22c1('0x8d')]();_this[_0x22c1('0x1ca')]=size;_this['startNum']=startNum;_this[_0x22c1('0x364')]=endNum;_this[_0x22c1('0x16d')]();return _this;}_createClass(HeartCurve,[{'key':'init','value':function init(){this[_0x22c1('0x300')]=[];var _this$center=this['center'],x=_this$center['x'],y=_this$center['y'];var circleCenter1=new Vector2(x+0.5*this['size'],y-0.5*this['size']);var circleCenter2=new Vector2(x-0.5*this[_0x22c1('0x1ca')],y-0.5*this[_0x22c1('0x1ca')]);var circleCenter3=new Vector2(x,y+0.5*this['size']);var circleCurve1=new CircleCurve(circleCenter1,Math[_0x22c1('0x370')]*this[_0x22c1('0x1ca')],-0.25*Math['PI'],0.75*Math['PI']);var circleCurve2=new CircleCurve(circleCenter2,Math[_0x22c1('0x370')]*this[_0x22c1('0x1ca')],-0.75*Math['PI'],0.25*Math['PI']);var circleCurve3=new CircleCurve(circleCenter3,0.5*Math[_0x22c1('0x370')]*this[_0x22c1('0x1ca')],0.75*Math['PI'],1.25*Math['PI']);var lowPoint=new Vector2(x,y+this[_0x22c1('0x1ca')]);var point1=new Vector2(x+this['size'],y);var point2=point1['clone']()['lerp'](lowPoint,0.75);var point4=new Vector2(x-this[_0x22c1('0x1ca')],y);var point3=point4[_0x22c1('0x8d')]()[_0x22c1('0x108')](lowPoint,0.75);var lineCurve1=new LineCurve(point1,point2);var lineCurve2=new LineCurve(point3,point4);this[_0x22c1('0x300')]['push'](circleCurve1,lineCurve1,circleCurve3,lineCurve2,circleCurve2);}},{'key':_0x22c1('0x24a'),'value':function getPoint(t){this[_0x22c1('0x36e')](t);var point=this[_0x22c1('0x371')][_0x22c1('0x24a')](this[_0x22c1('0x36f')]);return point;}},{'key':_0x22c1('0x2ec'),'value':function getPointAt(t){return this[_0x22c1('0x24a')](t);}},{'key':'getCurrentLine','value':function getCurrentLine(t){var posNum=(t*(this['endNum']-this[_0x22c1('0x363')])+this[_0x22c1('0x363')])%0x1;if(posNum<0x0){posNum+=0x1;}posNum*=0x9*Math['PI']/0x8+1.5;var lineNum;var halfPI=0.5*Math['PI'];if(posNum<halfPI){lineNum=0x0;this[_0x22c1('0x36f')]=posNum/halfPI;}else if(posNum<halfPI+0.75){lineNum=0x1;this[_0x22c1('0x36f')]=(posNum-halfPI)/0.75;}else if(posNum<0x5*Math['PI']/0x8+0.75){lineNum=0x2;this[_0x22c1('0x36f')]=(posNum-halfPI-0.75)/(Math['PI']/0x8);}else if(posNum<0x5*Math['PI']/0x8+1.5){lineNum=0x3;this[_0x22c1('0x36f')]=(posNum-0x5*Math['PI']/0x8-0.75)/0.75;}else{lineNum=0x4;this[_0x22c1('0x36f')]=(posNum-0x5*Math['PI']/0x8-1.5)/halfPI;}this[_0x22c1('0x371')]=this['curves'][lineNum];return this[_0x22c1('0x371')];}},{'key':_0x22c1('0x2f8'),'value':function getTangent(t){this['getCurrentLine'](t);var tangent=this[_0x22c1('0x371')][_0x22c1('0x2f8')](this[_0x22c1('0x36f')]);return tangent[_0x22c1('0x6a')]();}},{'key':_0x22c1('0x366'),'value':function getNormal(t){this[_0x22c1('0x36e')](t);var tangent=this[_0x22c1('0x371')][_0x22c1('0x366')](this[_0x22c1('0x36f')]);return tangent[_0x22c1('0x6a')]();}}]);return HeartCurve;}(Curve);function _createSuper$d(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$d();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$d(){if(typeof Reflect===_0x22c1('0x0')||!Reflect['construct'])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy==='function')return!![];try{Boolean[_0x22c1('0x1')][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x438610){return![];}}var RectangularCurve=function(_Curve){_inherits(RectangularCurve,_Curve);var _super=_createSuper$d(RectangularCurve);function RectangularCurve(center,size){var _this;var ratio=arguments[_0x22c1('0x32')]>0x2&&arguments[0x2]!==undefined?arguments[0x2]:0x1;var startNum=arguments[_0x22c1('0x32')]>0x3&&arguments[0x3]!==undefined?arguments[0x3]:0x0;var endNum=arguments['length']>0x4&&arguments[0x4]!==undefined?arguments[0x4]:0x1;_classCallCheck(this,RectangularCurve);_this=_super[_0x22c1('0x2')](this);_this[_0x22c1('0x1f')]=_0x22c1('0x372');_this[_0x22c1('0xf9')]=center['clone']();_this[_0x22c1('0x1ca')]=size;_this[_0x22c1('0x373')]=ratio;_this[_0x22c1('0x363')]=startNum;_this[_0x22c1('0x364')]=endNum;_this['init']();return _this;}_createClass(RectangularCurve,[{'key':_0x22c1('0x16d'),'value':function init(){this['curves']=[];var _this$center=this[_0x22c1('0xf9')],x=_this$center['x'],y=_this$center['y'];var points=[];var halfWidth=this[_0x22c1('0x1ca')];var halfHeight=this[_0x22c1('0x1ca')]/this['ratio'];points[0x0]=new Vector2(x-halfWidth,y-halfHeight);points[0x1]=new Vector2(x+halfWidth,y-halfHeight);points[0x2]=new Vector2(x+halfWidth,y+halfHeight);points[0x3]=new Vector2(x-halfWidth,y+halfHeight);for(var i=0x0;i<0x4;i++){this[_0x22c1('0x300')]['push'](new LineCurve(points[i],points[(i+0x1)%0x4]));}}},{'key':_0x22c1('0x24a'),'value':function getPoint(t){this[_0x22c1('0x36e')](t);var point=this['currentLine'][_0x22c1('0x24a')](this[_0x22c1('0x36f')]);return point;}},{'key':_0x22c1('0x2ec'),'value':function getPointAt(t){return this[_0x22c1('0x24a')](t);}},{'key':_0x22c1('0x36e'),'value':function getCurrentLine(t){var posNum=(t*(this[_0x22c1('0x364')]-this[_0x22c1('0x363')])+this['startNum'])%0x1;if(posNum<0x0){posNum+=0x1;}posNum*=(0x1+this[_0x22c1('0x373')])*0x2;var lineNum;if(posNum<this[_0x22c1('0x373')]){lineNum=0x0;this[_0x22c1('0x36f')]=posNum/this[_0x22c1('0x373')];}else if(posNum<this[_0x22c1('0x373')]+0x1){lineNum=0x1;this[_0x22c1('0x36f')]=(posNum-this[_0x22c1('0x373')])/0x1;}else if(posNum<0x2*this[_0x22c1('0x373')]+0x1){lineNum=0x2;this[_0x22c1('0x36f')]=(posNum-this[_0x22c1('0x373')]-0x1)/this[_0x22c1('0x373')];}else{lineNum=0x3;this[_0x22c1('0x36f')]=(posNum-0x2*this[_0x22c1('0x373')]-0x1)/0x1;}this[_0x22c1('0x36d')]=this[_0x22c1('0x300')][lineNum];return this['currentLine'];}},{'key':_0x22c1('0x2f8'),'value':function getTangent(t){this['getCurrentLine'](t);var tangent=this[_0x22c1('0x36d')][_0x22c1('0x2f8')]();return tangent[_0x22c1('0x6a')]();}},{'key':_0x22c1('0x366'),'value':function getNormal(t){this[_0x22c1('0x36e')](t);var tangent=this['currentLine'][_0x22c1('0x366')]();return tangent['normalize']();}}]);return RectangularCurve;}(Curve);var TransformForPaths=function(){function TransformForPaths(){_classCallCheck(this,TransformForPaths);}_createClass(TransformForPaths,[{'key':_0x22c1('0x374'),'value':function breakLine(paths,boundingBox){var isVertical=arguments[_0x22c1('0x32')]>0x2&&arguments[0x2]!==undefined?arguments[0x2]:![];var min=boundingBox[_0x22c1('0x54')],max=boundingBox['max'];var centerX=0.5*(min['x']+max['x']);var centerY=0.5*(min['y']+max['y']);for(var i=0x0;i<paths['length'];i++){var subPaths=paths[i][_0x22c1('0x32c')];for(var j=0x0;j<subPaths[_0x22c1('0x32')];j++){var curves=subPaths[j]['curves'];var newCurves=[];for(var k=0x0;k<curves[_0x22c1('0x32')];k++){var curve=curves[k];var option=isVertical?{'y':centerY}:{'x':centerX};var newCurve=curve['split'](option);newCurves[_0x22c1('0x2e')][_0x22c1('0x7')](newCurves,_toConsumableArray(newCurve));}paths[i]['subPaths'][j][_0x22c1('0x300')]=newCurves;}}}},{'key':'getBoundingBoxOfPaths','value':function getBoundingBoxOfPaths(paths){var signal=arguments[_0x22c1('0x32')]>0x1&&arguments[0x1]!==undefined?arguments[0x1]:0x0;var max=new Vector2(-Infinity,-Infinity);var min=new Vector2(Infinity,Infinity);for(var i=0x0;i<paths[_0x22c1('0x32')];i++){var subPaths=paths[i][_0x22c1('0x32c')];var _this$getExtremumOfSu=this['getExtremumOfSubPaths'](subPaths,signal),maxPos=_this$getExtremumOfSu[_0x22c1('0x53')],minPos=_this$getExtremumOfSu['min'];max['x']=Math[_0x22c1('0x53')](max['x'],maxPos['x']);max['y']=Math[_0x22c1('0x53')](max['y'],maxPos['y']);min['x']=Math[_0x22c1('0x54')](min['x'],minPos['x']);min['y']=Math[_0x22c1('0x54')](min['y'],minPos['y']);}var width=max['x']-min['x'];var height=max['y']-min['y'];var boundingBox={'max':max,'min':min,'width':width,'height':height};return boundingBox;}},{'key':_0x22c1('0x375'),'value':function boundingBoxOfAFont(subPaths){var _this$getExtremumOfSu2=this[_0x22c1('0x376')](subPaths),max=_this$getExtremumOfSu2['max'],min=_this$getExtremumOfSu2[_0x22c1('0x54')];return[max['x']-min['x'],max['y']-min['y']];}},{'key':_0x22c1('0x377'),'value':function centreOfAFont(subPaths){var _this$getExtremumOfSu3=this[_0x22c1('0x376')](subPaths),max=_this$getExtremumOfSu3[_0x22c1('0x53')],min=_this$getExtremumOfSu3[_0x22c1('0x54')];var midX=0.5*(max['x']+min['x']);var midY=0.5*(max['y']+min['y']);return[midX,midY];}},{'key':_0x22c1('0x378'),'value':function caculateCrossPoint(point1,point2,point3,point4){var x0=point1['x'],y0=point1['y'];var x1=point2['x'],y1=point2['y'];var x2=point3['x'],y2=point3['y'];var x3=point4['x'],y3=point4['y'];var y=((y0-y1)*(y3-y2)*x0+(y3-y2)*(x1-x0)*y0+(y1-y0)*(y3-y2)*x2+(x2-x3)*(y1-y0)*y2)/((x1-x0)*(y3-y2)+(y0-y1)*(x3-x2));var x=x2+(x3-x2)*(y-y2)/(y3-y2);return new Vector2(x,y);}},{'key':_0x22c1('0x379'),'value':function makeTheJointSmooth(paths){for(var i=0x0;i<paths['length'];i++){var subPaths=paths[i]['subPaths'];for(var j=0x0;j<subPaths['length'];j++){var curves=subPaths[j][_0x22c1('0x300')];for(var k=0x0;k<curves[_0x22c1('0x32')];k++){if(curves[k][_0x22c1('0x1f')]==='QuadraticBezierCurve'&&curves[k][_0x22c1('0x37a')]){var _curves$k=curves[k],v0=_curves$k['v0'],v1=_curves$k['v1'],v2=_curves$k['v2'];v1['x']=0x2*v1['x']-0.5*(v0['x']+v2['x']);v1['y']=0x2*v1['y']-0.5*(v0['y']+v2['y']);}}paths[i][_0x22c1('0x32c')][j][_0x22c1('0x300')]=curves;}}}},{'key':_0x22c1('0x37b'),'value':function lineToQuadraticBezier(paths){for(var i=0x0;i<paths[_0x22c1('0x32')];i++){var subPaths=paths[i]['subPaths'];for(var j=0x0;j<subPaths['length'];j++){var curves=subPaths[j][_0x22c1('0x300')];var newCurves=[];for(var k=0x0;k<curves[_0x22c1('0x32')];k++){var curve=curves[k];if(curve[_0x22c1('0x1f')]===_0x22c1('0x37c')&&curve['getLength']()>0x5){var v1=curve['v1'],v2=curve['v2'];var midPoint=new Vector2(0.5*(v1['x']+v2['x']),0.5*(v1['y']+v2['y']));var newCurve=new QuadraticBezierCurve(v1,midPoint,v2);newCurve['isFromLine']=!![];newCurves[_0x22c1('0x2e')](newCurve);}else{newCurves['push'](curve);}}paths[i][_0x22c1('0x32c')][j]['curves']=newCurves;}}}},{'key':_0x22c1('0x37d'),'value':function getWhetherParallel(p1,p2,p3,p4){var vec1=p2[_0x22c1('0x8d')]()['sub'](p1);var vec2=p4[_0x22c1('0x8d')]()[_0x22c1('0xab')](p3);return vec1[_0x22c1('0x105')](vec2)<0x1;}},{'key':_0x22c1('0x376'),'value':function getExtremumOfSubPaths(subPaths){var signal=arguments[_0x22c1('0x32')]>0x1&&arguments[0x1]!==undefined?arguments[0x1]:0x0;var max=new Vector2(-Infinity,-Infinity);var min=new Vector2(Infinity,Infinity);var l=subPaths[_0x22c1('0x32')]-signal;for(var j=0x0;j<l;j++){var curves=subPaths[j][_0x22c1('0x300')];for(var k=0x0;k<curves[_0x22c1('0x32')];k++){curves[k]['getPole'](min,max);}}return{'max':max,'min':min};}},{'key':'getRandom','value':function getRandom(num){var tempNum=Math['sin'](num)*43758.5453123;return tempNum-Math['trunc'](tempNum);}},{'key':'baseTransform','value':function baseTransform(funcPerCurve,funcPerChar,funcPreprocess){var paths=this[_0x22c1('0x32d')];var charPosDatas=this['options'][_0x22c1('0x37e')];var extraData=funcPreprocess&&funcPreprocess();var _loop=function _loop(i){var subPaths=paths[i][_0x22c1('0x32c')];var data=funcPerChar&&funcPerChar(i,charPosDatas[i],extraData);for(var j=0x0;j<subPaths[_0x22c1('0x32')];j++){var curves=subPaths[j][_0x22c1('0x300')];for(var k=0x0;k<curves[_0x22c1('0x32')];k++){curves[k][_0x22c1('0x316')](function(point){funcPerCurve(point,data);});}}};for(var i=0x0;i<paths[_0x22c1('0x32')];i++){_loop(i);}}},{'key':'transform','value':function transform(paths,options){this[_0x22c1('0x32d')]=paths;this['options']=options;this[_0x22c1('0x37f')]=Object[_0x22c1('0x48')]([],options['intensitys']);this[_0x22c1('0x37f')][_0x22c1('0x22')](function(element,index,array){array[index]=element/0x64;});this['boundingBox']=this['getBoundingBoxOfPaths'](paths);var _this$boundingBox=this[_0x22c1('0x1e4')],width=_this$boundingBox[_0x22c1('0x287')],height=_this$boundingBox[_0x22c1('0x1cc')];this[_0x22c1('0x380')]=/^hor/[_0x22c1('0x149')](options['writingMode']);this[_0x22c1('0x381')]=this[_0x22c1('0x380')]?width:height;this[_0x22c1('0x382')]=this[_0x22c1('0x380')]?height:width;this[_0x22c1('0x330')]=options['maxFontSize'];}}]);return TransformForPaths;}();function _createSuper$e(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$e();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$e(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect['construct']['sham'])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean['prototype'][_0x22c1('0x2fd')][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x29d7cd){return![];}}var BendForPaths=function(_TransformForPaths){_inherits(BendForPaths,_TransformForPaths);var _super=_createSuper$e(BendForPaths);function BendForPaths(){_classCallCheck(this,BendForPaths);return _super['apply'](this,arguments);}_createClass(BendForPaths,[{'key':_0x22c1('0x383'),'value':function bend(paths,options){var type=options[_0x22c1('0x1f')];var baseRadius=this['lineHeight']*0x2/Math[_0x22c1('0x7c')](this['intensitys'][0x0]*Math['PI']*0.5);var isVertical=/^bend/[_0x22c1('0x149')](type)?/Vertical$/[_0x22c1('0x149')](type):!this[_0x22c1('0x380')];var boundingBox=this[_0x22c1('0x1e4')];var max=boundingBox[_0x22c1('0x53')],min=boundingBox[_0x22c1('0x54')],width=boundingBox['width'],height=boundingBox[_0x22c1('0x1cc')];var angle=(isVertical?height:width)/0x2/baseRadius;var boxCenter=min[_0x22c1('0x8d')]()[_0x22c1('0x108')](max,0.5);var baseAngle;var circleCenter=boxCenter['clone']();if(isVertical){baseAngle=0x0;circleCenter['x']+=this[_0x22c1('0x381')]/0x2/Math['tan'](angle)+Math[_0x22c1('0x2d7')](angle)*width/0x2;}else{baseAngle=1.5*Math['PI'];circleCenter['y']+=this[_0x22c1('0x381')]/0x2/Math[_0x22c1('0x384')](angle)+Math[_0x22c1('0x2d7')](angle)*height/0x2;}var setNewPos1=function setNewPos1(pos){var r=baseRadius+Math['sign'](angle)*height/0x2-(pos['y']-boxCenter['y']);var currentAngle=baseAngle+(pos['x']-circleCenter['x'])/width*0x2*angle;var x=circleCenter['x']+r*Math[_0x22c1('0x7b')](currentAngle);var y=circleCenter['y']+r*Math[_0x22c1('0x7c')](currentAngle);pos[_0x22c1('0x5e')](x,y);};var setNewPos2=function setNewPos2(pos){var currentAngle=baseAngle+(pos['x']-circleCenter['x'])/width*0x2*angle;var x=circleCenter['x']+baseRadius*Math[_0x22c1('0x7b')](currentAngle);var y=circleCenter['y']+baseRadius*Math[_0x22c1('0x7c')](currentAngle)-Math[_0x22c1('0x2d7')](angle)*height/0x2+(pos['y']-boxCenter['y']);pos[_0x22c1('0x5e')](x,y);};var setNewPos3=function setNewPos3(pos){var r=baseRadius+Math[_0x22c1('0x2d7')](angle)*width/0x2+(pos['x']-boxCenter['x']);var currentAngle=baseAngle+(pos['y']-circleCenter['y'])/height*0x2*angle;var x=circleCenter['x']+r*Math[_0x22c1('0x7b')](currentAngle);var y=circleCenter['y']+r*Math[_0x22c1('0x7c')](currentAngle);pos[_0x22c1('0x5e')](x,y);};var setNewPos4=function setNewPos4(pos){var currentAngle=baseAngle+(pos['y']-circleCenter['y'])/height*0x2*angle;var x=circleCenter['x']+baseRadius*Math[_0x22c1('0x7b')](currentAngle)+Math[_0x22c1('0x2d7')](angle)*width/0x2+(pos['x']-boxCenter['x']);var y=circleCenter['y']+baseRadius*Math['sin'](currentAngle);pos[_0x22c1('0x5e')](x,y);};var setNewPos;switch(type){case _0x22c1('0x383'):setNewPos=setNewPos1;break;case'bendVertical':setNewPos=setNewPos3;break;case'archCurve':setNewPos=this['isHorizontal']?setNewPos2:setNewPos4;}var funcPerCurve=function funcPerCurve(point){setNewPos(point);};this[_0x22c1('0x385')](funcPerCurve);}},{'key':_0x22c1('0x386'),'value':function transform(paths,options){_get(_getPrototypeOf(BendForPaths['prototype']),_0x22c1('0x386'),this)[_0x22c1('0x2')](this,paths,options);if(Math[_0x22c1('0x106')][_0x22c1('0x7')](Math,_toConsumableArray(options[_0x22c1('0x37f')]))){this[_0x22c1('0x37b')](paths);this[_0x22c1('0x383')](paths,options);this[_0x22c1('0x379')](paths);}return this['getBoundingBoxOfPaths'](paths);}}]);return BendForPaths;}(TransformForPaths);var FFD=function(){function FFD(){_classCallCheck(this,FFD);}_createClass(FFD,[{'key':_0x22c1('0x387'),'value':function _factorial(num){var rval=0x1;for(var i=0x2;i<=num;i++){rval=rval*i;}return rval;}},{'key':_0x22c1('0x388'),'value':function _combination(n,m){return this[_0x22c1('0x387')](n)/(this['_factorial'](m)*this[_0x22c1('0x387')](n-m));}},{'key':_0x22c1('0x389'),'value':function _bernsteinBasis(l,i,s){return this[_0x22c1('0x388')](l,i)*Math['pow'](s,i)*Math[_0x22c1('0x57')](0x1-s,l-i);}},{'key':_0x22c1('0x38a'),'value':function _linearBasis(l,i,s){var k=i<s*l?i+0x1-s*l:s*l-i+0x1;return Math[_0x22c1('0x53')](0x0,k);}},{'key':_0x22c1('0x38b'),'value':function _basisFunction(l,i,s,basisType){if(basisType===undefined)basisType='bernstein';if(basisType===_0x22c1('0x38c')){return this['_bernsteinBasis'](l,i,s);}else if(basisType===_0x22c1('0x38d')){return this[_0x22c1('0x38a')](l,i,s);}}},{'key':_0x22c1('0x38e'),'value':function _calculateSTUfromX(X){var S=this['S'];var T=this['T'];var U=this['U'];var P0=this['P0'];var stu=new Vector3(0x0,0x0,0x0);var temp=T[_0x22c1('0x8d')]()[_0x22c1('0x105')](U)[_0x22c1('0x9c')](X[_0x22c1('0x8d')]()['sub'](P0));var de=T[_0x22c1('0x8d')]()[_0x22c1('0x105')](U)[_0x22c1('0x9c')](S);stu['x']=temp/de;stu['y']=S[_0x22c1('0x8d')]()['cross'](U)[_0x22c1('0x9c')](X[_0x22c1('0x8d')]()[_0x22c1('0xab')](P0))/S['clone']()[_0x22c1('0x105')](U)[_0x22c1('0x9c')](T);stu['z']=S['clone']()[_0x22c1('0x105')](T)[_0x22c1('0x9c')](X[_0x22c1('0x8d')]()[_0x22c1('0xab')](P0))/S[_0x22c1('0x8d')]()[_0x22c1('0x105')](T)['dot'](U);return stu;}},{'key':'_calculateXfromSTU','value':function _calculateXfromSTU(s,t,u,basisType){var X=new Vector3(0x0,0x0,0x0);for(var i=0x0;i<this['m'];i++){for(var j=0x0;j<this['n'];j++){for(var k=0x0;k<this['o'];k++){var coeff=this[_0x22c1('0x38b')](this['m']-0x1,i,s,basisType)*this['_basisFunction'](this['n']-0x1,j,t,basisType)*this[_0x22c1('0x38b')](this['o']-0x1,k,u,basisType);X[_0x22c1('0xc5')](this['P'][i][j][k][_0x22c1('0x8d')]()[_0x22c1('0x6f')](coeff));}}}return X;}},{'key':_0x22c1('0x38f'),'value':function _initP(bufferGeometry,m,n,o){var meshGeometryBoundingBoxMaxx=0x0;var meshGeometryBoundingBoxMinx=0x0;var meshGeometryBoundingBoxMaxy=0x0;var meshGeometryBoundingBoxMiny=0x0;var meshGeometryBoundingBoxMaxz=0x0;var meshGeometryBoundingBoxMinz=0x0;for(var i=0x0;i<bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')]['count'];i++){var vertex=new Vector3()[_0x22c1('0xa0')](bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')],i*0x3);if(vertex['x']>meshGeometryBoundingBoxMaxx){meshGeometryBoundingBoxMaxx=vertex['x'];}if(vertex['x']<meshGeometryBoundingBoxMinx){meshGeometryBoundingBoxMinx=vertex['x'];}if(vertex['y']>meshGeometryBoundingBoxMaxy){meshGeometryBoundingBoxMaxy=vertex['y'];}if(vertex['y']<meshGeometryBoundingBoxMiny){meshGeometryBoundingBoxMiny=vertex['y'];}if(vertex['z']>meshGeometryBoundingBoxMaxz){meshGeometryBoundingBoxMaxz=vertex['z'];}if(vertex['z']<meshGeometryBoundingBoxMinz){meshGeometryBoundingBoxMinz=vertex['z'];}}var origin=new Vector3(meshGeometryBoundingBoxMinx,meshGeometryBoundingBoxMiny,meshGeometryBoundingBoxMinz);var XWidth=meshGeometryBoundingBoxMaxx-meshGeometryBoundingBoxMinx;var YWidth=meshGeometryBoundingBoxMaxy-meshGeometryBoundingBoxMiny;var ZWidth=meshGeometryBoundingBoxMaxz-meshGeometryBoundingBoxMinz;this[_0x22c1('0x390')]=XWidth;this['YWidth']=YWidth;this[_0x22c1('0x391')]=ZWidth;var center=new Vector3((meshGeometryBoundingBoxMaxx+meshGeometryBoundingBoxMinx)*0.5,(meshGeometryBoundingBoxMaxy+meshGeometryBoundingBoxMiny)*0.5,(meshGeometryBoundingBoxMaxz+meshGeometryBoundingBoxMinz)*0.5);this[_0x22c1('0xf9')]=center;this['m']=m;this['n']=n;this['o']=o;var vvvP=new Array(m);for(var _i=0x0;_i<m;_i++){vvvP[_i]=new Array(n);for(var j=0x0;j<n;j++){vvvP[_i][j]=new Array(o);}}var stepX=XWidth/(m-0x1);var stepY=YWidth/(n-0x1);var stepZ=ZWidth/(o-0x1);for(var _i2=0x0;_i2<m;_i2++){for(var _j=0x0;_j<n;_j++){for(var k=0x0;k<o;k++){var offset=new Vector3(0x0,0x0,0x0);offset['x']=_i2*stepX;offset['y']=_j*stepY;offset['z']=k*stepZ;vvvP[_i2][_j][k]=origin['clone']()[_0x22c1('0xc5')](offset);}}}this['P']=vvvP;this['P0']=origin;this['S']=new Vector3(XWidth,0x0,0x0);this['T']=new Vector3(0x0,YWidth,0x0);this['U']=new Vector3(0x0,0x0,ZWidth);}},{'key':_0x22c1('0x392'),'value':function _getP(i,j,k){if(i<0x0||i>=this['m'])return;if(j<0x0||j>=this['n'])return;if(k<0x0||k>=this['o'])return;return this['P'][i][j][k];}},{'key':'_changeP','value':function _changeP(i,j,k,newPos){if(!newPos[_0x22c1('0xa2')])return;if(i<0x0||i>=this['m'])return;if(j<0x0||j>=this['n'])return;if(k<0x0||k>=this['o'])return;this['P'][i][j][k]=newPos;}},{'key':_0x22c1('0x393'),'value':function _addP(i,j,k,newPos){if(!newPos[_0x22c1('0xa2')])return;if(i<0x0||i>=this['m'])return;if(j<0x0||j>=this['n'])return;if(k<0x0||k>=this['o'])return;this['P'][i][j][k]['add'](newPos);}},{'key':'_initSTUs','value':function _initSTUs(bufferGeometry){var STUs=[];for(var i=0x0;i<bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0xd7')];i++){STUs[i]=this[_0x22c1('0x38e')](new Vector3()[_0x22c1('0xa0')](bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')],i*0x3));}this[_0x22c1('0x394')]=STUs;}},{'key':'_calculateDeformedGeometry','value':function _calculateDeformedGeometry(bufferGeometry,basisType){for(var i=0x0;i<bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0xd7')];i++){var deformedPos=this[_0x22c1('0x395')](this[_0x22c1('0x394')][i]['x'],this['STUs'][i]['y'],this[_0x22c1('0x394')][i]['z'],basisType);bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')][i*0x3+0x0]=deformedPos['x'];bufferGeometry[_0x22c1('0xed')]['position']['array'][i*0x3+0x1]=deformedPos['y'];bufferGeometry['attributes']['position']['array'][i*0x3+0x2]=deformedPos['z'];}}},{'key':'_calculateBoundingBox','value':function _calculateBoundingBox(bufferGeometry){var meshGeometryBoundingBoxMaxx=0x0;var meshGeometryBoundingBoxMinx=0x0;var meshGeometryBoundingBoxMaxy=0x0;var meshGeometryBoundingBoxMiny=0x0;var meshGeometryBoundingBoxMaxz=0x0;var meshGeometryBoundingBoxMinz=0x0;for(var i=0x0;i<bufferGeometry['attributes'][_0x22c1('0xee')][_0x22c1('0xd7')];i++){if(bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')]['array'][i*0x3+0x0]>meshGeometryBoundingBoxMaxx){meshGeometryBoundingBoxMaxx=bufferGeometry['attributes'][_0x22c1('0xee')][_0x22c1('0x1e9')][i*0x3+0x0];}if(bufferGeometry['attributes'][_0x22c1('0xee')][_0x22c1('0x1e9')][i*0x3+0x0]<meshGeometryBoundingBoxMinx){meshGeometryBoundingBoxMinx=bufferGeometry[_0x22c1('0xed')]['position'][_0x22c1('0x1e9')][i*0x3+0x0];}if(bufferGeometry['attributes'][_0x22c1('0xee')]['array'][i*0x3+0x1]>meshGeometryBoundingBoxMaxy){meshGeometryBoundingBoxMaxy=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')][i*0x3+0x1];}if(bufferGeometry['attributes'][_0x22c1('0xee')][_0x22c1('0x1e9')][i*0x3+0x1]<meshGeometryBoundingBoxMiny){meshGeometryBoundingBoxMiny=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')][i*0x3+0x1];}if(bufferGeometry['attributes']['position']['array'][i*0x3+0x2]>meshGeometryBoundingBoxMaxz){meshGeometryBoundingBoxMaxz=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')][i*0x3+0x2];}if(bufferGeometry[_0x22c1('0xed')]['position'][_0x22c1('0x1e9')][i*0x3+0x2]<meshGeometryBoundingBoxMinz){meshGeometryBoundingBoxMinz=bufferGeometry[_0x22c1('0xed')]['position']['array'][i*0x3+0x2];}}var meshWidthX=meshGeometryBoundingBoxMaxx-meshGeometryBoundingBoxMinx;var meshWidthY=meshGeometryBoundingBoxMaxy-meshGeometryBoundingBoxMiny;var meshWidthZ=meshGeometryBoundingBoxMaxz-meshGeometryBoundingBoxMinz;return[meshWidthX,meshWidthY,meshWidthZ];}},{'key':'RUN','value':function RUN(bufferGeometry,options){var pattern=options[_0x22c1('0x396')]?Number(options[_0x22c1('0x396')]):0x1;pattern=parseInt(pattern);var intensity=options['intensity']/0x64||0x0;var intensity1=options['intensity1']/0x64||0x0;var basisType=options[_0x22c1('0x397')]||_0x22c1('0x38c');if(intensity===0x0&&intensity1===0x0)return;var tag=0x64;var tag1=0xc8;var tag2=0x12c;var tag3=0x190;var tag4=0x1f4;var latticeDimX;var latticeDimY;var latticeDimZ;if(pattern<=tag){latticeDimX=0x3;latticeDimY=0x2;latticeDimZ=0x2;}else if(pattern>tag&&pattern<tag1){latticeDimX=0x4;latticeDimY=0x2;latticeDimZ=0x2;}else if(pattern>=tag1&&pattern<tag2){latticeDimX=0x4;latticeDimY=0x4;latticeDimZ=0x2;}else if(pattern>=tag2&&pattern<tag3){latticeDimX=0xa;latticeDimY=0x2;latticeDimZ=0x2;}else if(pattern>=tag3&&pattern<tag4){latticeDimX=0x2;latticeDimY=0x3;latticeDimZ=0x2;}else if(pattern>=tag4){latticeDimX=0x2;latticeDimY=0x2;latticeDimZ=0x2;}this['_initP'](bufferGeometry,latticeDimX,latticeDimY,latticeDimZ);var _options$baseLineHeig=options[_0x22c1('0x398')],baseLineHeight=_options$baseLineHeig===void 0x0?0x64:_options$baseLineHeig,_options$maxLineWidth=options[_0x22c1('0x399')],maxLineWidth=_options$maxLineWidth===void 0x0?0x190:_options$maxLineWidth;this[_0x22c1('0x39a')](bufferGeometry);if(pattern===0x0){this['_changeP'](0x0,0x0,0x0,new Vector3(-intensity,-intensity,0x0));}else if(pattern===0x1){var y=intensity*baseLineHeight*0x2;this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,y,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,y,0x0));}else if(pattern===0x2){var _y=intensity*baseLineHeight;if(_y>0x0)_y=_y*0.5;this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,-_y,0x0));this['_addP'](0x0,0x1,0x1,new Vector3(0x0,-_y,0x0));this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(0x0,_y,0x0));this[_0x22c1('0x393')](0x0,0x0,0x1,new Vector3(0x0,_y,0x0));var scale=0x2;this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,scale*_y,0x0));this['_addP'](0x1,0x1,0x1,new Vector3(0x0,scale*_y,0x0));this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(0x0,-scale*_y,0x0));this[_0x22c1('0x393')](0x1,0x0,0x1,new Vector3(0x0,-scale*_y,0x0));this[_0x22c1('0x393')](0x2,0x1,0x0,new Vector3(0x0,-_y,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,-_y,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(0x0,_y,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(0x0,_y,0x0));}else if(pattern===0x3){var _y2=intensity*baseLineHeight*0x2;this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,_y2,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,_y2,0x0));this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(0x0,_y2,0x0));this[_0x22c1('0x393')](0x1,0x0,0x1,new Vector3(0x0,_y2,0x0));}else if(pattern===0x4){var _y3=intensity*baseLineHeight*0x2;this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(0x0,_y3,0x0));this[_0x22c1('0x393')](0x1,0x0,0x1,new Vector3(0x0,_y3,0x0));}else if(pattern===0x5){var _y4=intensity*baseLineHeight;this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(0x0,_y4,0x0));this[_0x22c1('0x393')](0x0,0x0,0x1,new Vector3(0x0,_y4,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(0x0,-_y4,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(0x0,-_y4,0x0));var leftLength=this[_0x22c1('0x392')](0x0,0x1,0x0)[_0x22c1('0x107')](this[_0x22c1('0x392')](0x0,0x0,0x0));var rightLength=this[_0x22c1('0x392')](0x2,0x1,0x0)['distanceTo'](this[_0x22c1('0x392')](0x2,0x0,0x0));var ratio=leftLength/(leftLength+rightLength);this[_0x22c1('0x39b')](0x1,0x0,0x0,this[_0x22c1('0x392')](0x0,0x0,0x0)['clone']()[_0x22c1('0x6f')](0x1-ratio)[_0x22c1('0xc5')](this[_0x22c1('0x392')](0x2,0x0,0x0)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](ratio)));this['_changeP'](0x1,0x1,0x0,this['_getP'](0x0,0x1,0x0)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0x1-ratio)[_0x22c1('0xc5')](this[_0x22c1('0x392')](0x2,0x1,0x0)[_0x22c1('0x8d')]()['multiplyScalar'](ratio)));this['_changeP'](0x1,0x0,0x1,this[_0x22c1('0x392')](0x0,0x0,0x1)['clone']()['multiplyScalar'](0x1-ratio)['add'](this[_0x22c1('0x392')](0x2,0x0,0x1)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](ratio)));this[_0x22c1('0x39b')](0x1,0x1,0x1,this[_0x22c1('0x392')](0x0,0x1,0x1)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0x1-ratio)['add'](this['_getP'](0x2,0x1,0x1)['clone']()['multiplyScalar'](ratio)));var YChange=intensity1*baseLineHeight;this['_addP'](0x0,0x1,0x1,new Vector3(0x0,YChange,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,YChange,0x0));this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,YChange,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,YChange,0x0));this['_addP'](0x2,0x1,0x0,new Vector3(0x0,YChange,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,YChange,0x0));}else if(pattern===0x6){var _y5=intensity*baseLineHeight;this['_addP'](0x0,0x1,0x0,new Vector3(0x0,_y5,0x0));this[_0x22c1('0x393')](0x0,0x1,0x1,new Vector3(0x0,_y5,0x0));this[_0x22c1('0x393')](0x2,0x1,0x0,new Vector3(0x0,-_y5,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,-_y5,0x0));var _leftLength=this['_getP'](0x0,0x1,0x0)[_0x22c1('0x107')](this[_0x22c1('0x392')](0x0,0x0,0x0));var _rightLength=this[_0x22c1('0x392')](0x2,0x1,0x0)[_0x22c1('0x107')](this['_getP'](0x2,0x0,0x0));var _ratio=_leftLength/(_leftLength+_rightLength);this['_changeP'](0x1,0x0,0x0,this[_0x22c1('0x392')](0x0,0x0,0x0)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0x1-_ratio)[_0x22c1('0xc5')](this[_0x22c1('0x392')](0x2,0x0,0x0)['clone']()[_0x22c1('0x6f')](_ratio)));this[_0x22c1('0x39b')](0x1,0x1,0x0,this['_getP'](0x0,0x1,0x0)['clone']()[_0x22c1('0x6f')](0x1-_ratio)[_0x22c1('0xc5')](this[_0x22c1('0x392')](0x2,0x1,0x0)['clone']()[_0x22c1('0x6f')](_ratio)));this[_0x22c1('0x39b')](0x1,0x0,0x1,this[_0x22c1('0x392')](0x0,0x0,0x1)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0x1-_ratio)['add'](this[_0x22c1('0x392')](0x2,0x0,0x1)[_0x22c1('0x8d')]()['multiplyScalar'](_ratio)));this[_0x22c1('0x39b')](0x1,0x1,0x1,this[_0x22c1('0x392')](0x0,0x1,0x1)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0x1-_ratio)[_0x22c1('0xc5')](this[_0x22c1('0x392')](0x2,0x1,0x1)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](_ratio)));var _YChange=intensity1*baseLineHeight;this[_0x22c1('0x393')](0x0,0x1,0x1,new Vector3(0x0,_YChange,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,_YChange,0x0));this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,_YChange,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,_YChange,0x0));this['_addP'](0x2,0x1,0x0,new Vector3(0x0,_YChange,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,_YChange,0x0));}else if(pattern===0x7){var x=intensity*maxLineWidth*0.5;this['_addP'](0x0,0x1,0x0,new Vector3(x,0x0,0x0));this[_0x22c1('0x393')](0x0,0x1,0x1,new Vector3(x,0x0,0x0));this['_addP'](0x2,0x1,0x0,new Vector3(-x,0x0,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(-x,0x0,0x0));this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(-x,0x0,0x0));this['_addP'](0x0,0x0,0x1,new Vector3(-x,0x0,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(x,0x0,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(x,0x0,0x0));}else if(pattern===0x8){var _x=intensity*maxLineWidth*0.5;this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(_x,0x0,0x0));this[_0x22c1('0x393')](0x0,0x0,0x1,new Vector3(_x,0x0,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(-_x,0x0,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(-_x,0x0,0x0));}else if(pattern===0x9){var _x2=intensity*baseLineHeight;var _y6=intensity1*maxLineWidth;this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(-_x2,_y6,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(_x2,_y6,0x0));this['_addP'](0x1,0x0,0x0,new Vector3(-_x2,0x0,0x0));this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(_x2,0x0,0x0));this[_0x22c1('0x393')](0x2,0x1,0x0,new Vector3(_x2,-_y6,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(-_x2,-_y6,0x0));this[_0x22c1('0x393')](0x0,0x0,0x1,new Vector3(-_x2,_y6,0x0));this[_0x22c1('0x393')](0x0,0x1,0x1,new Vector3(_x2,_y6,0x0));this[_0x22c1('0x393')](0x1,0x0,0x1,new Vector3(-_x2,0x0,0x0));this['_addP'](0x1,0x1,0x1,new Vector3(_x2,0x0,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(_x2,-_y6,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(-_x2,-_y6,0x0));}else if(pattern===0xa){var _y7=intensity*baseLineHeight*0.5;this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(0x0,_y7,0x0));this['_addP'](0x0,0x0,0x1,new Vector3(0x0,_y7,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,-_y7,0x0));this[_0x22c1('0x393')](0x0,0x1,0x1,new Vector3(0x0,-_y7,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(0x0,-_y7,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(0x0,-_y7,0x0));this['_addP'](0x2,0x1,0x0,new Vector3(0x0,_y7,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,_y7,0x0));var _leftLength2=this[_0x22c1('0x392')](0x0,0x1,0x0)['distanceTo'](this['_getP'](0x0,0x0,0x0));var _rightLength2=this['_getP'](0x2,0x1,0x0)[_0x22c1('0x107')](this[_0x22c1('0x392')](0x2,0x0,0x0));var _ratio2=_leftLength2/(_leftLength2+_rightLength2);this[_0x22c1('0x39b')](0x1,0x0,0x0,new Vector3()[_0x22c1('0x109')](this[_0x22c1('0x392')](0x0,0x0,0x0),this['_getP'](0x2,0x0,0x0),_ratio2));this['_changeP'](0x1,0x1,0x0,new Vector3()[_0x22c1('0x109')](this[_0x22c1('0x392')](0x0,0x1,0x0),this[_0x22c1('0x392')](0x2,0x1,0x0),_ratio2));this[_0x22c1('0x39b')](0x1,0x0,0x1,new Vector3()[_0x22c1('0x109')](this[_0x22c1('0x392')](0x0,0x0,0x1),this[_0x22c1('0x392')](0x2,0x0,0x1),_ratio2));this[_0x22c1('0x39b')](0x1,0x1,0x1,new Vector3()['lerpVectors'](this[_0x22c1('0x392')](0x0,0x1,0x1),this[_0x22c1('0x392')](0x2,0x1,0x1),_ratio2));var _YChange2=intensity1*baseLineHeight;this[_0x22c1('0x393')](0x0,0x1,0x1,new Vector3(0x0,_YChange2,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,_YChange2,0x0));this['_addP'](0x1,0x1,0x0,new Vector3(0x0,_YChange2,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,_YChange2,0x0));this[_0x22c1('0x393')](0x2,0x1,0x0,new Vector3(0x0,_YChange2,0x0));this['_addP'](0x2,0x1,0x1,new Vector3(0x0,_YChange2,0x0));}else if(pattern===0xe){var _x3=intensity*0x64;var _y8=intensity1*0x64;var XChange=this['XWidth']*0.5*_x3;var _YChange3=this[_0x22c1('0x39c')]*0.5*_y8;this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(-XChange,-_YChange3,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(-XChange,_YChange3,0x0));this['_addP'](0x1,0x0,0x0,new Vector3(0x0,-_YChange3,0x0));this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,_YChange3,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(XChange,-_YChange3,0x0));this[_0x22c1('0x393')](0x2,0x1,0x0,new Vector3(XChange,_YChange3,0x0));}else if(pattern===0xf){var _XChange=intensity*0x64;var _YChange4=intensity1*0x64;this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(_XChange,_YChange4,0x0));this['_addP'](0x0,0x1,0x0,new Vector3(_XChange,_YChange4,0x0));this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(_XChange,_YChange4,0x0));this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(_XChange,_YChange4,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(_XChange,_YChange4,0x0));this[_0x22c1('0x393')](0x2,0x1,0x0,new Vector3(_XChange,_YChange4,0x0));}else if(pattern===0x10){var _y9=intensity*maxLineWidth;var y1=intensity1*maxLineWidth;this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(0x0,-y1,0x0));this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(0x0,y1,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(0x0,-y1,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,-_y9,0x0));this['_addP'](0x1,0x1,0x0,new Vector3(0x0,_y9,0x0));this['_addP'](0x2,0x1,0x0,new Vector3(0x0,-_y9,0x0));this[_0x22c1('0x393')](0x0,0x0,0x1,new Vector3(0x0,-y1,0x0));this[_0x22c1('0x393')](0x1,0x0,0x1,new Vector3(0x0,y1,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(0x0,-y1,0x0));this['_addP'](0x0,0x1,0x1,new Vector3(0x0,-_y9,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,_y9,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,-_y9,0x0));}else if(pattern===tag+0x1){var _y10=intensity*baseLineHeight;this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,_y10,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,_y10,0x0));this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(0x0,_y10,0x0));this[_0x22c1('0x393')](0x1,0x0,0x1,new Vector3(0x0,_y10,0x0));this['_addP'](0x2,0x1,0x0,new Vector3(0x0,-_y10,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,-_y10,0x0));this[_0x22c1('0x393')](0x2,0x0,0x0,new Vector3(0x0,-_y10,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(0x0,-_y10,0x0));}else if(pattern===tag+0x2){var _y11=intensity*baseLineHeight;if(_y11>0x0)_y11=_y11*0.5;this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,-_y11,0x0));this['_addP'](0x0,0x1,0x1,new Vector3(0x0,-_y11,0x0));this['_addP'](0x0,0x0,0x0,new Vector3(0x0,_y11,0x0));this[_0x22c1('0x393')](0x0,0x0,0x1,new Vector3(0x0,_y11,0x0));this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,_y11,0x0));this['_addP'](0x1,0x1,0x1,new Vector3(0x0,_y11,0x0));this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(0x0,-_y11,0x0));this[_0x22c1('0x393')](0x1,0x0,0x1,new Vector3(0x0,-_y11,0x0));this[_0x22c1('0x393')](0x2,0x1,0x0,new Vector3(0x0,_y11,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,_y11,0x0));this['_addP'](0x2,0x0,0x0,new Vector3(0x0,-_y11,0x0));this[_0x22c1('0x393')](0x2,0x0,0x1,new Vector3(0x0,-_y11,0x0));this[_0x22c1('0x393')](0x3,0x1,0x0,new Vector3(0x0,-_y11,0x0));this['_addP'](0x3,0x1,0x1,new Vector3(0x0,-_y11,0x0));this[_0x22c1('0x393')](0x3,0x0,0x0,new Vector3(0x0,_y11,0x0));this[_0x22c1('0x393')](0x3,0x0,0x1,new Vector3(0x0,_y11,0x0));}else if(pattern===tag1+0x1){var _y12=intensity*baseLineHeight;this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(0x0,_y12,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,_y12,0x0));this[_0x22c1('0x393')](0x1,0x2,0x0,new Vector3(0x0,_y12,0x0));this['_addP'](0x1,0x2,0x1,new Vector3(0x0,_y12,0x0));this[_0x22c1('0x393')](0x2,0x1,0x0,new Vector3(0x0,-_y12,0x0));this[_0x22c1('0x393')](0x2,0x1,0x1,new Vector3(0x0,-_y12,0x0));this[_0x22c1('0x393')](0x2,0x2,0x0,new Vector3(0x0,-_y12,0x0));this['_addP'](0x2,0x2,0x1,new Vector3(0x0,-_y12,0x0));}else if(pattern===tag3+0x2){var _x4=intensity*maxLineWidth*0.5;this[_0x22c1('0x393')](0x0,0x2,0x0,new Vector3(_x4,0x0,0x0));this[_0x22c1('0x393')](0x0,0x2,0x1,new Vector3(_x4,0x0,0x0));this[_0x22c1('0x393')](0x1,0x2,0x0,new Vector3(-_x4,0x0,0x0));this['_addP'](0x1,0x2,0x1,new Vector3(-_x4,0x0,0x0));this[_0x22c1('0x393')](0x0,0x0,0x0,new Vector3(-_x4,0x0,0x0));this[_0x22c1('0x393')](0x0,0x0,0x1,new Vector3(-_x4,0x0,0x0));this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(_x4,0x0,0x0));this['_addP'](0x1,0x0,0x1,new Vector3(_x4,0x0,0x0));var topLength=this[_0x22c1('0x392')](0x0,0x2,0x0)[_0x22c1('0x107')](this[_0x22c1('0x392')](0x1,0x2,0x0));var bottomLength=this['_getP'](0x0,0x0,0x0)['distanceTo'](this[_0x22c1('0x392')](0x1,0x0,0x0));var _ratio3=topLength/(topLength+bottomLength);this[_0x22c1('0x39b')](0x0,0x1,0x0,this[_0x22c1('0x392')](0x0,0x2,0x0)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0x1-_ratio3)[_0x22c1('0xc5')](this[_0x22c1('0x392')](0x0,0x0,0x0)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](_ratio3)));this[_0x22c1('0x39b')](0x1,0x1,0x0,this[_0x22c1('0x392')](0x1,0x2,0x0)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0x1-_ratio3)[_0x22c1('0xc5')](this[_0x22c1('0x392')](0x1,0x0,0x0)['clone']()['multiplyScalar'](_ratio3)));this[_0x22c1('0x39b')](0x0,0x1,0x1,this[_0x22c1('0x392')](0x0,0x2,0x1)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](0x1-_ratio3)[_0x22c1('0xc5')](this[_0x22c1('0x392')](0x0,0x0,0x1)['clone']()[_0x22c1('0x6f')](_ratio3)));this[_0x22c1('0x39b')](0x1,0x1,0x1,this[_0x22c1('0x392')](0x1,0x2,0x1)['clone']()[_0x22c1('0x6f')](0x1-_ratio3)['add'](this[_0x22c1('0x392')](0x1,0x0,0x1)[_0x22c1('0x8d')]()[_0x22c1('0x6f')](_ratio3)));var _YChange5=intensity1*baseLineHeight;this[_0x22c1('0x393')](0x0,0x2,0x1,new Vector3(0x0,_YChange5,0x0));this[_0x22c1('0x393')](0x0,0x2,0x0,new Vector3(0x0,_YChange5,0x0));this[_0x22c1('0x393')](0x1,0x2,0x0,new Vector3(0x0,_YChange5,0x0));this[_0x22c1('0x393')](0x1,0x2,0x1,new Vector3(0x0,_YChange5,0x0));this[_0x22c1('0x393')](0x0,0x1,0x1,new Vector3(0x0,0.5*_YChange5,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,0.5*_YChange5,0x0));this['_addP'](0x1,0x1,0x0,new Vector3(0x0,0.5*_YChange5,0x0));this['_addP'](0x1,0x1,0x1,new Vector3(0x0,0.5*_YChange5,0x0));}else if(pattern===tag4+0x1){var _XChange2=intensity*maxLineWidth;this[_0x22c1('0x393')](0x1,0x0,0x0,new Vector3(_XChange2,0x0,0x0));this[_0x22c1('0x393')](0x1,0x0,0x1,new Vector3(_XChange2,0x0,0x0));this[_0x22c1('0x393')](0x1,0x1,0x0,new Vector3(_XChange2,0x0,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(_XChange2,0x0,0x0));}else if(pattern===tag4+0x2){var _YChange6=intensity*baseLineHeight;this[_0x22c1('0x393')](0x0,0x1,0x1,new Vector3(0x0,_YChange6,0x0));this[_0x22c1('0x393')](0x0,0x1,0x0,new Vector3(0x0,_YChange6,0x0));this['_addP'](0x1,0x1,0x0,new Vector3(0x0,_YChange6,0x0));this[_0x22c1('0x393')](0x1,0x1,0x1,new Vector3(0x0,_YChange6,0x0));}this[_0x22c1('0x39d')](bufferGeometry,basisType);}}]);return FFD;}();function _createSuper$f(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$f();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$f(){if(typeof Reflect===_0x22c1('0x0')||!Reflect[_0x22c1('0x2fb')])return![];if(Reflect[_0x22c1('0x2fb')][_0x22c1('0x2fc')])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean[_0x22c1('0x1')]['valueOf'][_0x22c1('0x2')](Reflect[_0x22c1('0x2fb')](Boolean,[],function(){}));return!![];}catch(_0x26afdf){return![];}}var FFDForPaths=function(_TransformForPaths){_inherits(FFDForPaths,_TransformForPaths);var _super=_createSuper$f(FFDForPaths);function FFDForPaths(){_classCallCheck(this,FFDForPaths);return _super[_0x22c1('0x7')](this,arguments);}_createClass(FFDForPaths,[{'key':'creatFFDControlPoints','value':function creatFFDControlPoints(boundingBox,addPointInX,addPointInY){var min=boundingBox[_0x22c1('0x54')],max=boundingBox['max'],width=boundingBox['width'],height=boundingBox['height'];var controlPoints=[];if(this[_0x22c1('0x380')]){var dx=width/(addPointInX+0x1);var dy=height/(addPointInY+0x1);for(var i=0x0;i<addPointInX+0x2;i++){for(var j=0x0;j<addPointInY+0x2;j++){var controlPoint=new Vector2(min['x']+i*dx,min['y']+j*dy);controlPoints[_0x22c1('0x2e')](controlPoint);}}}else{var _dx=width/(addPointInY+0x1);var _dy=height/(addPointInX+0x1);for(var _i=0x0;_i<addPointInX+0x2;_i++){for(var _j=0x0;_j<addPointInY+0x2;_j++){var _controlPoint=new Vector2(max['x']-_j*_dx,min['y']+_i*_dy);controlPoints['push'](_controlPoint);}}}return controlPoints;}},{'key':'adjustControlPoints','value':function adjustControlPoints(point,vec){var x=vec['x'],y=vec['y'];if(this[_0x22c1('0x380')]){point['x']+=x;point['y']+=y;}else{point['x']-=y;point['y']+=x;}}},{'key':_0x22c1('0x39e'),'value':function factorialForFFD(n){var result=0x1;for(var i=0x2;i<=n;i++){result*=i;}return result;}},{'key':_0x22c1('0x39f'),'value':function combineForFFD(N,M){var a=this[_0x22c1('0x39e')](N)/this[_0x22c1('0x39e')](N-M)/this['factorialForFFD'](M);return a;}},{'key':_0x22c1('0x3a0'),'value':function caculateForBezierFFD(paths,boundingBox,controlPoints,addPointInX,addPointInY){var _this=this;var getWeight=function getWeight(addPointInX,i,s){return _this[_0x22c1('0x39f')](addPointInX+0x1,i)*Math['pow'](0x1-s,addPointInX+0x1-i)*Math[_0x22c1('0x57')](s,i);};this[_0x22c1('0x3a1')](getWeight,paths,boundingBox,controlPoints,addPointInX,addPointInY);}},{'key':_0x22c1('0x3a2'),'value':function linearBasis(l,i,s){var k=i<s*l?i+0x1-s*l:s*l-i+0x1;return Math[_0x22c1('0x53')](0x0,k);}},{'key':'caculateForLinearFFD','value':function caculateForLinearFFD(paths,boundingBox,controlPoints,addPointInX,addPointInY){var _this2=this;var getWeight=function getWeight(addPointInX,i,s){return _this2['linearBasis'](addPointInX+0x1,i,s);};this[_0x22c1('0x3a1')](getWeight,paths,boundingBox,controlPoints,addPointInX,addPointInY);}},{'key':'caculateForFFD','value':function caculateForFFD(getWeight,paths,boundingBox,controlPoints,addPointInX,addPointInY){var min=boundingBox['min'],max=boundingBox['max'],width=boundingBox[_0x22c1('0x287')],height=boundingBox[_0x22c1('0x1cc')];var funcPerCurve;if(this[_0x22c1('0x380')]){funcPerCurve=function funcPerCurve(point){var kx=(point['x']-min['x'])/width;var ky=(point['y']-min['y'])/height;var sumOfX=0x0,sumOfY=0x0;for(var i=0x0;i<addPointInX+0x2;i++){var sOfV=getWeight(addPointInX,i,kx);for(var j=0x0;j<addPointInY+0x2;j++){var tOfV=getWeight(addPointInY,j,ky);var controlPoint=controlPoints[i*(addPointInY+0x2)+j];sumOfX+=sOfV*tOfV*controlPoint['x'];sumOfY+=sOfV*tOfV*controlPoint['y'];}}point[_0x22c1('0x5e')](sumOfX,sumOfY);};}else{funcPerCurve=function funcPerCurve(point){var kx=(max['x']-point['x'])/width;var ky=(point['y']-min['y'])/height;var sumOfX=0x0,sumOfY=0x0;for(var i=0x0;i<addPointInX+0x2;i++){var sOfV=getWeight(addPointInX,i,ky);for(var j=0x0;j<addPointInY+0x2;j++){var tOfV=getWeight(addPointInY,j,kx);var controlPoint=controlPoints[i*(addPointInY+0x2)+j];sumOfX+=sOfV*tOfV*controlPoint['x'];sumOfY+=sOfV*tOfV*controlPoint['y'];}}point['set'](sumOfX,sumOfY);};}this[_0x22c1('0x385')](funcPerCurve);}},{'key':'transform','value':function transform(paths,_ref){var type=_ref['type'],intensitys=_ref['intensitys'],_ref$maxFontSize=_ref[_0x22c1('0x3a3')],maxFontSize=_ref$maxFontSize===void 0x0?0x64:_ref$maxFontSize,charPosDatas=_ref[_0x22c1('0x37e')],_ref$writingMode=_ref['writingMode'],writingMode=_ref$writingMode===void 0x0?_0x22c1('0x3a4'):_ref$writingMode;_get(_getPrototypeOf(FFDForPaths[_0x22c1('0x1')]),'transform',this)['call'](this,paths,{'intensitys':intensitys,'maxFontSize':maxFontSize,'charPosDatas':charPosDatas,'writingMode':writingMode});if(Math[_0x22c1('0x106')][_0x22c1('0x7')](Math,_toConsumableArray(intensitys))>0x0){var MAXANGLE=Math['PI']/0x3;var baseHeight=this[_0x22c1('0x382')],baseWidth=this['baseWidth'],boundingBox=this['boundingBox'],isHorizontal=this[_0x22c1('0x380')];var _this$intensitys=_slicedToArray(this[_0x22c1('0x37f')],0x2),intensity1=_this$intensitys[0x0],intensity2=_this$intensitys[0x1];var isNeedToBreak=![];var needToBreakTypes=[_0x22c1('0x3a5'),_0x22c1('0x3a6'),_0x22c1('0x3a7'),_0x22c1('0x3a8'),_0x22c1('0x3a9'),_0x22c1('0x3aa')];if(needToBreakTypes['find'](function(name){return name===type;})){isNeedToBreak=!![];}if(isNeedToBreak){this[_0x22c1('0x374')](paths,this[_0x22c1('0x1e4')],!isHorizontal);}if(/Curve$/[_0x22c1('0x149')](type)){this[_0x22c1('0x37b')](paths);}var controlPoints,diviation1,diviation2,k,vec;var addPointInX=0x0;var addPointInY=0x0;var needToSmooth=![];switch(type){case _0x22c1('0x3ab'):needToSmooth=!![];diviation1=0.05/maxFontSize*baseWidth*baseWidth*intensity1;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);vec=new Vector2(0x0,-diviation1);this['adjustControlPoints'](controlPoints[0x2],vec);this[_0x22c1('0x3ad')](controlPoints[0x3],vec);break;case _0x22c1('0x3ae'):needToSmooth=!![];diviation1=baseHeight*intensity1;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(0x0,-diviation1));this[_0x22c1('0x3ad')](controlPoints[0x2],new Vector2(0x0,0x2*diviation1));this[_0x22c1('0x3ad')](controlPoints[0x4],new Vector2(0x0,-diviation1));this['adjustControlPoints'](controlPoints[0x1],new Vector2(0x0,diviation1));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(0x0,-0x2*diviation1));this[_0x22c1('0x3ad')](controlPoints[0x5],new Vector2(0x0,diviation1));break;case _0x22c1('0x3af'):needToSmooth=!![];diviation1=(intensity1>0x0?0.5*baseWidth:0x2*baseHeight)*intensity1;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x2],new Vector2(0x0,-diviation1));break;case _0x22c1('0x3b0'):needToSmooth=!![];controlPoints=this['creatFFDControlPoints'](boundingBox,addPointInX,addPointInY);diviation1=(intensity1>0x0?0.5*baseWidth:0x2*baseHeight)*intensity1;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(0x0,+diviation1));break;case _0x22c1('0x3b1'):needToSmooth=!![];diviation1=-baseHeight*intensity1;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this['adjustControlPoints'](controlPoints[0x0],new Vector2(0x0,-0.5*diviation1));this[_0x22c1('0x3ad')](controlPoints[0x2],new Vector2(0x0,0x2*diviation1));this[_0x22c1('0x3ad')](controlPoints[0x4],new Vector2(0x0,-0.5*diviation1));this['adjustControlPoints'](controlPoints[0x1],new Vector2(0x0,0.5*diviation1));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(0x0,-0x2*diviation1));this[_0x22c1('0x3ad')](controlPoints[0x5],new Vector2(0x0,0.5*diviation1));break;case'skew':needToSmooth=![];addPointInX=0x0;addPointInY=0x0;controlPoints=this['creatFFDControlPoints'](boundingBox,addPointInX,addPointInY);diviation1=baseHeight*Math[_0x22c1('0x384')](intensity1*MAXANGLE);diviation2=baseWidth*Math[_0x22c1('0x384')](intensity2*MAXANGLE);this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(diviation1,0x0));this[_0x22c1('0x3ad')](controlPoints[0x2],new Vector2(diviation1,-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(0x0,-diviation2));break;case _0x22c1('0x3aa'):needToSmooth=!![];diviation1=0.5*baseWidth*intensity1;addPointInX=0x3;addPointInY=0x0;controlPoints=this['creatFFDControlPoints'](boundingBox,addPointInX,addPointInY);this['adjustControlPoints'](controlPoints[0x2],new Vector2(0x0,-diviation1));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(0x0,-diviation1));this[_0x22c1('0x3ad')](controlPoints[0x6],new Vector2(0x0,diviation1));this[_0x22c1('0x3ad')](controlPoints[0x7],new Vector2(0x0,diviation1));break;case _0x22c1('0x3b2'):needToSmooth=!![];diviation1=0.25*baseWidth*intensity1;diviation2=0.5*baseHeight*intensity2;k=0.5*(intensity1+0x1);addPointInX=0x0;addPointInY=0x1;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(+diviation1,-diviation2));this['adjustControlPoints'](controlPoints[0x2],new Vector2(-diviation1,+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(-diviation1,-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x5],new Vector2(+diviation1,+diviation2));controlPoints[0x1]=new Vector2()['lerpVectors'](controlPoints[0x2],controlPoints[0x0],k);controlPoints[0x4]=new Vector2()['lerpVectors'](controlPoints[0x5],controlPoints[0x3],k);break;case _0x22c1('0x3b3'):needToSmooth=!![];diviation1=baseWidth*Math[_0x22c1('0x384')](intensity1*MAXANGLE);diviation2=baseHeight*intensity2;k=0.5*(intensity1+0x1);addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this['adjustControlPoints'](controlPoints[0x0],new Vector2(0x0,-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x4],new Vector2(0x0,-diviation2));this[_0x22c1('0x3ad')](controlPoints[intensity1>0x0?0x1:0x5],new Vector2(0x0,+Math[_0x22c1('0x69')](diviation1)));controlPoints[0x2]=new Vector2()[_0x22c1('0x109')](controlPoints[0x0],controlPoints[0x4],k);controlPoints[0x3]=new Vector2()[_0x22c1('0x109')](controlPoints[0x1],controlPoints[0x5],k);break;case'topTrapezoid':needToSmooth=!![];diviation1=baseWidth*Math[_0x22c1('0x384')](intensity1*MAXANGLE);diviation2=baseHeight*intensity2;k=0.5*(intensity1+0x1);addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this['adjustControlPoints'](controlPoints[0x1],new Vector2(0x0,+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x5],new Vector2(0x0,+diviation2));this[_0x22c1('0x3ad')](controlPoints[intensity1>0x0?0x4:0x0],new Vector2(0x0,-Math[_0x22c1('0x69')](diviation1)));controlPoints[0x2]=new Vector2()[_0x22c1('0x109')](controlPoints[0x4],controlPoints[0x0],k);controlPoints[0x3]=new Vector2()[_0x22c1('0x109')](controlPoints[0x5],controlPoints[0x1],k);break;case'horizontalTrapezoid':needToSmooth=!![];diviation1=0.5*baseWidth*Math['tan'](intensity1*MAXANGLE);diviation2=0.5*baseHeight*intensity2;k=0.5+intensity1*0.5;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[intensity1>0x0?0x0:0x4],new Vector2(0x0,-Math[_0x22c1('0x2d7')](intensity1)*diviation1));this['adjustControlPoints'](controlPoints[intensity1>0x0?0x1:0x5],new Vector2(0x0,+Math[_0x22c1('0x2d7')](intensity1)*diviation1));this['adjustControlPoints'](controlPoints[0x0],new Vector2(0x0,-diviation2));this['adjustControlPoints'](controlPoints[0x1],new Vector2(0x0,+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x4],new Vector2(0x0,-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x5],new Vector2(0x0,+diviation2));controlPoints[0x2]=new Vector2()[_0x22c1('0x109')](controlPoints[0x0],controlPoints[0x4],k);controlPoints[0x3]=new Vector2()[_0x22c1('0x109')](controlPoints[0x1],controlPoints[0x5],k);break;case'bevel':needToSmooth=![];diviation1=0.5*baseWidth*Math[_0x22c1('0x384')](intensity1*MAXANGLE);diviation2=0.5*baseHeight*intensity2;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(0x0,-diviation2));this['adjustControlPoints'](controlPoints[0x2],new Vector2(0x0,-diviation1-diviation2));this['adjustControlPoints'](controlPoints[0x4],new Vector2(0x0,-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x1],new Vector2(0x0,+diviation2));this['adjustControlPoints'](controlPoints[0x3],new Vector2(0x0,-diviation1+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x5],new Vector2(0x0,+diviation2));break;case _0x22c1('0x3a6'):needToSmooth=![];diviation1=0.5*baseWidth*Math[_0x22c1('0x384')](intensity1*MAXANGLE);diviation2=baseHeight*intensity2;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(0x0,+intensity1*baseHeight-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x2],new Vector2(0x0,-diviation1-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x4],new Vector2(0x0,+intensity1*baseHeight-diviation2));break;case _0x22c1('0x3a7'):needToSmooth=![];diviation1=0.5*baseWidth*Math['tan'](intensity1*MAXANGLE);diviation2=baseHeight*intensity2;addPointInX=0x1;addPointInY=0x0;controlPoints=this['creatFFDControlPoints'](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x1],new Vector2(0x0,-intensity1*baseHeight+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(0x0,+diviation1+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x5],new Vector2(0x0,-intensity1*baseHeight+diviation2));break;case _0x22c1('0x3a8'):needToSmooth=![];diviation1=0.5*baseWidth*Math['tan'](intensity1*0.5*MAXANGLE);diviation2=0.5*baseHeight*intensity2;addPointInX=0x1;addPointInY=0x0;controlPoints=this['creatFFDControlPoints'](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(0x0,+0.5*diviation1-diviation2));this['adjustControlPoints'](controlPoints[0x2],new Vector2(0x0,-0x2*diviation1-diviation2));this['adjustControlPoints'](controlPoints[0x4],new Vector2(0x0,0.5*diviation1-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x1],new Vector2(0x0,-0.5*diviation1+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(0x0,0x2*diviation1+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x5],new Vector2(0x0,-0.5*diviation1+diviation2));break;case _0x22c1('0x3a9'):needToSmooth=![];diviation1=0.5*baseWidth*Math[_0x22c1('0x384')](intensity1*0.5*MAXANGLE);diviation2=0.5*baseHeight*intensity2;addPointInX=0x1;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(0x0,-diviation1-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x2],new Vector2(0x0,+0.5*diviation1-diviation2));this[_0x22c1('0x3ad')](controlPoints[0x4],new Vector2(0x0,-diviation1-diviation2));this['adjustControlPoints'](controlPoints[0x1],new Vector2(0x0,+diviation1+diviation2));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(0x0,-0.5*diviation1+diviation2));this['adjustControlPoints'](controlPoints[0x5],new Vector2(0x0,+diviation1+diviation2));break;case _0x22c1('0x3b4'):needToSmooth=![];addPointInX=0x0;addPointInY=0x0;controlPoints=this['creatFFDControlPoints'](boundingBox,addPointInX,addPointInY);diviation1=0.5*baseWidth*intensity1;this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(-diviation1,0x0));this[_0x22c1('0x3ad')](controlPoints[0x2],new Vector2(diviation1,0x0));this[_0x22c1('0x3ad')](controlPoints[0x1],new Vector2(-diviation1,0x0));this[_0x22c1('0x3ad')](controlPoints[0x3],new Vector2(diviation1,0x0));break;case'verticalStretching':needToSmooth=![];addPointInX=0x0;addPointInY=0x0;controlPoints=this[_0x22c1('0x3ac')](boundingBox,addPointInX,addPointInY);diviation1=0.5*baseHeight*intensity1;this[_0x22c1('0x3ad')](controlPoints[0x0],new Vector2(0x0,-diviation1));this[_0x22c1('0x3ad')](controlPoints[0x2],new Vector2(0x0,-diviation1));this[_0x22c1('0x3ad')](controlPoints[0x1],new Vector2(0x0,+diviation1));this['adjustControlPoints'](controlPoints[0x3],new Vector2(0x0,+diviation1));break;}if(needToSmooth){this[_0x22c1('0x3a0')](paths,boundingBox,controlPoints,addPointInX,addPointInY);this[_0x22c1('0x379')](paths);}else{this['caculateForLinearFFD'](paths,boundingBox,controlPoints,addPointInX,addPointInY);}}return this[_0x22c1('0x3b5')](paths);}}]);return FFDForPaths;}(TransformForPaths);var TWIST=function(){function TWIST(){_classCallCheck(this,TWIST);}_createClass(TWIST,[{'key':'runPattern','value':function runPattern(bufferGeometry,options){var axis,angle;if(options[_0x22c1('0x396')]==='0'){axis=new Vector3(0x1,0x0,0x0);angle=Math['PI']/0x4;}else if(options['pattern']==='1'){axis=new Vector3(0x0,0x1,0x0);angle=Math['PI']/0x4;}else if(options[_0x22c1('0x396')]==='2'){axis=new Vector3(0x0,0x0,0x1);angle=Math['PI']/0x4;}var controlPointMesh=this[_0x22c1('0x361')](bufferGeometry,axis,angle,options[_0x22c1('0x3b6')]);return controlPointMesh;}},{'key':_0x22c1('0x361'),'value':function RUN(bufferGeometry,axis,angle,intensity){if(intensity===0x0)return;axis[_0x22c1('0x6a')]();var meshGeometryBoundingBoxMaxx=0x0;var meshGeometryBoundingBoxMinx=0x0;var meshGeometryBoundingBoxMaxy=0x0;var meshGeometryBoundingBoxMiny=0x0;var meshGeometryBoundingBoxMaxz=0x0;var meshGeometryBoundingBoxMinz=0x0;var positions=bufferGeometry['attributes']['position'][_0x22c1('0x1e9')];var vertexNumb=parseInt(positions['length']/0x3);for(var i=0x0;i<vertexNumb;i++){var vertex=new Vector3();vertex[_0x22c1('0xa0')](positions,i*0x3);if(vertex['x']>meshGeometryBoundingBoxMaxx){meshGeometryBoundingBoxMaxx=vertex['x'];}if(vertex['x']<meshGeometryBoundingBoxMinx){meshGeometryBoundingBoxMinx=vertex['x'];}if(vertex['y']>meshGeometryBoundingBoxMaxy){meshGeometryBoundingBoxMaxy=vertex['y'];}if(vertex['y']<meshGeometryBoundingBoxMiny){meshGeometryBoundingBoxMiny=vertex['y'];}if(vertex['z']>meshGeometryBoundingBoxMaxz){meshGeometryBoundingBoxMaxz=vertex['z'];}if(vertex['z']<meshGeometryBoundingBoxMinz){meshGeometryBoundingBoxMinz=vertex['z'];}}var center=new Vector3(0.5*(meshGeometryBoundingBoxMinx+meshGeometryBoundingBoxMaxx),0.5*(meshGeometryBoundingBoxMiny+meshGeometryBoundingBoxMaxy),0.5*(meshGeometryBoundingBoxMinz+meshGeometryBoundingBoxMaxz));var matrix=new Matrix4();for(var _i=0x0;_i<vertexNumb;_i++){var _vertex=new Vector3();_vertex[_0x22c1('0xa0')](positions,_i*0x3);var projectedAxis=_vertex['clone']()[_0x22c1('0xab')](center)[_0x22c1('0x9c')](axis);var newAngle=0.01*projectedAxis*angle*intensity;matrix[_0x22c1('0x7e')](axis,newAngle);var finalPos=_vertex[_0x22c1('0x8d')]()[_0x22c1('0xab')](center)[_0x22c1('0xb7')](matrix)['add'](center);positions[_i*0x3+0x0]=finalPos['x'];positions[_i*0x3+0x1]=finalPos['y'];positions[_i*0x3+0x2]=finalPos['z'];}}}]);return TWIST;}();var Verbatim=function(){function Verbatim(){_classCallCheck(this,Verbatim);}_createClass(Verbatim,[{'key':_0x22c1('0x361'),'value':function RUN(bufferGeometry,parameters){if(parameters[_0x22c1('0x3b6')]===0x0)return;if(parameters[_0x22c1('0x396')]==='0'||parameters[_0x22c1('0x396')]==='1'||parameters[_0x22c1('0x396')]==='2'){this[_0x22c1('0x3b7')](bufferGeometry,parameters);}else if(parameters[_0x22c1('0x396')]==='10'||parameters[_0x22c1('0x396')]==='11'||parameters[_0x22c1('0x396')]==='12'){this[_0x22c1('0x3b8')](bufferGeometry,parameters);}else if(parameters[_0x22c1('0x396')]==='20'||parameters[_0x22c1('0x396')]==='21'||parameters[_0x22c1('0x396')]==='22'){this[_0x22c1('0x3b9')](bufferGeometry,parameters);}else if(parameters[_0x22c1('0x396')]==='30'||parameters[_0x22c1('0x396')]==='31'||parameters[_0x22c1('0x396')]==='32'){this[_0x22c1('0x3ba')](bufferGeometry,parameters);}else if(parameters['pattern']==='40'){this[_0x22c1('0x3bb')](bufferGeometry,parameters);}else if(parameters[_0x22c1('0x396')]==='50'||parameters['pattern']==='51'){this[_0x22c1('0x3bc')](bufferGeometry,parameters);}else if(parameters[_0x22c1('0x396')]==='60'||parameters[_0x22c1('0x396')]==='61'){this['runPattern6'](bufferGeometry,parameters);}else if(parameters[_0x22c1('0x396')]==='70'||parameters[_0x22c1('0x396')]==='71'){this['runPattern7'](bufferGeometry,parameters);}else if(parameters[_0x22c1('0x396')]==='80'){this[_0x22c1('0x3bd')](bufferGeometry,parameters);}else if(parameters['pattern']==='90'){this['runPattern9'](bufferGeometry,parameters);}}},{'key':'runPattern0','value':function runPattern0(bufferGeometry,parameters){var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')]['array'];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var offset=new Vector3();if(parameters[_0x22c1('0x396')]==='0'){offset['x']=parameters[_0x22c1('0x3b6')];}else if(parameters[_0x22c1('0x396')]==='1'){offset['y']=parameters['intensity'];}else if(parameters[_0x22c1('0x396')]==='2'){offset['z']=parameters[_0x22c1('0x3b6')];}var tempVect=new Vector3();for(var i=0x0;i<vertexNumb;i++){tempVect[_0x22c1('0xa0')](positions,i*0x3);var charID=bufferGeometry[_0x22c1('0x212')][i];if(charID%0x2===0x0){tempVect[_0x22c1('0xc5')](offset);}else{tempVect[_0x22c1('0xab')](offset);}positions[i*0x3+0x0]=tempVect['x'];positions[i*0x3+0x1]=tempVect['y'];positions[i*0x3+0x2]=tempVect['z'];}}},{'key':_0x22c1('0x3b8'),'value':function runPattern1(bufferGeometry,parameters){var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')];var vertexNumb=Math[_0x22c1('0x3be')](positions[_0x22c1('0x32')]/0x3);var _this$PerCharCalculat=this[_0x22c1('0x3bf')](bufferGeometry,parameters),charCenterArrayT=_this$PerCharCalculat['charCenterArrayT'];var intensity=parameters[_0x22c1('0x3b6')],pattern=parameters[_0x22c1('0x396')],maxLineWidth=parameters[_0x22c1('0x399')];var offset=new Vector3();switch(pattern){case'10':offset['x']=0x1;break;case'11':offset['y']=0x1;break;case'12':offset['z']=0x1;break;}var tempVect=new Vector3();for(var i=0x0;i<vertexNumb;i++){tempVect['fromArray'](positions,i*0x3);var charID=bufferGeometry[_0x22c1('0x212')][i];var scale=charCenterArrayT[charID]*0.01*intensity*maxLineWidth;tempVect[_0x22c1('0xc5')](offset[_0x22c1('0x8d')]()['multiplyScalar'](scale));positions[i*0x3+0x0]=tempVect['x'];positions[i*0x3+0x1]=tempVect['y'];positions[i*0x3+0x2]=tempVect['z'];}}},{'key':'runPattern2','value':function runPattern2(bufferGeometry,parameters){var _this$PerCharCalculat2=this[_0x22c1('0x3bf')](bufferGeometry,parameters),charCenterArrayT=_this$PerCharCalculat2[_0x22c1('0x214')];var intensity=parameters[_0x22c1('0x3b6')],pattern=parameters['pattern'],maxLineWidth=parameters[_0x22c1('0x399')];var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')];var vertexNumb=Math[_0x22c1('0x3be')](positions[_0x22c1('0x32')]/0x3);var offset=new Vector3();var val=intensity*0.002*maxLineWidth;switch(pattern){case'20':offset['x']=val;break;case'21':offset['y']=val;break;case'22':offset['z']=val;break;}for(var i=0x0;i<vertexNumb;i++){var charID=bufferGeometry['charVertexFlagArray'][i];var charIDT=charCenterArrayT[charID];var newOffset=offset['clone']();newOffset[_0x22c1('0x6f')](Math['sin'](charIDT*Math['PI']));positions[i*0x3+0x0]+=newOffset['x'];positions[i*0x3+0x1]+=newOffset['y'];positions[i*0x3+0x2]+=newOffset['z'];}}},{'key':_0x22c1('0x3ba'),'value':function runPattern3(bufferGeometry,parameters){var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var _this$PerCharCalculat3=this['PerCharCalculation'](bufferGeometry,parameters),charCenterArrayT=_this$PerCharCalculat3['charCenterArrayT'];var offset=new Vector3();if(parameters[_0x22c1('0x396')]==='30'){offset['x']=parameters['intensity'];}else if(parameters[_0x22c1('0x396')]==='31'){offset['y']=parameters[_0x22c1('0x3b6')];}else if(parameters[_0x22c1('0x396')]==='32'){offset['z']=parameters[_0x22c1('0x3b6')];}for(var i=0x0;i<vertexNumb;i++){var charID=bufferGeometry[_0x22c1('0x212')][i];var charIDT=charCenterArrayT[charID];var finalOffset=offset[_0x22c1('0x8d')]()[_0x22c1('0x6f')](Math[_0x22c1('0x7c')](charIDT*Math['PI']*0x2));positions[i*0x3+0x0]+=finalOffset['x'];positions[i*0x3+0x1]+=finalOffset['y'];positions[i*0x3+0x2]+=finalOffset['z'];}}},{'key':'runPattern4','value':function runPattern4(bufferGeometry,parameters){var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var scale=0.1;var offsetArray=[];var tempVect=new Vector3();for(var i=0x0;i<vertexNumb;i++){tempVect['fromArray'](positions,i*0x3);var charID=bufferGeometry[_0x22c1('0x212')][i];if(offsetArray[charID]===undefined){var offset=new Vector3();offset['y']=(Math['random']()*0x2-0x1)*parameters['intensity']*scale;offset['z']=(Math[_0x22c1('0x51')]()*0x2-0x1)*parameters[_0x22c1('0x3b6')]*scale;offsetArray[charID]=offset;}tempVect[_0x22c1('0xc5')](offsetArray[charID]);positions[i*0x3+0x0]=tempVect['x'];positions[i*0x3+0x1]=tempVect['y'];positions[i*0x3+0x2]=tempVect['z'];}}},{'key':_0x22c1('0x3bc'),'value':function runPattern5(bufferGeometry,parameters){var positions=bufferGeometry['attributes'][_0x22c1('0xee')][_0x22c1('0x1e9')];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var _this$PerCharCalculat4=this[_0x22c1('0x3bf')](bufferGeometry,parameters),charCenterArray=_this$PerCharCalculat4[_0x22c1('0x213')];var tempVect=new Vector3();var rotateAxis=new Vector3(0x0,0x1,0x0);if(parameters[_0x22c1('0x396')]==='50'){rotateAxis=new Vector3(0x0,0x1,0x0);}else if(parameters[_0x22c1('0x396')]==='51'){rotateAxis=new Vector3(0x0,0x0,0x1);}for(var i=0x0;i<vertexNumb;i++){var charID=bufferGeometry[_0x22c1('0x212')][i];tempVect[_0x22c1('0xa0')](positions,i*0x3);tempVect['sub'](charCenterArray[charID]);tempVect['applyAxisAngle'](rotateAxis,parameters['intensity']/0xb4*Math['PI']);tempVect[_0x22c1('0xc5')](charCenterArray[charID]);positions[i*0x3+0x0]=tempVect['x'];positions[i*0x3+0x1]=tempVect['y'];positions[i*0x3+0x2]=tempVect['z'];}}},{'key':'runPattern6','value':function runPattern6(bufferGeometry,parameters){var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')]['array'];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var scale=0.1;var _this$PerCharCalculat5=this[_0x22c1('0x3bf')](bufferGeometry,parameters),charCenterArray=_this$PerCharCalculat5[_0x22c1('0x213')];var rotateAxisArray=[];var tempVect=new Vector3();for(var i=0x0;i<vertexNumb;i++){var charID=bufferGeometry[_0x22c1('0x212')][i];tempVect[_0x22c1('0xa0')](positions,i*0x3);tempVect[_0x22c1('0xab')](charCenterArray[charID]);if(rotateAxisArray[charID]===undefined){var rotateAxis=new Vector3(Math['random']()*0x2-0x1,Math[_0x22c1('0x51')]()*0x2-0x1,Math[_0x22c1('0x51')]()*0x2-0x1);rotateAxis['normalize']();rotateAxisArray[charID]=rotateAxis;}tempVect[_0x22c1('0xb3')](rotateAxisArray[charID],parameters[_0x22c1('0x3b6')]/0xb4*Math['PI']*scale);tempVect[_0x22c1('0xc5')](charCenterArray[charID]);positions[i*0x3+0x0]=tempVect['x'];positions[i*0x3+0x1]=tempVect['y'];positions[i*0x3+0x2]=tempVect['z'];}}},{'key':'runPattern7','value':function runPattern7(bufferGeometry,parameters){var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var _this$PerCharCalculat6=this['PerCharCalculation'](bufferGeometry,parameters),center=_this$PerCharCalculat6[_0x22c1('0xf9')],minX=_this$PerCharCalculat6[_0x22c1('0x3c0')],maxX=_this$PerCharCalculat6['maxX'],charCenterArray=_this$PerCharCalculat6['charCenterArray'],charCenterArrayT=_this$PerCharCalculat6[_0x22c1('0x214')],bboxPerLine=_this$PerCharCalculat6[_0x22c1('0x3c1')];var translationArray=[];var rotationMatrixArray=[];var charCount=bufferGeometry[_0x22c1('0x212')][bufferGeometry['charVertexFlagArray'][_0x22c1('0x32')]-0x1]+0x1;for(var i=0x0;i<charCount;i++){var charID=i;var lineNumb=parameters[_0x22c1('0x37e')][charID][_0x22c1('0x3c2')];var thisLineBbox=bboxPerLine[lineNumb];var thisLineCenter=new Vector3();thisLineBbox[_0x22c1('0xe4')](thisLineCenter);var v0=void 0x0,v1=void 0x0,v2=void 0x0;if(parameters[_0x22c1('0x396')]==='70'){v0=new Vector3(minX,thisLineCenter['y'],thisLineCenter['z']);v1=new Vector3(center['x'],thisLineCenter['y']+parameters['intensity'],thisLineCenter['z']);v2=new Vector3(maxX,thisLineCenter['y'],thisLineCenter['z']);}else if(parameters[_0x22c1('0x396')]==='71'){v0=new Vector3(minX,thisLineCenter['y'],thisLineCenter['z']);v1=new Vector3(center['x'],thisLineCenter['y'],thisLineCenter['z']+parameters['intensity']);v2=new Vector3(maxX,thisLineCenter['y'],thisLineCenter['z']);}var curve=new QuadraticBezierCurve3(v0,v1,v2);var lineCurve=new LineCurve3(new Vector3(minX,thisLineCenter['y'],thisLineCenter['z']),new Vector3(maxX,thisLineCenter['y'],thisLineCenter['z']));var charIDT=charCenterArrayT[i];if(translationArray[charID]===undefined){var _charCenterArray$char=charCenterArray[charID],x=_charCenterArray$char['x'],y=_charCenterArray$char['y'],z=_charCenterArray$char['z'];var newVec=new Vector3(x,y,z);var localOffset=newVec['sub'](lineCurve[_0x22c1('0x24a')](charIDT));var centerOffset=curve[_0x22c1('0x2ec')](charIDT)['clone']()[_0x22c1('0xab')](charCenterArray[charID])[_0x22c1('0xc5')](localOffset);var xAxis=void 0x0,yAxis=void 0x0,zAxis=void 0x0;if(parameters[_0x22c1('0x396')]==='70'){xAxis=curve[_0x22c1('0x2f9')](charIDT)[_0x22c1('0x6a')]();zAxis=new Vector3(0x0,0x0,0x1);yAxis=zAxis[_0x22c1('0x8d')]()[_0x22c1('0x105')](xAxis)['normalize']();}else if(parameters['pattern']==='71'){xAxis=curve[_0x22c1('0x2f9')](charIDT)['normalize']();yAxis=new Vector3(0x0,0x1,0x0);zAxis=xAxis[_0x22c1('0x8d')]()[_0x22c1('0x105')](yAxis)[_0x22c1('0x6a')]();}translationArray[charID]=centerOffset;var rotationMatrix=new Matrix3();rotationMatrix[_0x22c1('0x5e')](xAxis['x'],xAxis['y'],xAxis['z'],yAxis['x'],yAxis['y'],yAxis['z'],zAxis['x'],zAxis['y'],zAxis['z']);rotationMatrix[_0x22c1('0x74')]();rotationMatrixArray[charID]=rotationMatrix;}}var tempVect=new Vector3();for(var _i=0x0;_i<vertexNumb;_i++){var _charID=bufferGeometry['charVertexFlagArray'][_i];tempVect[_0x22c1('0xa0')](positions,_i*0x3);tempVect['sub'](charCenterArray[_charID]);tempVect['applyMatrix3'](rotationMatrixArray[_charID]);tempVect[_0x22c1('0xc5')](charCenterArray[_charID]);tempVect[_0x22c1('0xc5')](translationArray[_charID]);positions[_i*0x3+0x0]=tempVect['x'];positions[_i*0x3+0x1]=tempVect['y'];positions[_i*0x3+0x2]=tempVect['z'];}}},{'key':'runPattern8','value':function runPattern8(bufferGeometry,parameters){var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')]['array'];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var intensity=parameters['intensity'],randNum=parameters[_0x22c1('0x3c3')];var _this$PerCharCalculat7=this[_0x22c1('0x3bf')](bufferGeometry,parameters),charCenterArray=_this$PerCharCalculat7[_0x22c1('0x213')];var rotateAxisArray=[];var offsetArray=[];for(var i=0x0;i<vertexNumb;i++){var charID=bufferGeometry[_0x22c1('0x212')][i];var newVertice=new Vector3();newVertice[_0x22c1('0xa0')](positions,i*0x3);newVertice['sub'](charCenterArray[charID]);if(rotateAxisArray[charID]===undefined){var rotateAxis=new Vector3(this[_0x22c1('0x3c4')](randNum+charID*Math['E']),this[_0x22c1('0x3c4')](randNum+(charID+0x1)*Math['E']),this[_0x22c1('0x3c4')](randNum+(charID+0x2)*Math['E']));rotateAxis[_0x22c1('0x6a')]();rotateAxisArray[charID]=rotateAxis;}if(offsetArray[charID]===undefined){var offset=new Vector3(0x0,this[_0x22c1('0x3c4')](randNum+charID*Math[_0x22c1('0x2db')])*intensity,this[_0x22c1('0x3c4')](randNum+(charID+0x1)*Math['SQRT2'])*intensity);offsetArray[charID]=offset;}newVertice[_0x22c1('0xb3')](rotateAxisArray[charID],parameters['intensity1']/0x32*Math['PI']);newVertice['add'](offsetArray[charID]);newVertice['add'](charCenterArray[charID]);positions[i*0x3+0x0]=newVertice['x'];positions[i*0x3+0x1]=newVertice['y'];positions[i*0x3+0x2]=newVertice['z'];}}},{'key':_0x22c1('0x3c5'),'value':function runPattern9(bufferGeometry,parameters){var positions=bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')]['array'];var vertexNumb=parseInt(positions[_0x22c1('0x32')]/0x3);var _this$PerCharCalculat8=this[_0x22c1('0x3bf')](bufferGeometry,parameters),center=_this$PerCharCalculat8[_0x22c1('0xf9')],charCenterArray=_this$PerCharCalculat8['charCenterArray'],charCenterArrayT=_this$PerCharCalculat8[_0x22c1('0x214')];var radius=parameters[_0x22c1('0x3b6')]*0xa;var startAngle=1.5*Math['PI']-(0x1-parameters[_0x22c1('0x3c6')]/0x64)*Math['PI'];var endAngle=-0.5*Math['PI']+(0x1-parameters[_0x22c1('0x3c6')]/0x64)*Math['PI'];var curve=new EllipseCurve(center['x'],center['y'],radius,radius,startAngle,endAngle,!![],0x0);var translationArray=[];var rotationMatrixArray=[];var charCount=bufferGeometry[_0x22c1('0x212')][bufferGeometry[_0x22c1('0x212')][_0x22c1('0x32')]-0x1]+0x1;for(var i=0x0;i<charCount;i++){var charID=i;var CharIDt=charCenterArrayT[i];if(charCount===0x1)CharIDt=0.5;if(translationArray[charID]===undefined){var pos2D=curve[_0x22c1('0x24a')](CharIDt);var centerOffset=new Vector3(pos2D['x'],pos2D['y'],0x0)[_0x22c1('0xab')](charCenterArray[charID]);var xAxis2D=curve[_0x22c1('0x2f9')](CharIDt)[_0x22c1('0x6a')]();var xAxis=new Vector3(xAxis2D['x'],xAxis2D['y'],0x0);var zAxis=new Vector3(0x0,0x0,0x1);var yAxis=zAxis['clone']()[_0x22c1('0x105')](xAxis)[_0x22c1('0x6a')]();translationArray[charID]=centerOffset;var rotationMatrix=new Matrix3();rotationMatrix[_0x22c1('0x5e')](xAxis['x'],xAxis['y'],xAxis['z'],yAxis['x'],yAxis['y'],yAxis['z'],zAxis['x'],zAxis['y'],zAxis['z']);rotationMatrix[_0x22c1('0x74')]();rotationMatrixArray[charID]=rotationMatrix;}}var newVertice=new Vector3();for(var _i2=0x0;_i2<vertexNumb;_i2++){var _charID2=bufferGeometry['charVertexFlagArray'][_i2];newVertice[_0x22c1('0xa0')](positions,_i2*0x3);newVertice[_0x22c1('0xab')](charCenterArray[_charID2]);newVertice[_0x22c1('0x104')](rotationMatrixArray[_charID2]);newVertice[_0x22c1('0xc5')](charCenterArray[_charID2]);newVertice[_0x22c1('0xc5')](translationArray[_charID2]);positions[_i2*0x3+0x0]=newVertice['x'];positions[_i2*0x3+0x1]=newVertice['y'];positions[_i2*0x3+0x2]=newVertice['z'];}this['curve']=curve;}},{'key':_0x22c1('0x3bf'),'value':function PerCharCalculation(bufferGeometry,parameters){var center=new Vector3();bufferGeometry[_0x22c1('0x1e4')][_0x22c1('0xe4')](center);var charCenterArray=bufferGeometry[_0x22c1('0x213')],charCenterArrayT=bufferGeometry[_0x22c1('0x214')],charBBoxArray=bufferGeometry['charBBoxArray'];var _bufferGeometry$bound=bufferGeometry[_0x22c1('0x1e4')][_0x22c1('0x54')],minX=_bufferGeometry$bound['x'],minY=_bufferGeometry$bound['y'],minZ=_bufferGeometry$bound['z'];var _bufferGeometry$bound2=bufferGeometry[_0x22c1('0x1e4')]['max'],maxX=_bufferGeometry$bound2['x'],maxY=_bufferGeometry$bound2['y'],maxZ=_bufferGeometry$bound2['z'];var bboxPerLine=[];for(var i=0x0;i<parameters['charPosDatas'][_0x22c1('0x32')];i++){var lineNumb=parameters[_0x22c1('0x37e')][i][_0x22c1('0x3c2')];bboxPerLine[lineNumb]=bboxPerLine[lineNumb]||new Box3();bboxPerLine[lineNumb][_0x22c1('0xfa')](charBBoxArray[i]);}return{'center':center,'minX':minX,'maxX':maxX,'minY':minY,'maxY':maxY,'minZ':minZ,'maxZ':maxZ,'charCenterArray':charCenterArray,'charCenterArrayT':charCenterArrayT,'charBBoxArray':charBBoxArray,'bboxPerLine':bboxPerLine};}},{'key':'getRandom','value':function getRandom(num){var tempNum=Math['sin'](num)*43758.5453123;return tempNum-Math['trunc'](tempNum);}}]);return Verbatim;}();function _createSuper$g(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct$g();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this)[_0x22c1('0xd')];result=Reflect[_0x22c1('0x2fb')](Super,arguments,NewTarget);}else{result=Super[_0x22c1('0x7')](this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct$g(){if(typeof Reflect===_0x22c1('0x0')||!Reflect['construct'])return![];if(Reflect[_0x22c1('0x2fb')]['sham'])return![];if(typeof Proxy===_0x22c1('0xa'))return!![];try{Boolean['prototype']['valueOf'][_0x22c1('0x2')](Reflect['construct'](Boolean,[],function(){}));return!![];}catch(_0x2d2558){return![];}}var VerbatimForPaths=function(_TransformForPaths){_inherits(VerbatimForPaths,_TransformForPaths);var _super=_createSuper$g(VerbatimForPaths);function VerbatimForPaths(){_classCallCheck(this,VerbatimForPaths);return _super[_0x22c1('0x7')](this,arguments);}_createClass(VerbatimForPaths,[{'key':_0x22c1('0x3c7'),'value':function patchwork(){var _this=this;var funcPerChar=function funcPerChar(i,charPosData){var columnNum=charPosData[_0x22c1('0x3c8')],fontSize=charPosData['fontSize'];var diviate=0.5*Math[_0x22c1('0x57')](-0x1,columnNum+0x1)*_this[_0x22c1('0x37f')][0x0]*fontSize;var translateVec=_this[_0x22c1('0x380')]?new Vector2(0x0,-diviate):new Vector2(diviate,0x0);return{'translateVec':translateVec};};var funcPerCurve=function funcPerCurve(point,data){point[_0x22c1('0xc5')](data[_0x22c1('0x3c9')]);};this[_0x22c1('0x385')](funcPerCurve,funcPerChar);}},{'key':_0x22c1('0x3ca'),'value':function step(){var _this2=this;var funcPerChar=function funcPerChar(i,charPosData){var min=_this2['boundingBox'][_0x22c1('0x54')];var centerPos=charPosData['centerPos'];var translateVec;if(_this2[_0x22c1('0x380')]){var diviate=(centerPos['x']-min['x'])*_this2[_0x22c1('0x37f')][0x0];translateVec=new Vector2(0x0,-diviate);}else{var _diviate=(centerPos['y']-min['y'])*_this2['intensitys'][0x0];translateVec=new Vector2(_diviate,0x0);}return{'translateVec':translateVec};};var funcPerCurve=function funcPerCurve(point,data){point[_0x22c1('0xc5')](data[_0x22c1('0x3c9')]);};this[_0x22c1('0x385')](funcPerCurve,funcPerChar);}},{'key':_0x22c1('0x3cb'),'value':function arch2(){var _this3=this;var funcPerChar=function funcPerChar(i,charPosData){var intensity=_this3[_0x22c1('0x37f')][0x0];var min=_this3[_0x22c1('0x1e4')][_0x22c1('0x54')];var centerPos=charPosData[_0x22c1('0x3cc')];var t,translateVec;if(_this3['isHorizontal']){t=(centerPos['x']-min['x'])/_this3[_0x22c1('0x381')];var diviate=t*(0x1-t)*intensity*_this3[_0x22c1('0x381')];translateVec=new Vector2(0x0,-diviate);}else{t=(centerPos['y']-min['y'])/_this3[_0x22c1('0x381')];var _diviate2=t*(0x1-t)*intensity*_this3[_0x22c1('0x381')];translateVec=new Vector2(_diviate2,0x0);}return{'translateVec':translateVec};};var funcPerCurve=function funcPerCurve(point,data){point[_0x22c1('0xc5')](data[_0x22c1('0x3c9')]);};this[_0x22c1('0x385')](funcPerCurve,funcPerChar);}},{'key':_0x22c1('0x3cd'),'value':function wave(){var _this4=this;var funcPerChar=function funcPerChar(i,charPosData){var intensity=_this4[_0x22c1('0x37f')][0x0];var _this4$boundingBox=_this4[_0x22c1('0x1e4')],width=_this4$boundingBox[_0x22c1('0x287')],height=_this4$boundingBox[_0x22c1('0x1cc')],min=_this4$boundingBox[_0x22c1('0x54')];var centerPos=charPosData[_0x22c1('0x3cc')];var t,translateVec;if(_this4[_0x22c1('0x380')]){t=(centerPos['x']-min['x'])/width;t*=0x2*Math['PI'];var diviate=0.25*Math['sin'](t)*intensity*width;translateVec=new Vector2(0x0,-diviate);}else{t=(centerPos['y']-min['y'])/height;t*=0x2*Math['PI'];var _diviate3=0.25*Math[_0x22c1('0x7c')](t)*intensity*height;translateVec=new Vector2(_diviate3,0x0);}return{'translateVec':translateVec};};var funcPerCurve=function funcPerCurve(point,data){point['add'](data['translateVec']);};this['baseTransform'](funcPerCurve,funcPerChar);}},{'key':_0x22c1('0x3ce'),'value':function stepFarAndNear(){var _this5=this;var funcPerChar=function funcPerChar(i,charPosData){var centerPos=charPosData[_0x22c1('0x3cc')];var k=_this5[_0x22c1('0x37f')][0x0];var _this5$boundingBox=_this5[_0x22c1('0x1e4')],min=_this5$boundingBox['min'],width=_this5$boundingBox[_0x22c1('0x287')],height=_this5$boundingBox[_0x22c1('0x1cc')];var t,centerX,centerY;if(_this5['isHorizontal']){t=(centerPos['x']-min['x'])/width;centerX=(centerPos['x']-min['x'])*(k*t+0x1-k)+min['x'];centerY=centerPos['y'];}else{t=(centerPos['y']-min['y'])/height;centerX=centerPos['x'];centerY=(centerPos['y']-min['y'])*(k*t+0x1-k)+min['y'];}var y=0x2*(t-0.5)*k+0x1;return{'centerX':centerX,'centerY':centerY,'t':y,'centerPos':centerPos};};var funcPerCurve=function funcPerCurve(point,data){var centerX=data[_0x22c1('0x3cf')],centerY=data[_0x22c1('0x3d0')],t=data['t'],centerPos=data[_0x22c1('0x3cc')];var x=(point['x']-centerPos['x'])*t+centerX;var y=(point['y']-centerPos['y'])*t+centerY;point['set'](x,y);};this['baseTransform'](funcPerCurve,funcPerChar);}},{'key':_0x22c1('0x3d1'),'value':function archFarAndNear(){var _this6=this;var funcPreprocess=function funcPreprocess(){var _this6$boundingBox=_this6[_0x22c1('0x1e4')],width=_this6$boundingBox['width'],height=_this6$boundingBox[_0x22c1('0x1cc')],min=_this6$boundingBox[_0x22c1('0x54')];var boxCenter=new Vector2(min['x']+0.5*width,min['y']+0.5*height);return{'width':width,'height':height,'min':min,'boxCenter':boxCenter};};var funcPerChar=function funcPerChar(i,charPosData,data){var k=_this6[_0x22c1('0x37f')][0x0];var centerPos=charPosData[_0x22c1('0x3cc')];var boxCenter=data[_0x22c1('0x3d2')],width=data['width'],height=data[_0x22c1('0x1cc')];var t,centerX,centerY;if(_this6['isHorizontal']){t=0x2*Math['abs'](centerPos['x']-boxCenter['x'])/width;centerX=(centerPos['x']-boxCenter['x'])*(-k*t+0x1+k)+boxCenter['x'];centerY=centerPos['y'];}else{t=0x2*Math[_0x22c1('0x69')](centerPos['y']-boxCenter['y'])/height;centerX=centerPos['x'];centerY=(centerPos['y']-boxCenter['y'])*(-k*t+0x1+k)+boxCenter['y'];}var y=-0x2*(t-0.5)*k+0x1;return{'centerX':centerX,'centerY':centerY,'t':y,'centerPos':centerPos};};var funcPerCurve=function funcPerCurve(point,data){var centerX=data['centerX'],centerY=data[_0x22c1('0x3d0')],t=data['t'],centerPos=data[_0x22c1('0x3cc')];var x=(point['x']-centerPos['x'])*t+centerX;var y=(point['y']-centerPos['y'])*t+centerY;point[_0x22c1('0x5e')](x,y);};this['baseTransform'](funcPerCurve,funcPerChar,funcPreprocess);}},{'key':_0x22c1('0x3d3'),'value':function horizontalRotate(){var _this7=this;var funcPerChar=function funcPerChar(i,charPosData){var centerPos=charPosData[_0x22c1('0x3cc')];var angle=0.333*_this7[_0x22c1('0x37f')][0x0]*Math['PI'];var cos=Math[_0x22c1('0x7b')](angle);var sin=Math[_0x22c1('0x7c')](angle);return{'cos':cos,'sin':sin,'centerPos':centerPos};};var funcPerCurve=function funcPerCurve(point,data){var cos=data['cos'],sin=data[_0x22c1('0x7c')],centerPos=data['centerPos'];var initx=point['x']-centerPos['x'];var inity=point['y']-centerPos['y'];var x=centerPos['x']+initx*cos-inity*sin;var y=centerPos['y']+initx*sin+inity*cos;point[_0x22c1('0x5e')](x,y);};this['baseTransform'](funcPerCurve,funcPerChar);}},{'key':_0x22c1('0x3d4'),'value':function horizontalCurvedRotate(){var _this8=this;var funcPreprocess=function funcPreprocess(){var _this8$boundingBox=_this8[_0x22c1('0x1e4')],width=_this8$boundingBox[_0x22c1('0x287')],height=_this8$boundingBox['height'],min=_this8$boundingBox[_0x22c1('0x54')];var center=new Vector2(min['x']+width/0x2,min['y']+height/0x2);var radius=_this8['lineHeight']*0x2/Math[_0x22c1('0x7c')](_this8[_0x22c1('0x37f')][0x0]*Math['PI']*0.5);var angle=0.5*_this8['baseWidth']/radius;var baseAngle=_this8[_0x22c1('0x380')]?0x0:0.5*Math['PI'];var curve=new CircleCurve(center,radius,baseAngle-angle,baseAngle+angle);return{'width':width,'min':min,'height':height,'curve':curve,'isHorizontal':_this8[_0x22c1('0x380')]};};var _this$getPerCharAndCu=this[_0x22c1('0x3d5')](!![]),funcPerChar=_this$getPerCharAndCu[_0x22c1('0x3d6')],funcPerCurve=_this$getPerCharAndCu[_0x22c1('0x3d7')];this[_0x22c1('0x385')](funcPerCurve,funcPerChar,funcPreprocess);}},{'key':_0x22c1('0x3d8'),'value':function arbitraryOffsetRotate(){var _this9=this;var baseRandNum=this[_0x22c1('0x2dd')][_0x22c1('0x3c3')];var funcPerChar=function funcPerChar(i,charPosData){var fontSize=charPosData[_0x22c1('0x3d9')],centerPos=charPosData['centerPos'];var randNum=_this9[_0x22c1('0x3c4')](baseRandNum+i*Math['E']);var angle=0.5*_this9[_0x22c1('0x37f')][0x1]*Math['PI']*randNum;var cos=Math['cos'](angle);var sin=Math[_0x22c1('0x7c')](angle);randNum=_this9['getRandom'](baseRandNum+i*i*Math['E']);var diviate=0.5*_this9['intensitys'][0x0]*randNum*fontSize;return{'cos':cos,'sin':sin,'diviate':diviate,'centerPos':centerPos};};var funcPerCurve=function funcPerCurve(point,data){var cos=data[_0x22c1('0x7b')],diviate=data['diviate'],sin=data[_0x22c1('0x7c')],centerPos=data['centerPos'];var initx=point['x']-centerPos['x'];var inity=point['y']-centerPos['y'];var x,y;if(_this9['isHorizontal']){x=centerPos['x']+initx*cos-inity*sin;y=centerPos['y']+diviate+initx*sin+inity*cos;}else{x=centerPos['x']+diviate+initx*cos-inity*sin;y=centerPos['y']+initx*sin+inity*cos;}point[_0x22c1('0x5e')](x,y);};this['baseTransform'](funcPerCurve,funcPerChar);}},{'key':_0x22c1('0x320'),'value':function ellipse(){var _this10=this;var funcPreprocess=function funcPreprocess(){var _this10$boundingBox=_this10[_0x22c1('0x1e4')],width=_this10$boundingBox[_0x22c1('0x287')],height=_this10$boundingBox[_0x22c1('0x1cc')],min=_this10$boundingBox[_0x22c1('0x54')];var e=_this10[_0x22c1('0x37f')][0x3]||0x0;var aX,aY,xRadius,yRadius;if(_this10['isHorizontal']){aX=min['x']+0.5*width;aY=min['y'];xRadius=0.5*width*_this10[_0x22c1('0x37f')][0x0];yRadius=Math[_0x22c1('0x8a')](0x1-e*e)*xRadius;}else{aX=min['x'];aY=min['y']+0.5*height;yRadius=0.5*height*_this10[_0x22c1('0x37f')][0x0];xRadius=Math[_0x22c1('0x8a')](0x1-e*e)*yRadius;}var aStartAngle=(_this10['intensitys'][0x1]/1.8+(_this10['isHorizontal']?0x1:1.5))*Math['PI'];var aEndAngle=aStartAngle+_this10['intensitys'][0x2]/1.8*Math['PI'];var aClockwise=![];var ellipseCurve=new EllipseCurve(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise);return{'width':width,'min':min,'height':height,'curve':ellipseCurve,'isHorizontal':_this10[_0x22c1('0x380')]};};var _this$getPerCharAndCu2=this[_0x22c1('0x3d5')](this[_0x22c1('0x2dd')]['isFollowTangent']),funcPerChar=_this$getPerCharAndCu2['funcPerChar'],funcPerCurve=_this$getPerCharAndCu2[_0x22c1('0x3d7')];this[_0x22c1('0x385')](funcPerCurve,funcPerChar,funcPreprocess);}},{'key':_0x22c1('0x263'),'value':function triangle(){this[_0x22c1('0x3da')]();}},{'key':_0x22c1('0x3db'),'value':function rectangular(){var _this11=this;var funcPreprocess=function funcPreprocess(){var _this11$boundingBox=_this11['boundingBox'],width=_this11$boundingBox['width'],height=_this11$boundingBox[_0x22c1('0x1cc')],min=_this11$boundingBox[_0x22c1('0x54')];var rectangularCenter,size;if(_this11[_0x22c1('0x380')]){rectangularCenter=new Vector2(min['x']+0.5*width,min['y']);size=0.5*_this11[_0x22c1('0x37f')][0x0]*width;}else{rectangularCenter=new Vector2(min['x'],min['y']+0.5*height);size=0.5*_this11[_0x22c1('0x37f')][0x0]*height;}var ratio=_this11['intensitys'][0x1];var startNum=_this11[_0x22c1('0x37f')][0x2];var endNum=startNum+_this11[_0x22c1('0x37f')][0x3];var rectangularCurve=new RectangularCurve(rectangularCenter,size,ratio,startNum,endNum);return{'width':width,'min':min,'height':height,'curve':rectangularCurve,'isHorizontal':_this11[_0x22c1('0x380')]};};var _this$getPerCharAndCu3=this[_0x22c1('0x3d5')](this[_0x22c1('0x2dd')][_0x22c1('0x3dc')]),funcPerChar=_this$getPerCharAndCu3[_0x22c1('0x3d6')],funcPerCurve=_this$getPerCharAndCu3[_0x22c1('0x3d7')];this['baseTransform'](funcPerCurve,funcPerChar,funcPreprocess);}},{'key':_0x22c1('0x3dd'),'value':function pentagon(){this[_0x22c1('0x3da')]();}},{'key':_0x22c1('0x3da'),'value':function polygon(){var _this12=this;var funcPreprocess=function funcPreprocess(){var _this12$boundingBox=_this12[_0x22c1('0x1e4')],width=_this12$boundingBox[_0x22c1('0x287')],height=_this12$boundingBox[_0x22c1('0x1cc')],min=_this12$boundingBox[_0x22c1('0x54')];var polygonCenter,size;if(_this12[_0x22c1('0x380')]){polygonCenter=new Vector2(min['x']+0.5*width,min['y']);size=0.5*_this12['intensitys'][0x0]*width;}else{polygonCenter=new Vector2(min['x'],min['y']+0.5*height);size=0.5*_this12[_0x22c1('0x37f')][0x0]*height;}var num=_this12[_0x22c1('0x37f')][0x1]*0x64;var startNum=_this12[_0x22c1('0x37f')][0x2];var endNum=startNum+_this12['intensitys'][0x3];var polygonCurve=new PolygonCurve(polygonCenter,size,num,startNum,endNum);return{'width':width,'min':min,'height':height,'curve':polygonCurve,'isHorizontal':_this12[_0x22c1('0x380')],'needExpandAlongNormal':!![]};};var _this$getPerCharAndCu4=this[_0x22c1('0x3d5')](this[_0x22c1('0x2dd')][_0x22c1('0x3dc')]),funcPerChar=_this$getPerCharAndCu4[_0x22c1('0x3d6')],funcPerCurve=_this$getPerCharAndCu4['funcPerCurve'];this[_0x22c1('0x385')](funcPerCurve,funcPerChar,funcPreprocess);}},{'key':_0x22c1('0x3de'),'value':function heart(){var _this13=this;var funcPreprocess=function funcPreprocess(){var _this13$boundingBox=_this13[_0x22c1('0x1e4')],width=_this13$boundingBox[_0x22c1('0x287')],height=_this13$boundingBox['height'],min=_this13$boundingBox['min'];var center,size;if(_this13[_0x22c1('0x380')]){center=new Vector2(min['x']+0.5*width,min['y']);size=0.5*_this13[_0x22c1('0x37f')][0x0]*width;}else{center=new Vector2(min['x'],min['y']+0.5*height);size=0.5*_this13[_0x22c1('0x37f')][0x0]*height;}var startNum=_this13[_0x22c1('0x37f')][0x1];var endNum=startNum+_this13[_0x22c1('0x37f')][0x2];var curve=new HeartCurve(center,size,startNum,endNum);return{'width':width,'min':min,'height':height,'curve':curve,'isHorizontal':_this13[_0x22c1('0x380')]};};var _this$getPerCharAndCu5=this[_0x22c1('0x3d5')](this[_0x22c1('0x2dd')][_0x22c1('0x3dc')]),funcPerChar=_this$getPerCharAndCu5[_0x22c1('0x3d6')],funcPerCurve=_this$getPerCharAndCu5[_0x22c1('0x3d7')];this[_0x22c1('0x385')](funcPerCurve,funcPerChar,funcPreprocess);}},{'key':'getPerCharAndCurveFunc','value':function getPerCharAndCurveFunc(isFollowTangent){var funcPerChar,funcPerCurve;if(isFollowTangent){funcPerChar=this[_0x22c1('0x3df')];funcPerCurve=this[_0x22c1('0x3e0')];}else{funcPerChar=this[_0x22c1('0x3e1')];funcPerCurve=this['resetPointPosWithoutRotate'];}return{'funcPerChar':funcPerChar,'funcPerCurve':funcPerCurve};}},{'key':_0x22c1('0x3df'),'value':function calculateNewCenter(i,charPosData,data){var width=data[_0x22c1('0x287')],height=data['height'],min=data[_0x22c1('0x54')],curve=data[_0x22c1('0x3e2')],isHorizontal=data[_0x22c1('0x380')],_data$needExpandAlong=data['needExpandAlongNormal'],needExpandAlongNormal=_data$needExpandAlong===void 0x0?![]:_data$needExpandAlong;var centerPos=charPosData[_0x22c1('0x3cc')],centerDiviation=charPosData[_0x22c1('0x3e3')];var t=isHorizontal?(centerPos['x']-min['x'])/width:(centerPos['y']-min['y'])/height;var diviateVec=isHorizontal?new Vector2(0x0,centerPos['y']-min['y']):new Vector2(centerPos['x']-min['x'],0x0);if(needExpandAlongNormal){var normalVec=curve['getNormal'](t);diviateVec[_0x22c1('0xaa')](normalVec,-centerDiviation);}var newCenterPos=curve[_0x22c1('0x2ec')](t)['add'](diviateVec);var tangentVec=curve[_0x22c1('0x2f8')](t);var cos=tangentVec['x'];var sin=tangentVec['y'];return{'cos':cos,'sin':sin,'newCenterPos':newCenterPos,'centerPos':centerPos};}},{'key':_0x22c1('0x3e1'),'value':function calculateNewCenterWithoutRotate(i,charPosData,data){var width=data[_0x22c1('0x287')],height=data[_0x22c1('0x1cc')],min=data[_0x22c1('0x54')],curve=data[_0x22c1('0x3e2')],isHorizontal=data[_0x22c1('0x380')];var centerPos=charPosData[_0x22c1('0x3cc')];var t=isHorizontal?(centerPos['x']-min['x'])/width:(centerPos['y']-min['y'])/height;var diviateVec=isHorizontal?new Vector2(0x0,centerPos['y']-min['y']):new Vector2(centerPos['x']-min['x'],0x0);var newCenterPos=curve[_0x22c1('0x2ec')](t)[_0x22c1('0xc5')](diviateVec);return{'newCenterPos':newCenterPos,'centerPos':centerPos};}},{'key':_0x22c1('0x3e0'),'value':function resetPointPos(point,data){var newCenterPos=data[_0x22c1('0x3e4')],_data$cos=data[_0x22c1('0x7b')],cos=_data$cos===void 0x0?0x1:_data$cos,_data$sin=data['sin'],sin=_data$sin===void 0x0?0x0:_data$sin,centerPos=data['centerPos'];var dx=point['x']-centerPos['x'];var dy=point['y']-centerPos['y'];var x=newCenterPos['x']+dx*cos-dy*sin;var y=newCenterPos['y']+dx*sin+dy*cos;point[_0x22c1('0x5e')](x,y);}},{'key':_0x22c1('0x3e5'),'value':function resetPointPosWithoutRotate(point,data){var newCenterPos=data[_0x22c1('0x3e4')],centerPos=data[_0x22c1('0x3cc')];var x=point['x']-centerPos['x']+newCenterPos['x'];var y=point['y']-centerPos['y']+newCenterPos['y'];point[_0x22c1('0x5e')](x,y);}},{'key':_0x22c1('0x386'),'value':function transform(paths,options){if(Math[_0x22c1('0x106')][_0x22c1('0x7')](Math,_toConsumableArray(options[_0x22c1('0x37f')]))){_get(_getPrototypeOf(VerbatimForPaths[_0x22c1('0x1')]),'transform',this)[_0x22c1('0x2')](this,paths,options);var type=this[_0x22c1('0x2dd')]['type'][_0x22c1('0x169')](/-byWord$/,'');this[type]&&this[type]();}return this[_0x22c1('0x3b5')](paths);}}]);return VerbatimForPaths;}(TransformForPaths);function makeArch(geometry,pathSizeData,archIntensity){var ffdOptions={'pattern':0x3,'intensity':archIntensity,'basisType':'bernstein'};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeBottomSlope(geometry,pathSizeData,bottomSlopeIntensity,changeYIntensity){var ffdOptions={'pattern':0x5,'intensity':bottomSlopeIntensity,'intensity1':changeYIntensity,'basisType':'bernstein'};Object['assign'](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeChangeX(geometry,pathSizeData,changeXIntensity){var ffdOptions={'pattern':0x1f5,'intensity':changeXIntensity,'basisType':_0x22c1('0x38d')};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeChangeY(geometry,pathSizeData,changeYIntensity){var ffdOptions={'pattern':0x1f6,'intensity':changeYIntensity,'basisType':_0x22c1('0x38d')};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeDownCurve(geometry,pathSizeData,downCurveIntensity){var ffdOptions={'pattern':0x4,'intensity':downCurveIntensity,'basisType':_0x22c1('0x38c')};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd['RUN'](geometry,ffdOptions);return geometry;}function makeExtrudeScale(geometry,scaleX,scaleY){var ffdOptions={'pattern':0xe,'intensity':scaleX,'intensity1':scaleY,'basisType':_0x22c1('0x38d')};var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeFlag(geometry,pathSizeData,flagIntensity){var ffdOptions={'pattern':0x65,'intensity':flagIntensity,'basisType':_0x22c1('0x38c')};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeShear(geometry,pathSizeData){var intensity=arguments[_0x22c1('0x32')]>0x2&&arguments[0x2]!==undefined?arguments[0x2]:0x0;var intensity1=arguments[_0x22c1('0x32')]>0x3&&arguments[0x3]!==undefined?arguments[0x3]:0x0;var ffdOptions={'pattern':0x9,'intensity':intensity,'intensity1':intensity1,'basisType':'linear'};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd['RUN'](geometry,ffdOptions);return geometry;}function makeSideTrapezium(geometry,pathSizeData,sideTrapeziumIntensity,changeYIntensity){var ffdOptions={'pattern':0xa,'intensity':sideTrapeziumIntensity,'intensity1':changeYIntensity,'basisType':_0x22c1('0x38c')};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeTopSlope(geometry,pathSizeData,topSlopeIntensity,changeYIntensity){var ffdOptions={'pattern':0x6,'intensity':topSlopeIntensity,'intensity1':changeYIntensity,'basisType':_0x22c1('0x38c')};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeTopTrapezium(geometry,pathSizeData,topTrapeziumIntensity,changeYIntensity){var ffdOptions={'pattern':0x192,'intensity':topTrapeziumIntensity,'intensity1':changeYIntensity,'basisType':_0x22c1('0x38c')};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeUpCurve(geometry,pathSizeData,upCurveIntensity){var ffdOptions={'pattern':0x1,'intensity':upCurveIntensity,'basisType':'bernstein'};Object['assign'](ffdOptions,pathSizeData);var ffd=new FFD();ffd['RUN'](geometry,ffdOptions);return geometry;}function makeUpDownCurve(geometry,pathSizeData,updownCurveIntensity){var ffdOptions={'pattern':0x2,'intensity':updownCurveIntensity,'basisType':_0x22c1('0x38c')};Object['assign'](ffdOptions,pathSizeData);var ffd=new FFD();ffd[_0x22c1('0x361')](geometry,ffdOptions);return geometry;}function makeUpDownShrink(geometry,pathSizeData,upShrinkIntensity,downShrinkIntensity){var ffdOptions={'pattern':0x10,'intensity':upShrinkIntensity,'intensity1':downShrinkIntensity,'basisType':_0x22c1('0x38d')};Object[_0x22c1('0x48')](ffdOptions,pathSizeData);var ffd=new FFD();ffd['RUN'](geometry,ffdOptions);return geometry;}function makePerCharacterTransformation(geometry,options){var warp=new Verbatim();warp[_0x22c1('0x361')](geometry,options);return geometry;}var bufferGeometryMap=new LRUMap(0x5);debug[_0x22c1('0x59')](_0x22c1('0x201'),''[_0x22c1('0x171')](VERSION));var defaultTextGeometryOptions={'size':0x64,'height':0xa,'steps':0x1,'curveSegments':0xa,'bevelEnabled':![],'bevelThickness':0x1,'bevelSize':-0x5,'bevelSegments':0x4,'bevelType':_0x22c1('0x2c9'),'extrudeOffsetX':0x0,'extrudeOffsetY':0x0,'laplacianIterationNumb':0x0,'shrink_factor':0x0,'enable_collision_detection':![],'expand':0x0,'triangulateMethod':'poly2tri','horizon':!![],'offsetScale':0x1,'shadingSmoothAngle':0x32,'lineHeight':0x1,'letterSpacing':0x1,'modelRotate':[0x0,0x0,0x0],'textAlign':_0x22c1('0xf9'),'writingMode':_0x22c1('0x3a4'),'worker':!![],'isDeformationON':![]};function loadFont(_x){return _loadFont['apply'](this,arguments);}function _loadFont(){_loadFont=_asyncToGenerator(regenerator['mark'](function _callee(url){var response,arrayBuffer,fontData;return regenerator['wrap'](function _callee$(_context){while(0x1){switch(_context[_0x22c1('0x3d')]=_context[_0x22c1('0x29')]){case 0x0:_context[_0x22c1('0x29')]=0x2;return fetch(url);case 0x2:response=_context['sent'];_context[_0x22c1('0x29')]=0x5;return response[_0x22c1('0x3e6')]();case 0x5:arrayBuffer=_context['sent'];fontData=parse$1(arrayBuffer);return _context[_0x22c1('0x340')]('return',new Font(fontData));case 0x8:case _0x22c1('0x42'):return _context[_0x22c1('0x341')]();}}},_callee);}));return _loadFont[_0x22c1('0x7')](this,arguments);}function createTextModel(_x2,_x3){return _createTextModel[_0x22c1('0x7')](this,arguments);}function _createTextModel(){_createTextModel=_asyncToGenerator(regenerator['mark'](function _callee2(text,options){var textGeometryOptions,deformation,warpByWord,intensity,type,intensity1,isCurve,key,index,val,bufferGeometry,bufferGeometryCopy,_bufferGeometry$param,charPosDatas,textAlign,baseLineHeight,maxLineWidth,_intensity,_intensity2,randNum,pattern,_warpByWord$offsetX,offsetX,_options,pathSizeData,indexs,positions,normals,uvs,_bufferGeometry,boundingBox,groups,bevelEnabled,sideCount,bevelCount,frontCount,i,k,indexArray,offSet,_i,_k,_groups$_i,start,count,data,model;return regenerator[_0x22c1('0x20')](function _callee2$(_context2){while(0x1){switch(_context2[_0x22c1('0x3d')]=_context2[_0x22c1('0x29')]){case 0x0:textGeometryOptions=initTextGeometryOptions(replaceWithMap(options,AI_PARAMS_MAP),defaultTextGeometryOptions);debug['log'](_0x22c1('0x3e7'),textGeometryOptions);deformation=options['deformation'],warpByWord=options['warpByWord'];intensity=deformation[_0x22c1('0x3b6')],type=deformation['type'],intensity1=deformation[_0x22c1('0x3c6')];isCurve=/Curve$/['test'](type);if(isCurve&&deformation['intensity']){textGeometryOptions[_0x22c1('0x2ba')]=!![];}if(warpByWord[_0x22c1('0x15d')]&&warpByWord[_0x22c1('0x396')]==='90'){text=text[_0x22c1('0x169')](/\n/,'');}key=text+options[_0x22c1('0x334')]['url'];for(index in options){val=options[index];if(!(val instanceof Object)){key+='_'+index+'_'+val;}}bufferGeometry=bufferGeometryMap[_0x22c1('0x1d6')](key);if(bufferGeometry){_context2['next']=0x1a;break;}bufferGeometry=new TextBufferGeometry(text,textGeometryOptions);_context2['prev']=0xc;_context2[_0x22c1('0x29')]=0xf;return bufferGeometry[_0x22c1('0x16d')]();case 0xf:_context2[_0x22c1('0x29')]=0x15;break;case 0x11:_context2[_0x22c1('0x3d')]=0x11;_context2['t0']=_context2[_0x22c1('0x3e8')](0xc);console[_0x22c1('0x3e9')](_context2['t0']);throw new Error(_0x22c1('0x3ea'));case 0x15:bufferGeometryCopy=cloneDeep(bufferGeometry);bufferGeometryCopy['initPosArray']=bufferGeometry['attributes'][_0x22c1('0xee')][_0x22c1('0x1e9')]['slice']();bufferGeometryMap[_0x22c1('0x5e')](key,bufferGeometryCopy);_context2[_0x22c1('0x29')]=0x1b;break;case 0x1a:bufferGeometry[_0x22c1('0xed')][_0x22c1('0xee')][_0x22c1('0x1e9')]=bufferGeometry[_0x22c1('0x3eb')][_0x22c1('0x40')]();case 0x1b:_bufferGeometry$param=bufferGeometry[_0x22c1('0x13d')][_0x22c1('0x2dd')],charPosDatas=_bufferGeometry$param[_0x22c1('0x37e')],textAlign=_bufferGeometry$param[_0x22c1('0x339')],baseLineHeight=_bufferGeometry$param[_0x22c1('0x398')],maxLineWidth=_bufferGeometry$param[_0x22c1('0x399')];if(warpByWord[_0x22c1('0x15d')]){_intensity=warpByWord['intensity'],_intensity2=warpByWord['intensity1'],randNum=warpByWord[_0x22c1('0x3c3')],pattern=warpByWord[_0x22c1('0x396')],_warpByWord$offsetX=warpByWord[_0x22c1('0x331')],offsetX=_warpByWord$offsetX===void 0x0?0x0:_warpByWord$offsetX;_options={'pattern':pattern,'offsetX':offsetX,'intensity':_intensity,'intensity1':_intensity2,'charPosDatas':charPosDatas,'textAlign':textAlign,'randNum':randNum,'maxLineWidth':maxLineWidth};makePerCharacterTransformation(bufferGeometry,_options);}pathSizeData={'baseLineHeight':baseLineHeight,'maxLineWidth':maxLineWidth};_context2['t1']=type;_context2['next']=_context2['t1']==='none'?0x21:_context2['t1']==='archCurve'?0x22:_context2['t1']===_0x22c1('0x3ae')?0x24:_context2['t1']===_0x22c1('0x3af')?0x26:_context2['t1']===_0x22c1('0x3b0')?0x28:_context2['t1']===_0x22c1('0x3b1')?0x2a:_context2['t1']===_0x22c1('0x3ec')?0x2c:_context2['t1']===_0x22c1('0x3aa')?0x2e:_context2['t1']==='trapezoid'?0x30:_context2['t1']===_0x22c1('0x3b3')?0x32:_context2['t1']===_0x22c1('0x3ed')?0x34:_context2['t1']==='horizontalTrapezoid'?0x36:_context2['t1']==='bevel'?0x38:_context2['t1']==='upperRoof'?0x3a:_context2['t1']===_0x22c1('0x3a7')?0x3c:_context2['t1']===_0x22c1('0x3a8')?0x3e:_context2['t1']==='foldedCorner'?0x40:_context2['t1']==='lateralStretching'?0x42:_context2['t1']===_0x22c1('0x3ee')?0x44:0x46;break;case 0x21:return _context2['abrupt'](_0x22c1('0x43'),0x46);case 0x22:makeArch(bufferGeometry,pathSizeData,intensity);return _context2['abrupt'](_0x22c1('0x43'),0x46);case 0x24:makeUpDownCurve(bufferGeometry,pathSizeData,-intensity);return _context2['abrupt']('break',0x46);case 0x26:makeUpCurve(bufferGeometry,pathSizeData,intensity);return _context2['abrupt']('break',0x46);case 0x28:makeDownCurve(bufferGeometry,pathSizeData,-intensity);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x2a:makeUpDownCurve(bufferGeometry,pathSizeData,intensity);return _context2[_0x22c1('0x340')]('break',0x46);case 0x2c:makeShear(bufferGeometry,pathSizeData,intensity,-intensity1);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x2e:makeFlag(bufferGeometry,pathSizeData,intensity);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x30:makeTopTrapezium(bufferGeometry,pathSizeData,intensity,intensity1);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x32:makeBottomSlope(bufferGeometry,pathSizeData,-intensity,intensity1);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x34:makeTopSlope(bufferGeometry,pathSizeData,-intensity,intensity1);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x36:makeSideTrapezium(bufferGeometry,pathSizeData,-intensity,intensity1);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x38:makeUpDownShrink(bufferGeometry,pathSizeData,intensity,intensity);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x3a:makeUpDownShrink(bufferGeometry,pathSizeData,intensity,0x0);return _context2[_0x22c1('0x340')]('break',0x46);case 0x3c:makeUpDownShrink(bufferGeometry,pathSizeData,0x0,-intensity);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x3e:makeUpDownShrink(bufferGeometry,pathSizeData,intensity,-intensity);return _context2['abrupt']('break',0x46);case 0x40:makeUpDownShrink(bufferGeometry,pathSizeData,-intensity,intensity);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x42:makeChangeX(bufferGeometry,pathSizeData,intensity);return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x46);case 0x44:makeChangeY(bufferGeometry,pathSizeData,intensity);return _context2[_0x22c1('0x340')]('break',0x46);case 0x46:debug[_0x22c1('0x226')](_0x22c1('0x3ef'));makeExtrudeScale(bufferGeometry,deformation['extrudeScaleX'],deformation['extrudeScaleY']);debug['timeEnd'](_0x22c1('0x3ef'));bufferGeometry['center']();bufferGeometry['computeBoundingBox']();indexs=bufferGeometry[_0x22c1('0x1e8')];positions=bufferGeometry['getAttribute'](_0x22c1('0xee'));normals=bufferGeometry[_0x22c1('0x3f0')](_0x22c1('0x1e'));uvs=bufferGeometry['getAttribute']('uv');_bufferGeometry=bufferGeometry,boundingBox=_bufferGeometry['boundingBox'],groups=_bufferGeometry[_0x22c1('0x20b')];debug['log'](_0x22c1('0x3f1')+positions[_0x22c1('0xd7')]);bevelEnabled=textGeometryOptions[_0x22c1('0x2c4')];sideCount=0x0,bevelCount=0x0,frontCount=0x0;i=0x0;case 0x54:if(!(i<groups[_0x22c1('0x32')])){_context2[_0x22c1('0x29')]=0x62;break;}k=bevelEnabled?i%0x3:i%0x2*0x2;_context2['t2']=k;_context2[_0x22c1('0x29')]=_context2['t2']===0x0?0x59:_context2['t2']===0x1?0x5b:_context2['t2']===0x2?0x5d:0x5f;break;case 0x59:frontCount+=groups[i][_0x22c1('0xd7')];return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x5f);case 0x5b:bevelCount+=groups[i][_0x22c1('0xd7')];return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x5f);case 0x5d:sideCount+=groups[i][_0x22c1('0xd7')];return _context2[_0x22c1('0x340')](_0x22c1('0x43'),0x5f);case 0x5f:i++;_context2[_0x22c1('0x29')]=0x54;break;case 0x62:indexArray=[new Uint32Array(frontCount),new Uint32Array(bevelCount),new Uint32Array(sideCount)];offSet=[0x0,0x0,0x0];for(_i=0x0;_i<groups[_0x22c1('0x32')];_i++){_k=bevelEnabled?_i%0x3:_i%0x2*0x2;_groups$_i=groups[_i],start=_groups$_i[_0x22c1('0x20a')],count=_groups$_i[_0x22c1('0xd7')];if(indexArray[_k][_0x22c1('0x32')]){indexArray[_k][_0x22c1('0x5e')](indexs['array']['slice'](start,start+count),offSet[_k]);}offSet[_k]+=groups[_i]['count'];}data={'position':new Float32Array(positions[_0x22c1('0x1e9')]),'normal':new Float32Array(normals[_0x22c1('0x1e9')]),'texCoord':new Float32Array(uvs[_0x22c1('0x1e9')])};model={'data':data,'indexArray':indexArray,'boundingBox':{'min':[boundingBox['min']['x'],boundingBox[_0x22c1('0x54')]['y'],boundingBox[_0x22c1('0x54')]['z']],'max':[boundingBox[_0x22c1('0x53')]['x'],boundingBox[_0x22c1('0x53')]['y'],boundingBox['max']['z']]}};return _context2['abrupt'](_0x22c1('0x1d'),model);case 0x68:case'end':return _context2[_0x22c1('0x341')]();}}},_callee2,null,[[0xc,0x11]]);}));return _createTextModel[_0x22c1('0x7')](this,arguments);}export{Bend,BendForPaths,FFD,FFDForPaths,ShapePath,TWIST,Verbatim,VerbatimForPaths,createTextModel,loadFont};
